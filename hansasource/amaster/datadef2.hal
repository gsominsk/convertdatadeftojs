/* datadef2.hal */
procedure DefineIVVcRecordType_Header(Boolean fieldsisf)
begin
  RecordField(InvDate,M4Date,0,0);
  RecordField(CustCode,M4Code,20,CUVc);
  RecordField(Math,M4Matrix,0,0);
  RecordField(PayDate,M4Date,0,0);
  RecordField(Addr0,M4Str,60,0);
  RecordField(Addr1,M4Str,60,0);
  RecordField(Addr2,M4Str,60,0);
  RecordField(Addr3,M4Str,60,0);
  RecordField(OurContact,M4Str,20,0);
  RecordField(ClientContact,M4Str,60,0);
  RecordField(ExportFlag,M4Int,0,0);
  RecordField(PayDeal,M4Code,2,0);
  RecordField(OrderNr,M4Long,0,0);
  RecordField(Prntdf,M4Int,0,0);
  RecordField(OKFlag,M4Mark,0,0);
  RecordField(pdays,M4Long,0,0);
  RecordField(pdvrebt,M4Qty,0,0);
  RecordField(pdrdays,M4Long,0,0);
  RecordField(CustCat,M4Code,5,0);
  RecordField(pdComment,M4Str,60,0);
  RecordField(x1,M4Dummy,0,0);
  RecordField(InvType,M4Int,0,0); /* 1 = Normal, 2 = Cash, 3 = Credit, 4 = Interest, 5 = Debit Note, 6 = Accounting Period + Net Days 7 = "Dummy" Prepayment Invoice*/
  RecordField(xStatFlag,M4Int,0,0);
  RecordField(PriceList,M4Code,5,0);
  RecordField(Objects,M4UStr,60,ObjVc);
  RecordField(InclVAT,M4Int,0,0);
  RecordField(ARAcc,M4Code,10,AccVc);
  RecordField(InvComment,M4Str,200,0);
  RecordField(CredInv,M4Long,0,0);
  RecordField(CredMark,M4Str,1,0);
  RecordField(SalesMan,M4UStr,60,UserVc);
  if (fieldsisf) then begin
    FieldIsUser(SalesMan);
  end;
  RecordField(ToRateB1,M4Rate,0,0);
  RecordField(TransDate,M4Date,0,0);
  if (fieldsisf) then begin
    FieldIsTransDate(TransDate);
  end;
  RecordField(CurncyCode,M4Code,5,CurncyCodeVc);
  RecordField(LangCode,M4Code,5,0);
  RecordField(UpdStockFlag,M4Int,0,0);
  RecordField(LastRemndr,M4Long,0,0);
  RecordField(LastRemDate,M4Date,0,0);
  RecordField(Sign,M4Code,10,UserVc);
  RecordField(FrPrice,M4Val,0,0);
  RecordField(FrBase,M4Val,0,0);
  RecordField(FrItem,M4Code,20,INVc);
  RecordField(FrVATCode,M4Code,10,VATCodeBlock);
  RecordField(FrObjects,M4UStr,60,ObjVc);
  RecordField(OrgCust,M4Code,20,CUVc);
  RecordField(FrGP,M4Val,0,0);
  RecordField(FrGPPercent,M4Val,0,0);
  RecordField(Sum0,M4Val,0,0);
  RecordField(Sum1,M4Val,0,0);
  RecordField(Sum2,M4Val,0,0);
  RecordField(Sum3,M4Val,0,0);
  RecordField(Sum4,M4Val,0,0);
  RecordField(VATNr,M4Str,20,0);
  RecordField(ShipDeal,M4Code,5,0);
  RecordField(ShipAddr0,M4Str,60,0);
  RecordField(ShipAddr1,M4Str,60,0);
  RecordField(ShipAddr2,M4Str,60,0);
  RecordField(ShipAddr3,M4Str,60,0);
  RecordField(ShipMode,M4Code,5,0);
  RecordField(Location,M4Code,10,LocationVc);
  if (fieldsisf) then begin
    FieldIsLocation(Location);
  end;
  RecordField(PRCode,M4Code,20,PRVc);
  RecordField(FrSalesAcc,M4Code,10,AccVc);
  RecordField(TAX1Sum,M4Val,0,0);
  RecordField(CustVATCode,M4Code,10,VATCodeBlock);
  RecordField(RebCode,M4Code,5,0);
  RecordField(CalcFinRef,M4Str,30,0);
  RecordField(Phone,M4PhoneNo,20,0);
  RecordField(Fax,M4Str,20,0);
  RecordField(IntCode,M4Str,10,0);
  RecordField(ARonTR,M4Int,0,0);
  RecordField(CustOrdNr,M4Str,60,0);
  RecordField(ExportedFlag,M4Int,0,0);
  RecordField(BaseSum4,M4Val,0,0);
  RecordField(FrRate,M4Rate,0,0); 
  RecordField(ToRateB2,M4Rate,0,0); 
  RecordField(BaseRate1,M4Rate,0,0); 
  RecordField(BaseRate2,M4Rate,0,0); 
  RecordField(InvoiceNr,M4Str,20,0);
  RecordField(DiscPerc,M4Qty,0,0);
  RecordField(DiscSum,M4Val,0,0);
  RecordField(TotGP,M4Val,0,0);
  RecordField(LocOKNr,M4Qty,0,0);
  RecordField(Invalid,M4Int,0,0);
  FieldIsInvalid(Invalid);
  RecordField(CreditCard,M4UStr,20,CreditCardVc);
  RecordField(AuthorizationCode,M4UStr,10,0);
  RecordField(RecValue,M4Val,0,0);
  RecordField(RetValue,M4Val,0,0);
  RecordField(FromBUQT,M4Int,0,0);
  RecordField(Sorting,M4Str,20,0);
  RecordField(NoInterestFlag,M4Int,0,0);
  RecordField(NoRemndrFlag,M4Int,0,0);
  RecordField(SVONr,M4Long,0,0);
  RecordField(InstallmentInv,M4Int,0,0);
  RecordField(OfficialSerNr,M4Str,100,0);
  RecordField(OfficialSerNr2,M4Str,100,0);
  RecordField(TotQty,M4Qty,0,0);
  RecordField(TotWeight,M4Qty,0,0);
  RecordField(TotVolume,M4Qty,0,0);
  RecordField(Commision,M4Val,0,0);
  RecordField(SumIncCom,M4Val,0,0);
  RecordField(InvAddr3,M4Str,60,0);
  RecordField(InvAddr4,M4Str,60,0);
  RecordField(DelAddr3,M4Str,60,0);
  RecordField(DelAddr4,M4Str,60,0);
  RecordField(DelAddrCode,M4Code,20,0);
  RecordField(AutoGiro,M4Int,0,0);
  RecordField(SalesGroup,M4UStr,30,SalesGroupVc);
  if (fieldsisf) then begin
    FieldIsGroup(SalesGroup);
  end;
  RecordField(DisputedFlag,M4Int,0,0);
  RecordField(NoColectionFlag,M4Int,0,0);
  RecordField(QTNr,M4Long,0,0);
  RecordField(FiscalFlag,M4Mark,0,0);
  RecordField(JobNr,M4Long,0,0);
  RecordField(RetnValue,M4Val,0,0);
  RecordField(MachineName,M4Code,20,0);
  RecordField(TransTime,M4Time,0,0);
  RecordField(DrawerCode,M4Code,5,0);
  RecordField(SiteX,M4Code,10,0);
  RecordField(colnr,M4Set,46,0);
  RecordField(StatVal,M4Val,0,0);
  RecordField(EInvFunc,M4Int,0,0);
  RecordField(EInvExpFlag,M4Int,0,0);
  RecordField(EInvExpDate,M4Date,0,0);
  RecordField(EInvExpQty,M4Long,0,0);
  RecordField(ServiceDelDate,M4Date,0,0);
  RecordField(Region,M4Code,20,RegionVc);
  RecordField(RefStr,M4Str,60,0);
  RecordField(TAX2Sum,M4Val,0,0);
  RecordField(pdvrebt2,M4Qty,0,0);
  RecordField(pdrdays2,M4Long,0,0);
  RecordField(NoTax1,M4Int,0,0);
  RecordField(NoTax2,M4Int,0,0);
  RecordField(FreightCode,M4Code,5,0);
  RecordField(BankCode,M4Str,60,BankVc);
  RecordField(InvalidDate,M4Date,0,0);
  RecordField(InvalidLocOKNr,M4Qty,0,0);
  RecordField(NoEInvoice,M4Int,0,0);
  RecordField(TaxAuthID,M4Str,200,0);
  RecordField(TaxAuthIDCC,M4Str,20,0);
  RecordField(BranchID,M4Code,20,CUVc);
  RecordField(Status,M4Set,361,0);
  RecordField(NoTAXonVAT,M4Long,0,0);
  RecordField(TotalwoTAX,M4Int,0,0);
  RecordField(CredManNr,M4Long,0,0);
  RecordField(RegDate,M4Date,0,0);
  RecordField(RegTime,M4Time,0,0);
  RecordField(COCUSerNr,M4Long,0,0);
  RecordField(CAE,M4Str,20,0);
  RecordField(CAEExpiry,M4Date,0,0);
  RecordField(VINr,M4Long,0,0);
  RecordField(TerminalID,M4Str,60,0);
  RecordField(OrderType,M4Set,433,0);
  RecordField(FiscalDeviceSeqNr,M4Long,0,0);
  RecordField(CCTransID,M4UStr,50,0);
  RecordField(AcceptanceStatus,M4Int,0,0);
  RecordField(TaxMatrix,M4PackedMatrix,0,TaxMatrixVc);
  RecordField(CustTaxTemplateCode,M4Code,10,TaxTemplateVc);
  RecordField(RoyaltyIVFlag,M4Int,0,0);
  RecordField(LoyaltyCardNr,M4Code,20,0);
  RecordField(LCMLevel,M4Code,10,0);
  RecordField(Points,M4Val,0,0); 
  RecordField(DepCode,M4Code,10,0);
  RecordField(SelfBilling,M4Int,0,0);
  RecordField(Hash,M4Str,255,0);
  RecordField(HashKeyVersion,M4Int,0,0);
  RecordField(InvCountry,M4Code,5,0);
  RecordField(DelCountry,M4Code,5,0);
  RecordField(TREONr,M4Long,0,0);
  RecordField(ORCONr,M4Long,0,0);
  RecordField(CAEAStartDate,M4Date,0,0);
  RecordField(CAEAExpiryDate,M4Date,0,0);
  RecordField(CAEAFlag,M4Int,0,0);
  RecordField(FInvExpFlag,M4Int,0,0);
  RecordField(GroupInv,M4Int,0,0);
  RecordField(Suspended,M4Int,0,0);
  RecordField(AcceptanceBy,M4List,200,UserVc);
  RecordField(RetNr,M4Long,0,0);
  RecordField(TaxAdminServSignatureTimeStamp,M4Str,30,0);
  RecordField(TaxAdminServCertificateNr,M4Str,20,0);
  RecordField(TaxAdminServSeal,M4Str,250,0);
  RecordField(CredOfficialSerNr,M4UStr,100,0);
  RecordField(AcceptanceFYI,M4List,200,UserVc);
  RecordField(PMCode,M4Code,2,0);
  RecordField(PayAccNo,M4Str,4,0);
  RecordField(BrazilEInvType,M4Code,10,BrazilEInvTypeVc);
  RecordField(TaxAdminReceiptNr,M4Str,200,0);
  RecordField(TaxAuthReceiptDate,M4Date,0,0);//Why we cannot use EInvExpDate from above ? 
  RecordField(TaxAuthReceiptTime,M4Time,0,0);
  RecordField(ReceiptInfo,M4Str,200,0);
  RecordField(InvalidTime,M4Time,0,0);
  RecordField(OKBy,M4Code,10,UserVc);
  RecordField(PlanSendDate,M4Date,0,0);
  RecordField(PlanSendTime,M4Time,0,0);
  RecordField(PlanArrDate,M4Date,0,0);
  RecordField(PlanArrTime,M4Time,0,0);
  RecordField(FedServCode,M4Code,10,FedServVc);
  RecordField(InvalidBy,M4Code,10,UserVc);
  RecordField(Reason,M4Code,20,0);
  RecordField(InvCountryName,M4Str,100,0);
  RecordField(DelCountryName,M4Str,100,0);
  RecordField(OfficialSerNrSerie,M4Str,30,0);
  RecordField(OfficialSerNr2Serie,M4Str,30,0);
  RecordField(IPBookVAT,M4Int,0,0);
  RecordField(ThirdPartyBillMark,M4Int,0,0);
  RecordField(RecipientGLN,M4Str,20,0);
  RecordField(DelRecipientGLN,M4Str,20,0);
  RecordField(IntrastatTransCode,M4Code,20,0);
  RecordField(GlobalTransportNr,M4UStr,30,0);
  RecordField(GlobalTransportDate,M4Date,0,0);
  RecordField(DeliverySiteCode,M4Str,60,0);
  RecordField(PrintDate,M4Str,60,0);
  RecordField(WorkSiteNumber,M4Str,60,0);
  RecordField(GPProc,M41Val,0,0);
  RecordField(TaxInvType,M4Set,609,0);
  RecordField(OYNr,M4Long,0,OYVc);
  RecordField(OYDescription,M4Str,200,0);
  RecordField(eMail,M4Str,60,0);
  RecordField(RvrsVAT,M4Val,0,0);
  RecordField(RegNr1,M4Str,20,0);
  RecordField(PromotionCodes,M4List,200,0);
  RecordField(BankReceiptNr,M4Str,20,0);
  RecordField(ExcludeFromExports,M4Int,0,0);
  return;
end; 

procedure DefineIVVcRecordType_Array()
begin
  ArrayBegin(Math,-,1);
  ArrayField(stp,M4Int,0,0);
  ArrayField(ArtCode,M4Code,20,INVc); //?? M4Str in interest rowtype??
  ArrayField(Quant,M4UVal,0,0);
  ArrayField(Price,M423Val,0,0);
  ArrayField(Sum,M4Val,0,0);
  ArrayField(vRebate,M41Val,0,0);
  ArrayField(SalesAcc,M4Code,10,AccVc);
  ArrayField(Objects,M4UStr,60,ObjVc);
  ArrayField(OrdRow,M4Long,0,0);
  ArrayField(BasePrice,M4Val,0,0);
  ArrayField(rowGP,M4Val,0,0);
  ArrayField(FIFO,M45Val,0,0);
  ArrayField(Spec,M4Str,100,0);
  ArrayField(VATCode,M4Code,10,VATCodeBlock);
  ArrayField(Recepy,M4Code,20,RecVc);
  ArrayField(SerialNr,M4Str,60,0);
  ArrayField(PriceFactor,M45Val,0,0);
  ArrayField(VARList,M4UStr,30,0);
  ArrayField(CUPNr,M4Long,0,0);
  ArrayField(FIFORowVal,M45Val,0,0);
  ArrayField(Coefficient,M45Val,0,0);
  ArrayField(CuAccCode,M4Code,20,0);
  ArrayField(ExciseNr,M4Str,20,0); // This is ShipDate!?!
  ArrayField(PeriodCode,M4Code,10,0);
  ArrayField(UnitCode,M4Code,5,0);
  ArrayField(UnitFactQuant,M4UVal,0,0);
  ArrayField(UnitFactPrice,M423Val,0,0);
  ArrayField(UnitXval,M4UVal,0,0);
  ArrayField(UnitYval,M4UVal,0,0);
  ArrayField(UnitZval,M4UVal,0,0);
  ArrayField(VECode,M4Code,20,VEVc);
  ArrayField(CreditCard,M4UStr,20,CreditCardVc);
  ArrayField(AuthorizationCode,M4UStr,10,0);
  ArrayField(PosCode,M4Code,20,0);  
  ArrayField(CurncyCode,M4Code,5,CurncyCodeVc); 
  ArrayField(FrRate,M4Rate,0,0); 
  ArrayField(ToRateB1,M4Rate,0,0);
  ArrayField(ToRateB2,M4Rate,0,0); 
  ArrayField(BaseRate1,M4Rate,0,0); 
  ArrayField(BaseRate2,M4Rate,0,0);   
  ArrayField(PayMode,M4Code,2,0);   
  ArrayField(GCNr,M4Long,0,0);   
  ArrayField(CustOrdNr,M4Str,60,0);
  ArrayField(RepaExVAT,M4Val,0,0);
  ArrayField(BasePriceB2,M4Val,0,0);
  ArrayField(TAX2Code,M4Code,5,0);
  ArrayField(TAX2Prc,M423Val,0,0);
  ArrayField(TAX2Reb,M4Val,0,0);
  ArrayField(TAX1Reb,M4Val,0,0);
  ArrayField(TAX2Acc,M4Code,10,AccVc);
  ArrayField(CreditedRow,M4Long,0,0);
  ArrayField(NotUpdStockFlag,M4Int,0,0);
  ArrayField(CUServiceHistNr,M4Long,0,0);
  ArrayField(CUServiceUntilDate,M4Date,0,0);
  ArrayField(ServiceDelDate,M4Date,0,0);
  ArrayField(Location,M4Code,10,LocationVc);
  ArrayField(Comment,M4Str,100,0);
  ArrayField(DiscApprovedBy,M4Code,10,UserVc);
  ArrayField(Perceptions,M4Int,0,0);
  ArrayField(VoidedRowNr,M4Long,0,0);   
  ArrayField(VoidedSign,M4Code,10,UserVc);
  ArrayField(ovst,M4Int,0,0);
  ArrayField(Withholdings,M4Int,0,0);
  ArrayField(WHTax,M4Code,2,0);
  ArrayField(CCTransID,M4UStr,50,0);
  ArrayField(TaxMatrix,M4PackedMatrix,0,TaxMatrixVc);
  ArrayField(TaxTemplateCode,M4UStr,60,TaxTemplateVc);
  ArrayField(ResUsage,M4Code,10,ResUsageVc);
  ArrayField(MBRCode,M4Code,10,MultiBuyRebVc);
  ArrayField(ChequeNr,M4Long,0,0);
  ArrayField(CheckNr,M4UStr,20,0);   
  ArrayField(Points,M4Val,0,0);   
  ArrayField(SalesAssistant,M4Code,10,UserVc);
  ArrayField(CCTimestamp,M4Str,20,0);
  ArrayField(MotherArtCode,M4Code,20,INVc);
  ArrayField(RecipeQuant,M4Qty,0,0);
  ArrayField(OrdNr,M4Long,0,0);
  ArrayField(IVNr,M4Long,0,0);
  ArrayField(RetRow,M4Long,0,0);
  ArrayField(QTRow,M4Long,0,0);
  ArrayField(SHNr,M4Long,0,0);
  ArrayField(SHRow,M4Long,0,0);
  ArrayField(CustArtCode,M4Code,20,CUINVc);
  ArrayField(Salesmen,M4UStr,60,UserVc);
  ArrayField(CredOfficialSerNr,M4Str,100,0);
  ArrayField(MotherNr,M4Str,60,0);
  ArrayField(AEStatus,M4Set,544,0);
  ArrayField(CustomsNr,M4Str,30,0);
  ArrayField(CountryOfOrg,M4Code,5,CountryVc);
  ArrayField(SecondarySerialNr,M4Str,60,0);
  ArrayField(AlternateDeviceID,M4Str,30,0);
  ArrayField(MotherSecondarySerialNr,M4Str,60,0);
  ArrayField(MotherAlternateDeviceID,M4Str,30,0);
  ArrayField(UnitComment,M4Str,200,0);
  ArrayField(RvrsVATCode,M4Code,10,VATCodeBlock);
  EndArray;
  return;
end; 

begin
  RecordBegin(CLInVc,-,"");
  ImpExpLevel(3);  
  RecordField(SerNr,M4Long,0,0);
  SerialNoBlock(CLInSerBlock);
  RecordField(NetVal,M4Val,0,0);
  RecordField(VATVal,M4Val,0,0);
  RecordField(Total,M4Val,0,0);
  RecordField(TransDate,M4Date,0,0);
  FieldIsTransDate(TransDate);
  RecordField(PayMode,M4Code,2,0);
  RecordField(Person,M4Code,10,UserVc);
  FieldIsUser(Person);
  RecordField(CorspCode,M4Code,20,0);
  RecordField(CorspComment,M4Str,60,0);
  RecordField(CUCode,M4Code,20,CUVc);
  RecordField(CUName,M4Str,60,0);
  RecordField(Addr0,M4Str,60,0);
  RecordField(Addr1,M4Str,60,0);
  RecordField(Addr2,M4Str,60,0);
  RecordField(Comment,M4Str,200,0);
  RecordField(VATCode,M4Code,10,VATCodeBlock);
  RecordField(OKFlag,M4Mark,0,0);
  RecordField(ExportedFlag,M4Int,0,0);
  RecordField(RefStr,M4Str,60,0);
  RecordField(Objects,M4UStr,60,ObjVc);
  RecordField(CurncyCode,M4Code,5,CurncyCodeVc);
  RecordField(FrRate,M4Rate,0,0); 
  RecordField(ToRateB1,M4Rate,0,0); 
  RecordField(ToRateB2,M4Rate,0,0); 
  RecordField(BaseRate1,M4Rate,0,0); 
  RecordField(BaseRate2,M4Rate,0,0); 
  RecordField(FileName,M4Str,20,0); 
  RecordField(FSerNr,M4Long,0,0); 
  RecordField(TAX1Sum,M4Val,0,0);
  RecordField(PMObjects,M4UStr,60,ObjVc);
  RecordField(Addr3,M4Str,60,0);
  RecordField(Addr4,M4Str,60,0);
  RecordField(LangCode,M4Code,5,0);
  RecordField(ColFlag,M4Mark,0,0);
  RecordField(Invalid,M4Int,0,0);
  FieldIsInvalid(Invalid);
  RecordField(ARonTR,M4Int,0,0);
  RecordField(PPOKNr,M4Long,0,0);
  RecordField(OfficialSerNr,M4Str,100,0);
  RecordField(TAX2Sum,M4Val,0,0);
  RecordField(Math,M4Matrix,0,0);
  RecordField(SalesGroup,M4Code,5,SalesGroupVc);
  FieldIsGroup(SalesGroup);
  RecordField(OfficialSerNrSerie,M4Str,30,0);
  ArrayBegin(Math,-,1);
  ArrayField(Type,M4Set,66,0);
  ArrayField(Company,M4Code,20,CUVc);
  ArrayField(TransNr,M4Long,0,0);
  ArrayField(Sum,M4Val,0,0);
  ArrayField(Objects,M4UStr,60,ObjVc);
  ArrayField(OrderNr,M4Long,0,0);
  ArrayField(CorspCode,M4Code,20,0);
  ArrayField(Comment,M4Str,60,0);
  ArrayField(stp,M4Int,0,0);
  ArrayField(TAX1Sum,M4Val,0,0);
  ArrayField(TAX2Sum,M4Val,0,0);
  ArrayField(ARAPAcc,M4Code,10,AccVc);
  ArrayField(PayMode,M4Code,2,0);
  ArrayField(TransOfficialSerNr,M4Str,100,0);
  EndArray;  

  MainKeyBegin(SerNr,1);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesGroup);
  AppendFieldToKeyName(Person);
  KeySegment(SerNr);
  KeyBegin(ExportedFlag);
  KeySegment(ExportedFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(TransDate);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesGroup);
  AppendFieldToKeyName(Person);
  KeySegment(TransDate);
  KeySegment(SerNr);
  SubsetKeyBegin2(Comment);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesGroup);
  AppendFieldToKeyName(Person);
  KeySegment(Comment);
  KeySegment(SerNr);
  KeyBegin(ColFlag);
  KeySegment(ColFlag);
  KeySegment(SerNr);
  KeyBegin(PPOKNr);
  KeySegment(PPOKNr);
  KeySegment(SerNr);  
  SubsetKeyBegin2(OKFlag);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesGroup);
  AppendFieldToKeyName(Person);
  KeySegment(OKFlag);
  KeySegment(SerNr);
  KeyBegin(OfficialSerNr);
  KeySegment(OfficialSerNr);
  KeySegment(SerNr);

  EndRecord;

  RecordBegin(CLOutVc,-,"");
  RecordField(SerNr,M4Long,0,0);
  SerialNoBlock(CLOutSerBlock);
  RecordField(Total,M4Val,0,0);
  RecordField(TransDate,M4Date,0,0);
  FieldIsTransDate(TransDate);
  RecordField(PayMode,M4Code,2,0);
  RecordField(Person,M4Code,10,UserVc);
  FieldIsUser(Person);
  RecordField(CorspCode,M4Code,20,0);
  RecordField(CorspComment,M4Str,60,0);
  RecordField(CUCode,M4Code,20,VEVc);
  RecordField(CUName,M4Str,60,0);
  RecordField(Comment,M4Str,200,0);
  RecordField(OKFlag,M4Mark,0,0);
  RecordField(ExportedFlag,M4Int,0,0);
  RecordField(Objects,M4UStr,60,ObjVc);
  RecordField(Addr0,M4Str,60,0);
  RecordField(Addr1,M4Str,60,0);
  RecordField(Addr2,M4Str,60,0);
  RecordField(CurncyCode,M4Code,5,CurncyCodeVc);
  RecordField(FrRate,M4Rate,0,0); 
  RecordField(ToRateB1,M4Rate,0,0); 
  RecordField(ToRateB2,M4Rate,0,0); 
  RecordField(BaseRate1,M4Rate,0,0); 
  RecordField(BaseRate2,M4Rate,0,0); 
  RecordField(NetVal,M4Val,0,0);
  RecordField(VATVal,M4Val,0,0);
  RecordField(VATCode,M4Code,10,VATCodeBlock);
  RecordField(RefStr,M4Str,60,0);
  RecordField(PMObjects,M4UStr,60,ObjVc);
  RecordField(Addr3,M4Str,60,0);
  RecordField(Addr4,M4Str,60,0);
  RecordField(FileName,M4Str,20,0);
  RecordField(FSerNr,M4Long,0,0);
  RecordField(LangCode,M4Code,5,0);
  RecordField(ColFlag,M4Mark,0,0);
  RecordField(LocalMachineCode,M4Code,20,0);
  RecordField(Invalid,M4Int,0,0);
  FieldIsInvalid(Invalid);
  RecordField(ARonTR,M4Int,0,0);
  RecordField(PPOKNr,M4Long,0,0);
  RecordField(TAX1Sum,M4Val,0,0);
  RecordField(TAX2Sum,M4Val,0,0);
  RecordField(Math,M4Matrix,0,0);
  RecordField(SalesGroup,M4Code,5,SalesGroupVc);
  FieldIsGroup(SalesGroup);
  ArrayBegin(Math,-,1);
  ArrayField(Type,M4Set,73,0);
  ArrayField(Company,M4Code,20,CUVc);
  ArrayField(TransNr,M4Long,0,0);
  ArrayField(Sum,M4Val,0,0);
  ArrayField(Objects,M4UStr,60,ObjVc);
  ArrayField(OrderNr,M4Long,0,0);
  ArrayField(CorspCode,M4Code,20,0);
  ArrayField(Comment,M4Str,60,0);
  ArrayField(stp,M4Int,0,0);
  ArrayField(TAX1Sum,M4Val,0,0);
  ArrayField(TAX2Sum,M4Val,0,0);
  ArrayField(APARAcc,M4Code,10,AccVc);
  ArrayField(PayMode,M4Code,2,0);
  ArrayField(DocNr,M4Str,20,0);
  ArrayField(ExpDate,M4Date,0,0);
  ArrayField(VEName,M4Str,60,0);
  ArrayField(Identifier,M4Str,20,0);
  ArrayField(VATCode,M4Code,10,VATCodeBlock);
  ArrayField(TransOfficialSerNr,M4Str,100,0);
  EndArray;    
  MainKeyBegin(SerNr,1);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesGroup);
  AppendFieldToKeyName(Person);
  KeySegment(SerNr);
  KeyBegin(ExportedFlag);
  KeySegment(ExportedFlag);
  KeySegment(SerNr);  
  SubsetKeyBegin2(TransDate);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesGroup);
  AppendFieldToKeyName(Person);
  KeySegment(TransDate);
  KeySegment(SerNr);  
  SubsetKeyBegin2(Comment);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesGroup);
  AppendFieldToKeyName(Person);
  KeySegment(Comment);
  KeySegment(SerNr);  
  KeyBegin(ColFlag);
  KeySegment(ColFlag);
  KeySegment(SerNr);
  KeyBegin(PPOKNr);
  KeySegment(PPOKNr);
  KeySegment(SerNr);
  SubsetKeyBegin2(OKFlag);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesGroup);
  AppendFieldToKeyName(Person);
  KeySegment(OKFlag);
  KeySegment(SerNr);
  EndRecord;

  RecordBegin(CLCorspVc,-,"clcorsp");
  RecordField(Code,M4Code,20,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(AccNumber,M4Code,10,AccVc);
  RecordField(Closed,M4Mark,0,0);
  MainKeyBegin(Code,0);
  KeySegment(Code);
  KeyBegin(Comment);
  KeySegment(Comment);
  KeySegment(Code);
  KeyBegin(Code2);
  KeySegment(Code);  
  EndRecord;

  RecordBegin(OPPVc,-,"");
  ImpExpLevel(0);
  RecordField(SerNr,M4Long,0,0);
  RecordField(PPVal,M4Val,0,0);
  RecordField(PayDate,M4Date,0,0);
  RecordField(VECode,M4Code,20,VEVc);
  RecordField(RebDate,M4Date,0,0);
  RecordField(VEName,M4Str,60,0);
  RecordField(CurncyCode,M4Code,5,CurncyCodeVc);
  RecordField(BookRVal,M4Val,0,0);
  RecordField(VATVal,M4Val,0,0);
  RecordField(VATCode,M4Code,10,VATCodeBlock);
  RecordField(VATBookVal,M4Val,0,0);
  RecordField(BankCurncy,M4Code,5,CurncyCodeVc);
  RecordField(OrderNr,M4Long,0,0);
  MainKeyBegin(SerNr,0);
  KeySegment(SerNr);
  KeySegment(VECode);
  KeyBegin(PayDate);
  KeySegment(PayDate);
  KeySegment(SerNr);
  KeySegment(VECode);
  KeyBegin(RebDate);
  KeySegment(RebDate);
  KeySegment(SerNr);
  KeySegment(VECode);
  KeyBegin(VECode);
  KeySegment(VECode);
  KeySegment(SerNr);
  KeyBegin(VEName);
  KeySegment(VEName);
  KeySegment(VECode);
  KeySegment(SerNr);
  KeyBegin(OrderNr);
  KeySegment(OrderNr);
  KeySegment(SerNr);
  KeySegment(VECode);
  EndRecord;
      
  RecordBegin(SPLVc,-,"");
  RecordField(SerNr,M4Long,0,0);
  SerialNoBlock(SPLSerBlock);
  RecordField(RegDate,M4Date,0,0);
  RecordField(TransDate,M4Date,0,0);
  FieldIsTransDate(TransDate);
  RecordField(Comment,M4Str,60,0);
  RecordField(Math,M4Matrix,0,0);
  RecordField(VECode,M4Code,20,VEVc);
  RecordField(VEName,M4Str,60,0);
  RecordField(PONr,M4Long,0,0);
  RecordField(Location,M4Code,10,LocationVc);
  FieldIsLocation(Location);
  RecordField(OKFlag,M4Mark,0,0);
  RecordField(CurncyCode,M4Code,5,CurncyCodeVc);
  RecordField(ToRateB1,M4Rate,0,0);
  RecordField(InclVAT,M4Int,0,0);
  RecordField(SumCostPrice,M45Val,0,0);
  RecordField(SumQuant,M4Qty,0,0);
  RecordField(ShipCost,M4UVal,0,0);
  RecordField(CustomsCost,M4UVal,0,0);
  RecordField(ExtraCost,M4UVal,0,0);
  RecordField(ExportedFlag,M4Int,0,0);
  RecordField(FrRate,M4Rate,0,0); 
  RecordField(ToRateB2,M4Rate,0,0); 
  RecordField(BaseRate1,M4Rate,0,0); 
  RecordField(BaseRate2,M4Rate,0,0); 
  RecordField(LocOKNr,M4Qty,0,0);
  RecordField(Objects,M4UStr,60,ObjVc);
  RecordField(PUClass,M4Code,10,0);
  RecordField(POCOSerNr,M4Long,0,0);
  RecordField(Cost1,M4UVal,0,0);
  RecordField(Cost2,M4UVal,0,0);
  RecordField(Cost3,M4UVal,0,0);
  RecordField(Cost4,M4UVal,0,0);
  RecordField(Cost5,M4UVal,0,0);
  RecordField(VATVal,M4UVal,0,0);
  RecordField(SubTotal,M4UVal,0,0);
  RecordField(PayVal,M4UVal,0,0);
  RecordField(VEVATCode,M4Code,10,VATCodeBlock);
  RecordField(Invalid,M4Int,0,0);
  FieldIsInvalid(Invalid);
  ArrayBegin(Math,-,1);
  ArrayField(ArtCode,M4Code,20,INVc);
  ArrayField(Quant,M4UVal,0,0);
  ArrayField(Spec,M4Str,100,0);
  ArrayField(UPrice,M45Val,0,0);
  ArrayField(SerialNr,M4Str,60,0);
  ArrayField(OrdRow,M4Long,0,0);
  ArrayField(Extra,M4PrcStr,20,0);
  ArrayField(CostPrice,M45Val,0,0);
  ArrayField(VEItemCode,M4Code,20,0);
  ArrayField(VARList,M4UStr,30,0);
  ArrayField(ShipCost,M45Val,0,0);
  ArrayField(CustomsCost,M4PrcStr,20,0); //!!
  ArrayField(BestBefore,M4Date,0,0);
  ArrayField(Coefficient,M45Val,0,0);
  ArrayField(BasePrice,M423Val,0,0);
  ArrayField(Sum,M45Val,0,0);
  ArrayField(Comment,M4Str,30,0);
  ArrayField(Objects,M4UStr,60,ObjVc);
  ArrayField(CostAcc,M4UStr,10,AccVc);
  ArrayField(CredAcc,M4UStr,10,AccVc);
  ArrayField(CustomsNr,M4Str,30,0);
  ArrayField(CountryOfOrg,M4Code,5,0);
  ArrayField(PosCode,M4Code,20,0);
  ArrayField(BatchStatus,M4Code,20,BatchStatusVc);
  ArrayField(UnitXval,M4UVal,0,0);
  ArrayField(UnitYval,M4UVal,0,0);
  ArrayField(UnitZval,M4UVal,0,0);
  ArrayField(RowCost1,M4UVal,0,0);
  ArrayField(RowCost2,M4UVal,0,0);
  ArrayField(RowCost3,M4UVal,0,0);
  ArrayField(RowCost4,M4UVal,0,0);
  ArrayField(RowCost5,M4UVal,0,0);
  ArrayField(VATCode,M4Code,10,VATCodeBlock);
  ArrayField(stp,M4Int,0,0);
  ArrayField(ovst,M4Int,0,0);
  ArrayField(Sign,M4Code,10,UserVc);
  ArrayField(UpdDate,M4Date,0,0);
  EndArray;
  MainKeyBegin(SerNr,0);
  KeySegment(SerNr);
  SynchronizationIndex;
  KeyBegin(ExportedFlag);
  KeySegment(ExportedFlag);
  KeySegment(SerNr);
  KeyBegin(OKFlag);
  KeySegment(OKFlag);
  KeySegment(SerNr);
  KeyBegin(TransDate);
  KeySegment(TransDate);
  KeySegment(SerNr);
  KeyBegin(PONr);
  KeySegment(PONr);
  KeySegment(SerNr);
  KeyBegin(VECode);
  KeySegment(VECode);
  KeySegment(SerNr);
  KeyBegin(Comment);
  KeySegment(Comment);
  KeySegment(SerNr);
  KeyBegin(LocOK);
  KeySegment(Location);
  KeySegment(OKFlag);
  KeySegment(TransDate);  
  KeySegment(SerNr);  
  KeyBegin(Location);
  KeySegment(Location);
  KeySegment(SerNr);
  EndRecord;
  
  RecordBegin(ItemHistVc,-,"ItemHistVc2");
  RecordField(SerNr,M4Long,0,ItemHistVc);
  RecordField(ArtCode,M4Code,20,INVc);
  RecordField(Variety,M4Code,20,0);
  RecordField(Location,M4Code,10,LocationVc);
  FieldIsLocation(Location);
  RecordField(FileName,M4Str,20,0);
  RecordField(TransNr,M4Long,0,0);
  RecordField(Row,M4Int,0,0);
  RecordField(TransDate,M4Date,0,0);
  RecordField(StockAffectf,M4Int,0,0);
  RecordField(Qty,M45Val,0,0);
  RecordField(Qty2,M45Val,0,0);
  RecordField(RemQty,M45Val,0,0);
  RecordField(Source,M4Long,0,ItemHistVc);
  RecordField(TotCostPrice,M45Val,0,0);
  RecordField(SerialNr,M4Str,60,0);
  RecordField(RemCostPrice,M45Val,0,0);
  RecordField(FIFODate,M4Date,0,0);
  RecordField(WATotCost,M45Val,0,0);
  RecordField(CPTotCost,M45Val,0,0);
  RecordField(BPTotCost,M45Val,0,0);
  RecordField(WATotCostPerLoc,M45Val,0,0);
  RecordField(CPTotCostPerLoc,M45Val,0,0);
  RecordField(BPTotCostPerLoc,M45Val,0,0);
  RecordField(Position,M4Code,20,PosVc);
  RecordField(Invalid,M4Int,0,0);
  FieldIsInvalid(Invalid);
  RecordField(SerNrPerLoc,M4Qty,0,0);
  RecordField(VECode,M4Code,20,CUVc);
  RecordField(ConsigStock,M4Int,0,0);
  RecordField(WillBePurged,M4Mark,0,0);
  RecordField(TREOStock,M4Int,0,0);
  RecordField(PrimaryCostModel,M4Int,0,0);
  RecordField(QueuedCostModel,M4Int,0,0);
  RecordField(FIFOPerLocation,M4Int,0,0);
  RecordField(ItemType,M4Int,0,0);
  RecordField(FIFOPerSerialNr,M4Int,0,0);
  RecordField(NoNLCostOnShip,M4Int,0,0);
  RecordField(WAPerLocation,M4Int,0,0);
  RecordField(WABase2,M4Int,0,0);
  RecordField(UpdWeightAvFromRetPU,M4Int,0,0);
  RecordField(UpdWeightAvFromRet,M4Int,0,0);
  MainKeyBegin(SerNr,0);
  KeySegment(SerNr);
  KeyBegin(ActiveQty);
  KeySegment(ArtCode);
  KeySegment(FIFODate);
  KeySegment(SerNr);
  KeyBegin(ActiveLocQty);
  KeySegment(ArtCode);
  KeySegment(Location);
  KeySegment(FIFODate);
  KeySegment(SerNr);
  KeyBegin(ArtCode);
  KeySegment(ArtCode);
  KeySegment(TransDate);
  KeySegment(SerNr);
  KeyBegin(ArtCodeVariety); // KJELL
  KeySegment(ArtCode);
  KeySegment(Variety);
  KeySegment(TransDate);
  KeySegment(SerNr);
  KeyBegin(FNTransNr);
  KeySegment(FileName);
  KeySegment(TransNr);
  KeySegment(Row);
  KeySegment(SerNr);
  KeyBegin(ArtCodeLoc);
  KeySegment(ArtCode);
  KeySegment(Location);
  KeySegment(TransDate);
  KeySegment(SerNr);
  KeyBegin(ArtCodeSN);
  KeySegment(ArtCode);
  KeySegment(SerNr);
  KeyBegin(ArtCodeLocSN);
  KeySegment(ArtCode);
  KeySegment(Location);
  KeySegment(SerNr);
  KeyBegin(ArtCodeFD);
  KeySegment(ArtCode);
  KeySegment(FIFODate);
  KeySegment(SerNr);
  KeyBegin(ArtCodeLocFD);
  KeySegment(ArtCode);
  KeySegment(Location);
  KeySegment(FIFODate);
  KeySegment(SerNr);
  KeyBegin(FNArtCode);
  KeySegment(FileName);
  KeySegment(ArtCode);
  KeySegment(TransDate);
  KeySegment(SerNr);
  KeyBegin(Source);
  KeySegment(Source);
  KeySegment(SerNr);
  KeyBegin(ArtCodeSerialNr);
  KeySegment(ArtCode);
  KeySegment(SerialNr);
  KeySegment(FileName);
  KeySegment(SerNr);
  KeyBegin(Position);
  KeySegment(Position);
  KeySegment(ArtCode);
  KeySegment(SerNr);
  KeyBegin(FutArtFile);
  KeySegment(ArtCode);
  KeySegment(TransDate);
  KeySegment(FileName);
  KeySegment(SerNr);
  KeyBegin(SerNrPerLoc);
  KeySegment(Location);
  KeySegment(SerNrPerLoc);
  KeySegment(SerNr); 
  KeyBegin(TransDate);
  KeySegment(TransDate);
  KeySegment(SerNr);
  KeyBegin(FNTransDate);
  KeySegment(FileName);
  KeySegment(TransDate);
  KeySegment(ArtCode);
  KeySegment(SerNr);
  KeyBegin(FNLocation);
  KeySegment(FileName);
  KeySegment(Location);
  KeySegment(TransDate);
  KeySegment(SerNr);
  KeyBegin(SerialNr);
  KeySegment(SerialNr);
  KeySegment(FileName);
  KeySegment(SerNr);
  KeyBegin(ActiveSerialNr);
  KeySegment(ArtCode);
  KeySegment(SerialNr);
  KeySegment(SerNr);
  EndRecord;
  
  RecordBegin(TempStockVc,-,"");
  ImpExpLevel(0);
  RecordField(TransDate,M4Date,0,0);
  RecordField(FileName,M4Str,20,0);
  RecordField(TransNr,M4Long,0,0);
  RecordField(LocOKNr,M4Qty,0,0);
  RecordField(RecordWeight,M4Int,0,0); // Not used
  RecordField(Qty,M4Qty,0,0);
  RecordField(TotCostPrice,M45Val,0,0);
  RecordField(WATotCost,M45Val,0,0);
  RecordField(CPTotCost,M45Val,0,0);
  RecordField(BPTotCost,M45Val,0,0);
  RecordField(WATotCostPerLoc,M45Val,0,0);
  RecordField(CPTotCostPerLoc,M45Val,0,0);
  RecordField(BPTotCostPerLoc,M45Val,0,0);
  RecordField(Location,M4Code,10,LocationVc);
  RecordField(Invalid,M4Int,0,0);
  RecordField(OKStatus,M4Int,0,0);
  RecordField(Math,M4Matrix,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(ArtCode,M4Code,20,INVc);
  ArrayField(Row,M4Long,0,0);

  ArrayField(PrimaryCostModel,M4Int,0,0);
  ArrayField(QueuedCostModel,M4Int,0,0);
  ArrayField(FIFOPerLocation,M4Int,0,0);
  ArrayField(ItemType,M4Int,0,0);
  ArrayField(FIFOPerSerialNr,M4Int,0,0);
  ArrayField(NoNLCostOnShip,M4Int,0,0);
  ArrayField(WAPerLocation,M4Int,0,0);
  ArrayField(WABase2,M4Int,0,0);
  ArrayField(UpdWeightAvFromRetPU,M4Int,0,0);
  ArrayField(UpdWeightAvFromRet,M4Int,0,0);
  ArrayField(StockAffectf,M4Int,0,0);

  EndArray;
  
  MainKeyBegin(TransDate,0);
  KeySegment(TransDate);
  KeySegment(LocOKNr);
  KeySegment(FileName);
  KeySegment(TransNr);
  KeyBegin(LocOKNr);
  KeySegment(LocOKNr);
  KeySegment(FileName);
  KeySegment(TransDate);
  KeySegment(TransNr);    
  KeyBegin(LocationLocOKNr);
  KeySegment(Location);
  KeySegment(LocOKNr);
  KeySegment(FileName);
  KeySegment(TransDate);
  KeySegment(TransNr);
  KeyBegin(LocationDate);
  KeySegment(Location);
  KeySegment(TransDate);
  KeySegment(FileName);
  KeySegment(TransNr);
  KeySegment(LocOKNr);
  KeyBegin(FileName);
  KeySegment(FileName);
  KeySegment(TransNr);
  KeySegment(TransDate);
  KeySegment(LocOKNr);
  EndRecord;

// only for the type
  RecordBegin(RepDefVc,RepDefType,"");
  ImpExpLevel(0);
  RecordField(repname,M4Str,40,0);
  RecordField(shortname,M4Str,20,0);
  RecordField(header,M4Str,60,0);
  MainKeyBegin(Code,0);
  KeySegment(repname);
  EndRecord;

// Data area for login window
  RecordBegin(USRowVc,-,"");
  ImpExpLevel(0);
  RecordField(Sign,M4Code,10,UserVc);
  RecordField(Name,M4Str,60,0);
  RecordField(Password,M4Str,20,0);
  RecordField(TextStr,M4Str,60,0);
  RecordField(MasterPassword,M4Str,60,0);
  RecordField(LoginMode,M4Set,341,0);
  RecordField(CompCode,M4Int,0,0); // new "magic" set needed
  RecordField(RememberLoginf,M4Int,0,0);
  MainKeyBegin(Code,0);
  KeySegment(Sign);
  EndRecord;

// not exported yet
  RecordBegin(PrintSelVc,PrintSelType,"");
  ImpExpLevel(0);
  RecordField(repname,M4Str,40,0);
  RecordField(printername,M4Str,20,0);
  RecordField(bgfilename,M4Str,40,0);
  MainKeyBegin(Code,0);
  KeySegment(repname);
  EndRecord;

  RecordBegin(CuAccVc,-,"cuacc");
  RecordField(Code,M4Code,20,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(CUCode,M4Code,20,CUVc);
  RecordField(CUName,M4Str,60,0);
  RecordField(IntCode,M4Code,5,0);
  RecordField(MainAcc,M4Code,10,AccVc);
  RecordField(Objects,M4UStr,60,ObjVc);
  RecordField(Limit,M4Qty,0,0);
  RecordField(ExtraLimit,M4Qty,0,0);
  RecordField(Math,M4Matrix,0,0);
  RecordField(InstNr,M4UVal,0,0);
  RecordField(Closed,M4Mark,0,0);
  RecordField(TransDate,M4Date,0,0);
  RecordField(LoanStatus,M4Str,60,0);
  RecordField(LoanSuccess,M4Str,60,0);
  ArrayBegin(Math,-,1);
  ArrayField(PlanDate,M4Date,0,0);
  ArrayField(InvNr,M4Long,0,IVVc);
  ArrayField(ValStr,M4Str,20,0);//M4PrcStr
  ArrayField(Person,M4Code,10,UserVc);
  ArrayField(Comment,M4Str,60,0);
  EndArray;
  MainKeyBegin(Code,0);
  KeySegment(Code);
  KeyBegin(Comment);
  KeySegment(Comment);
  KeySegment(Code);
  KeyBegin(CUCode);
  KeySegment(CUCode);
  KeySegment(Code);
  KeyBegin(CUName);
  KeySegment(CUName);
  KeySegment(CUCode);
  KeySegment(Code);
  KeyBegin(Closed);
  KeySegment(Closed);
  KeySegment(Code);
  EndRecord;
 
  BlockBegin(LoanStatusBlock,-,"");
  RecordField(Math,M4Matrix,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(Status2,M4Str,60,0);
  EndArray;
  EndBlock;

  BlockBegin(LoanSuccessBlock,-,"");
  RecordField(Math,M4Matrix,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(Success2,M4Str,60,0);
  EndArray;
  EndBlock;

  RecordBegin(IntVc,-,"int");
  RecordField(Code,M4Code,5,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(FreeCode,M4Code,5,0);
  RecordField(daysinYear,M4Long,0,0);
  RecordField(RndTotal,M4Set,70,0);
  MainKeyBegin(Code,0);
  KeySegment(Code);
  EndRecord;
 
  RecordBegin(IRVc,-,"ir");
  RecordField(Math,M4Matrix,0,0);
  RecordField(Code,M4Code,5,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(startDate,M4Date,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(limit,M4Qty,0,0);
  ArrayField(rate,M4Qty,0,0);
  EndArray;
  MainKeyBegin(CDKey,0);
  KeySegment(Code);
  KeySegment(startDate);
  EndRecord;
 
  RecordBegin(TSVc,-,"TimeSheets2");
  RecordField(SerNr,M4Long,0,0);
  SerialNoBlock(TSSerBlock);                  
  RecordField(RegDate,M4Date,0,0);
  FieldIsTransDate(RegDate);
  RecordField(OKFlag,M4Mark,0,0);
  RecordField(OKMark,M4Mark,0,0); // should not be needed anymore
  RecordField(Math,M4Matrix,0,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(Sign,M4Code,10,UserVc);
  RecordField(Sum,M4Val,0,0);
  RecordField(SumOther,M4Val,0,0);
  RecordField(SalesMan,M4Code,10,UserVc);
  FieldIsUser(SalesMan);
  RecordField(SalesGroup,M4Code,5,SalesGroupVc);
  FieldIsGroup(SalesGroup);
  ArrayBegin(Math,-,1);
  ArrayField(date,M4Date,0,0);
  ArrayField(EMCode,M4Code,10,UserVc);
  ArrayField(PRCode,M4Code,20,PRVc);
  ArrayField(ArtCode,M4Code,20,INVc);
  ArrayField(Qty,M4UVal,0,0);
  ArrayField(Spec,M4Str,60,0); // Should be a 100
  ArrayField(RowType,M4Set,11,0);
  ArrayField(stp,M4Int,0,0);
  ArrayField(ovst,M4Int,0,0);
  ArrayField(ItemType,M4Int,0,0);
  ArrayField(TimeClass,M4Code,5,0);
  ArrayField(Objects,M4UStr,60,ObjVc);
  ArrayField(ArtName,M4Str,60,0);
  ArrayField(PRName,M4Str,60,0);
  ArrayField(EMName,M4Str,60,0);
  ArrayField(Comment1,M4Str,100,0);
  ArrayField(Comment2,M4Str,100,0);
  EndArray;
  MainKeyBegin(SerNr,1);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(SerNr);
  SubsetKeyBegin2(OKFlag);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(OKFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(RegDate);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(RegDate);
  KeySegment(SerNr);
  SubsetKeyBegin2(Comment);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(Comment);
  KeySegment(SerNr);
  KeySegment(RegDate);
  SubsetKeyBegin2(Sign);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(Sign);
  KeySegment(SerNr);
  EndRecord;

  RecordBegin(StyleVc,-,"styles2");
  NewAutosyncRegister(kSyncDirectionToClient,true);
  RecordField(Code,M4Str,20,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(MacFont,M4Str,60,0);
  RecordField(MacSize,M4Int,0,0);
  RecordField(MacFace,M4Int,0,0);
  RecordField(WinFont,M4Str,60,0);
  RecordField(WinSize,M4Int,0,0);
  RecordField(WinFace,M4Int,0,0);
  RecordField(AnsiChar,M4Int,0,0);
  RecordField(CharSpacing,M4Qty,0,0);
  RecordField(LinuxFont,M4Str,200,0);
  RecordField(LinuxSize,M4Int,0,0);
  RecordField(LinuxFace,M4Int,0,0);
  RecordField(BinaryFont,M4Int,0,0);
  RecordField(PdfFontFile,M4Str,200,0);
  RecordField(PdfFont,M4Set,473,0);
  RecordField(PdfSize,M4Int,0,0);
  RecordField(PdfFace,M4Int,0,0);
  RecordField(BarcodeType,M4Set,504,0);
  RecordField(BarcodeVersion,M4Int,0,0);
  RecordField(BarcodeECLevel,M4Set,532,0);
  RecordField(Rotation,M4Int,0,0);
  MainKeyBegin(MainKey,0);
  KeySegment(Code);
  EndRecord;

  RecordBegin(ODBCEventVc,ODBCEventView,"");
  RecordField(Code,M4Code,20,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(Event,M4Int,0,0);
  RecordField(Type,M4Int,0,0);
  RecordField(RecordTyp,M4Int,0,0);
  RecordField(Sequence,M4Int,0,0);
  RecordField(Math,M4TextField,0,0);
  MainKeyBegin(MainKey,0);
  KeySegment(Code);
  KeySegment(Event);
  KeySegment(Type);
  KeySegment(Sequence);
  EndRecord;

  BlockBegin(ODBCLinkBlock,-,"");
  RecordField(Math,M4Matrix,0,0);
  ArrayBegin(Math,ODBCLinkRowType,1);
  ArrayField(VcCode,M4Str,20,0);
  ArrayField(Comment,M4Str,60,0);
  ArrayField(Event,M4Code,20,0);
  EndArray;
  EndBlock;

  RecordBegin(POVc,-,"POVc2");
  RecordField(SerNr,M4Long,0,0);
  SerialNoBlock(POSerBlock);  
  RecordField(VECode,M4Code,20,VEVc);
  RecordField(TransDate,M4Date,0,0);
  FieldIsTransDate(TransDate);
  RecordField(PayDeal,M4Code,2,0);
  RecordField(ExportFlag,M4Int,0,0);
  RecordField(OKFlag,M4Mark,0,0);
  RecordField(Addr0,M4Str,60,0);
  RecordField(Addr1,M4Str,60,0);
  RecordField(Addr2,M4Str,60,0);
  RecordField(Addr3,M4Str,60,0);
  RecordField(ShipAddr0,M4Str,60,0);
  RecordField(ShipAddr1,M4Str,60,0);
  RecordField(ShipAddr2,M4Str,60,0);
  RecordField(ShipAddr3,M4Str,60,0);
  RecordField(VEContact,M4Str,60,0);
  RecordField(OurContact,M4Str,20,0);
  RecordField(ShipMode,M4Code,5,0);
  RecordField(CurncyCode,M4Code,5,CurncyCodeVc);
  RecordField(PlanShip,M4Str,10,0);
  RecordField(Sign,M4Code,10,UserVc);
  RecordField(ShipDeal,M4Code,5,0);
  RecordField(LangCode,M4Code,5,0);
  RecordField(OrdNr,M4Long,0,0);
  RecordField(ToRateB1,M4Rate,0,0);
  RecordField(Closed,M4Int,0,0);
  RecordField(CostPerUnit,M4PrcStr,20,0);
  RecordField(Sum0,M4Val,0,0);
  RecordField(Sum1,M4Val,0,0);
  RecordField(Sum2,M4Val,0,0);
  RecordField(Sum3,M4Val,0,0);
  RecordField(Sum4,M4Val,0,0);
  RecordField(Math,M4Matrix,0,0);
  RecordField(PRCode,M4Code,20,PRVc);
  RecordField(Printdf,M4Int,0,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(InclVAT,M4Int,0,0);
  RecordField(Location,M4Code,10,LocationVc);
  FieldIsLocation(Location);
  RecordField(VEFactoring,M4Code,20,VEVc);
  RecordField(PUFlag,M4Mark,0,0);
  RecordField(OSFlag,M4Int,0,0);
  RecordField(ExportedFlag,M4Int,0,0);
  RecordField(FrRate,M4Rate,0,0); 
  RecordField(ToRateB2,M4Rate,0,0); 
  RecordField(BaseRate1,M4Rate,0,0); 
  RecordField(BaseRate2,M4Rate,0,0); 
  RecordField(WONr,M4Long,0,0);
  RecordField(Objects,M4UStr,60,ObjVc);
  RecordField(PIFlag,M4Mark,0,0);
  RecordField(InvFlag,M4Int,0,0);
  RecordField(Reference,M4Str,20,0);
  RecordField(SalesMan,M4Code,10,UserVc);
  FieldIsUser(SalesMan);
  RecordField(OKPersons,M4UStr,60,0);
  RecordField(POClass,M4Code,5,0);
  RecordField(POCQStatNr,M4Long,0,0);
  RecordField(SalesGroup,M4Code,5,SalesGroupVc);
  FieldIsGroup(SalesGroup);
  RecordField(InvAddr3,M4Str,60,0);
  RecordField(InvAddr4,M4Str,60,0);
  RecordField(DelAddr3,M4Str,60,0);
  RecordField(DelAddr4,M4Str,60,0);
  RecordField(POCOSerNr,M4Long,0,0);
  RecordField(VEVATCode,M4Code,10,VATCodeBlock);
  RecordField(TotPalletNr,M4UVal,0,0);
  RecordField(Cost1,M4UVal,0,0);
  RecordField(Cost2,M4UVal,0,0);
  RecordField(Cost3,M4UVal,0,0);
  RecordField(Cost4,M4UVal,0,0);
  RecordField(Cost5,M4UVal,0,0);
  RecordField(CustomsCost,M4UVal,0,0);
  RecordField(ShipCost,M4UVal,0,0);
  RecordField(IntORNo,M4Long,0,0);
  RecordField(xAcceptanceState,M4Int,0,0);
  RecordField(xAcceptanceGroup,M4Code,20,AcceptGroupVc);
  RecordField(PlanShipDate,M4Date,0,0);
  RecordField(PrepaidAmount,M4Val,0,0);
  RecordField(InvBeforePU,M4Int,0,0);
  RecordField(TAX1Sum,M4Val,0,0);
  RecordField(TAX2Sum,M4Val,0,0);
  RecordField(BranchID,M4Code,20,VEVc);
  RecordField(NoTAXonVAT,M4Long,0,0);
  RecordField(Region,M4Code,20,RegionVc);
  RecordField(OrderType,M4Set,433,0);
  RecordField(AcceptanceStatus,M4Int,0,0);
  RecordField(SVONr,M4Long,0,0);
  RecordField(OrderStockFlag,M4Int,0,0);
  RecordField(ValidUntil,M4Date,0,0);
  RecordField(VETaxTemplateCode,M4Code,10,TaxTemplateVc);
  RecordField(TaxMatrix,M4PackedMatrix,0,TaxMatrixVc);
  RecordField(RebCode,M4Code,5,0);
  RecordField(InvoiceToCode,M4Code,20,VEVc);
  RecordField(AcceptanceBy,M4List,200,UserVc);
  RecordField(ExtraCostsCalculation,M4Int,0,0);
  RecordField(AcceptanceFYI,M4List,200,UserVc);
  RecordField(SetZeroPUQuant,M4Int,0,0);
  RecordField(IntrastatTransCode,M4Code,20,0);  
  RecordField(DownPaySent,M4Val,0,0);
  RecordField(DownPayRedcd,M4Val,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(stp,M4Int,0,0);
  ArrayField(ovst,M4Int,0,0);
  ArrayField(VEArtCode,M4Str,20,PIVc);
  ArrayField(ArtCode,M4Code,20,INVc);
  ArrayField(Quant,M4UVal,0,0);
  ArrayField(Spec,M4Str,100,0);
  ArrayField(Price,M45Val,0,0);
  ArrayField(Sum,M45Val,0,0);
  ArrayField(vRebate,M41Val,0,0);
  ArrayField(VATCode,M4Code,10,VATCodeBlock);
  ArrayField(Objects,M4UStr,60,ObjVc);
  ArrayField(Shipd2,M4UVal,0,0);
  ArrayField(Shipd1,M4UVal,0,0);
  ArrayField(VEQuant,M4UVal,0,0);
  ArrayField(PIFactor,M4UVal,0,0);
  ArrayField(PriceFactor,M45Val,0,0);
  ArrayField(VARList,M4UStr,30,0);
  ArrayField(PRCode,M4Code,20,PRVc);
  ArrayField(WSNr,M4Long,0,0);
  ArrayField(Invd,M4UVal,0,0);
  ArrayField(CostAcc,M4UStr,10,AccVc);
  ArrayField(PlanShipRow,M4Str,10,0);
  ArrayField(Comment,M4Str,100,0);
  ArrayField(Coefficient,M45Val,0,0);
  ArrayField(RentSerialNr,M4Str,60,0);
  ArrayField(PalletNr,M4UVal,0,0);
  ArrayField(UnitCode,M4Code,5,0);
  ArrayField(VEUnit,M4Code,5,0);
  ArrayField(RowCost1,M4UVal,0,0);
  ArrayField(RowCost2,M4UVal,0,0);
  ArrayField(RowCost3,M4UVal,0,0);
  ArrayField(RowCost4,M4UVal,0,0);
  ArrayField(RowCost5,M4UVal,0,0); 
  ArrayField(ShipCost,M45Val,0,0);
  ArrayField(CustomsCost,M4PrcStr,20,0); 
  ArrayField(IntORRow,M4Long,0,0);
  ArrayField(POCORow,M4Long,0,0);
  ArrayField(TAX2Code,M4Code,5,0);
  ArrayField(TAX2Prc,M423Val,0,0);
  ArrayField(TAX2Reb,M4Val,0,0);
  ArrayField(TAX1Reb,M4Val,0,0);
  ArrayField(TAX2Acc,M4Code,10,AccVc);
  ArrayField(ChargeNumber,M4Long,0,0);
  ArrayField(StockType,M4Set,359,0); 
  ArrayField(OrdRow,M4Long,0,0);
  ArrayField(TaxTemplateCode,M4UStr,60,TaxTemplateVc);
  ArrayField(TaxMatrix,M4PackedMatrix,0,TaxMatrixVc);
  ArrayField(TREO,M4Set,509,0);
  ArrayField(OrderType,M4Set,626,0);
  ArrayField(OrdNr,M4Long,0,0);
  EndArray;
  MainKeyBegin(SerNr,1);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(SerNr);
  SynchronizationIndex;
  SubsetKeyBegin2(ExportedFlag);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(ExportedFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(VECode);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(VECode);
  KeySegment(OKFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(Name);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(Addr0);
  KeySegment(SerNr);
  SubsetKeyBegin2(OKFlag);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(OKFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(PUFlag);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(PUFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(OSFlag);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(OSFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(TransDate);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(TransDate);
  KeySegment(SerNr);
  SubsetKeyBegin2(OrdNr);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(OrdNr);
  KeySegment(SerNr);
  SubsetKeyBegin2(WONr);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(WONr);
  KeySegment(SerNr);
  SubsetKeyBegin2(InvFlag);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(InvFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(Reference);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(Reference);
  KeySegment(SerNr);
  SubsetKeyBegin2(PlanShip);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(PlanShip);
  KeySegment(SerNr);
  SubsetKeyBegin2(POCOSerNr);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(POCOSerNr);
  KeySegment(SerNr);
  SubsetKeyBegin2(IntORNo);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(IntORNo);
  KeySegment(SerNr); 
  
  SubsetKeyBegin2(ActSerNr);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(SerNr);
  KeySegment(OSFlag);
  SubsetKeyBegin2(ActTransDate);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(TransDate);
  KeySegment(OSFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(ActVECode);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(VECode);
  KeySegment(OSFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(ActName);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(Addr0);
  KeySegment(OSFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(PlanShipDate);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(PlanShipDate);
  KeySegment(SerNr);
  SubsetKeyBegin2(PRCode);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(PRCode);
  KeySegment(SerNr);
/*  
  SubsetKeyBegin2(PONotReconPU);
  KeySegment(SerNr);
  SubsetKeyBegin2(PONotReconVI);
  KeySegment(SerNr);  
*/  
  SubsetKeyBegin2(VECodeTransDate);
  StoreInBaseKey;
  AppendFieldToKeyName(SalesMan);
  AppendFieldToKeyName(SalesGroup);
  KeySegment(VECode);
  KeySegment(TransDate);
  KeySegment(OKFlag);
  KeySegment(SerNr);
  KeyBegin(VECodeOpen);
  KeySegment(VECode);
  KeySegment(SerNr);
  KeyBegin(SVONr);
  KeySegment(SVONr);
  KeySegment(SerNr);
  KeyBegin(OrderStockFlag);
  KeySegment(OrderStockFlag);
  KeySegment(SerNr);
  KeyBegin(Location);
  KeySegment(Location);
  KeySegment(SerNr);
  KeyBegin(Sum4);
  KeySegment(Sum4);
  KeySegment(SerNr);
  KeyBegin(Closed);
  KeySegment(Closed);
  KeySegment(SerNr);
  SubsetKeyBegin2(ActArtCodeOSFlag);
  StoreInBaseKey;
  AppendMatrixFieldToKeyName(ArtCode,0);
  KeySegment(SerNr);  
  EndRecord;

  RecordBegin(POQTVc,-,"");
  RecordField(SerNr,M4Long,0,0);
  SerialNoBlock(POQTSerBlock);      
  RecordField(VECode,M4Code,20,VEVc);
  RecordField(TransDate,M4Date,0,0);
  FieldIsTransDate(TransDate);
  RecordField(PayDeal,M4Code,2,0);
  RecordField(ExportFlag,M4Int,0,0);
  RecordField(Addr0,M4Str,60,0);
  RecordField(Addr1,M4Str,60,0);
  RecordField(Addr2,M4Str,60,0);
  RecordField(Addr3,M4Str,60,0);
  RecordField(ShipAddr0,M4Str,60,0);
  RecordField(ShipAddr1,M4Str,60,0);
  RecordField(ShipAddr2,M4Str,60,0);
  RecordField(ShipAddr3,M4Str,60,0);
  RecordField(VEContact,M4Str,60,0);
  RecordField(OurContact,M4Str,20,0);
  RecordField(ShipMode,M4Code,5,0);
  RecordField(CurncyCode,M4Code,5,CurncyCodeVc);
  RecordField(PlanShip,M4Str,10,0);
  RecordField(Sign,M4Code,10,UserVc);
  RecordField(ShipDeal,M4Code,5,0);
  RecordField(LangCode,M4Code,5,0);
  RecordField(OrdNr,M4Long,0,0);
  RecordField(ToRateB1,M4Rate,0,0);
  RecordField(Closed,M4Int,0,0);
  RecordField(CostPerUnit,M4PrcStr,20,0);
  RecordField(Sum0,M4Val,0,0);
  RecordField(Sum1,M4Val,0,0);
  RecordField(Sum2,M4Val,0,0);
  RecordField(Sum3,M4Val,0,0);
  RecordField(Sum4,M4Val,0,0);
  RecordField(Math,M4Matrix,0,0);
  RecordField(PRCode,M4Code,20,PRVc);
  RecordField(Comment,M4Str,60,0);
  RecordField(InclVAT,M4Int,0,0);
  RecordField(Location,M4Code,10,LocationVc);
  RecordField(VEFactoring,M4Code,20,VEVc);
  RecordField(ExportedFlag,M4Int,0,0);
  RecordField(FrRate,M4Rate,0,0); 
  RecordField(ToRateB2,M4Rate,0,0); 
  RecordField(BaseRate1,M4Rate,0,0); 
  RecordField(BaseRate2,M4Rate,0,0); 
  RecordField(WONr,M4Long,0,0);
  RecordField(Objects,M4UStr,60,ObjVc);
  RecordField(Reference,M4Str,20,0);
  RecordField(SalesMan,M4Code,10,UserVc);
  RecordField(PONr,M4Long,0,0);
  RecordField(POClass,M4Code,5,0);
  RecordField(POCQStatNr,M4Long,0,0);
  RecordField(InvAddr3,M4Str,60,0);
  RecordField(InvAddr4,M4Str,60,0);
  RecordField(DelAddr3,M4Str,60,0);
  RecordField(DelAddr4,M4Str,60,0);
  RecordField(POCOSerNr,M4Long,0,0);
  RecordField(PlanShipDate,M4Date,0,0);
  RecordField(TAX1Sum,M4Val,0,0);
  RecordField(TAX2Sum,M4Val,0,0);
  RecordField(BranchID,M4Code,20,VEVc);
  RecordField(NoTAXonVAT,M4Long,0,0);
  RecordField(RebCode,M4Code,5,0);
  RecordField(VEVATCode,M4Code,10,VATCodeBlock);
  RecordField(SalesGroup,M4Code,5,SalesGroupVc);
  FieldIsGroup(SalesGroup);
  RecordField(InvoiceToCode,M4Code,20,VEVc);
  ArrayBegin(Math,-,1);
  ArrayField(stp,M4Int,0,0);
  ArrayField(ovst,M4Int,0,0);
  ArrayField(VEArtCode,M4Str,20,PIVc);
  ArrayField(ArtCode,M4Code,20,INVc);
  ArrayField(Quant,M4UVal,0,0);
  ArrayField(Spec,M4Str,100,0);
  ArrayField(Price,M45Val,0,0);
  ArrayField(Sum,M45Val,0,0);
  ArrayField(vRebate,M41Val,0,0);
  ArrayField(VATCode,M4Code,10,VATCodeBlock);
  ArrayField(Objects,M4UStr,60,ObjVc);
  ArrayField(VEQuant,M4UVal,0,0);
  ArrayField(PIFactor,M4UVal,0,0);
  ArrayField(PriceFactor,M45Val,0,0);
  ArrayField(VARList,M4UStr,30,0);
  ArrayField(PRCode,M4Code,20,PRVc);
  ArrayField(WSNr,M4Long,0,0);
  ArrayField(CostAcc,M4UStr,10,AccVc);
  ArrayField(RentSerialNr,M4Str,60,0);
  ArrayField(TAX2Code,M4Code,5,0);
  ArrayField(TAX2Prc,M423Val,0,0);
  ArrayField(TAX2Reb,M4Val,0,0);
  ArrayField(TAX1Reb,M4Val,0,0);
  ArrayField(TAX2Acc,M4Code,10,AccVc);
  ArrayField(StockType,M4Set,359,0); 
  ArrayField(UnitCode,M4Code,5,0);
  ArrayField(VEUnit,M4Code,5,0);
  ArrayField(PalletNr,M4UVal,0,0);
  ArrayField(CustomsCost,M4PrcStr,20,0); 
  EndArray;
  MainKeyBegin(SerNr,0);
  KeySegment(SerNr);
  KeyBegin(ExportedFlag);
  KeySegment(ExportedFlag);
  KeySegment(SerNr);
  KeyBegin(VECode);
  KeySegment(VECode);
  KeySegment(SerNr);
  KeyBegin(Name);
  KeySegment(Addr0);
  KeySegment(SerNr);
  KeyBegin(TransDate);
  KeySegment(TransDate);
  KeySegment(SerNr);
  KeyBegin(OrdNr);
  KeySegment(OrdNr);
  KeySegment(SerNr);
  KeyBegin(PONr);
  KeySegment(PONr);
  KeySegment(SerNr);
  KeyBegin(WONr);
  KeySegment(WONr);
  KeySegment(SerNr);
  KeyBegin(Reference);
  KeySegment(Reference);
  KeySegment(SerNr);
  KeyBegin(PlanShip);
  KeySegment(PlanShip);
  KeySegment(SerNr);
  KeyBegin(PlanShipDate);
  KeySegment(PlanShipDate);
  KeySegment(SerNr);
  EndRecord;

  RecordBegin(PLDefVc,-,"pldef2");
  NewAutosyncRegister(kSyncDirectionToClient,true);
  RecordField(Code,M4Code,5,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(CurncyCode,M4Code,5,CurncyCodeVc);
  RecordField(InclVAT,M4Int,0,0);
  RecordField(Math,M4Matrix,0,0);
  RecordField(DepPrice,M4Int,0,0);
  RecordField(StartDate,M4Date,0,0);
  RecordField(EndDate,M4Date,0,0);
  RecordField(PLReplCode,M4Code,5,0);
  RecordField(PLBasedOn,M4Int,0,0);
  RecordField(VATCode,M4Code,10,VATCodeBlock);
  RecordField(BBVECode,M4Code,20,VEVc);
  RecordField(BBVarAcc,M4Code,10,AccVc);
  RecordField(BBGenTrans,M4Int,0,0);
  RecordField(LengthClass,M4Int,0,0);
  RecordField(StartTime,M4Time,0,0);
  RecordField(EndTime,M4Time,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(ItemCode,M4UStr,60,INVc);
  ArrayField(Formula,M4Code,5,0);
  ArrayField(CodeType,M4Set,14,0);
  ArrayField(VATCode,M4Code,10,VATCodeBlock);
  ArrayField(TaxTemplateCode,M4Code,10,TaxTemplateVc);
  EndArray;
  MainKeyBegin(Code,0);
  KeySegment(Code);
  KeySegment(StartDate);
  KeyBegin(PLReplCode);
  KeySegment(PLReplCode);
  KeySegment(LengthClass);
  KeySegment(StartDate);
  KeySegment(Code);
  KeyBegin(EndDate);//Used ? 
  KeySegment(PLReplCode);
  KeySegment(EndDate);
  KeySegment(Code);
  KeySegment(StartDate);
  EndRecord;

  RecordBegin(AutSimPerVc,-,"");
  RecordField(Code,M4Code,10,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(PrelAcc,M4Code,10,AccVc);
  RecordField(Math,M4Matrix,0,0);
  RecordField(TempAcc,M4Code,10,AccVc);
  ArrayBegin(Math,-,1);
  ArrayField(Months,M4Code,5,0);
  ArrayField(Days,M4Code,5,0);
  ArrayField(calc,M4PrcStr,20,0);
  ArrayField(VATCode,M4Str,10,VATCodeBlock);
  EndArray;
  MainKeyBegin(Code,0);
  KeySegment(Code);
  KeyBegin(Comment);
  KeySegment(Comment);
  KeySegment(Code);
  KeyBegin(PrelAcc);
  KeySegment(PrelAcc);
  KeySegment(Code);
  EndRecord;

  RecordBegin(ProdVc,-,"");
  RecordField(SerNr,M4Long,0,0);
  SerialNoBlock(ProdSerBlock);          
  RecordField(Comment,M4Str,60,0);
  RecordField(DoneFlag,M4Mark,0,0);
  RecordField(xReserved,M4Int,0,0);
  RecordField(ProdDate,M4Date,0,0);
  FieldIsTransDate(ProdDate);
  RecordField(Qty,M4UVal,0,0);
  RecordField(Math,M4Matrix,0,0);
  RecordField(Recepy,M4Code,20,RecVc);
  RecordField(RecName,M4Str,60,0);
  RecordField(Location,M4Code,10,LocationVc);
  FieldIsLocation(Location);
  RecordField(ExportedFlag,M4Int,0,0);
  RecordField(LocOKNr,M4Qty,0,0);
  RecordField(StartDate,M4Date,0,0);
  RecordField(PRStatusFlag,M4Int,0,0);
  RecordField(FinnishedFlag,M4Int,0,0);
  RecordField(Comment2,M4Str,60,0);
  RecordField(Comment3,M4Str,60,0);
  RecordField(FixAssCode,M4Code,20,AT2Vc);
  RecordField(Person,M4Code,10,UserVc);
  RecordField(Objects,M4UStr,60,ObjVc);
  RecordField(OrderNr,M4Long,0,0);
  RecordField(StartTime,M4Time,0,0);
  RecordField(EndTime,M4Time,0,0);
  RecordField(BreakTime,M4Time,0,0);
  RecordField(Inspector,M4Code,10,UserVc);
  RecordField(xInspectStatus,M4Int,0,0); // 0 = not done, 1 = OK, 2 = faulty (Not used)
  RecordField(ProdOrder,M4Long,0,ProdOrderVc);
  RecordField(TotalIdleTime,M4Time,0,0);
  RecordField(xSetUpTime,M4Time,0,0); // Not used
  RecordField(xScale,M4Qty,0,0); // Not used
  RecordField(StandProblem,M4Code,20,0);
  RecordField(TotWeight,M4UVal,0,0);
  RecordField(TotOutWeight,M4UVal,0,0);
  RecordField(TotalProdOrdQty,M4UVal,0,0);
  RecordField(ExtraProdQty,M4PrcStr,10,0);
  RecordField(LangCode,M4Code,5,0);
  RecordField(TotPalletNr,M4UVal,0,0);
  RecordField(OrgProdNr,M4Long,0,ProdVc);
  RecordField(Routing,M4Code,20,RoutingVc);
  RecordField(RowsHoldActualQty,M4Int,0,0);
  RecordField(AcumCostPrice,M4Val,0,0);
  RecordField(ActualQty,M4UVal,0,0);
  RecordField(Disassemble,M4Mark,0,0);
  RecordField(ProdClass,M4Code,5,0);
  ArrayBegin(Math,-,1);
  ArrayField(Item,M4Code,20,INVc);
  ArrayField(Comment,M4Str,60,0);
  ArrayField(InQty,M45Val,0,0);
  ArrayField(OutQty,M45Val,0,0);
  ArrayField(ItemCost,M45Val,0,0);
  ArrayField(ExtraCost,M45Val,0,0);
  ArrayField(SerialNr,M4Str,60,0);
  ArrayField(BestBefore,M4Date,0,0);
  ArrayField(RelVal,M4UVal,0,0);
  ArrayField(FIFORowVal,M45Val,0,0);
  ArrayField(Coefficient,M45Val,0,0);
  ArrayField(Objects,M4UStr,60,ObjVc);
  ArrayField(OutBatchStatus,M4Code,5,BatchStatusVc);
  ArrayField(UnitXval,M4UVal,0,0);
  ArrayField(UnitYval,M4UVal,0,0);
  ArrayField(UnitZval,M4UVal,0,0);
  ArrayField(Weight,M45Val,0,0);
  ArrayField(PosCode,M4Code,20,0);
  ArrayField(Material,M4Str,60,0);
  ArrayField(ActualQty,M4UVal,0,0);
  ArrayField(OrgProdRow,M4Long,0,0);
  ArrayField(OrgProdFIFORowVal,M45Val,0,0);
  ArrayField(SuppSerialNr,M4Str,20,0);
  ArrayField(MajStoneDet,M4Str,20,0);
  ArrayField(Colour,M4Str,20,0);
  ArrayField(Clarity,M4Str,20,0);
  ArrayField(Cert,M4Str,20,0);
  ArrayField(MinStoneDet,M4Str,20,0);
  ArrayField(Metal,M4Str,20,0);
  ArrayField(RowWeight,M4Str,20,0);
  ArrayField(Size,M4Str,20,0);
  ArrayField(Length,M4Str,20,0);
  ArrayField(WatchBrand,M4Str,20,0);
  ArrayField(StyleName,M4Str,20,0);
  ArrayField(WatchMetal,M4Str,20,0);
  ArrayField(Movement,M4Str,20,0);
  ArrayField(BrcStr,M4Str,20,0);
  ArrayField(Gender,M4Str,20,0);
  ArrayField(Other,M4Str,20,0);
  ArrayField(Other2,M4Str,20,0)
  EndArray;
  MainKeyBegin(SerNr,0);
  KeySegment(SerNr);
  KeyBegin(ExportedFlag);
  KeySegment(ExportedFlag);
  KeySegment(SerNr);
  KeyBegin(PRStatusFlag);
  KeySegment(PRStatusFlag);
  KeySegment(SerNr);
  KeyBegin(ProdDate);
  KeySegment(ProdDate);
  KeySegment(SerNr);
  KeyBegin(LocOK);
  KeySegment(Location);
  KeySegment(FinnishedFlag);
  KeySegment(ProdDate);
  KeySegment(SerNr);  
  KeyBegin(Comment);
  KeySegment(Comment);
  KeySegment(SerNr);
  KeyBegin(StartDate);
  KeySegment(StartDate);
  KeySegment(SerNr);
  KeyBegin(FixAssCode);
  KeySegment(FixAssCode);
  KeySegment(ProdDate);
  KeySegment(SerNr);
  KeyBegin(Recepy);
  KeySegment(Recepy);
  KeySegment(SerNr);
  KeyBegin(ProdOrder);
  KeySegment(ProdOrder);
  KeySegment(SerNr);  
  KeyBegin(Person);
  KeySegment(Person);
  KeySegment(SerNr);  
  KeyBegin(OrgProdNr);
  KeySegment(OrgProdNr);
  KeySegment(SerNr);  
  KeyBegin(ProdOrderStatus);
  KeySegment(ProdOrder);
  KeySegment(PRStatusFlag);
  KeySegment(SerNr);  
  KeyBegin(PersonStatus);
  KeySegment(Person);
  KeySegment(PRStatusFlag);
  KeySegment(SerNr);  
  KeyBegin(FinnishedFlagProdDate);
  KeySegment(FinnishedFlag);
  KeySegment(ProdDate);
  KeySegment(SerNr);  
  KeyBegin(OrderNr);
  KeySegment(OrderNr);
  KeySegment(SerNr);
  KeyBegin(ProdClass);
  KeySegment(ProdClass);
  KeySegment(SerNr);
  EndRecord;

  RecordBegin(ProdOrderVc,-,"");
  RecordField(SerNr,M4Long,0,0);
  SerialNoBlock(ProdOrdSerBlock);          
  RecordField(ExportedFlag,M4Int,0,0);
  RecordField(DoneFlag,M4Mark,0,0);
  RecordField(StartDate,M4Date,0,0);
  FieldIsTransDate(StartDate);
  RecordField(StartTime,M4Time,0,0);
  RecordField(EndDate,M4Date,0,0);
  RecordField(EndTime,M4Time,0,0);
  RecordField(DueDate,M4Date,0,0);
  RecordField(DurTime,M4Time,0,0);
  RecordField(DurDays,M4Long,0,0);
  RecordField(QueuePos,M4Long,0,0);
  RecordField(Qty,M4UVal,0,0);
  RecordField(Finished,M4UVal,0,0);
  RecordField(Objects,M4UStr,60,0);
  RecordField(Location,M4Code,10,LocationVc);
  RecordField(LengthClass,M4Int,0,0);
  RecordField(Machine,M4Str,30,0);
  RecordField(Person,M4Code,5,0);
  RecordField(RecName,M4Str,60,0);
  RecordField(Comment1,M4Str,100,0);
  RecordField(Comment2,M4Str,100,0);
  RecordField(Comment3,M4Str,100,0);
  RecordField(Recipe,M4Code,20,RecVc);
  RecordField(Math,M4Matrix,0,0);
  RecordField(FinnishedFlag,M4Int,0,0);
  RecordField(SalesOrder,M4Long,0,ORVc);
  RecordField(Instr0,M4Str,100,0);
  RecordField(Instr1,M4Str,100,0);
  RecordField(Instr2,M4Str,100,0);
  RecordField(SetUpTime,M4Time,0,0);
  RecordField(Discarded,M4UVal,0,0);
  RecordField(StatusFlag,M4Int,0,0);
  RecordField(xScale,M4Qty,0,0); // Not used
  RecordField(PlannedStartDate,M4Date,0,0);
  RecordField(ExtraProdQty,M4PrcStr,10,0);
  RecordField(LangCode,M4Code,5,0);
  RecordField(Reserved,M4Int,0,0);
  RecordField(Routing,M4Code,20,RoutingVc);
  RecordField(ProdClass,M4Code,5,0);
  RecordField(Priority,M4Long,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(Item,M4Code,20,INVc);
  ArrayField(Comment,M4Str,60,0); // ??
  ArrayField(InQty,M45Val,0,0);
  ArrayField(OutQty,M45Val,0,0);
  ArrayField(Objects,M4UStr,60,0);
  ArrayField(OutBatchStatus,M4Code,5,BatchStatusVc);
  ArrayField(UnitXval,M4UVal,0,0);
  ArrayField(UnitYval,M4UVal,0,0);
  ArrayField(UnitZval,M4UVal,0,0);
  ArrayField(Coefficient,M45Val,0,0);
  ArrayField(RelVal,M4UVal,0,0);
  ArrayField(ItemCost,M45Val,0,0);
  ArrayField(ExtraCost,M45Val,0,0);
  ArrayField(FIFORowVal,M45Val,0,0);
  ArrayField(Material,M4Str,60,0);
  EndArray;
  MainKeyBegin(SerNr,0);
  KeySegment(SerNr);
  KeyBegin(ExportedFlag);
  KeySegment(ExportedFlag);
  KeySegment(SerNr);
  KeyBegin(StartDate);
  KeySegment(StartDate);
  KeySegment(SerNr);
  KeyBegin(DoneFlag);
  KeySegment(DoneFlag);
  KeySegment(SerNr);
  KeyBegin(Comment);
  KeySegment(Comment1);
  KeySegment(SerNr);
  KeyBegin(Queue);
  KeySegment(Machine);
  KeySegment(QueuePos);
  KeySegment(SerNr);
  KeyBegin(ProdStartTime);
  KeySegment(Machine);
  KeySegment(LengthClass);
  KeySegment(StartDate);
  KeySegment(SerNr);
  KeyBegin(DueDate);
  KeySegment(DueDate);
  KeySegment(SerNr);
  KeyBegin(PlannedStartDate);
  KeySegment(PlannedStartDate);
  KeySegment(SerNr);
  KeyBegin(Recipe);
  KeySegment(Recipe);
  KeySegment(SerNr);
  KeyBegin(MachineSD);
  KeySegment(Machine);
  KeySegment(StartDate);
  KeySegment(SerNr);
  KeyBegin(DoneQueue);
  KeySegment(DoneFlag);
  KeySegment(QueuePos);
  KeySegment(SerNr);
  KeyBegin(SalesOrder);
  KeySegment(SalesOrder);
  KeySegment(SerNr);
  KeyBegin(ProdClass);
  KeySegment(ProdClass);
  KeySegment(SerNr);

  SubSetKeyBegin2(OutItemDue);
  StoreInBasekey;
  AppendMatrixFieldToKeyName(Item,0);
  KeySegment(DueDate);
  KeySegment(SerNr);
  SubSetKeyBegin2(OutItemDueAct);
  StoreInBasekey;
  AppendMatrixFieldToKeyName(Item,0);
  KeySegment(DueDate);
  KeySegment(SerNr);
  EndRecord;
  
  RecordBegin(ProdItemVc,-,"");
  RecordField(ItemCode,M4Code,20,INVc);
  RecordField(DefMachine,M4Code,20,0);
  RecordField(StartDate,M4Date,0,0);
  RecordField(EndDate,M4Date,0,0);
  RecordField(Recipe,M4Code,20,RecVc);
  RecordField(Routing,M4Code,20,RoutingVc);
  RecordField(Math,M4Matrix,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(Machine,M4Code,20,0);
  ArrayField(DefRecipe,M4Code,20,RecVc);
  ArrayField(Recipes,M4UStr,100,RecVc);
  ArrayField(Routing,M4Code,20,RoutingVc);
  EndArray;
  MainKeyBegin(ItemCode,0);
  KeySegment(ItemCode);
  KeySegment(StartDate);
  KeyBegin(DefMachine);
  KeySegment(DefMachine);
  KeySegment(ItemCode);
  KeySegment(StartDate);
  KeyBegin(ItemCodeED);
  KeySegment(ItemCode);
  KeySegment(EndDate);
  KeySegment(StartDate);
  EndRecord;
  
  RecordBegin(MachineHoursVc,-,"MachineHoursVc2");
  RecordField(SerNr,M4Long,0,0);
  RecordField(Code,M4Code,20,0);
  RecordField(Description,M4Str,60,0);
  RecordField(MonStart,M4Time,0,0);
  RecordField(MonEnd,M41Val,0,0);
  RecordField(TueStart,M4Time,0,0);
  RecordField(TueEnd,M41Val,0,0);
  RecordField(WedStart,M4Time,0,0);
  RecordField(WedEnd,M41Val,0,0);
  RecordField(ThuStart,M4Time,0,0);
  RecordField(ThuEnd,M41Val,0,0);
  RecordField(FriStart,M4Time,0,0);
  RecordField(FriEnd,M41Val,0,0);
  RecordField(SatStart,M4Time,0,0);
  RecordField(SatEnd,M41Val,0,0);
  RecordField(SunStart,M4Time,0,0);
  RecordField(SunEnd,M41Val,0,0);
  RecordField(ResMgrColNr,M4Set,46,0);
  RecordField(InventoryNr,M4Str,30,0);
  MainKeyBegin(SerNr,0);
  KeySegment(SerNr);
  KeyBegin(Code);
  KeySegment(Code);
  KeySegment(SerNr);
  KeyBegin(InventoryNr);
  KeySegment(InventoryNr);
  KeySegment(SerNr);
  EndRecord;
  
  BlockBegin(MachineGroupsBlock,-,"");
  RecordField(Math,M4Matrix,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(Code,M4Code,5,0);
  ArrayField(DefStr,M4Str,200,0);
  ArrayField(Description,M4Str,200,0);
  EndArray;
  EndBlock;

  BlockBegin(LocalMachineGrBlock,-,"");
  RecordField(Math,M4Matrix,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(Code,M4Code,5,0);
  ArrayField(DefStr,M4Str,200,0);
  EndArray;
  EndBlock;
  
  RecordBegin(ProdClassVc,-,"prodclass");
  RecordField(Code,M4Code,5,0);
  RecordField(Comment,M4Str,60,0);
  MainKeyBegin(Code,0);
  KeySegment(Code);
  EndRecord;

  BlockBegin(ProdSettingsBlock,-,"");
  RecordField(MachineCostItem,M4Code,20,INVc);
  RecordField(AutoCalcCostf,M4Int,0,0);
  RecordField(AutoGenProd,M4Int,0,0);
  RecordField(DayBuffer,M4Int,0,0);
  RecordField(RoundUpToOneDay,M4Int,0,0);
  RecordField(WorkCostPerHour,M4Val,0,0);
  RecordField(AddWorkCost,M4Int,0,0);
  RecordField(AddDiscardedCost,M4Int,0,0);
  RecordField(ActType,M4Code,5,ActTypeVc);
  RecordField(SetupActType,M4Code,5,ActTypeVc);
  RecordField(MakeSDFromDiscard,M4Int,0,0);
  RecordField(xDiscardedAccount,M4Code,10,AccVc);
  RecordField(SetNormalPlanned,M4Int,0,0);
  RecordField(ProdRowsHoldActualQty,M4Int,0,0);
  RecordField(CompleteSequence,M4Int,0,0);
  RecordField(LabourCostItem,M4Code,20,INVc);
  RecordField(SetupCostItem,M4Code,20,INVc);
  RecordField(MoveCostItem,M4Code,20,INVc);
  RecordField(QueueCostItem,M4Code,20,INVc);
  RecordField(FixedTime,M4Int,0,0);
  RecordField(MoveActType,M4Code,5,ActTypeVc);
  RecordField(QueueActType,M4Code,5,ActTypeVc);
  RecordField(UpdProdInQtyFromStockMov,M4Int,0,0);
  RecordField(OrdClassToProd,M4Int,0,0);
  EndBlock;

  RecordBegin(LocationVc,-,"location2");
  NewAutosyncRegister(kSyncDirectionToClient,true);
  RecordField(Code,M4Code,10,LocationVc);
  RecordField(Name,M4Str,60,0);
  RecordField(Addr0,M4Str,60,0);
  RecordField(Addr1,M4Str,60,0);
  RecordField(Addr2,M4Str,60,0);
  RecordField(Contact,M4Str,60,0);
  RecordField(Phone,M4PhoneNo,20,0);
  RecordField(Fax,M4Str,20,0);
  RecordField(StockAcc,M4Code,10,AccVc);
  RecordField(IgnoreChronology,M4Int,0,0);
  RecordField(LastOKNr,M4Qty,0,0);
  RecordField(Email,M4Str,60,0);
  RecordField(PriceList,M4Code,5,0);
  RecordField(RequirePos,M4Int,0,0);
  RecordField(Addr3,M4Str,60,0);
  RecordField(Addr4,M4Str,60,0);
  RecordField(Objects,M4UStr,60,ObjVc);
  RecordField(Type,M4Int,0,0);
  RecordField(RespPerson,M4UStr,60,UserVc);
  RecordField(ReservLocAccess,M4Code,10,ReservLocAccessVc);
  RecordField(BranchID,M4Code,20,CUVc);
  RecordField(PurLoc,M4Code,10,0);
  RecordField(ShipToAccount,M4Str,20,0);
  RecordField(Group,M4Code,10,LocGrVc);
  RecordField(Classification,M4List,200,LocClVc);
  RecordField(WHMPalletArea,M4Code,20,0);
  RecordField(WHMDefPUPosCode,M4Code,20,0);
  RecordField(WHMDefProdPosCode,M4Code,20,0);
  RecordField(WHMPickArea,M4Code,20,0);
  RecordField(WHMWraperPosCode,M4Code,20,0);
  RecordField(WHMDeliveryPosCode,M4Code,20,0);
  RecordField(WHMForkLiftSystem,M4Int,0,0);
  RecordField(WHMAutOKStockMovements,M4Int,0,0);
  RecordField(WHMDeliveryArea,M4Code,20,0);
  RecordField(WHMPickOrderPerArea,M4Int,0,0);
  RecordField(WHMHighestPosCodeFirst,M4Int,0,0);
  RecordField(WHMDefPUVECode,M4Code,20,VEVc);
  RecordField(WHMExpressOrderClass,M4Code,5,OrderClassVc);
  RecordField(ThrouLocation,M4Code,10,0);
  MainKeyBegin(Code,0);
  KeySegment(Code);
  KeyBegin(Name);
  KeySegment(Name);
  KeySegment(Code);
  KeyBegin(BranchID);
  KeySegment(BranchID);
  KeySegment(Code);
  KeyBegin(Group);
  KeySegment(Group);
  KeySegment(Code);
  SubsetKeyBegin2(Classification);
  StoreInBaseKey;
  AppendListFieldToKeyName(Classification);
  KeySegment(Code);
  EndRecord;

  RecordBegin(DepVc,-,"dep");
  RecordField(Code,M4Code,10,0);
  RecordField(Description,M4Str,60,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(Addr0,M4Str,60,0);
  RecordField(Addr1,M4Str,60,0);
  RecordField(Addr2,M4Str,60,0);
  RecordField(Addr3,M4Str,60,0);
  RecordField(Addr4,M4Str,60,0);
  RecordField(Addr5,M4Str,60,0);
  MainKeyBegin(Code,0);
  KeySegment(Code);
  KeyBegin(Description);
  KeySegment(Description);
  KeySegment(Code);
  EndRecord;

  RecordBegin(CCatVc,-,"CCatVc2");
  NewAutosyncRegister(kSyncDirectionToClient,true);
  RecordField(Code,M4Code,5,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(PLCode,M4Code,5,0);
  RecordField(ARAcc,M4Code,10,AccVc);
  RecordField(RebCode,M4Code,5,0);
  RecordField(ComCode,M4Code,5,0);
  RecordField(OnAccAcc,M4Code,10,AccVc);
  RecordField(DownPayPerc,M4Qty,0,0);
  RecordField(WebOrderClass,M4Code,5,OrderClassVc);
  RecordField(MainDispGroup,M4Code,5,0);
  RecordField(WebDisplays,M4Code,5,WebDisplayVc);
  RecordField(BadARAcc,M4Code,10,AccVc);
/*from supplier group*/  
  RecordField(AccAP,M4Code,10,AccVc);
  RecordField(RetainAcc,M4Code,10,AccVc);
  RecordField(OnAccAccAP,M4Code,10,AccVc);
  RecordField(ClassType,M4Str,60,0);
  RecordField(WebOTCode,M4Code,5,OTVc);
  MainKeyBegin(Code,0);
  KeySegment(Code);
  KeyBegin(Comment);
  KeySegment(Comment);
  KeySegment(Code);
  EndRecord;

  RecordBegin(TBPFormVc,-,"");
  RecordField(Code,M4Code,5,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(SelBase,M4Int,0,0);
  RecordField(Perc,M45Val,0,0);
  RecordField(Add1Val,M4Qty,0,0);
  RecordField(RndTo,M4Set,70,0);  
  RecordField(Add2Val,M4Qty,0,0);
  MainKeyBegin(Code,0);
  KeySegment(Code);
  EndRecord;

/*
  BlockBegin(TBPLDefBlock,-,"");
  RecordField(Math,M4Matrix,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(ItemCode,M4UStr,60,0);
  ArrayField(Formula,M4Code,5,0);
  ArrayField(Formcost,M4Code,5,0);
  ArrayField(TimeClass,M4Code,5,0);
  ArrayField(CodeType,M4Set,14,0);
  EndArray;
  EndBlock;
*/

  RecordBegin(TBPLDefVc,-,"");
  RecordField(Code,M4Code,5,0);
  RecordField(TimeClass,M4Code,5,0);
  RecordField(Comment,M4Str,60,0);  
  RecordField(Math,M4Matrix,0,0);  
  ArrayBegin(Math,-,1);
  ArrayField(ITCode,M4Code,5,0);
  ArrayField(PriceFormula,M4Code,5,0);
  ArrayField(CostFormula,M4Code,5,0);
  EndArray;
  MainKeyBegin(Code,0);
  KeySegment(Code);
  KeyBegin(TimeClass);
  KeySegment(TimeClass);
  KeySegment(Code);
  KeyBegin(Comment);
  KeySegment(Comment);
  KeySegment(Code);
  EndRecord;

  RecordBegin(TimeClassVc,-,"");
  RecordField(Code,M4Code,5,0);
  RecordField(Comment,M4Str,60,0);  
  RecordField(StartTime,M4Time,0,0);
  RecordField(EndTime,M4Time,0,0);
  RecordField(Monday,M4Mark,0,0);
  RecordField(Tuesday,M4Mark,0,0);
  RecordField(Wednesday,M4Mark,0,0);
  RecordField(Thursday,M4Mark,0,0);
  RecordField(Friday,M4Mark,0,0);
  RecordField(Saturday,M4Mark,0,0);
  RecordField(Sunday,M4Mark,0,0);
  RecordField(Redday,M4Mark,0,0);
  RecordField(DBRedday,M4Mark,0,0);
  MainKeyBegin(Code,0);
  KeySegment(Code);
  EndRecord;

  RecordBegin(PFormVc,-,"pform2");
  NewAutosyncRegister(kSyncDirectionToClient,true);
  RecordField(Code,M4Code,5,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(SelBase,M4Int,0,0);
  RecordField(Perc,M4Qty,0,0);
  RecordField(Add1Val,M4Qty,0,0);
  RecordField(RndTo,M4Set,70,0);
  RecordField(Add2Val,M4Qty,0,0);
  RecordField(BasePriceList,M4Str,5,PLDefVc);
  RecordField(BasePriceListOption,M4Int,0,0);
  RecordField(BasePriceListAltFormula,M4Str,5,PFormVc);
  MainKeyBegin(Code,0);
  KeySegment(Code);
  EndRecord;

  RecordBegin(StaffVc,-,"staff2");
  NewAutosyncRegister(kSyncDirectionToClient,true);
  RecordField(Code,M4Code,5,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(StaffType,M4Int,0,0);
  RecordField(Lim1,M4Qty,0,0);
  RecordField(Lim2,M4Qty,0,0);
  RecordField(Lim3,M4Qty,0,0);
  RecordField(Lim4,M4Qty,0,0);
  RecordField(Lim5,M4Qty,0,0);
  RecordField(Lim6,M4Qty,0,0);
  RecordField(Lim7,M4Qty,0,0);
  RecordField(Lim8,M4Qty,0,0);
  RecordField(Lim9,M4Qty,0,0);
  MainKeyBegin(Code,0);
  KeySegment(Code);
  EndRecord;

  RecordBegin(RebVc,-,"reb2");
  NewAutosyncRegister(kSyncDirectionToClient,true);
  RecordField(Code,M4Code,5,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(StaffCode,M4Code,5,0);
  RecordField(Math,M4Matrix,0,0);
  RecordField(vra0,M41Val,0,0);
  RecordField(vra1,M41Val,0,0);
  RecordField(vra2,M41Val,0,0);
  RecordField(vra3,M41Val,0,0);
  RecordField(vra4,M41Val,0,0);
  RecordField(vra5,M41Val,0,0);
  RecordField(vra6,M41Val,0,0);
  RecordField(vra7,M41Val,0,0);
  RecordField(vra8,M41Val,0,0);
  RecordField(vra9,M41Val,0,0);
  RecordField(DiscAcc,M4Str,10,AccVc);
  RecordField(DiscPerc,M4Qty,0,0);
  RecordField(VATCode,M4Str,10,VATCodeBlock);
  RecordField(FromDate,M4Date,0,0);
  RecordField(ToDate,M4Date,0,0);
  RecordField(Replaces,M4Code,5,RebVc);
  ArrayBegin(Math,-,1);
  ArrayField(ITCode,M4Code,20,ITVc);
  ArrayField(StaffCode,M4Code,5,0);
  ArrayField(vra0,M41Val,0,0);
  ArrayField(vra1,M41Val,0,0);
  ArrayField(vra2,M41Val,0,0);
  ArrayField(vra3,M41Val,0,0);
  ArrayField(vra4,M41Val,0,0);
  ArrayField(vra5,M41Val,0,0);
  ArrayField(vra6,M41Val,0,0);
  ArrayField(vra7,M41Val,0,0);
  ArrayField(vra8,M41Val,0,0);
  ArrayField(vra9,M41Val,0,0);
  ArrayField(CodeType,M4Set,14,0);
  EndArray;
  MainKeyBegin(Code,0);
  KeySegment(Code);
  KeySegment(FromDate);
  KeyBegin(Replaces);
  KeySegment(Replaces);
  KeySegment(FromDate);
  KeySegment(Code);
  KeyBegin(ToDate);
  KeySegment(Replaces);
  KeySegment(ToDate);
  KeySegment(Code);
  KeySegment(FromDate);
  EndRecord;

  RecordBegin(TIVc,-,"timeitem");
  RecordField(Code,M4Code,20,INVc);
  RecordField(Name,M4Str,60,0);
  RecordField(Math,M4Matrix,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(EMGroup,M4Code,5,0);
  ArrayField(price0,M4UVal,0,0);
  ArrayField(price1,M4UVal,0,0);
  ArrayField(price2,M4UVal,0,0);
  ArrayField(price3,M4UVal,0,0);
  ArrayField(price4,M4UVal,0,0);
  ArrayField(price5,M4UVal,0,0);
  ArrayField(TimeClass,M4Code,5,0);
  EndArray;
  MainKeyBegin(Code,0);
  KeySegment(Code);
  KeyBegin(Name);
  KeySegment(Name);
  KeySegment(Code);
  EndRecord;

  RecordBegin(TJGIVc,-,"");
  RecordField(Code,M4Code,5,0);
  RecordField(Name,M4Str,60,0);
  RecordField(Math,M4Matrix,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(ItemCode,M4Code,20,INVc);
  ArrayField(price0,M4UVal,0,0);
  ArrayField(price1,M4UVal,0,0);
  ArrayField(price2,M4UVal,0,0);
  ArrayField(price3,M4UVal,0,0);
  ArrayField(price4,M4UVal,0,0);
  ArrayField(price5,M4UVal,0,0);
  ArrayField(TimeClass,M4Code,5,0);
  EndArray;
  MainKeyBegin(Code,0);
  KeySegment(Code);
  KeyBegin(Name);
  KeySegment(Name);
  KeySegment(Code);
  EndRecord;

  RecordBegin(CountryVc,-,"country");
  RecordField(Code,M4Code,5,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(DutiesCodes,M4Str,60,0);
  RecordField(CurncyCode,M4Code,5,0);
  RecordField(Math,M4Matrix,0,0);
  RecordField(Region,M4Code,10,CountryRegionVc);
  RecordField(Nationality,M4Str,20,0);
  RecordField(FreightCode,M4Code,5,WebFreightVc);
  RecordField(PLCode,M4Code,5,PLDefVc);
  RecordField(RebCode,M4Code,5,RebVc);
  RecordField(Objects,M4UStr,60,ObjVc);
  RecordField(ExportFlag,M4Int,0,0);
  RecordField(ShowOnWeb,M4Int,0,0);
  RecordField(ISOCode,M4Code,5,0);
  RecordField(TaxOfficeCode,M4Code,3,0);
  RecordField(BillingTypePreference,M4Set,578,0);
  RecordField(DefaultVATNr,M4Str,20,0);
  RecordField(dateOrder,M4Int,0,0);
  RecordField(leadZday,M4Int,0,0);
  RecordField(leadZmonth,M4Int,0,0);
  RecordField(century,M4Int,0,0);
  RecordField(dateSep,M4Str,1,0);
  RecordField(decimalPt,M4Str,1,0);
  RecordField(thousSep,M4Str,1,0);
  RecordField(CountryEditCtlf,M4Int,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(LangCode,M4Code,5,0);
  ArrayField(Text,M4Str,100,0);
  EndArray;
  MainKeyBegin(Code,0);
  KeySegment(Code);
  KeyBegin(Region);
  KeySegment(Region);
  KeySegment(Code);
  KeyBegin(Nationality);
  KeySegment(Nationality);
  KeySegment(Code);
  KeyBegin(Comment);
  KeySegment(Comment);
  KeySegment(Code);
  EndRecord;

//## not used any more it seems, or support register
  RecordBegin(PBVc,-,"costbud");
  ImpExpLevel(0);
  RecordField(Project,M4Code,20,PRVc);
  RecordField(Item,M4Code,20,INVc);
  RecordField(Desc,M4Str,60,0);
  RecordField(Estimate,M4Int,0,0);
  RecordField(Value,M4Val,0,0);
  RecordField(Discount,M4Val,0,0);
  RecordField(PRName,M4Str,60,0);
  RecordField(InvSeparately,M4Int,0,0);
  RecordField(Sum,M4Val,0,0);
  RecordField(NoInvBefore,M4Date,0,0);
  RecordField(SumInvoiced,M4Val,0,0);
  RecordField(Math,M4Matrix,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(Descr,M4Str,60,0);
  ArrayField(BudQty,M4UVal,0,0);
  ArrayField(SpentQty,M4UVal,0,0);
  ArrayField(Price,M4UVal,0,0);
  ArrayField(Discount,M4Qty,0,0);
  ArrayField(Markup,M4UVal,0,0);
  ArrayField(Total,M4UVal,0,0);
  ArrayField(Invoiced,M4UVal,0,0);
  EndArray;
  MainKeyBegin(Project,0);
  KeySegment(Project);
  KeySegment(Item);
  EndRecord;

//## not used or support register
  RecordBegin(TBVc,-,"timebud");
  ImpExpLevel(0);
  RecordField(Project,M4Code,20,PRVc);
  RecordField(Item,M4Code,20,INVc);
  RecordField(Desc,M4Str,60,0);
  RecordField(Estimate,M4Int,0,0);
  RecordField(Value,M4Val,0,0);
  RecordField(Discount,M4Val,0,0);
  RecordField(PRName,M4Str,60,0);
  RecordField(InvSeparately,M4Int,0,0);
  RecordField(Sum,M4Val,0,0);
  RecordField(NoInvBefore,M4Date,0,0);
  RecordField(SumInvoiced,M4Val,0,0);
  RecordField(Math,M4Matrix,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(Person,M4Code,10,UserVc);
  ArrayField(BudQty,M4UVal,0,0);
  ArrayField(SpentQty,M4UVal,0,0);
  ArrayField(InvoicedQty,M4UVal,0,0);
  ArrayField(MarkupQty,M4UVal,0,0);
  ArrayField(ToInvoiceQty,M4UVal,0,0);
  ArrayField(Price,M4UVal,0,0);
  ArrayField(CostInvd,M4UVal,0,0);
  ArrayField(CostToInv,M4UVal,0,0);
  EndArray;
  MainKeyBegin(Project,0);
  KeySegment(Project);
  KeySegment(Item);
  EndRecord;

  RecordBegin(PErsVc,-,"");
  ImpExpLevel(0);
  RecordField(TSSerNr,M4Long,0,0);
  RecordField(Date,M4Date,0,0);
  RecordField(Item,M4Code,20,INVc);
  RecordField(Person,M4Code,10,UserVc);
  RecordField(PRCode,M4Code,20,PRVc);
  RecordField(INGroup,M4Code,5,ITVc);
  RecordField(FileName,M4Str,20,0);
  MainKeyBegin(MainKey,0);
  KeySegment(Person);
  KeySegment(Date);
  KeySegment(Item);
  KeySegment(PRCode);
  KeySegment(TSSerNr);
  KeySegment(FileName);
  KeyBegin(Item);
  KeySegment(Person);
  KeySegment(Item);
  KeySegment(Date);
  KeySegment(PRCode);
  KeySegment(TSSerNr);
  KeySegment(FileName);
  KeyBegin(PRCode);
  KeySegment(Person);
  KeySegment(PRCode);
  KeySegment(TSSerNr);
  KeySegment(Item);
  KeySegment(Date);
  KeySegment(FileName);
  KeyBegin(INGroup);
  KeySegment(Person);
  KeySegment(INGroup);
  KeySegment(Date);
  KeySegment(Item);
  KeySegment(PRCode);
  KeySegment(TSSerNr);
  KeySegment(FileName);
  KeyBegin(Project); //NEW KEY
  KeySegment(PRCode);
  KeySegment(Person);
  KeySegment(Date);
  KeySegment(TSSerNr);
  KeySegment(Item);
  KeySegment(FileName);
  EndRecord;

  SimpleRecordBegin(PRrsVc,-,"");
  ImpExpLevel(0);
  RecordField(SerNr,M4Long,0,0);
  RecordField(Date,M4Date,0,0);
  RecordField(PRCode,M4Code,20,PRVc);
  RecordField(RecType,M4Int,0,0);
  MainKeyBegin(MainKey,0);
  KeySegment(PRCode);
  KeySegment(Date);
  KeySegment(RecType);
  KeySegment(SerNr);
  EndRecord;

  RecordBegin(CDVc,-,"custdisc2");
  NewAutosyncRegister(kSyncDirectionToClient,true);
  RecordField(Math,M4Matrix,0,0);
  RecordField(CustCode,M4Code,20,CUVc);
  RecordField(CustName,M4Str,60,0);
  ArrayBegin(Math,-,1);
  ArrayField(Item,M4Code,20,INVc);
  ArrayField(Price,M4Val,0,0);
  ArrayField(Discount,M4Qty,0,0);
  ArrayField(TimeClass,M4Code,20,0);
  EndArray;
  MainKeyBegin(CustCode,0);
  KeySegment(CustCode);
  EndRecord;

  RecordBegin(VGVc,-,"vg");
  RecordField(Code,M4Code,5,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(AccAP,M4Code,10,AccVc);
  RecordField(OnAccAcc,M4Code,10,AccVc);
  RecordField(RetainAcc,M4Code,10,AccVc);
  MainKeyBegin(Code,0);
  KeySegment(Code);
  SynchronizationIndex;
  KeyBegin(Comment);
  KeySegment(Comment);
  KeySegment(Code);
  EndRecord;
  
  RecordBegin(DelAddrVc,-,"");
  RecordField(CustCode,M4Code,20,CUVc);
  RecordField(Name,M4Str,60,0);
  RecordField(DelCode,M4Code,20,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(DelAddr0,M4Str,60,0);
  RecordField(DelAddr1,M4Str,60,0);
  RecordField(DelAddr2,M4Str,60,0);
  RecordField(DelAddr3,M4Str,60,0);
  RecordField(DelAddr4,M4Str,60,0);
  RecordField(Region,M4Code,20,RegionVc);
  RecordField(Class,M4UStr,200,0);
  RecordField(Closed,M4Int,0,0);
  RecordField(Contact,M4Str,60,0);
  RecordField(Phone,M4PhoneNo,20,0);
  RecordField(Fax,M4Str,20,0);
  RecordField(Email,M4Str,60,0);
  RecordField(PriceList,M4Code,5,0);
  RecordField(InvoiceBase,M4Int,0,0);
  RecordField(IncludeOriginalItem,M4Int,0,0);
  RecordField(IncludePeriod,M4Int,0,0);
  RecordField(AddEmptyLine,M4Int,0,0);
  RecordField(UseAsQty,M4Int,0,0);
  RecordField(GroupInvoice,M4Int,0,0);
  RecordField(IncludeSite,M4Int,0,0);
  RecordField(InclCustOrdNr,M4Int,0,0);
  RecordField(InclRentResNo,M4Int,0,0);
  RecordField(OnePerReservation,M4Int,0,0);
  RecordField(TaxTemplateCode,M4Code,10,TaxTemplateVc);
  RecordField(Sorting,M4Str,20,0);
  RecordField(DelCountry,M4Code,5,0);
  RecordField(FreightCode,M4Code,5,WebFreightVc);
  RecordField(VATCode,M4Code,10,VATCodeBlock);
  RecordField(ExportFlag,M4Int,0,0);
  RecordField(RecipientGLN,M4Str,20,0);
  RecordField(RecipientDepartment,M4Str,20,0);
  MainKeyBegin(DelCode,0);
  KeySegment(DelCode);
  KeySegment(CustCode);
  KeyBegin(CustCode);
  KeySegment(CustCode);
  KeySegment(DelCode);
  KeyBegin(Name);
  KeySegment(Name);
  KeySegment(CustCode);
  KeySegment(DelCode);
  KeyBegin(Comment);
  KeySegment(Comment);
  KeySegment(CustCode);
  KeySegment(DelCode);
  SubSetKeyBegin2(Class);
  AppendListFieldToKeyName(Class);
  KeySegment(DelCode);
  KeySegment(CustCode);
  SubSetKeyBegin2(ActDelCode);
  AppendFieldToKeyName(CustCode);
  KeySegment(DelCode);
  KeySegment(CustCode);
  SubSetKeyBegin2(ActComment);
  AppendFieldToKeyName(CustCode);
  KeySegment(Comment);
  KeySegment(CustCode);
  KeySegment(DelCode);
  EndRecord;

/*
  be carefull when adding new fields here
  you need to add them to DefineIVVcRecordType function
*/    
  RecordBegin(IVVc,-,"IVVc3");
  RecordField(SerNr,M4Long,0,0);
  SerialNoBlock(IVSerBlock);
  DefineIVVcRecordType_Header(1);  
  DefineIVVcRecordType_Array;
  MainKeyBegin(SerNr,1);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(SerNr);
  SynchronizationIndex;

  SubsetKeyBegin2(ExportedFlag);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(ExportedFlag);
  KeySegment(SerNr);

  SubsetKeyBegin2(CustCode);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(CustCode);
  KeySegment(SerNr);
  
  SubsetKeyBegin2(OKFlag);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(OKFlag);
  KeySegment(SerNr);

  SubsetKeyBegin2(InvDate);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(InvDate);
  KeySegment(SerNr);

  SubsetKeyBegin2(CredInv);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(CredInv);
  KeySegment(SerNr);

  SubsetKeyBegin2(Name);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(Addr0);
  KeySegment(SerNr);

  SubsetKeyBegin2(TransDate);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(TransDate);
  KeySegment(SerNr);
// Does all of these indexes really need to be SubsetKeys??????
  SubsetKeyBegin2(Sum4);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(Sum4);
  KeySegment(SerNr);
  SubsetKeyBegin2(OrderNr);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(OrderNr);
  KeySegment(SerNr);
  SubsetKeyBegin2(RefStr);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(CalcFinRef);
  KeySegment(SerNr);
  SubsetKeyBegin2(SalesMan);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(SalesMan);
  KeySegment(InvDate);
  KeySegment(SerNr);
  SubsetKeyBegin2(Location);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(Location);
  KeySegment(InvDate);
  KeySegment(SerNr);
  KeyBegin(LocOK);
  KeySegment(Location);
  KeySegment(OKFlag);
  KeySegment(UpdStockFlag);
  KeySegment(TransDate);
  KeySegment(SerNr);
  SubsetKeyBegin2(Sorting);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(Sorting);
  KeySegment(SerNr);
  SubsetKeyBegin2(SVONr);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(SVONr);
  KeySegment(SerNr);
  SubsetKeyBegin2(JobNr);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(JobNr);
  KeySegment(SerNr);
  SubsetKeyBegin2(PRCode);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(PRCode);
  KeySegment(SerNr);
  SubsetKeyBegin2(DelAddrCode);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(DelAddrCode);
  KeySegment(SerNr);
  KeyBegin(DisputedFlag);
  KeySegment(DisputedFlag);
  KeySegment(SerNr);
  KeyBegin(OfficialSerNr);
  KeySegment(OfficialSerNr);
  KeySegment(SerNr);
  KeyBegin(InvType);
  KeySegment(InvType);
  KeySegment(SerNr);
  KeyBegin(FiscalFlag);
  KeySegment(FiscalFlag);
  KeySegment(SerNr);  
  KeyBegin(CustDate);
  KeySegment(CustCode);
  KeySegment(InvDate);
  KeySegment(SerNr);
  KeyBegin(OKFlagPayDate);
  KeySegment(OKFlag);
  KeySegment(PayDate);
  KeySegment(SerNr);
  SubsetKeyBegin2(OKFlagSalesMan);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(OKFlag);
  KeySegment(SalesMan);
  KeySegment(SerNr);
  KeyBegin(Cashup);
  KeySegment(MachineName);
  KeySegment(DrawerCode);
  KeySegment(TransDate);
  KeySegment(TransTime);
  KeySegment(SerNr);
  KeyBegin(EInvToExport);
  KeySegment(OKFlag);
  KeySegment(EInvFunc);
  KeySegment(EInvExpFlag);
  KeySegment(SerNr);
  
  KeyBegin(OfficialSerNrDate);
  KeySegment(OfficialSerNr);
  KeySegment(InvDate);
  KeySegment(SerNr);  
  
  KeyBegin(TransDateCust);
  KeySegment(TransDate);
  KeySegment(CustCode);
  KeySegment(SerNr);
/* Not used
  SubsetKeyBegin2(ArtCodeLoc);
  StoreInBaseKey;
  AppendMatrixFieldToKeyName(ArtCode,0);
  KeySegment(Location);  
  KeySegment(SerNr);
  KeyBegin(Region);
  KeySegment(Region);
  KeySegment(SerNr);
*/
  KeyBegin(OKFlagTransDate);
  KeySegment(OKFlag);
  KeySegment(UpdStockFlag);
  KeySegment(TransDate);
  KeySegment(SerNr);

  KeyBegin(TransDateOffSerNr); // Only used in Arg. VAT Sales Report....
  KeySegment(TransDate);
  KeySegment(OfficialSerNr);
  KeySegment(SerNr);
/* Incorrect index. Only add AppendMatrix if you KNOW that it will help basically everyone, or if it will make it possible to remove a support register
  SubSetKeyBegin2(Object);
  AppendListFieldToKeyName(Objects);
  AppendMatrixFieldToKeyName(Objects,0);
  KeySegment(CustCode);
  KeySegment(SerNr);
*/

  KeyBegin(CustOKFlag); // Made it, then didn't need it, but found another place to use it, so I kept it :)
  KeySegment(OKFlag);
  KeySegment(CustCode);
  KeySegment(SerNr);
  KeyBegin(TerminalID);
  KeySegment(TerminalID);
  KeySegment(FiscalDeviceSeqNr);
  KeySegment(SerNr);
  KeyBegin(RegDate);
  KeySegment(RegDate);
  KeySegment(RegTime);
  KeySegment(SerNr);
  KeyBegin(MachineName);
  KeySegment(MachineName);
  KeySegment(TransDate);
  KeySegment(TransTime);
  KeySegment(SerNr);

  SubSetKeyBegin2(MBRCode);
  AppendMatrixFieldToKeyName(MBRCode,0);
  KeySegment(TransDate);
  KeySegment(SerNr);
  KeyBegin(PriceList);
  KeySegment(PriceList);
  KeySegment(TransDate);
  KeySegment(SerNr);

  SubSetKeyBegin2(OpenSerNr);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(SerNr);
  SubSetKeyBegin2(OpenInvDate);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(InvDate);
  KeySegment(SerNr);
  SubSetKeyBegin2(OpenCustCode);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(CustCode);
  KeySegment(SerNr);
  SubSetKeyBegin2(OpenName);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesGroup);
  AppendListFieldToKeyName(SalesMan);
  KeySegment(Addr0);
  KeySegment(SerNr);

  KeyBegin(RetNr);
  KeySegment(RetNr);
  KeySegment(SerNr);

  KeyBegin(OpenOfficialSerNr2);
  KeySegment(OfficialSerNr2);
  KeySegment(SerNr);
  KeyBegin(Prntdf);
  KeySegment(Prntdf);
  KeySegment(SerNr);

  KeyBegin(ServiceDelDate);
  KeySegment(ServiceDelDate);
  KeySegment(SerNr);
  KeyBegin(OYNr);
  KeySegment(OYNr);
  KeySegment(SerNr);
  KeyBegin(Reason);
  KeySegment(Reason);
  KeySegment(VATNr);
  KeySegment(SerNr);

  KeyBegin2(TaxAdminServSeal,8132);
  KeySegment(TaxAdminServSeal);
  KeySegment(SerNr);
  EndRecord;

/*
  be carefull when adding new fields here
  you need to add them to DefineIVVcRecordType funciotn
*/    
  RecordBegin(EDIIVVc,-,"EDIIVVc2");  
  RecordField(BatchNr,M4Long,0,0);  
  RecordField(SerNr,M4Long,0,0);
  DefineIVVcRecordType_Header(0);  
  DefineIVVcRecordType_Array;  
  MainKeyBegin(SerNr,0);
  KeySegment(SerNr);
  KeyBegin(ExportedFlag);
  KeySegment(ExportedFlag);
  KeySegment(SerNr);
  KeyBegin(CustCode);
  KeySegment(CustCode);
  KeySegment(SerNr);
  KeyBegin(OKFlag);
  KeySegment(OKFlag);
  KeySegment(SerNr);
  KeyBegin(InvDate);
  KeySegment(InvDate);
  KeySegment(SerNr);
  KeyBegin(CredInv);
  KeySegment(CredInv);
  KeySegment(SerNr);
  KeyBegin(Name);
  KeySegment(Addr0);
  KeySegment(SerNr);
  KeyBegin(TransDate);
  KeySegment(TransDate);
  KeySegment(SerNr);
  KeyBegin(Sum4);
  KeySegment(Sum4);
  KeySegment(SerNr);
  KeyBegin(OrderNr);
  KeySegment(OrderNr);
  KeySegment(SerNr);
  KeyBegin(RefStr);
  KeySegment(CalcFinRef);
  KeySegment(SerNr);
  KeyBegin(SalesMan);
  KeySegment(SalesMan);
  KeySegment(InvDate);
  KeySegment(SerNr);
  KeyBegin(Location);
  KeySegment(Location);
  KeySegment(InvDate);
  KeySegment(SerNr);
  KeyBegin(LocOK);
  KeySegment(Location);
  KeySegment(OKFlag);
  KeySegment(UpdStockFlag);
  KeySegment(TransDate);
  KeySegment(SerNr);
  KeyBegin(OrgCust);
  KeySegment(OrgCust);
  KeySegment(SerNr);
  KeyBegin(Prntdf);
  KeySegment(Prntdf);
  KeySegment(SerNr);
  EndRecord;  

  RecordBegin(ORVc,-,"ORVc2");
  RecordField(SerNr,M4Long,0,0);
  SerialNoBlock(ORSerBlock);
  RecordField(OrdDate,M4Date,0,0);
  FieldIsTransDate(OrdDate);
  RecordField(CustCode,M4Code,20,CUVc);
  RecordField(Math,M4Matrix,0,0);
  RecordField(Addr0,M4Str,60,0);
  RecordField(Addr1,M4Str,60,0);
  RecordField(Addr2,M4Str,60,0);
  RecordField(Addr3,M4Str,60,0);
  RecordField(OurContact,M4Str,20,0);
  RecordField(CustContact,M4Str,60,0);
  RecordField(ExportFlag,M4Int,0,0);
  RecordField(InvFlag,M4Int,0,0);
  RecordField(ShipFlag,M4Int,0,0);
  RecordField(Prntdf,M4Int,0,0);
  RecordField(PayDeal,M4Code,2,0);
  RecordField(CustCat,M4Code,5,0);
  RecordField(InvMark,M4Mark,0,0);
  RecordField(ShipMark,M4Mark,0,0);
  RecordField(Objects,M4UStr,60,ObjVc);
  RecordField(ShipMode,M4Code,5,0);
  RecordField(OrderStatus,M4Int,0,0);
  RecordField(PlanShip,M4Str,10,0);
  RecordField(SalesMan,M4UStr,60,UserVc);
  FieldIsUser(SalesMan);
  RecordField(Sign,M4Code,10,UserVc);
  RecordField(ShipDeal,M4Code,5,0);
  RecordField(ShipAddr0,M4Str,60,0);
  RecordField(ShipAddr1,M4Str,60,0);
  RecordField(ShipAddr2,M4Str,60,0);
  RecordField(ShipAddr3,M4Str,60,0);
  RecordField(CurncyCode,M4Code,5,CurncyCodeVc);
  RecordField(LangCode,M4Code,5,0);
  RecordField(InvoiceToCode,M4Code,20,CUVc);
  RecordField(Closed,M4Mark,0,0);
  RecordField(ToRateB1,M4Rate,0,0);
  RecordField(BuildOn,M4Int,0,0);
  RecordField(PRCode,M4Code,20,PRVc);
  RecordField(Comment,M4Str,60,0);
  RecordField(InvOnlyOnFull,M4Int,0,0);
  RecordField(DownPaySent,M4Val,0,0);
  RecordField(DownPayRedcd,M4Val,0,0);
  RecordField(OrderClass,M4Code,5,0);
  RecordField(CustOrdNr,M4Str,60,0);
  RecordField(PriceList,M4Code,5,0);
  RecordField(InclVAT,M4Int,0,0);
  RecordField(Sum0,M4Val,0,0);
  RecordField(Sum1,M4Val,0,0);
  RecordField(Sum2,M4Val,0,0);
  RecordField(Sum3,M4Val,0,0);
  RecordField(Sum4,M4Val,0,0);
  RecordField(Reserved,M4Int,0,0);
  RecordField(OSFlag,M4Int,0,0);
  RecordField(Location,M4Code,10,LocationVc);
  FieldIsLocation(Location);
  RecordField(CustVATCode,M4Code,10,VATCodeBlock);
  RecordField(RebCode,M4Code,5,0);
  RecordField(VATNr,M4Str,20,0);
  RecordField(Phone,M4PhoneNo,20,0);
  RecordField(Fax,M4Str,20,0);
  RecordField(ExportedFlag,M4Int,0,0);
  RecordField(BaseSum4,M4Val,0,0);
  RecordField(FrRate,M4Rate,0,0); 
  RecordField(ToRateB2,M4Rate,0,0); 
  RecordField(BaseRate1,M4Rate,0,0); 
  RecordField(BaseRate2,M4Rate,0,0); 
  RecordField(DiscPerc,M4Qty,0,0); 
  RecordField(DiscSum,M4Val,0,0);
  RecordField(TotGP,M4Val,0,0);
  RecordField(Probability,M41Val,0,0);
  RecordField(CreditCard,M4UStr,20,CreditCardVc);
  RecordField(AuthorizationCode,M4UStr,10,0);
  RecordField(GPProc,M41Val,0,0);
  RecordField(DespatchDate,M4Date,0,0);
  RecordField(DespatchTime,M4Time,0,0);
  RecordField(SalesGroup,M4UStr,30,SalesGroupVc);
  FieldIsGroup(SalesGroup);
  RecordField(Sorting,M4Str,20,0);
  RecordField(TotQty,M4Qty,0,0);
  RecordField(TotWeight,M4Qty,0,0);
  RecordField(TotVolume,M4Qty,0,0);
  RecordField(Commision,M4Val,0,0);
  RecordField(SumIncCom,M4Val,0,0);
  RecordField(FrPrice,M4Val,0,0);
  RecordField(FrBase,M4Val,0,0);
  RecordField(FrItem,M4Code,20,INVc);
  RecordField(FrVATCode,M4Code,10,VATCodeBlock);
  RecordField(FrObjects,M4UStr,60,ObjVc);
  RecordField(InvAddr3,M4Str,60,0);
  RecordField(InvAddr4,M4Str,60,0);
  RecordField(DelAddr3,M4Str,60,0);
  RecordField(DelAddr4,M4Str,60,0);
  RecordField(DelAddrCode,M4Code,20,0);
  RecordField(TAX1Sum,M4Val,0,0);
  RecordField(QuoteNr,M4Long,0,0);
  RecordField(InvBeforeShip,M4Int,0,0);
  RecordField(colnr,M4Set,46,0);
  RecordField(OKFlag,M4Mark,0,0);
  RecordField(PlanShipDate,M4Date,0,0);
  RecordField(PrepaidAmount,M4Val,0,0);
  RecordField(Region,M4Code,20,RegionVc);
  RecordField(RefStr,M4Str,60,0);
  RecordField(GroupOrdNr,M4Long,0,0);
  RecordField(NoDelivery,M4Int,0,0);
  RecordField(NoInvoice,M4Int,0,0);
  RecordField(TAX2Sum,M4Val,0,0);
  RecordField(NoTax1,M4Int,0,0);
  RecordField(NoTax2,M4Int,0,0);
  RecordField(BranchID,M4Code,20,CUVc);
  RecordField(NoTAXonVAT,M4Long,0,0);
  RecordField(TotalwoTAX,M4Int,0,0);
  RecordField(OrderType,M4Set,433,0);
  RecordField(AcceptanceStatus,M4Int,0,0);
  RecordField(CustTaxTemplateCode,M4Code,10,TaxTemplateVc);
  RecordField(TaxMatrix,M4PackedMatrix,0,TaxMatrixVc);
  RecordField(TerminalID,M4Str,60,0);
  RecordField(OfficialSerNr,M4Str,100,0);
  RecordField(Hash,M4Str,255,0);
  RecordField(HashKeyVersion,M4Int,0,0);
  RecordField(RegDate,M4Date,0,0);
  RecordField(RegTime,M4Time,0,0);
  RecordField(LocalMachineCode,M4Code,20,0);
  RecordField(InvCountry,M4Code,5,0);
  RecordField(DelCountry,M4Code,5,0);
  RecordField(TREONr,M4Long,0,0);
  RecordField(TREOExpDate,M4Date,0,0);
  RecordField(ORCONr,M4Long,0,0);
  RecordField(AcceptanceBy,M4List,200,UserVc);
  RecordField(AcceptanceFYI,M4List,200,UserVc);
  RecordField(BankCode,M4Code,10,BankVc);
  RecordField(InvCountryName,M4Str,100,0);
  RecordField(DelCountryName,M4Str,100,0);
  RecordField(OfficialSerNrSerie,M4Str,30,0);
  RecordField(RecipientGLN,M4Str,20,0);
  RecordField(DelRecipientGLN,M4Str,20,0);
  RecordField(IntrastatTransCode,M4Code,20,0);
  RecordField(Comment2,M4Str,100,0);
  RecordField(Comment3,M4Str,100,0);
  RecordField(Comment4,M4Str,100,0);
  RecordField(PONr,M4Long,0,0);
  RecordField(CompNr,M4Long,0,0);
  RecordField(OYNr,M4Long,0,OYVc);
  RecordField(OYDescription,M4Str,200,0);
  RecordField(SHShipSetToZero,M4Int,0,0);
  RecordField(RvrsVAT,M4Val,0,0);
  RecordField(PromotionCodes,M4List,200,0);
  ArrayBegin(Math,-,1);
  ArrayField(stp,M4Int,0,0);
  ArrayField(ArtCode,M4Code,20,INVc);
  ArrayField(Quant,M4UVal,0,0);
  ArrayField(Price,M423Val,0,0);
  ArrayField(Sum,M4Val,0,0);
  ArrayField(vRebate,M41Val,0,0);
  ArrayField(SalesAcc,M4Code,10,AccVc);
  ArrayField(Shipd1,M4UVal,0,0);
  ArrayField(Shipd2,M4UVal,0,0);
  ArrayField(Invd,M4UVal,0,0);
  ArrayField(Objects,M4UStr,60,ObjVc);
  ArrayField(BasePrice,M423Val,0,0);
  ArrayField(rowGP,M4Val,0,0);
  ArrayField(Spec,M4Str,100,0);
  ArrayField(VATCode,M4Code,10,VATCodeBlock);
  ArrayField(Recepy,M4Code,20,RecVc);
  ArrayField(SerialNr,M4Str,60,0);
  ArrayField(PriceFactor,M45Val,0,0);
  ArrayField(VARList,M4UStr,30,0);
  ArrayField(Location,M4Code,10,LocationVc);
  ArrayField(Source,M4Code,10,SourceVc);
  ArrayField(PickingDate,M4Date,0,0);
  ArrayField(PickingTime,M4Str,20,0);
  ArrayField(InloadingDate,M4Date,0,0);
  ArrayField(InloadingTime,M4Str,20,0);
  ArrayField(DespatchRowDate,M4Date,0,0);
  ArrayField(DespatchRowTime,M4Str,20,0);
  ArrayField(PlanShipRow,M4Str,10,0);
  ArrayField(ShipNote,M4Str,60,0);
  ArrayField(UnitCode,M4Code,5,0);
  ArrayField(UnitFactQuant,M4UVal,0,0);
  ArrayField(UnitFactPrice,M423Val,0,0);
  ArrayField(UnitXval,M4UVal,0,0);
  ArrayField(UnitYval,M4UVal,0,0);
  ArrayField(UnitZval,M4UVal,0,0);
  ArrayField(Coefficient,M45Val,0,0);
  ArrayField(VECode,M4Code,20,VEVc);
  ArrayField(Production,M4Code,20,ProdVc);
  ArrayField(GroupOrdRow,M4Long,0,0);
  ArrayField(TAX2Code,M4Code,5,0);
  ArrayField(TAX2Prc,M423Val,0,0);
  ArrayField(TAX2Reb,M4Val,0,0);
  ArrayField(TAX1Reb,M4Val,0,0);
  ArrayField(TAX2Acc,M4Code,10,AccVc);
  ArrayField(PlanShipRowDate,M4Date,0,0);
  ArrayField(CUServiceHistNr,M4Long,0,0);
  ArrayField(CUServiceUntilDate,M4Date,0,0);
  ArrayField(Position,M4Code,20,0);
  ArrayField(RowOrderType,M4Set,433,0);//no funcionality atm
  ArrayField(TaxTemplateCode,M4UStr,60,TaxTemplateVc);
  ArrayField(TaxMatrix,M4PackedMatrix,0,TaxMatrixVc);
  ArrayField(Region,M4Code,20,RegionVc);
  ArrayField(Perceptions,M4Int,0,0);
  ArrayField(MotherArtCode,M4Code,20,INVc);
  ArrayField(RecipeQuant,M4Qty,0,0);
  ArrayField(CustArtCode,M4Code,20,CUINVc);
  ArrayField(Salesmen,M4UStr,60,UserVc);
  ArrayField(OrderType,M4Set,626,0);
  ArrayField(UnitComment,M4Str,200,0);
  ArrayField(DiscApprovedBy,M4Code,10,UserVc);
  ArrayField(ServiceDelDate,M4Date,0,0);
  ArrayField(RvrsVATCode,M4Code,10,VATCodeBlock);
  EndArray;
  MainKeyBegin(SerNr,1);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(SerNr);
  SynchronizationIndex;
  SubsetKeyBegin2(ExportedFlag);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(ExportedFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(CustCode);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(CustCode);
  KeySegment(SerNr);
  SubsetKeyBegin2(InvFlag);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(InvFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(ShipFlag);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(ShipFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(Name);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(Addr0);
  KeySegment(SerNr);
  SubsetKeyBegin2(PRCode);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(PRCode);
  KeySegment(SerNr);
  SubsetKeyBegin2(OrderClass);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(OrderClass);
  KeySegment(SerNr);
  SubsetKeyBegin2(OSFlag);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(OSFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(OSCU);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(OSFlag);
  KeySegment(CustCode);
  KeySegment(SerNr);
  SubsetKeyBegin2(OSObjects);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(OSFlag);
  KeySegment(Objects);
  KeySegment(SerNr);
  SubsetKeyBegin2(OrdDate);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(OrdDate);
  KeySegment(SerNr);
  SubsetKeyBegin2(CustOrdNr);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(CustOrdNr);
  KeySegment(SerNr);
  KeyBegin(InvoiceCode);
  KeySegment(OSFlag);
  KeySegment(InvoiceToCode);
  KeySegment(SerNr);
  SubsetKeyBegin2(SalesMan);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(SalesMan);
  KeySegment(CustCode);
  KeySegment(SerNr);
  SubsetKeyBegin2(Reserved);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(Reserved);
  KeySegment(SerNr);
/* Unconfirmed crashproblems with crap in DespatchDate, Do we need this index??
  SubsetKeyBegin2(DespatchDate);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(DespatchDate);
  KeySegment(DespatchTime);
  KeySegment(SerNr);
*/
  SubsetKeyBegin2(Sorting);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(Sorting);
  KeySegment(SerNr);

//  SubsetKeyBegin2(UserSerNr);
//  StoreInBaseKey;
//  AppendListFieldToKeyName(SalesMan);
//  AppendListFieldToKeyName(SalesGroup);
//  KeySegment(SerNr);

  SubsetKeyBegin2(PlanShip);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(PlanShip);
  KeySegment(SerNr);
  SubsetKeyBegin2(DelAddrCode);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(DelAddrCode);
  KeySegment(SerNr);
  SubsetKeyBegin2(Sum4);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(Sum4);
  KeySegment(SerNr);
  SubsetKeyBegin2(QuoteNr);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(QuoteNr);
  KeySegment(SerNr);
  SubsetKeyBegin2(CustDate);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(CustCode);
  KeySegment(OrdDate);
  KeySegment(SerNr);
/* Not used
  SubsetKeyBegin2(ArtCodeSerNr);
  StoreInBaseKey;
  AppendMatrixFieldToKeyName(ArtCode,0);
  KeySegment(Location);  
  KeySegment(OrdDate);  
  KeySegment(SerNr);  
*/
  SubsetKeyBegin2(OKFlag);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(OKFlag);
  KeySegment(SerNr);

  SubsetKeyBegin2(ActSerNr);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(SerNr);
  KeySegment(OSFlag);
  SubsetKeyBegin2(ActOrdDate);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(OrdDate);
  KeySegment(OSFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(ActCustCode);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(CustCode);
  KeySegment(OSFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(ActName);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(Addr0);
  KeySegment(OSFlag);
  KeySegment(SerNr);
  SubsetKeyBegin2(PlanShipDate);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(PlanShipDate);
  KeySegment(SerNr);
  KeyBegin(Region);
  KeySegment(Region);
  KeySegment(SerNr);
  SubsetKeyBegin2(GroupOrdNr);
  StoreInBaseKey;
  AppendListFieldToKeyName(SalesMan);
  AppendListFieldToKeyName(SalesGroup);
  KeySegment(GroupOrdNr);
  KeySegment(SerNr);
  KeyBegin(OfficialSerNr);
  KeySegment(OfficialSerNr);
  KeySegment(SerNr);
/* Not used
  SubsetKeyBegin2(GroupOrdRow);
  StoreInBaseKey;
  AppendMatrixFieldToKeyName(GroupOrdRow,0);
  KeySegment(GroupOrdNr);  
  KeySegment(SerNr);
*/
  KeyBegin(RegDate);
  KeySegment(RegDate);
  KeySegment(RegTime);
  KeySegment(SerNr);
  KeyBegin(ORCONr);
  KeySegment(ORCONr);
  KeySegment(SerNr);

  SubsetKeyBegin2(ActArtCodeOSFlag);
  StoreInBaseKey;
  AppendMatrixFieldToKeyName(ArtCode,0);
  KeySegment(OSFlag);  
  KeySegment(SerNr);  
  KeyBegin(OYNr);
  KeySegment(OYNr);
  KeySegment(SerNr);
  EndRecord;

  RecordBegin(EDIORVc,-,"");
  RecordField(SerNr,M4Long,0,0);
  RecordField(OrdDate,M4Date,0,0);
  FieldIsTransDate(OrdDate);
  RecordField(CustCode,M4Code,20,CUVc);
  RecordField(Math,M4Matrix,0,0);
  RecordField(Addr0,M4Str,60,0);
  RecordField(Addr1,M4Str,60,0);
  RecordField(Addr2,M4Str,60,0);
  RecordField(Addr3,M4Str,60,0);
  RecordField(OurContact,M4Str,20,0);
  RecordField(CustContact,M4Str,60,0);
  RecordField(ExportFlag,M4Int,0,0);
  RecordField(InvFlag,M4Int,0,0);
  RecordField(ShipFlag,M4Int,0,0);
  RecordField(Prntdf,M4Int,0,0);
  RecordField(PayDeal,M4Code,2,0);
  RecordField(CustCat,M4Code,5,0);
  RecordField(InvMark,M4Mark,0,0);
  RecordField(ShipMark,M4Mark,0,0);
  RecordField(Objects,M4UStr,60,ObjVc);
  RecordField(ShipMode,M4Code,5,0);
  RecordField(OrderStatus,M4Int,0,0);
  RecordField(PlanShip,M4Str,10,0);
  RecordField(SalesMan,M4Code,10,UserVc);
  RecordField(Sign,M4Code,10,UserVc);
  RecordField(ShipDeal,M4Code,5,0);
  RecordField(ShipAddr0,M4Str,60,0);
  RecordField(ShipAddr1,M4Str,60,0);
  RecordField(ShipAddr2,M4Str,60,0);
  RecordField(ShipAddr3,M4Str,60,0);
  RecordField(CurncyCode,M4Code,5,CurncyCodeVc);
  RecordField(LangCode,M4Code,5,0);
  RecordField(InvoiceToCode,M4Code,20,CUVc);
  RecordField(Closed,M4Int,0,0);
  RecordField(ToRateB1,M4Rate,0,0);
  RecordField(BuildOn,M4Int,0,0);
  RecordField(PRCode,M4Code,20,PRVc);
  RecordField(Comment,M4Str,60,0);
  RecordField(InvOnlyOnFull,M4Int,0,0);
  RecordField(DownPaySent,M4Val,0,0);
  RecordField(DownPayRedcd,M4Val,0,0);
  RecordField(OrderClass,M4Code,5,0);
  RecordField(CustOrdNr,M4Str,60,0);
  RecordField(PriceList,M4Code,5,0);
  RecordField(InclVAT,M4Int,0,0);
  RecordField(Sum0,M4Val,0,0);
  RecordField(Sum1,M4Val,0,0);
  RecordField(Sum2,M4Val,0,0);
  RecordField(Sum3,M4Val,0,0);
  RecordField(Sum4,M4Val,0,0);
  RecordField(Reserved,M4Int,0,0);
  RecordField(OSFlag,M4Int,0,0);
  RecordField(Location,M4Code,10,LocationVc);
  RecordField(CustVATCode,M4Code,10,VATCodeBlock);
  RecordField(RebCode,M4Code,5,0);
  RecordField(VATNr,M4Str,20,0);
  RecordField(Phone,M4PhoneNo,20,0);
  RecordField(Fax,M4Str,20,0);
  RecordField(ExportedFlag,M4Int,0,0);
  RecordField(BaseSum4,M4Val,0,0);
  RecordField(FrRate,M4Rate,0,0); 
  RecordField(ToRateB2,M4Rate,0,0); 
  RecordField(BaseRate1,M4Rate,0,0); 
  RecordField(BaseRate2,M4Rate,0,0); 
  RecordField(DiscPerc,M4Qty,0,0); 
  RecordField(DiscSum,M4Val,0,0);
  RecordField(TotGP,M4Val,0,0);
  RecordField(Probability,M41Val,0,0);
  RecordField(CreditCard,M4UStr,20,CreditCardVc);
  RecordField(AuthorizationCode,M4UStr,10,0);
  RecordField(GPProc,M41Val,0,0);
  RecordField(VersionNr,M4Long,0,0);
  RecordField(ORSerNr,M4Long,0,0);
  RecordField(ANACode,M4Str,20,0);
  RecordField(CreateDate,M4Date,0,0);
  RecordField(CreateTime,M4Time,0,0);
  RecordField(DespatchDate,M4Date,0,0);
  RecordField(InvAddr3,M4Str,60,0);
  RecordField(InvAddr4,M4Str,60,0);
  RecordField(DelAddr3,M4Str,60,0);
  RecordField(DelAddr4,M4Str,60,0);
  RecordField(DelAddrCode,M4Code,20,0);
  RecordField(PlanShipDate,M4Date,0,0);
  RecordField(GroupOrdNr,M4Long,0,0);
  RecordField(UserStr1,M4Str,255,0);
  RecordField(UserStr2,M4Str,255,0);
  RecordField(UserStr3,M4Str,255,0);
  RecordField(UserStr4,M4Str,255,0);
  RecordField(UserStr5,M4Str,255,0);
  RecordField(UserVal1,M4UVal,0,0);
  RecordField(UserVal2,M4UVal,0,0);
  RecordField(UserVal3,M4UVal,0,0);
  RecordField(UserDate1,M4Date,0,0);
  RecordField(UserDate2,M4Date,0,0);
  RecordField(UserDate3,M4Date,0,0);
  RecordField(NoTAXonVAT,M4Long,0,0);
  RecordField(TotalwoTAX,M4Int,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(stp,M4Int,0,0);
  ArrayField(ArtCode,M4Code,20,INVc);
  ArrayField(Quant,M4UVal,0,0);
  ArrayField(Price,M423Val,0,0);
  ArrayField(Sum,M4Val,0,0);
  ArrayField(vRebate,M41Val,0,0);
  ArrayField(SalesAcc,M4Code,10,AccVc);
  ArrayField(Shipd1,M4UVal,0,0);
  ArrayField(Shipd2,M4UVal,0,0);
  ArrayField(Invd,M4UVal,0,0);
  ArrayField(Objects,M4UStr,60,ObjVc);
  ArrayField(BasePrice,M423Val,0,0);
  ArrayField(rowGP,M4Val,0,0);
  ArrayField(Spec,M4Str,100,0);
  ArrayField(VATCode,M4Code,10,VATCodeBlock);
  ArrayField(Recepy,M4Code,20,RecVc);
  ArrayField(SerialNr,M4Str,60,0);
  ArrayField(PriceFactor,M45Val,0,0);
  ArrayField(VARList,M4UStr,30,0);
  ArrayField(Location,M4Code,10,LocationVc);
  ArrayField(Source,M4Code,10,SourceVc);
  ArrayField(PickingDate,M4Date,0,0);
  ArrayField(PickingTime,M4Str,20,0);
  ArrayField(InloadingDate,M4Date,0,0);
  ArrayField(InloadingTime,M4Str,20,0);
  ArrayField(DespatchRowDate,M4Date,0,0);
  ArrayField(DespatchRowTime,M4Str,20,0);
  ArrayField(PlanShipRow,M4Str,10,0);
  ArrayField(ShipNote,M4Str,60,0);
  ArrayField(UnitCode,M4Code,5,0);
  ArrayField(UnitFactQuant,M4UVal,0,0);
  ArrayField(UnitFactPrice,M423Val,0,0);
  ArrayField(UnitXval,M4UVal,0,0);
  ArrayField(UnitYval,M4UVal,0,0);
  ArrayField(UnitZval,M4UVal,0,0);
  ArrayField(Coefficient,M45Val,0,0);
  ArrayField(VECode,M4Code,20,VEVc);
  ArrayField(GroupOrdRow,M4Long,0,0);
  ArrayField(UserStr1,M4Str,255,0);
  ArrayField(UserStr2,M4Str,255,0);
  ArrayField(UserStr3,M4Str,255,0);
  ArrayField(UserStr4,M4Str,255,0);
  ArrayField(UserStr5,M4Str,255,0);
  ArrayField(UserVal1,M4UVal,0,0);
  ArrayField(UserVal2,M4UVal,0,0);
  ArrayField(UserVal3,M4UVal,0,0);
  ArrayField(UserDate1,M4Date,0,0);
  ArrayField(UserDate2,M4Date,0,0);
  ArrayField(UserDate3,M4Date,0,0);
  ArrayField(MotherArtCode,M4Code,20,INVc);
  ArrayField(RecipeQuant,M4Qty,0,0);
  ArrayField(CustArtCode,M4Code,20,CUINVc);
  EndArray;
  MainKeyBegin(SerNr,0);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(ExportedFlag);
  KeySegment(ExportedFlag);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(CustCode);
  KeySegment(CustCode);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(InvFlag);
  KeySegment(InvFlag);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(ShipFlag);
  KeySegment(ShipFlag);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(Name);
  KeySegment(Addr0);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(PRCode);
  KeySegment(PRCode);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(OrderClass);
  KeySegment(OrderClass);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(OSFlag);
  KeySegment(OSFlag);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(OSCU);
  KeySegment(OSFlag);
  KeySegment(CustCode);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(OSObjects);
  KeySegment(OSFlag);
  KeySegment(Objects);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(OrdDate);
  KeySegment(OrdDate);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(CustOrdNr);
  KeySegment(CustOrdNr);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(InvoiceCode);
  KeySegment(OSFlag);
  KeySegment(InvoiceToCode);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(SalesMan);
  KeySegment(SalesMan);
  KeySegment(CustCode);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(Reserved);
  KeySegment(Reserved);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(DelAddrCode);
  KeySegment(DelAddrCode);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(PlanShip);
  KeySegment(PlanShip);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(PlanShipDate);
  KeySegment(PlanShipDate);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(GroupOrdNr);
  KeySegment(GroupOrdNr);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(Comment);
  KeySegment(Comment);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  KeyBegin(ORSerNr);
  KeySegment(ORSerNr);
  KeySegment(SerNr);
  KeySegment(VersionNr);
  EndRecord;

  RecordBegin(VARVc,VARView,"VARVc3");
  NewAutosyncRegister(kSyncDirectionToClient,true);
  RecordField(Code,M4Code,10,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(VARGCode,M4Code,5,VARGVc);
  RecordField(TerminateFlag,M4Int,0,0);
  RecordField(Math,M4Matrix,0,0);
  ArrayBegin(Math,-,1);
  ArrayField(LangCode,M4Code,5,0);
  ArrayField(Text,M4Str,100,0);
  EndArray;  
  MainKeyBegin(Code,0);
  KeySegment(Code);
  KeyBegin(VARGCode);
  KeySegment(VARGCode);
  KeySegment(Code);
  KeyBegin(Comment);
  KeySegment(Comment);
  KeySegment(Code);
  EndRecord;

  RecordBegin(VARGVc,VARGView,"VARGVc2");
  NewAutosyncRegister(kSyncDirectionToClient,true);
  RecordField(Code,M4Code,5,0);
  RecordField(Comment,M4Str,60,0);
  RecordField(VarSize,M4Str,2,0);
  RecordField(TopOnDocMat,M4Int,0,0);
  MainKeyBegin(Code,0);
  KeySegment(Code);
  KeyBegin(Comment);
  KeySegment(Comment);
  KeySegment(Code);
  EndRecord;

  BlockBegin(VARMaskBlock,-,"");
  NewAutosyncHBlock(kSyncDirectionToClient);
  ImpExpLevel(1);
  RecordField(Math,M4Matrix,0,0);
  ArrayBegin(Math,VARMaskRowType,1);
  ArrayField(FrItem,M4Code,20,INVc);
  ArrayField(ToItem,M4Code,20,INVc);
  ArrayField(ItemSize,M4Str,2,0);
  ArrayField(VARMask,M4UStr,60,0);
  ArrayField(VARRepOrder,M4UStr,60,0);
  ArrayField(VARSubsets,M4UStr,200,0);
  ArrayField(ItemGroup,M4Code,5,0);
  EndArray;
  EndBlock;

  RecordBegin(VARSubsetsVc,-,"VARSubsetsVc3");
  NewAutosyncRegister(kSyncDirectionToClient,true);
  RecordField(Code,M4Code,10,0);
  RecordField(Subset,M4UStr,200,0);
  RecordField(Comment,M4Str,60,0);
  MainKeyBegin(Code,0);
  KeySegment(Code);
  KeyBegin(Subset);
  KeySegment(Subset);
  KeySegment(Code);
  KeyBegin(Comment);
  KeySegment(Comment);
  KeySegment(Code);
  EndRecord;

  RecordBegin(VARMasksVc,-,"VARMasksVc3");
  NewAutosyncRegister(kSyncDirectionToClient,true);
  RecordField(Code,M4Code,10,0);
  RecordField(Masks,M4UStr,200,0);
  RecordField(Comment,M4Str,60,0);
  MainKeyBegin(Code,0);
  KeySegment(Code);
  KeyBegin(Masks);
  KeySegment(Masks);
  KeySegment(Code);
  KeyBegin(Comment);
  KeySegment(Comment);
  KeySegment(Code);
  EndRecord;

  RecordBegin(BarcodeVc,-,"BarcodeVc2");
  NewAutosyncRegister(kSyncDirectionToClient,true);
  RecordField(Barcode,M4UStr,60,0);
  RecordField(Itemcode,M4Code,20,INVc);
  RecordField(Comment,M4Str,100,0);
  RecordField(BarCodeSerialNo,M4Str,20,0);
  RecordField(CustCode,M4Code,20,CUVc);
  MainKeyBegin(Barcode,0);
  KeySegment(Barcode);
  KeyBegin(Itemcode);
  KeySegment(Itemcode);
  KeySegment(Barcode);
  KeyBegin(Comment);
  KeySegment(Comment);
  KeySegment(Barcode);
  KeySegment(Itemcode);
  KeyBegin(BarCodeSerialNo);
  KeySegment(BarCodeSerialNo);
  KeySegment(Barcode);
  KeySegment(Itemcode);
  EndRecord;
  
  return;
end;
