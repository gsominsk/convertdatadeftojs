/* Hapoeng.hal */

external inner function string 60 UserDefined(string,string);
external inner function real VATZoneButtonsLabelsENG(real,real,real,real);

event DefineWindows
begin
  real i,h,h1,h2,h3,h4,h5,h6,hs,v,vs,vm,hl,l,t,f;
  string 255 label;

  SetLangMode(LangEnglish,"ENG",2);

  WindowBegin("Purchase Order",PODClass,CGview,-);
  SetWRect(20,80,820,400);
  Sizeable(-1,-1,0,0);
  UseView(POVc);
  FormName(POForm);
  CommunicateButton;
  ActiveFieldOnNew("VECode");    
  Tile(0,74+24,false,"",VECode);
  EditField(h1=90,vm=(v=6),82,"No.",Normal,SerNr,false,TSerSClass);
  EditField(h1,v+=20,82,"#Supplier#",Normal,VECode,false,VESClass);
  EnterSkip(PayDeal);
  EditField(h=250,v=vm,-50,"Name",Normal,Addr0,false,0);
  EditField(h,v+=20,-50,"Signers",Normal,OKPersons,false,UserSClass);
  TileButton(1,"Date");
  TileButton(2,"Items");
  TileButton(3,"Currency");
  TileButton(4,"Terms");
  TileButton(5,"Other");
  TileButton(6,"O_rd. Address");
  TileButton(7,"Del. Address");
  TileButton(8,"Extra Costs");
  CheckBox(160,v+20,0,"Closed",Closed);
  CheckBox(230,v+20,0,"Price Incl VAT",InclVAT);
  Tile(1,70,false,"1",TransDate);
  vs = 20;
  EditField(h1=90,vm=(v=6),82,"Trans. Date",Normal,TransDate,false,PasteCurDate);
  EditField(h1,v+=vs,    25,"Pay. Terms",Normal,PayDeal,false,PDSClass);
  EditField(h1,v+=vs, 120,"Our Ref",Normal,OurContact,false,0);
  EditField(h2=300,v=vm,80,"Plan. Del.",Normal,PlanShip,false,PasteCurDate);
  EditField(h2,v+=vs,80,"P/Order Class",Normal,POClass,false,POrderClassSClass);
  EditField(h2,v+=vs,80,"Order Type",ViewOnly,OrderType,false,0);
  EditField(h3=470,v=vm,-50,"Pur. Ref.",Normal,Reference,false,0);
  EditField(h3,v+=vs,-50,"Attn.",Normal,VEContact,false,ContactSClass);
  EditField(h3,v+=vs,-50,"Tags/Objects",Normal,Objects,false,ObjSClass);
  EnterSkip(Math);
  Tile(2,120,true,"2",Math);
  CheckBox(20,-20,0,"OK",OKFlag);
  EditField(110,-40,70,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
  EditField(110,-20,70,"Pallets",ViewOnly,TotPalletNr,true,0);
  EditField(250,-40,70,"Freight",Normal,ShipCost,true,0);
  EditField(390,-40,70,"Customs",Normal,CustomsCost,true,0);
  EditField(250,-20,70,"Ext. Tax",ViewOnly,TAX1Sum,false,0);
  EditField(-144,-40,90,"Subtotal",ViewOnly,Sum1,true,0);
  EditField(390, -20,70,"VAT",ViewOnly,Sum3,true,0);
  EditField(-144,-20,90,"TOTAL",ViewOnly,Sum4,true,0);
  v = 24;
  MatrixBegin(3,v,-50,-44,-,199);
  MatTypedRow(stp);
  Flip(0);
  MatCol(1,28,"Item",0,ArtCode,false,INSClass);
//  MatCol(1,84,"Var",0,VARList,true,VARSClass);
//  MatCol(1,144,"Qty",0,Quant,true,0);
  MatCol(1,94,"Qty",0,Quant,true,MATVARINSClass);
  EnterSkip(ArtCode);
//  MatCol(1,194,"Description",0,Spec,false,0);
  Flip(1);
  MatColTL(1,164,"Unit",0,M4Code,ViewOnly,5,UnitCode,false,UnitSCLass);
  MatCol(1,204,"Description",0,Spec,false,0);
  MatCol(1,-337,"Stock Type",0,StockType,false,SetSClass);
  MatCol(1,-237,"Unit Price",0,Price,true,0);
  MatCol(1,-151,"%",0,vRebate,true,0);
  MatCol(1,-116,"Sum",0,Sum,true,0);
  MatCol(1,-26,"V-Cd",0,VATCode,false,VATCodeSClass);
  Flip(2);
  MatCol(1,164,"Description",0,Spec,false,0);
  MatCol(1,-310,"Purch. A/C",0,CostAcc,false,AccSClass);
  MatCol(1,-240,"Tags/Objects",0,Objects,false,ObjSClass);
  MatCol(1,-170,"Sup. Item",0,VEArtCode,false,PISClass);
  MatColTL(1,-100,"S. Unit",0,M4Code,ViewOnly,5,VEUnit,false,UnitSCLass);
  MatCol(1,-50,"Sup. Qty",0,VEQuant,true,0);
  Flip(3);
  MatCol(1,164,"Description",0,Spec,false,0);
  MatCol(1,-330,"Recv. 1",0,Shipd1,true,0);
  MatCol(1,-270,"Recv. 2",0,Shipd2,true,0);
  MatCol(1,-210,"Invoiced",0,Invd,true,0);
  MatCol(1,-150,"Pallet No.",0,PalletNr,true,0);
  MatCol(1,-90,"Project",0,PRCode,true,PRSClass);
  MatCol(1,-40,"WS No.",0,WSNr,true,0);
  Flip(4);
  MatCol(1,164,"Description",0,Spec,false,0);
  MatCol(1,-300,"Stock Type",0,StockType,false,SetSClass);
  MatCol(1,-200,"Plan. Del.",0,PlanShipRow,true,PasteCurDate);
  MatCol(1,-100,"Comment",0,Comment,true,0);
  Flip(5);
  MatCol(1,164,"Description",0,Spec,false,0);
  MatCol(1,-420,"Fr. Cost",0,ShipCost,true,0);
  MatCol(1,-360,"Customs",0,CustomsCost,true,0);
  label = UserDefined("AccBlock","PUCost1");
  if (blank(label)) then begin label = "Cost 1";end;
  MatCol(1,-300,label,0,RowCost1,true,0);
  label = UserDefined("AccBlock","PUCost2");
  if (blank(label)) then begin label = "Cost 2";end;
  MatCol(1,-240,label,0,RowCost2,true,0);
  label = UserDefined("AccBlock","PUCost3");
  if (blank(label)) then begin label = "Cost 3";end;
  MatCol(1,-180,label,0,RowCost3,true,0);
  label = UserDefined("AccBlock","PUCost4");
  if (blank(label)) then begin label = "Cost 4";end;
  MatCol(1,-120,label,0,RowCost4,true,0);
  label = UserDefined("AccBlock","PUCost5");
  if (blank(label)) then begin label = "Cost 5";end;
  MatCol(1,-60,label,0,RowCost5,true,0);
  DeleteRowTest;
  InsertRowTest;
  EndMatrix;
  vs = 20;
  v = 18; VTab(-35,v,-16,v+vs,ToolFlip,1,"A");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,2,"B");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,3,"C");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,4,"D");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,5,"E");
  Tile(3,70,false,"3",FrRate);
  vs = 20;
  EditField(h=110,v=6,50,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
  EditField(h2=295,v,50,"Agreed Rate",Normal,FrRate,true,0);
  EditField(h3=360,v,50,":",Normal,ToRateB1,true,0);
  StaticText(h3+60,v+12,"Base Currency 1",false);
  EditField(h,v+=vs,50,"Base Currency 1",Normal,BaseRate1,true,0);
  EditField(h3,v,50,":",Normal,ToRateB2,true,0);
  StaticText(h3+60,v+12,"Base Currency 2",false);
  EditField(h,v+=vs,50,"Base Currency 2",Normal,BaseRate2,true,0);
  Tile(4,110,false,"4",ShipDeal);
  vs = 20; v = 20; h2 = 450; h3 = 330;
  EditField(h=110,v=6,80,"Del. Terms",Normal,ShipDeal,false,ShipDealSClass);
  EditField(h,v+=vs,80,"Del. Mode",Normal,ShipMode,false,DMSClass);
  EditField(h,v+=vs,80,"Project",Normal,PRCode,false,PRSClass);
  EditField(h,v+=vs,170,"Factoring",Normal,InvoiceToCode,false,VESClass);
  EditField(h,v+=vs,170,"Order No.",Normal,OrdNr,false,0);
  v = VATZoneButtonsLabelsENG(h3,v=20,140,16);
  CheckBox(520,v=20,0,"Invoice Before Goods Receipt",InvBeforePU);
  Tile(5,150,false,"5",LangCode);
  vs = 20; v = 20; h2 = 450; h3 = 330;
  EditField(h,v=6,  80,"Language",Normal,LangCode,false,LangSClass);
  EditField(h,v+=vs,80,"P/O Process",Normal,POCQStatNr,true,POCQStatSClass);
  EditField(h,v+=vs,80,"PO Contract",ViewOnly,POCOSerNr,true,0);
  EditField(h,v+=vs,80,"Work Order",Normal,WONr,false,0);
  EditField(h,v+=vs,80,"Purchase Cost",Normal,CostPerUnit,true,0);
  EditField(h3,v,  100,"Branch",ViewOnly,BranchID,false,0);
  EditField(h,v+=vs,80,"Salesman",Normal,SalesMan,false,UserSClass);
  EditField(h3,v,80,"Sales Group",Normal,SalesGroup,false,SalesGroupSClass);
  EditField(h,v+=vs,-20,"Comment",Normal,Comment,false,0);
  Tile(6,110,false,"6",Addr1);
  vs = 20;
  EditField(h=110,v=6,384,"Ordering-",Normal,Addr1,false,0);
  EditField(h,v+=vs, 384,"address",Normal,Addr2,false,0);
  EditField(h,v+=vs, 384,"",Normal,Addr3,false,0);
  EditField(h,v+=vs, 384,"",Normal,InvAddr3,false,0);
  EditField(h,v+=vs, 384,"",Normal,InvAddr4,false,0);
  Tile(7,150,false,"7",ShipAddr0); vs = 20;
  EditField(h=110,v=6,100,"Location",Normal,Location,false,LocationSClass);
  EditField(h,v+=vs,384,"Delivery",Normal,ShipAddr0,false,0);
  EditField(h,v+=vs,384,"address",Normal,ShipAddr1,false,0);
  EditField(h,v+=vs,384,"",Normal,ShipAddr2,false,0);
  EditField(h,v+=vs,384,"",Normal,ShipAddr3,false,0);
  EditField(h,v+=vs,384,"",Normal,DelAddr3,false,0);
  EditField(h,v+=vs,384,"",Normal,DelAddr4,false,0);
  Tile(8,70,false,"8",ShipCost);
  vs = 20;
  label = UserDefined("AccBlock","PUCost1");
  if (blank(label)) then begin label = "Extra Cost 1";end;
  EditField(h=110,v=6,70,label,Normal,Cost1,true,0);
  label = UserDefined("AccBlock","PUCost2");
  if (blank(label)) then begin label = "Extra Cost 2";end;
  EditField(h2=295,v,70,label,Normal,Cost2,true,0);
  label = UserDefined("AccBlock","PUCost3");
  if (blank(label)) then begin label = "Extra Cost 3";end;
  EditField(h,v+=vs,70,label,Normal,Cost3,true,0);
  label = UserDefined("AccBlock","PUCost4");
  if (blank(label)) then begin label = "Extra Cost 4";end;
  EditField(h2,v,70,label,Normal,Cost4,true,0);
  label = UserDefined("AccBlock","PUCost5");
  if (blank(label)) then begin label = "Extra Cost 5";end;
  EditField(h,v+=vs,70,label,Normal,Cost5,true,0);
  EnterSkip(TransDate);
  SpecialMenu("Create Goods Receipt",'L',0,"PUFromPODsm");
  SpecialMenu("Create Shipment Notification",'L',0,"DropSHFromPODsm");
  SpecialMenu("Create Purchase Invoice",'F',1,"VIFromPODsm");
  SpecialMenu("Item Status",'I',2,"ItemStatusPODsm");
  SpecialMenu("Item Search",'f',1,"ItemSearchDsm");
  SpecialMenu("Create Email",'m',3,"CreateMailFromPODsm");
  SpecialMenu("Previous Purchase Prices",' ',4,"POLastPPrsm");
  SpecialMenu("Purchase Order Status",'r',5,"POStatRnPODsm");
  SpecialMenu("Create Returned Goods",'B',6,"RetPUFromPODsm");
  SpecialMenu("Reservations",' ',6,"POReservPODsm");
  SpecialMenu("Open TAX Matrix",' ',25,"OpenVatMatrixPODsm"); 
  EndWindow;

  return;
end;
#endif
