/* haengcu.hal */

external inner function string 60 UserDefined(string,string);
external inner function Boolean CUVATNrColumn;
external inner function Integer GetInternetEnablerCountry();
external inner function real VATZoneButtonsLabelsENG(real,real,real,real);

event DefineWindows
begin
  real x,h,h1,h2,h3,h4,h5,h6,h7,hs,v,v2,l,vs,vm,f,t;
  string 255 label;
  integer regincountry;
  
  SetLangMode(LangEnglish,"ENG",2);

  WindowBegin("Contact",CUDClass,CGview,-);
  DynamicWindow;
  SetWRect(20,80,750,601);
  Sizeable(-1,-1,0,0); 
  UseView(CUVc);
  FormName(PrintCUD);  
  ActiveFieldOnNew("Code"); //dont change, otherwise automatic address lookup helper window wont show automatically //wns
  CommunicateButton;
  Tile(0,150,false,"",Code);
  v = 6; h = 130; l=223; vs = 20; h1=410; h2 = 340; h3 = 430; h4 = 580; h5 = 460;
  EditField(h,v ,   95,"No.",Normal,Code,false,0);
  EditField(h1,v,50,"Customer Category",Normal,CustCat,false,CCatSClass);
  EditField(h,v+=vs,95,"Short",Normal,SearchKey,false,0);
  EditField(h1,v,50,"#Supplier# Category",Normal,VECat,false,VGSClass);
  EditField(h,v+=vs,95,"Title",Normal,Salutation1,false,0);
  EditField(h1,v,50,"Suffix",Normal,ANACode,false,0);
  EditField(h,v+=vs,h1-h+50,"First Name",Normal,Salutation2,false,0);
  EditField(h,v+=vs,h1-h+50,"Last Name",Normal,Salutation3,false,0);
  EditField(h,v+=vs,h1-h+50,"Display Name",Normal,Name,false,0);
  EditField(h1+200,v,100,"Salesman",Normal,SalesMan,false,UserSClass);
  CheckBox(h1+80,v=6,0,"C_ustomer",CUType);
  CheckBox(h1+80,v+=16,0,"#Supplier#",VEType);
  CheckBox(h1+80,v+=16,0,"Guest",GuestType);
  CheckBox(h1+80,v+=16,0,"Dealer",DealerType);
  CheckBox(h4,v=6,0,"No Mass Letters",NoLetterPosting);
  CheckBox(h4,v+=16,0,"No Mass Emailing",NoMailPosting);
  CheckBox(h4,v+=16,0,"No Contact at all",NoRepa);
//  HalPushButton(h1+170,v=10,h1+170+100,v+20,"CreditInfoCUDsm","Credit Info");
//  HalPushButton(h1+170,v=10,h1+170+100,v+20,"UpdCustomerAddressCUDsm","Update Address");
  TileButton(1,"Co_ntact");
  TileButton(2,"Delivery");
  TileButton(3,"Terms");
  TileButton(4,"Pricing");
  TileButton(5,"Compan_y");
  TileButton(6,"Accounts");
  TileButton(7,"Web");
  TileButton(8,"C_omments");
  TileButton(9,"Guest");
  TileButton(10,"User Defined");
  Tile(1,290,true,"1",InvAddr0);
  v=6;
  HalPushButton(h+120,v,h+120+100,v+20,"UpdCustomerAddressCUDsm","Update Address");
  v=v+10;
  StaticText(h,v+13,"Invoice Address",false);
  label = UserDefined("CUVc","InvAddr0");
  EditField(h,v+=vs,-20,label,Normal,InvAddr0,false,0);
  label = UserDefined("CUVc","InvAddr1");
  EditField(h,v+=vs,-20,label,Normal,InvAddr1,false,0);
  label = UserDefined("CUVc","InvAddr2");
  EditField(h,v+=vs,-20,label,Normal,InvAddr2,false,0);
  label = UserDefined("CUVc","InvAddr3");
  EditField(h,v+=vs,-20,label,Normal,InvAddr3,false,0);
  label = UserDefined("CUVc","InvAddr4");
  EditField(h,v+=vs,-20,label,Normal,InvAddr4,false,0);
  EditField(h,v+=vs,150,"Sort Key",Normal,Sorting,false,0);
  EditField(h1,v,-20,"Department",Normal,Department,false,0);
  EditField(h,v+=vs,150,"Telephone",Normal,Phone,false,0);
  EditField(h1,v,-20,"Fax",Normal,Fax,false,0);
  EditField(h,v+=vs,150,"Alt Phone",Normal,AltPhone,false,0);
  EditField(h1,v,-20,"Mobile",Normal,Mobile,false,0);
  EditField(h,v+=vs,150,"Skype Name",Normal,SkypeName,false,0);
  EditField(h1,v,-20,"SIP",Normal,SIPCode,false,0);
  EditField(h,v+=vs,150,"Email",Normal,eMail,false,0);  
  EditField(h1,v,-20,"Extension",Normal,Extension,false,0);
  EditField(h,v+=vs,150,"Primary Contact",Normal,Person,false,ContactSClass);
  EditField(h1,v,-20,"Web Site",Normal,wwwAddr,false,0);
  EditField(h,v+=vs,-20,"Classification",Normal,Classification,false,CClassSClass);
  RecordList2(10,v+=40,-30,-39,"ContactRelVc");
  RlColKey(4,4,"Code",ContactCode,false,CustContactCode);
  RlColKey(55,55,"Name",ContactName,false,CustContactName);
  RlCol(185,185,"Phone",ContactPhone,false);
  RlCol(285,285,"Mobile",ContactMobile,false);
  RlCol(385,385,"Alt. Phone",ContactAltPhone,false);
  RlCol(485,485,"Email",ContacteMail,false);
  RlCol(620,620,"Title",ContactTitle,false);
  RlCol(-1,-1,"",Invalid,true);
  Tile(2,220,false,"2",DelAddr0);
  v=6;
  HalPushButton(h+120,v,h+120+100,v+20,"UpdDeliveryAddressCUDsm","Update Address");
  v=v+12;
  StaticText(h,v+13,"Delivery Address",false);
  label = UserDefined("CUVc","DelAddr0");
  EditField(h,v+=vs,-20,label,Normal,DelAddr0,false,0);
  label = UserDefined("CUVc","DelAddr1");
  EditField(h,v+=vs,-20,label,Normal,DelAddr1,false,0);
  label = UserDefined("CUVc","DelAddr2");
  EditField(h,v+=vs,-20,label,Normal,DelAddr2,false,0);
  label = UserDefined("CUVc","DelAddr3");
  EditField(h,v+=vs,-20,label,Normal,DelAddr3,false,0);
  label = UserDefined("CUVc","DelAddr4");
  EditField(h,v+=vs,-20,label,Normal,DelAddr4,false,0);  
  EditField(h,v+=vs,-20,"Order Comment",Normal,OrderComment,false,0);
  EditField(h,v+=vs,120,"Freight No.",Normal,FreightNr,false,0);
  EditField(h2+50,v,70,"Region",Normal,Region,false,RegionSClass); 
  EditField(h,vm=(v+=vs),120,"Sales Del. Terms",Normal,ShipDeal,false,ShipDealSClass);
  EditField(h2+50,v,70,"Purchase Del. Terms",Normal,VEShipDeal,false,ShipDealSClass); 
  EditField(h,v+=vs,120,"Sales Del. Mode",Normal,ShipMode,false,DMSClass);
  EditField(h2+50,v,70,"Purchase Del. Mode",Normal,VEShipMode,false,DMSClass); 
/* these fields were used for securities trading, this module doesnt exist in hansa anymore */
/* Two of these fields are used in Russia and Ukraine */
//  EditField(h,vm=(v+=vs),120,"Securities Acc.",Normal,SecAccount,false,0);
//  EditField(h,v+=vs,120,"Bank Account",Normal,BankAccount,false,0);//xx
//  EditField(h,v+=vs,120,"Account Operator",Normal,AccOperator,false,BankSClass);//xx
//##  EditField(h,v+=vs ,70, "Com. Matrix",Normal,ComCode,false,ComSClass);
  ButtonFrame(h5+30,v=vm,150,2,"Delivery Date Based On");
  RadioButton(h5+30,v,0,0,"Current Date",DeliveryBasedOn);
  RadioButton(h5+30,v+=16,1,0,"Planned Delivery Date",DeliveryBasedOn);  
  Tile(3,160,false,"3",PayDeal);
  EditField(h,v=6,25,"Sales Pay. Terms",Normal,PayDeal,false,PDSClass);
  EditField(h,v+=vs,80,"Sales Credit Limit",Normal,CreditLimit,false,0);
  EditField(h,v+=vs,80,"Their Supp. Code",Normal,TheirCode,false,0);  
  EditField(h,v+=vs,80,"Invoice To",Normal,InvoiceToCode,false,CUSClass); // Factoring is something different 
  EditField(h,v+=vs,80,"ANA Code",Normal,ANACode,false,0);
  EditField(h,v+=vs,80,"Interest Rate",Normal,IntRate,false,0);
  EditField(h,v+=vs,80,"Creation Date",ViewOnly,DateCreated,false,0);
  EditField(h2,v=6,25,"Purch. Pay. Terms",Normal,VEPayDeal,false,PDSClass);
  EditField(h2,v+=vs,80,"Purch. Credit Limit",Normal,VECreditLimit,false,0);
  EditField(h2,v+=vs,80,"Their Customer Code",Normal,VECustID,false,0);  
  EditField(h2,v+=vs,80,"Factoring",Normal,VEFactoring,false,VESClass); // Factoring is something different  but in other places we have factoring ...//Purchase Invoice To
  EditField(h2,v+=vs,80,"Min. Order Sum",Normal,MinOrdSum,false,0);
  EditField(h2,v+=vs,80,"Reference",Normal,RefStr,false,0);
  EditField(h2,v+=vs,80,"Last Changed",Normal,DateChanged,false,0);
  CheckBox(h5,v=12,0,"Closed",blockedFlag);
  CheckBox(h5,v+=16,0,"On Hold",OnHoldFlag);
  CheckBox(h5,v+=16,0,"Reminders",RemndrFlag);
//  CheckBox(h5,v+=16,0,"Collection",ColectionFlag);
  CheckBox(h5,v+=16,0,"Interest",InterestFlag);
  CheckBox(h5,v+=16,0,"On Account",OnAccount);
  CheckBox(h5,v+=16,0,"No Factoring",NoFactoringFlag);
  CheckBox(h5,v+=16,0,"No Extra Tax",NoTax1);
  CheckBox(h5,v+=16,0,"Group Inv. Only",GroupInv);
  CheckBox(h4,v=12,0,"EGO Customer",EGOFlag);
  CheckBox(h4,v+=16,0,"EDI Customer",EDIFlag);
  CheckBox(h4,v+=16,0,"Allow Login",AllowLogin);
//  CheckBox(h4,v+=16,0,"Allow FTP Access",FTPLogin);
  CheckBox(h4,v+=16,0,"Fiscal Invoices Only",FiscalFlag);
  CheckBox(h4,v+=16,0,"No Region Perceptions",NoTax2);
  Tile(4,90,false,"4",PLCode);
  EditField(h,v=6 ,100, "Price List",Normal,PLCode,false,PLDefSClass);
  EditField(h,v+=vs ,100, "Discount Matrix",Normal,RebCode,false,RebSClass);
  EditField(h,v+=vs,100,"Salesman",Normal,SalesMan,false,UserSClass);
  EditField(h,v+=vs,100,"Sales Group",Normal,SalesGroup,false,SalesGroupSClass);
  EditField(h2,v=6,  80,"Sales Currency",Normal,CurncyCode,false,CurncyCodeSClass);
  EditField(h2,v+=vs,80,"Purch. Currency",Normal,VECurncyCode,false,CurncyCodeSClass);
  EditField(h2,v+=vs,80,"Default Items",Normal,CompItemCode,false,CompItemSClass);
  ButtonFrame(h5,v=24,150,3,"Price Based On");
  RadioButton(h5,v,0,0,"Order Date",PriceBasedOn);
  RadioButton(h5,v+=16,1,0,"Planned Del. Date",PriceBasedOn);
  RadioButton(h5,v+=16,2,0,"Despatch Dates",PriceBasedOn);  
  Tile(5,180,false,"5",Comment);
  EditField(h,v=6,-20,"Comment",Normal,Comment,false,0);
  EditField(h,v+=vs,-20,"Warning on Sales",Normal,WarnText1,false,0);
  EditField(h,v+=vs,-20,"Warning on Purchase",Normal,VEWarnText1,false,0);
  EditField(h,v+=vs,50,"Language",Normal,LangCode,false,LangSClass);
  EditField(h2-40,v,120,"Reg. No.1",Normal,RegNr1,false,0);
  EditField(h,v+=vs,50,"Country",Normal,CountryCode,false,CountrySClass);
  EditField(h2-40,v,120,"Reg. No.2",Normal,RegNr2,false,RegDefSClass);
  EditField(h,v+=vs,50,"Sales VAT Code",Normal,VATCode,false,VATCodeSClass);
  HalPushButton(h2-40,v,h2-40+100,v+20,"UpdCustomerAddressCUDsm","Update Address");
  EditField(h,v+=vs,50,"Purch. VAT Code",Normal,VEVATCode,false,VATCodeSClass);
  ButtonFrame(h2-40,v+=vs,143,1,"Type");
  RadioButton(h2-40,v,0,0,"Company",CustType);
  RadioButton(h2+50,v,1,0,"Person",CustType);
  EditField(h,v,120,"VAT Reg. No.",Normal,VATNr,false,0);
//  EditField(h,v+=vs,120,"Channel",Normal,WebServiceChannel,false,SetSClass);
  v = 84;
  v = VATZoneButtonsLabelsENG(h5+30,v,150,16);
  Tile(6,130,false,"6",AccAP);
  EditField(h,v=6,80,"Creditor A/C",Normal,AccAP,false,AccSClass);
  EditField(h,v+=vs,80,"Cost A/C",Normal,AccCost,false,AccSClass);
  EditField(h,v+=vs,80,"Cred. On Acc. A/C",Normal,OnAccAccAP,false,AccSClass);
  EditField(h,v+=vs,120,"Sales Tags/Objects",Normal,Objects,false,ObjSClass);
  EditField(h,v+=vs,120,"IBAN Code",Normal,IBANCode,false,0);
  EditField(h1,v=6,-20,"Bank Account",Normal,BankAccount,false,0);
  EditField(h1,v+=vs,-20,"Bank Account 2",Normal,Bank,false,0);
  EditField(h1,v+=vs,-20,"Account Operator",Normal,AccOperator,false,BankSClass);  
  EditField(h1,v+=vs,120,"Purch. Tags/Objects",Normal,VEObjects,false,ObjSClass);
  EditField(h1,v+=vs,80,"Sort Code",Normal,SortCode,false,0);
  EditField(h1,v+=vs,120,"Withholding Payment Modes",Normal,WithPayMode,false,PMSClass);
  Tile(7,70,false,"7",WebConf);
  EditField(h,vm=(v=6),120,"Web Conference",Normal,WebConf,true,0);
  EditField(h1,v,150,"Main Classification",Normal,MainDispGroup,false,DISClass);
  EditField(h,v+=vs,120,"Web Start Page",Normal,WebStartPage,false,0);
  EditField(h1,v,150,"Display on the Web",Normal,WebDisplays,false,WebDisplaySClass);
  EditField(h,v+=vs,120,"Freight Code",Normal,FreightCode,false,WebFreightSClass);
  Tile(8,170,false,"8",Comment0);
  EditField(h,v=6,-20,"Comment",Normal,Comment0,false,0);
  EditField(h,v+=vs,-20,"",Normal,Comment1,false,0);
  EditField(h,v+=vs,-20,"",Normal,Comment2,false,0);
  EditField(h,v+=vs,-20,"Title",Normal,Title,false,0);
  EditField(h,v+=vs,-20,"Job Title",Normal,JobDesc,false,JobTitleSClass);
  EditField(h,v+=vs,-20,"Salutation 1",Normal,Salutation1,false,0);
  EditField(h,v+=vs,-20,"Salutation 2",Normal,Salutation2,false,0);
  EditField(h,v+=vs,-20,"Salutation 3",Normal,Salutation3,false,0);
  Tile(9,240,false,"9",DocType);
  EditField(h,v=6,100,"Doc. Type",Normal,DocType,false,0);
  EditField(h2,v,-20,"ID",Normal,PassportNr,false,0);
//  EditFieldTL(h,vm=(v+=20),100,"Nationality",M4StrSet,Normal,423,Nationality,false,StrSetSClass);
  EditField(h,vm=(v+=20),100,"Nationality",Normal,Nationality,false,CountrySClass);
  EditField(h,v+=20,100,"Birthday",Normal,BirthDate,false,0);
  EditField(h,v+=20,100,"Profession",Normal,Profesion,false,0);   
  EditField(h,v+=20,100,"Newspaper",Normal,Newspaper,false,NewspaperSClass);
  EditField(h,v+=20,100,"Passphrase",Normal,Passphrase,false,0);
  EditField(h,v+=vs,100,"Tour Operator",Normal,TourOperator,false,CUSClass);
  EditField(h,v+=vs,100,"Agent",Normal,Agent,false,CUSClass);
  EditField(h,v+=vs,100,"Def. Pay. Mode",Normal,DefGuestPayMode,false,PMSClass);
  EditField(h,v+=vs,100,"Def. Booking Org.",Normal,BookOrigin,false,BookOrgSClass);
  EditField(h,v+=vs,300,"Diet Remarks",Normal,DietRemarks,false,0);
  EditField(h,v+=vs,300,"Req. Remarks",Normal,RequirementRemarks,false,0);

  ButtonFrame(h2,v=vm+20,100,2,"Sex");
  RadioButton(h2,v,0,0,"Male",Gender);
  RadioButton(h2,v+=17,1,0,"Female",Gender);

  CheckBox(h2+130,v=vm+20,0,"Smoker",Smoking);
  CheckBox(h2+130,v+=17,0,"Blacklisted",Blacklist);

  ButtonFrame(h2,vm=(v+=40),100,4,"Marital Status");
  RadioButton(h2,v,0,0,"Single",MarStatus);
  RadioButton(h2,v+=17,1,0,"Married",MarStatus);
  RadioButton(h2,v+=17,2,0,"Divorced",MarStatus);
  RadioButton(h2,v+=17,3,0,"Widowed",MarStatus);

  ButtonFrame(h2=h2+130,v=vm,100,3,"Age Status");
  RadioButton(h2,v,0,0,"Adult",AgeStatus);
  RadioButton(h2,v+=17,1,0,"Child",AgeStatus);
  RadioButton(h2,v+=17,2,0,"Pensioner",AgeStatus);

  Tile(10,270,false,"10",UserStr1);
  v=6;h=180;
  label = UserDefined("CUVc","UserStr1");
  if (nonblank(label)) then begin
    EditField(h,v,-20,label,Normal,UserStr1,false,0);
  end;
  label = UserDefined("CUVc","UserStr2");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserStr2,false,0);
  end;
  label = UserDefined("CUVc","UserStr3");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserStr3,false,0);
  end;
  label = UserDefined("CUVc","UserStr4");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserStr4,false,0);
  end;
  label = UserDefined("CUVc","UserStr5");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserStr5,false,0);
  end;
  label = UserDefined("CUVc","UserVal1");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserVal1,false,0);
  end;
  label = UserDefined("CUVc","UserVal2");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserVal2,false,0);
  end;
  label = UserDefined("CUVc","UserVal3");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserVal3,false,0);
  end;
  label = UserDefined("CUVc","UserDate1");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserDate1,false,0);
  end;
  label = UserDefined("CUVc","UserDate2");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserDate2,false,0);
  end;
  label = UserDefined("CUVc","UserDate3");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserDate3,false,0);
  end;
  
  EditField(h,v+=vs,-20,"Address Books",Normal,AddressBooks,false,0);
  
  SpecialMenu("Customer Status",'e',0,"CUStatusCUDsm");
//if (ValuePack(11)) then begin // Hotel
//  SpecialMenu("Create Guest",' ',0,"NewGuestCUDsm");
//end;
  SpecialMenu("Add Existing Contact",' ',1,"AddContactCUDsm");
  SpecialMenu("Create New Contact",' ',1,"NewContactCUDsm");
  SpecialMenu("Create Activity",'c',2,"NewActCUDsm");
  SpecialMenu("Create Random Password Mail",' ',3,"RandomPassMailCUDsm");
  SpecialMenu("Create Email",'m',5,"NewMailCUDsm");
  SpecialMenu("#Supplier# Status",'u',4,"VEStatusVEDsm");
  SpecialMenu("Update Contact Persons",' ',6,"UpdContactAddrCUDsm");
  if (GuiType==kGuiCocoa) then begin
    SpecialMenu("Copy to local address book",' ',7,"CopyToLocalAddressBookDsm");
  end;
  EndWindow;

  WindowBegin("Contacts",CULClass,CGmlist,-);
  SpawnClass(CUDClass);
  SetWRect(20,80,880,300);
  Sizeable(-1,-1,0,0);
  UseView(CUVc);
//  FormName(CustRn);  // Crash in multiuser
//  h = 20; HalPushButton(h,v=3,h=h+100,v+vs,"VEList","Suppliers");
//  HalPushButton(h=h+50,v=3,h=h+100,v+vs,"CUList","Customers");
  RecordList(4,17,-21,-39);
  RlColKey(4,4,"N_o.",Code,false,Code);
  RlColKey(96,96,"Short",SearchKey,false,SearchKey);
  RlColKey(145,140,"C_at",CustCat,false,Group);
  RlColKey(190,190,"Name",Name,false,Name);
  RlColKey(-480,-480,"Tele_phone",Phone,false,Phone);
  RlColKey(-380,-380,"Mobile",Mobile,false,Mobile);
  RlCol(-280,-280,"Email",eMail,true);
  RlCol(-150,-150,"Address 1",InvAddr0,false);
  SearchField("Search");
  CommunicateButton;
  BrowseSubsetButton(-40,-15);
  SpecialMenu("Customer Status",'e',0,"CUStatusCULsm");
  SpecialMenu("#Supplier# Status",'u',2,"VEStatusLsm");
  SpecialMenu("Change Password",' ',1,"ChangePasswdCULsm");
  SpecialMenu("Search",'F',3,"CUSearchLsm");
  SpecialMenu("Create Activity",'c',4,"NewActCULsm");
  if (GuiType==kGuiCocoa) then begin
    SpecialMenu("Import address book",' ',5,"ImportAddressbooksm");
  end;
  EndWindow;

  WindowBegin("Paste Customer",CUSClass,CGslist,-);
  SetWRect(20,80,880,300);
  Sizeable(-1,-1,0,0);
  UseView(CUVc);
  SpawnClass(CUDClass);
  RecordList(4,17,-21,-39);
  RlColKey(4,4,"N_o.",Code,false,ActCode);
  RlColKey(96,96,"Short",SearchKey,false,ActSearchKey);
  RlColKey(145,140,"C_at",CustCat,false,ActGroup);
  RlColKey(190,190,"Name",Name,false,ActName);
  RlColKey(-480,-480,"Tele_phone",Phone,false,ActPhone);
  RlColKey(-380,-380,"Mobile",Mobile,false,ActMobile);
  RlCol(-280,-280,"Email",eMail,true);
  RlCol(-150,-150,"Address 1",InvAddr0,false);
  SearchField("Search");
  BrowseSubsetButton(-40,-15);
  SpecialMenu("Customer Status",'e',0,"CUStatusCUSsm");
  SpecialMenu("Search",'F',1,"CUSearchLsm");
  EndWindow;

/*
  WindowBegin("Paste Supplier",VESClass,CGslist,-);
  SetWRect(20,80,880,300);
  Sizeable(-1,-1,0,0);
  UseView(CUVc);
  SpawnClass(CUDClass);
  RecordList(4,17,-21,-39);
  RlColKey(4,4,"N_o.",Code,false,Code);
  RlColKey(96,96,"Short",SearchKey,false,SearchKey);
  RlColKey(145,140,"C_at",CustCat,false,Group);
  RlColKey(190,190,"Name",Name,false,Name);
  RlColKey(-480,-480,"Tele_phone",Phone,false,Phone);
  RlColKey(-380,-380,"Mobile",Mobile,false,Mobile);
  RlCol(-280,-280,"Email",eMail,true);
  RlCol(-150,-150,"Address 1",InvAddr0,false);
  SearchField("Search");
  BrowseSubsetButton(-40,-15);
  SpecialMenu("Supplier Status",'u',0,"VEStatusLsm");
  SpecialMenu("Search",'F',1,"VESearchSsm");
  EndWindow;
*/
  WindowBegin("Paste #Supplier#",VESClass,CGslist,-);
  SetWRect(20,80,680,298);
  Sizeable(-1,-1,0,0);
  UseView(CUVc);
  SpawnClass(CUDClass);
  RecordList(4,17,-21,-39);
  RlColKey(4,4,"N_o.",Code,false,VEActCode);
  RlColKey(96,96,"Short",SearchKey,false,VEActSearchKey);
  RlColKey(145,140,"C_at",VECat,false,VEActGroup);
  RlColKey(190,190,"Name",Name,false,VEActName);
  RlColKey(-260,-260,"Department",Department,false,VEActDepartment);
  if (CUVATNrColumn) then begin
    RlColKey(-160,-160,"VAT Reg. No.",VATNr,false,VEActVATNr);
  end else begin
    RlColKey(-160,-160,"Reg. No.",RegNr1,false,VEActRegNr1);
  end;
  RlColKey(-70,-70,"Bank Account",BankAccount,false,ActBankAccount);
  SearchField("Search");
  BrowseSubsetButton(-40,-15);
  SpecialMenu("#Supplier# Status",'u',0,"VEStatusLsm");
  SpecialMenu("Search",'F',1,"VESearchSsm");
  EndWindow;
    
  WindowBegin("Paste Customer",AllCUSClass,CGslist,-);
  SetWRect(20,80,880,300);
  Sizeable(-1,-1,0,0);
  UseView(CUVc);
  SpawnClass(CUDClass);
  v = 5;  vs = 20; l = 80;
  h = 20; HalPushButton(h,v,h+l,v+vs,"SwitchToVE","Suppliers");
  h=h+l+12; HalPushButton(h,v,h+l,v+vs,"SwitchToContactCU","All Contacts");
  RecordList(4,17+28,-21,-39);
  RlColKey(4,4,"N_o.",Code,false,Code);
  RlColKey(96,96,"Short",SearchKey,false,SearchKey);
  RlColKey(145,140,"C_at",CustCat,false,Group);
  RlColKey(190,190,"Name",Name,false,Name);
  RlColKey(-480,-480,"Tele_phone",Phone,false,Phone);
  RlColKey(-380,-380,"Mobile",Mobile,false,Mobile);
  RlCol(-280,-280,"Email",eMail,true);
  RlCol(-150,-150,"Address 1",InvAddr0,false);
  SearchField("Search");
  BrowseSubsetButton(-40,-15);
  SpecialMenu("Customer Status",'e',0,"CUStatusCUSsm");
  EndWindow;

  WindowBegin("Paste #Supplier#",AllVESClass,CGslist,-);
  SetWRect(20,80,880,300);
  Sizeable(-1,-1,0,0);
  UseView(CUVc);
  SpawnClass(CUDClass);
  v = 5;  vs = 20; l = 80;
  h = 20; HalPushButton(h,v,h+l,v+vs,"SwitchToCU","Customers");
  h=h+l+12; HalPushButton(h,v,h+l,v+vs,"SwitchToContactCU","All Contacts");
  RecordList(4,17+28,-21,-39);
  RlColKey(4,4,"N_o.",Code,false,Code);
  RlColKey(96,96,"Short",SearchKey,false,SearchKey);
  RlColKey(145,140,"C_at",CustCat,false,Group);
  RlColKey(190,190,"Name",Name,false,Name);
  RlColKey(-480,-480,"Tele_phone",Phone,false,Phone);
  RlColKey(-380,-380,"Mobile",Mobile,false,Mobile);
  RlCol(-280,-280,"Email",eMail,true);
  RlCol(-150,-150,"Address 1",InvAddr0,false);
  SearchField("Search");
  BrowseSubsetButton(-40,-15);
  SpecialMenu("#Supplier# Status",'u',0,"VEStatusVESsm");
  EndWindow;
  
// Same as above, with one extra button
  WindowBegin("Paste Customer",AllCUGuestSClass,CGslist,-);
  SetWRect(20,80,880,300);
  Sizeable(-1,-1,0,0);
  UseView(CUVc);
  SpawnClass(CUDClass);
  v = 5;  vs = 20; l = 80;
  h = 20; HalPushButton(h,v,h+l,v+vs,"SwitchToVEGuest","Suppliers");
  h = h + 100; HalPushButton(h,v,h+l,v+vs,"SwitchToProfileGuest","Guests");
  RecordList(4,17+28,-21,-39);
  RlColKey(4,4,"N_o.",Code,false,Code);
  RlColKey(96,96,"Short",SearchKey,false,SearchKey);
  RlColKey(145,140,"C_at",CustCat,false,Group);
  RlColKey(190,190,"Name",Name,false,Name);
  RlColKey(-480,-480,"Tele_phone",Phone,false,Phone);
  RlColKey(-380,-380,"Mobile",Mobile,false,Mobile);
  RlCol(-280,-280,"Email",eMail,true);
  RlCol(-150,-150,"Address 1",InvAddr0,false);
  SearchField("Search");
  BrowseSubsetButton(-40,-15);
  SpecialMenu("Customer Status",'e',0,"CUStatusCUSsm");
  EndWindow;

// Same as above, with one extra button
  WindowBegin("Paste #Supplier#",AllVEGuestSClass,CGslist,-);
  SetWRect(20,80,880,300);
  Sizeable(-1,-1,0,0);
  UseView(CUVc);
  SpawnClass(CUDClass);
  v = 5;  vs = 20; l = 80;
  h = 20; HalPushButton(h,v,h+l,v+vs,"SwitchToCUGuest","Customers");
  h = h + 100; HalPushButton(h,v,h+l,v+vs,"SwitchToProfileGuest","Guests");
  RecordList(4,17+28,-21,-39);
  RlColKey(4,4,"N_o.",Code,false,Code);
  RlColKey(96,96,"Short",SearchKey,false,SearchKey);
  RlColKey(145,140,"C_at",CustCat,false,Group);
  RlColKey(190,190,"Name",Name,false,Name);
  RlColKey(-480,-480,"Tele_phone",Phone,false,Phone);
  RlColKey(-380,-380,"Mobile",Mobile,false,Mobile);
  RlCol(-280,-280,"Email",eMail,true);
  RlCol(-150,-150,"Address 1",InvAddr0,false);
  SearchField("Search");
  BrowseSubsetButton(-40,-15);
  SpecialMenu("#Supplier# Status",'u',0,"VEStatusVESsm");
  EndWindow;
  
  return;
end;

