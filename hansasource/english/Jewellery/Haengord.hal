#ifdef HAL

external inner function Boolean TouchScreenLook();
external inner function string 60 UserDefined(string,string);
external inner function real VATZoneButtonsLabelsENG(real,real,real,real);

event DefineWindows
begin
  real h,h1,hl,h2,h3,h4,h5,h6,h7,hs,v,v3,vm,l,vs,f,v2,t;
  string 60 label;
    
  SetLangMode(LangEnglish,"ENG",2);

  if (TouchScreenLook) then begin

  WindowBegin("Order",ORDClass,CGview,-);
  SetWRect(20,80,850,470);
  Sizeable(-1,-1,0,0);
  UseView(ORVc);
  FormName(OrdForm);
  ActiveFieldOnNew("CustCode");    
  CommunicateButton;
  h = 70; h1 = h + 200; h2 = h1 + 200; v = 6; vs = 20;
  //Tile(0,395,false,"",CustCode);
  EditField(h=90,vm=(v=6), 82,"No.",Normal,SerNr,false,TSerSClass);
  EditField(h,v+=20,82,"Ord. Date",Normal,OrdDate,false,PasteCurDate);
  EditField(h,v+=vs, 20,"Pay. Terms",Normal,PayDeal,false,PDSClass);
  EditField(h,v+=vs,82,"Planned Del.",Normal,PlanShip,false,PasteCurDate);
  EditField(h,v+=vs,82,"Cust. Ord. No.",Normal,CustOrdNr,false,0);
  EditField(h1,v=vm,95, "Customer",Normal,CustCode,false,AllCUSClass);
  EditField(h1,v+=vs,95,"Salesman",Normal,SalesMan,false,UserSClass);
  EditField(h1,v+=vs,95,"Tags/Objects",Normal,Objects,false,ObjSClass);
  EditField(h1,v+=vs,60,"Language",Normal,LangCode,false,LangSClass);
  EditField(h1,v+=vs,60,"Order Class",Normal,OrderClass,false,OrderClassSClass);
  h = 450; v = 6; vs = 20;
  EnterSkip(Math);
  EditField(h2,v=6,-40,"Name",Normal,Addr0,false,0);
  label = UserDefined("CUVc","InvAddr0");
  if (blank(label)) then begin label = "Invoice To"; end;
  EditField(h2,v+=vs,-40,label,ViewOnly,Addr1,false,0);
  label = UserDefined("CUVc","InvAddr1");
  if (blank(label)) then begin label = "Address"; end;
  EditField(h2,v+=vs, -40,label,ViewOnly,Addr2,false,0);
  label = UserDefined("CUVc","InvAddr2");
  EditField(h2,v+=vs, -40,label,ViewOnly,Addr3,false,0);
  label = UserDefined("CUVc","InvAddr3");
  EditField(h2,v+=vs,100,"Telephone",Normal,Phone,false,0);
  CheckBox(h2+200,v,0,"Closed",Closed);
  v = 22;
  MatrixBegin(15,125,-52,-100,-,199);
  MatTypedRow(stp);
  MatText(t=9,32,"Subtotal",true);
  MatCol(t,100,"",0,Spec,false,0);
  MatCol(t,-80,"Sum",0,Sum,true,0);
  MatText(t=17,32,"Header",true);
  MatCol(t,100,"",0,Spec,false,0);
  MatCol(t=1,28,"Serial No.",0,SerialNr,false,SerialNrSClass);
  MatCol(t=1,170,"Item",0,ArtCode,false,INSClass);
  MatCol(t,250,"Qty",0,Quant,true,MATVARINSClass);
  EnterSkip(ArtCode);
  MatText(t=10,32,"This row and all rows below it will be hidden on printout",false);
  MatCol(t=1,300,"Description",0,Spec,false,0);
  MatCol(t,-280,"Location",0,Location,false,LocationSClass);
  MatCol(t,-225,"Unit Price",0,Price,true,PLSClass);
  MatCol(t,-140,"%",0,vRebate,true,0);
  MatCol(t,-110,"Sum",0,Sum,true,0);
  MatCol(t,-25,"V-Cd",0,VATCode,false,VATCodeSClass);
  InsertRowTest;
  DeleteRowTest;
  EndMatrix;
  CheckBox(20,-80,0,"OK",OKFlag);
  EditField(65,-101,50,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
  EditField(190,-101,70,"Freight",Normal,FrPrice,true,0);
  EditField(350,-101,95,"VAT",ViewOnly ,Sum3,true,0);
  EditField(350,-81,95,"Base",ViewOnly,BaseSum4,true,0);
  EditField(-133,-101,95,"Subtotal",ViewOnly ,Sum1,true,0);
  EditField(-133,-81,95,"TOTAL",ViewOnly ,Sum4,true,0);
  ColourPushButton(h=17,v=-55,h+175,v+50,"DownPayFromORDsm","Create Downpayment Invoice",2);
  ColourPushButton(h=h+177,v,h+175,v+50,"SHFromORDsm","Create Delivery",2);
  ColourPushButton(h=h+177,v,h+175,v+50,"IVFromORDsm","Create Invoice",2);
  SpecialMenu("Add Header Line",' ',13,"ORAddHeaderLine");
  SpecialMenu("Add Hidden Line",' ',13,"ORAddHidLine");
  SpecialMenu("Add Subtotal",' ',14,"SubtotalORDsm");
  SpecialMenu("Recalculate Weight and Volume",' ',10,"RecalculateWeightORDsm");
  SpecialMenu("Update Currency Price List Items",' ',7,"UpdatePricesORDsm");
  SpecialMenu("Item Status",'I',2,"ItemStatusORDsm");
  SpecialMenu("Item Search",'f',1,"ItemSearchDsm");
  SpecialMenu("Order Status",'r',5,"ORInfoRnORDsm");
  SpecialMenu("Previous Sales Prices",' ',12,"ORLastSPrsm");
  SpecialMenu("Print Internal Order",' ',4,"Or2FormORDsm");
  SpecialMenu("Reservations",' ',15,"OrderReservORDsm");
  SpecialMenu("Create Activity",'c',9,"CreateActFromORDsm");
  SpecialMenu("Create Delivery",'L',0,"SHFromORDsm");
  SpecialMenu("Create Down Payment Invoice",'o',3,"DownPayFromORDsm");
  SpecialMenu("Create Email",'m',11,"CreateMailFromORDsm");
  SpecialMenu("Create Invoice",'F',1,"IVFromORDsm");
  SpecialMenu("Create Project",' ',9,"CreatePRFromORDsm");
  SpecialMenu("Create Project Budget",' ',10,"CreateTBBUFromORDsm");
  SpecialMenu("Create Returned Goods",'B',6,"RetFromORsm");
  SpecialMenu("Create Stock Movement",' ',8,"StockMovFromORDsm");
  EndWindow;

  end else begin
  
  WindowBegin("Order",ORDClass,CGview,-);
  SetWRect(20,80,660,460);
  Sizeable(-1,-1,0,0);
  UseView(ORVc);
  FormName(OrdForm);
  ActiveFieldOnNew("CustCode");    
  CommunicateButton;
  Tile(0,48+24,false,"",CustCode);
  EditField(75,vm=(v=6), 82,"No.",Normal,SerNr,false,TSerSClass);
  EditField(75,v+=20,95, "Customer",Normal,CustCode,false,CUSClass);
  EnterSkip(PayDeal);
  CheckBox(230,v,0,"Closed",Closed);
  CheckBox(310,v,0,"Reserved",Reserved);
  EditField(h=216,v=vm,-40,"Name",Normal,Addr0,false,0);
  TileButton(1,"Date");
  TileButton(2,"Items");
  TileButton(3,"Currency");
  TileButton(4,"Del. Terms");
  TileButton(5,"Inv. Address");
  TileButton(6,"Del. Address");
  Tile(1,88,false,"1",OrdDate);
  vs = 20;
  EditField(h1=110,vm=(v=6),82,"Date",Normal,OrdDate,false,PasteCurDate);
  EditField(h1,v+=vs, 25,"Pay. Terms",Normal,PayDeal,false,PDSClass);
  EditField(h1,v+=vs, 120,"Our Ref.",Normal,OurContact,false,0);
  EditField(h1,v+=vs, 120,"Tag/Object",Normal,Objects,false,ObjSClass);
  EditField(h2=330,v=vm,100,"Planned Del.",Normal,PlanShip,false,PasteCurDate);
  EditField(522,v,75,"Desp. Date",Normal,DespatchDate,false,PasteCurDate);
  EditField(645,v,-10,"Time",Normal,DespatchTime,false,PasteCurTime);
  EditField(h2,v+=vs,60,   "Salesman",Normal,SalesMan,false,UserSClass);
  EditField(522,v,75,"Order Type",Normal,OrderType,false,SetSClass);
  EditField(h2,v+=vs,-10,"Attn.",Normal,CustContact,false,ContactSClass);
  EditField(h2,v+=vs,200,"Cust. Ord. No.",Normal,CustOrdNr,false,0);
  EditField(645,v,-10,"Class",Normal,OrderClass,false,OrderClassSClass);
  EnterSkip(Math);
  Tile(2,220,true,"2",Math);
  CheckBox(20,-20,0,"OK",OKFlag);
  EditField(65,-41,50,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
  EditField(190,-41,70,"Freight",Normal,FrPrice,true,0);
  EditField(190,-21,70,"Ext. Tax",ViewOnly,TAX1Sum,true,0);
  EditField(310,-41,80,"VAT",ViewOnly ,Sum3,true,0);
  EditField(310,-21,80,"TAX2",ViewOnly,TAX2Sum,true,0);
  EditField(440,-21,95,"Base",ViewOnly,BaseSum4,true,0);
  EditField(-133,-41,95,"Subtotal",ViewOnly ,Sum1,true,0);
  EditField(-133,-21,95,"TOTAL",ViewOnly ,Sum4,true,0);
  v = 22;
  MatrixBegin(3,v,-50,-49,-,200);
  MatTypedRow(stp);
  Flip(0);
  MatText(t=9,32,"Subtotal",true);
  MatCol(t,100,"",0,Spec,false,0);
  MatColTL(t,-80,"Sum",0,-1,ViewOnly,0,Sum,true,0);
  MatText(t=17,32,"Header",true);
  MatCol(t,100,"",0,Spec,false,0);
  MatCol(t=1,32,"Item",0,ArtCode,false,INSClass);
//  MatCol(t,94,"Var",0,VARList,true,VARSClass);
//  MatCol(t,144,"Qty",0,Quant,true,0);
  MatCol(t,94,"Qty",0,Quant,true,MATVARINSClass);
  EnterSkip(ArtCode);
  MatText(t=10,32,"This row and all rows below it will be hidden on printout",false);
  Flip(1);
//  MatCol(t=1,194,"Description",0,Spec,false,0);
  MatCol(t=1,144,"Description",0,Spec,false,0);
  MatCol(t,-235,"Unit Price",0,Price,true,PLSClass);
  MatCol(t,-135,"%",0,vRebate,true,0);
  MatCol(t,-100,"Sum",0,Sum,true,0);
  Flip(2);
  MatCol(t=1,144,"Description",0,Spec,false,0);
  MatCol(t,-224,"A/C",0,SalesAcc,false,AccSClass);
  MatCol(t,-124,"Tag/Object",0,Objects,false,ObjSClass);
  MatCol(t,-30,"V-Cd",0,VATCode,false,VATCodeSClass);
  Flip(3);
  MatCol(t=1,144,"Description",0,Spec,false,0);
  if (UserCanAction("ViewCostPrice",true)) then begin
    MatCol(t,-245,"Unit Price",0,Price,true,PLSClass);
    MatCol(t,-175,"%",0,vRebate,true,0);
    MatCol(t,-140,"Cost",0,BasePrice,true,0);
    MatCol(t,-70,"GP",0,rowGP,true,0);
  end else begin
    MatCol(t,-235,"Unit Price",0,Price,true,PLSClass);
    MatCol(t,-135,"%",0,vRebate,true,0);
    MatCol(t,-100,"Sum",0,Sum,true,0);
  end;
  Flip(4);
  MatCol(t=1,144,"Desc.",0,Spec,false,0);
  MatCol(t,-290,"Del. 1",0,Shipd1,true,0);
  MatCol(t,-220,"Del. 2",0,Shipd2,true,0);
  MatCol(t,-150,"Invoiced",0,Invd,true,0);
  MatCol(t,-80,"Recipe",0,Recepy,false,RecSClass);
  Flip(5);
  MatCol(t=1,144,"Description",0,Spec,false,0);
  MatCol(t,-290,"Serial No.",0,SerialNr,false,SerialNrSClass);
  MatCol(t,-150,"Plan. Del.",0,PlanShipRow,true,PasteCurDate);
  MatCol(t,-70,"Price Factor",0,PriceFactor,true,0);
  Flip(6);
  MatCol(t=1,144,"Description",0,Spec,false,0);
  MatCol(t,-315,"Delivery Note",0,ShipNote,false,0);
  MatCol(t,-210,"Location",0,Location,false,LocationSClass);
  MatCol(t,-145,"Position",0,Position,true,UsedPosSClass);
  MatCol(t,-90,"Source",0,Source,true,SourceSClass);
  Flip(7);
  MatCol(t=1,144,"Pick. Date",0,PickingDate,false,PasteCurDate);
  MatCol(t,-390,"Pick. Time",0,PickingTime,false,PasteCurTime);
  MatCol(t,-320,"Inl. Date",0,InloadingDate,true,PasteCurDate);
  MatCol(t,-230,"Inl. Time",0,InloadingTime,true,PasteCurTime);
  MatCol(t,-160,"Desp. Date",0,DespatchRowDate,true,PasteCurDate);
  MatCol(t,-70,"Desp. Time",0,DespatchRowTime,true,PasteCurTime);
  Flip(8);
  MatCol(t=1,144,"Description",0,Spec,false,0);
  MatCol(t,-315,"Unit",0,UnitCode,false,UnitSClass);
  MatCol(t,-260,"Unit Qty",0,UnitFactQuant,true,0);
  MatCol(t,-200,"Width",0,UnitXval,true,0);
  MatCol(t,-160,"Height",0,UnitYval,true,0);
  MatCol(t,-120,"Depth",0,UnitZval,true,0);
  MatCol(t,-80,"Unit Pr.of Unit",0,UnitFactPrice,true,0);
  InsertRowTest;
  DeleteRowTest;
  EndMatrix;
  vs = 20;
  v = 18; VTab(-35,v,-16,v+vs,ToolFlip,1,"A");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,2,"B");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,3,"C");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,4,"D");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,5,"E");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,6,"F");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,7,"G");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,8,"H");
  Tile(3,70,false,"3",FrRate);
  vs = 20;
  EditField(h=110,v=6,50,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
  EditField(h2=295,v,50,"Rate",Normal,FrRate,true,0);
  EditField(h3=360,v,50,":",Normal,ToRateB1,true,0);
  StaticText(h3+60,v+12,"Base Currency 1",false);
  EditField(h,v+=vs,50,"Base Currency 1",Normal,BaseRate1,true,0);
  EditField(h3,v,50,":",Normal,ToRateB2,true,0);
  StaticText(h3+60,v+12,"Base Currency 2",false);
  EditField(h,v+=vs,50,"Base Currency 2",Normal,BaseRate2,true,0);
  Tile(4,215,false,"4",ShipDeal);
  vs = 20;
  EditField(h=110,v=6,60,"Del. Terms",Normal,ShipDeal,false,ShipDealSClass);
  EditField(h2=295,v,60,"Del. Mode",Normal,ShipMode,false,DMSClass);
  EditField(h3=480,v,60,"Sales Group",Normal,SalesGroup,false,SalesGroupSClass);
  EditField(h,v+=vs,60,"Order Class",Normal,OrderClass,false,OrderClassSClass);
  EditField(h2,v,60,"Location",Normal,Location,false,LocationSClass);
  //EditField(h3,v,60,"Despatch Date",Normal,DespatchDate,false,0);// field is also on card 1
  EditField(h,v+=vs,60,"Project",Normal,PRCode,false,PRSClass);
  EditField(h2,v,100,"Invoice To",Normal,InvoiceToCode,false,CUSClass);
  CheckBox(h3,v,0,"Invoice Before Delivery",InvBeforeShip);
  EditField(h,v+=vs,60,"Price List",Normal,PriceList,false,PLDefSClass);
  EditField(h2,v,  -20,"Credit Card",Normal,CreditCard,false,CreditCardSClass);
  EditField(h,v+=vs,60,"Language",Normal,LangCode,false,LangSClass);
  EditField(h2,v,  100,"Authorisation",Normal,AuthorizationCode,false,0);
  EditField(h,v+=vs,  60,"Discount Matrix",ViewOnly,RebCode,false,0); 
  EditField(h2,v,  100,"Branch",Normal,BranchID,false,AllCUSClass);
//  EditField(h2,v,60,"Disc %",ViewOnly,DiscPerc,false,0);
//  EditField(h3,v   ,-20,"Disc Amnt",ViewOnly,DiscSum,false,0);
  EditField(h,v+=vs,-20,"Comment",Normal,Comment,false,0);
  EditField(h,v+=vs,80,"Tot Quantity",ViewOnly,TotQty,true,0);
  EditField(h2,v,80,"Tot Weight",ViewOnly,TotWeight,true,0);
  EditField(h3,v,80,"Tot Volume",ViewOnly,TotVolume,true,0);

  EditField(h,v+=vs,80,"Commission",Normal,Commision,true,0);
  EditField(h2,v,80,"Total Incl. Com.",ViewOnly,SumIncCom,true,0);
  EditField(h3,v,-20,"Sorting",Normal,Sorting,false,0);
  if (UserCanAction("ViewCostPrice",true)) then begin
    EditField(h,v+=vs,80,"GP %",Normal,GPProc,true,0);
    EditField(h2,v,80,"Total GP",ViewOnly,TotGP,true,0);
  end;
  Tile(5,215,false,"5",Addr1); vs = 20;
  EditField(h=110,v=6,-20,"Invoice To",Normal,Addr1,false,0);
  EditField(h,v+=vs,-20,"Address",Normal,Addr2,false,0);
  EditField(h,v+=vs,-20,"",Normal,Addr3,false,0);
  EditField(h,v+=vs,-20,"",Normal,InvAddr3,false,0);
  EditField(h,v+=vs,-20,"",Normal,InvAddr4,false,0);
  EditField(h,vm=(v+=20),100,"Telephone",Normal,Phone,false,0);
  EditField(h,v+=20,100,"Fax",Normal,Fax,false,0);
  v = VATZoneButtonsLabelsENG(h2+4,v=vm+15,140,16);
  Tile(6,150,false,"6",ShipAddr0); vs = 20;
  EditField(h=110,v=6,-20,"Delivery",Normal,ShipAddr0,false,0);
  EditField(h,v+=vs,-20,"Address",Normal,ShipAddr1,false,0);
  EditField(h,v+=vs,-20,"",Normal,ShipAddr2,false,0);
  EditField(h,v+=vs,-20,"",Normal,ShipAddr3,false,0);
  EditField(h,v+=vs,-20,"",Normal,DelAddr3,false,0);
  EditField(h,v+=vs,-20,"",Normal,DelAddr4,false,0);
  EditField(h,v+=vs,80,"Address",Normal,DelAddrCode,false,DelAddrSClass);
  EditField(h2,v,80,"Region",Normal,Region,false,RegionSClass); 
  EnterSkip(OrdDate);
  SpecialMenu("Add Header Line",' ',13,"ORAddHeaderLine");
  SpecialMenu("Add Hidden Line",' ',13,"ORAddHidLine");
  SpecialMenu("Add Subtotal",' ',14,"SubtotalORDsm");
  SpecialMenu("Recalculate Weight and Volume",' ',10,"RecalculateWeightORDsm");
  SpecialMenu("Update Currency Price List Items",' ',7,"UpdatePricesORDsm");
  SpecialMenu("Item Status",'I',2,"ItemStatusORDsm");
  SpecialMenu("Item Search",'f',1,"ItemSearchDsm");
  SpecialMenu("Order Status",'r',5,"ORInfoRnORDsm");
  SpecialMenu("Previous Sales Prices",' ',12,"ORLastSPrsm");
  SpecialMenu("Print Internal Order",' ',4,"Or2FormORDsm");
  SpecialMenu("Reservations",' ',15,"OrderReservORDsm");
  SpecialMenu("Create Activity",'c',9,"CreateActFromORDsm");
  SpecialMenu("Create Delivery",'L',0,"SHFromORDsm");
  SpecialMenu("Create Down Payment Invoice",'o',3,"DownPayFromORDsm");
  SpecialMenu("Create Email",'m',11,"CreateMailFromORDsm");
  SpecialMenu("Create Invoice",'F',1,"IVFromORDsm");
  SpecialMenu("Create Project",' ',9,"CreatePRFromORDsm");
  SpecialMenu("Create Project Budget",' ',10,"CreateTBBUFromORDsm");
  SpecialMenu("Create Returned Goods",'B',6,"RetFromORsm");
  SpecialMenu("Create Stock Movement",' ',8,"StockMovFromORDsm");
  EndWindow;

  end;

  return;
end;

#endif
