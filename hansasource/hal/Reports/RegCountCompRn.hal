global
procedure RegCountCompRn(record RcVc RepSpec)
begin
  Integer i,rwcnt,oldcomp;
  record CompaniesBlock Compb;
  row CompaniesBlock Compbrw;
  LongInt totcnt,cnt;
  
  oldcomp = CurrentCompany;
  BlockLoad(Compb);
  StartReportJob(USetStr(13575));
  EndHeader;
  if (blank(RepSpec.TransStr)) then begin
    goto LRegCountCompRn;
  end;
  totcnt = 0;
  StartFormat(15);
   OutString(0,0,USetStr(14162),false);
   OutString(100,0,USetStr(13579),false);
   OutString(1,0,USetStr(13576),true);
  EndFormat;
  Gray_Divider(0,1);
  rwcnt = MatRowCnt(Compb);
  for (i=0;i<rwcnt;i=i+1) begin
    MatRowGet(Compb,i,Compbrw);
    if (Compbrw.ActiveStatus==0) then begin
      SetServerCompany(i+1);
      cnt = CountRecords(RepSpec.TransStr);
      StartFormat(15);
       OutString(0,0,Compbrw.CompCode,false);
       OutString(100,0,Compbrw.CompName,false);
       OutLongInt(1,0,cnt,true);
      EndFormat;
      totcnt = totcnt + cnt;
    end;
  end;
  Gray_Divider(0,1);
  StartFormat(15);
   OutLongInt(1,0,totcnt,true);
  EndFormat;
LRegCountCompRn:;  
  EndJob;
  ResetCompany(oldcomp);
  return;
end;