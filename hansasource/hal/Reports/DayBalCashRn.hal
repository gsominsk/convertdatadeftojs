external procedure DayBalNL2Rn(var record RcVc,Integer);

global
procedure DayBalCashRn(var record RcVc RepSpec)
BEGIN
  record PMBlock PMRec;
  row PMBlock PMrw;
  string 255 tstr;
  Integer rwcnt,i;

  if ((nonblank(RepSpec.f1)) or (nonblank(RepSpec.AccStr))) then begin
    BlockLoad(PMRec);
    rwcnt = MatRowCnt(PMRec);
    for (i = 0; i<rwcnt; i=i+1) begin
      MatRowGet(PMRec,i,PMrw);
      if (PMrw.Code==RepSpec.f1) then begin
        tstr = PMrw.AccNr;
      end;
    end;
    if (nonblank(tstr)) then begin
      RepSpec.AccStr = tstr;
      RepSpec.f1 = "";
      DayBalNL2Rn(RepSpec,3260);
    end else begin
      if (nonblank(RepSpec.AccStr)) then begin
        DayBalNL2Rn(RepSpec,3260);
      end;
    end;
  end else begin
    StartReportJob(USetStr(3260));
    EndHeader;
    StartFormat(15);
     OutString(20,0,USetStr(1101),false);
    EndFormat;
    EndJob;
  end;
  RETURN;
END;
