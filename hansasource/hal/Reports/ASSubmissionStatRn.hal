global
procedure ASSubmissionStatRn(record RcVc RepSpec)
begin
  record ASProdStatHistVc ASPSHr;
  record ASProductVc ASPr;
  Boolean found,testf;
  string 255 frcp,tocp;
  string 255 frpr,topr;
  string 255 frst,tost;

  StartReportJob(USetStr(31250));
  EndHeader;
  frpr = FirstInRange(RepSpec.f1,20);
  topr = LastInRange(RepSpec.f1,20);
  frst = FirstInRange(RepSpec.f2,20);
  tost = LastInRange(RepSpec.f2,20);
  frcp = FirstInRange(RepSpec.f3,20);
  tocp = LastInRange(RepSpec.f3,20);
  SetRepCol(2,35);
  SetRepCol(3,90);
  SetRepCol(4,170);
  SetRepCol(5,250);
  SetRepCol(6,310);
  SetRepCol(7,390);
  
  StartFormat(15);
   OutString(0,0,USetStr(31251),false);
   OutString(2,0,USetStr(31252),false);
   OutString(3,0,USetStr(31253),false);
   OutString(4,0,USetStr(31257),false);
   OutString(5,0,USetStr(31254),false);
   OutString(6,0,USetStr(31255),false);
   OutString(7,0,USetStr(31256),false);
  EndFormat;
  Gray_Divider(0,1);
  found = true;
  ASPSHr.RespPM = RepSpec.FirstAcc;
  while (LoopKey("RespPM",ASPSHr,1,found)) begin
    if (nonblank(RepSpec.FirstAcc)) then begin
      if (ASPSHr.RespPM!=RepSpec.FirstAcc) then begin found = false; end;
    end;
    if (found) then begin
      testf = true;
      if (nonblank(RepSpec.f1)) then begin
        if (ASPSHr.ASProduct<frpr) then begin testf = false; end;
        if (ASPSHr.ASProduct>topr) then begin testf = false; end;
      end;
      if (nonblank(RepSpec.f2)) then begin
        if (ASPSHr.ASStore<frst) then begin testf = false; end;
        if (ASPSHr.ASStore>tost) then begin testf = false; end;
      end;
      if (nonblank(RepSpec.f3)) then begin
        if (ASPSHr.ASCountry<frcp) then begin testf = false; end;
        if (ASPSHr.ASCountry>tocp) then begin testf = false; end;
      end;
      if (DateInRange(ASPSHr.TransDate,RepSpec.sStartDate,RepSpec.sEndDate)==false) then begin
        testf = false;
      end;
      if (testf) then begin
        if (RepSpec.flags[0]==0) then begin
          if (ASPSHr.StoreStatus==kAppStoreProductStoreNotAccepted) then begin
            testf = false;
          end;
        end;
        if (RepSpec.flags[1]==0) then begin
          if (ASPSHr.StoreStatus==kAppStoreProductStoreAccepted) then begin
            testf = false;
          end;
        end;
        if (RepSpec.flags[2]==0) then begin
          if (ASPSHr.StoreStatus==kAppStoreProductStoreForSale) then begin
            testf = false;
          end;
        end;
        if (RepSpec.flags[3]==0) then begin
          if (ASPSHr.StoreStatus==kAppStoreProductStoreNeverSubmit) then begin
            testf = false;
          end;
        end;
        if (RepSpec.flags[10]==0) then begin
          if (ASPSHr.SubmissionStatus==kAppStoreProductSubmissionStatusNone) then begin
            testf = false;
          end;
        end;
        if (RepSpec.flags[11]==0) then begin
          if (ASPSHr.SubmissionStatus==kAppStoreProductSubmissionStatusReview) then begin
            testf = false;
          end;
        end;
      end;
      if (testf) then begin
        ASPr.Code = ASPSHr.ASProduct;
        ReadFirstMain(ASPr,1,true);
        StartFormat(15);
         OutString(0,0,ASPSHr.RespPM,false);
         OutStringID(2,"DblASProductStatusVc",ASPSHr.TransDate,false,ASPSHr.ASProdStatSerNr);
         OutString(3,0,ASPr.Comment,false);
         OutString(4,0,ASPSHr.DateVersion,false);
         OutString(5,0,ASPSHr.ASStore,false);
         OutString(6,0,ASPSHr.ASCountry,false);
         OutString(7,0,StringFromSet(558,ASPSHr.StoreStatus),false);
        EndFormat;
      end;
    end;
  end;
  
  EndJob;
  return
end;