external procedure LogAreaToFile(string,area);remote procedure GetRemoteCloudServerLog(var record RemoteCloudServerVc,string,var area,var Boolean);function LongInt MIN(LongInt a,LongInt b)begin  if (a<b) then begin    MIN = a;  end else begin    MIN = b;  end;end;globalprocedure LoadFileToInspectInArea(string filepath,var area part,var Boolean partialf)begin  LongInt fsz,pos,blocklen;  fsz = FileSize(filepath);  pos = fsz;  blocklen = MIN(pos,200000); // 0.1MB at a time...  pos = pos - blocklen;  if (pos>0) then begin    partialf = true;  end else begin    partialf = false;  end;  LoadFileToArea(filepath,pos,blocklen,part);  return;end;globalprocedure InspectLogInArea(area part,Boolean partialf)begin  LongInt l,lcnt;  string 255 tstr;  Boolean testf;  array string 255 lines;  lcnt = CountLinesInArea(part);  if (partialf==true) then begin lcnt = lcnt - 1; end; // Skip last (potentially incomplete) line  for (l=0;l<lcnt;l=l+1) begin    testf = true;    tstr = Trim(GetLineFromArea(part,l));    if (blank(tstr)) then begin testf = false; end;    if (len(tstr)==1) then begin testf = false; end;    if (testf) then begin      lines[lines.length] = tstr;    end;  end;  for (l=lines.length-1;l>=0;l=l-1) begin    StartFormat(15);    OutString(0,0,lines[l],false);    EndFormat;  end;  return;end;globalprocedure InspectRemoteCloudServerLogRn(record RcVc RepSpec)begin  area part;  record RemoteCloudServerVc RCSr;  Boolean partialf;  RCSr.UUID = StringToUUID(RepSpec.f1);  GetRemoteCloudServerLog(RCSr,RepSpec.f2,part,partialf);  StartReportJob(USetStr(1014) & " " & RepSpec.f2 & " on server " & RCSr.Name);  EndHeader;  InspectLogInArea(part,partialf);  EndJob;  return;end;globalprocedure InspectLocalLogRn(record RcVc RepSpec)begin  area part;  Boolean partialf;  if (blank(RepSpec.f2)) then begin    RepSpec.f2 = "hansa.log";  end;  LoadFileToInspectInArea(RepSpec.f2,part,partialf);  StartReportJob(USetStr(1014) & " " & RepSpec.f2);  EndHeader;  InspectLogInArea(part,partialf);  EndJob;  return;end;