external procedure HTItems(string,var string);
external procedure BuildTheItemArray(array record SMVc,Integer,var array string,var array Integer,var Integer);
external procedure HT2Per(Date,Date,var string);
external procedure PrintForecastNumbers(Date,array record SMVc,var Integer,array string,array Integer,Integer,record RcVc,Boolean,Boolean,Integer,string);
external procedure BuildThePOPlanArray(var array record SMVc,var Integer,Date,Date,string,Boolean,Integer,record RcVc);
external procedure DebugSelection(record RcVc);
external procedure DebugOption(record RcVc);

global
procedure ExpArrivalRn(record RcVc RepSpec)
BEGIN
  array record SMVc aSMr; // Projected Month Close
  string 255 tstr;
  Integer rw;
  Integer asmcnt;
  array string 20 aitems;
  array Integer atype;
  Integer acnt;
  
  StartReportJob(USetStr(16329));
  rw = 1;
  HT2Per(RepSpec.sStartDate,RepSpec.sEndDate,tstr);
  Header(rw,tstr,1);
  rw = rw + 1;
  HTItems(RepSpec.f1,tstr);
  Header(rw,tstr,1);  
  EndHeader;
  SetRepCol(2,55);
  SetRepCol(3,180);
  asmcnt = 0;
  DebugSelection(RepSpec);
  BuildThePOPlanArray(aSMr,asmcnt,RepSpec.sStartDate,RepSpec.sEndDate,RepSpec.f2,false,RepSpec.flags[7],RepSpec);
  BuildTheItemArray(aSMr,asmcnt,aitems,atype,acnt);

  PrintForecastNumbers(RepSpec.sStartDate,aSMr,asmcnt,aitems,atype,acnt,RepSpec,false,false,1,"");
  DebugOption(RepSpec);
  EndJob;
  RETURN;
END;

