global
procedure GuestSugRn(record RcVc RepSpec)
begin
  record JobVc Jobr;
  row JobVc Jobrw;
  record CUVc Profile;
  record ResEventTypersVc ResEventTypers;
  Boolean TrHs,Skip;
  Integer rwcnt,i;
  
  StartReportJob("Huespedes Sugeridos para el Evento" );
  EndHeader;
  
  SetRepCol(2,60);
  
  StartFormat(15);
  OutString(0,0,"Reserva",false);
  OutString(2,0,"Huesped",false);
  EndFormat;
  
  Gray_Divider(0,1);
  TrHs = true;
  ResEventTypers.EventType = RepSpec.f1;
  while (LoopKey("EventType",ResEventTypers,1,TrHs)) begin
    
    Skip = false;
    if (ResEventTypers.EventType<>RepSpec.f1) then begin
      TrHs = false;
    end;
    if (ResEventTypers.TransDate<>RepSpec.d1) then begin
      TrHs = false;
      Skip = true;
    end;
    
    if (not Skip) then begin
      Jobr.SerNr= ResEventTypers.JobNr; // falta que busque en hijos
      if ReadFirstMain(Jobr,1,true) then begin
         
        rwcnt= MatRowCnt(Jobr);
        for(i=0;i<rwcnt;i=i+1) begin
          MatRowGet(Jobr,i,Jobrw);
           
          Profile.Code= Jobrw.GuestCode;
          if ReadFirstMain(Profile,1,true) then begin
            StartFormat(15);      
            OutString(0,"DblJobVc",ResEventTypers.JobNr,false);        
            OutString(2,0,Profile.Name,false);
            EndFormat;
          end;
        end;
      end;
    end;
  end;
  EndJob;
  return;
end;
