global
procedure CloudMachineStatRn(record RcVc RepSpec)
begin
  record CloudMachineStatsVc CMSr;
  Boolean found;
  
  StartReportJob("Cloud Machine Statistics");
  EndHeader;
  SetRepCol(2,30);
  SetRepCol(3,90);
  SetRepCol(4,150);
  SetRepCol(5,300);
  SetRepCol(6,330);
  SetRepCol(7,380);
  SetRepCol(8,420);
  if (blank(RepSpec.f1)) then begin
    StartFormat(15);
     OutString(0,0,"Specify Server Code",false);
    EndFormat;
    goto LCloudMachineStatRn;
  end;

  StartFormat(15);
   OutString(0,0,"Code",false);
   OutString(2,0,"Date",false);
   OutString(3,0,"Time",false);
   OutString(4,0,"HostName",false);
   OutString(5,0,"SampleSeconds",false);
   OutString(6,0,"SystemCPUTime",false);
   OutString(7,0,"UserCPUTime",false);
   OutString(8,0,"ServerDiskFree",false);
   OutString(1,0,"AvgRespTime",true);
  EndFormat;
  Gray_Divider(0,1);
  found = true;
  CMSr.ServerCode = RepSpec.f1;
  CMSr.Date = RepSpec.sStartDate;
  while (LoopKey("MainKey",CMSr,2,found)) begin
    if (CMSr.ServerCode!=RepSpec.f1) then begin found = false; end;
    if (DateInRange(CMSr.Date,RepSpec.sStartDate,RepSpec.sEndDate)==false) then begin
      found = false;
    end;
    if (found) then begin
      StartFormat(15);
       OutString(0,"DblCloudMachineStatsVc",CMSr.ServerCode,false);
       OutString(2,0,CMSr.Date,false);
       OutString(3,0,CMSr.Time,false);
       OutString(4,0,CMSr.HostName,false);
       OutString(5,0,CMSr.SampleSeconds,false);
       OutString(6,0,CMSr.SystemCPUTime,false);
       OutString(7,0,CMSr.UserCPUTime,false);
       OutString(8,0,CMSr.ServerDiskFree,false);
       OutString(1,0,CMSr.AvgRespTime,true);
      EndFormat;
    end;
  end;
LCloudMachineStatRn:;  
  EndJob;
  return;
end;