global
procedure ListCheckinMessRn(record RcVc RepSpec)
begin
  record ResMesVc ResMesr;
  record OBTypeVc OBTyper;
  row ResMesVc ResMesrw;
  Integer i,rwcnt;
 
  StartReportJob(USetStr(10132));
  EndHeader;
  StartFormat(15);
  OutStringID(0,"DblBookRest",USetStr(10141),false,RepSpec.long1);
  EndFormat;
  StartFormat(15);
  EndFormat;
  ResMesr.Code = RepSpec.f2;
  if (ReadFirstMain(ResMesr,1,true)) begin
    StartFormat(15);
    OutString(0,0,ResMesr.Code,false);
    OutString(50,0,ResMesr.Comment,false);
    EndFormat;
    rwcnt = MatRowCnt(ResMesr);
    for (i=0;i<rwcnt;i=i+1) begin
      MatRowGet(ResMesr,i,ResMesrw);
      StartFormat(15);
      OutStringID(50,"DblNewObs",ResMesrw.TextCode,false,RepSpec.f6);
      OBTyper.Code = ResMesrw.TextCode;
      if (ReadFirstMain(OBTyper,1,true)==false) then begin
        OBTyper.Comment = "";
      end;
      OutString(100,0,OBTyper.Comment,false);
      EndFormat;
    end;  
  end;
  EndJob;
  return;
end;
/*
global
procedure ListCheckinMessRn(record RcVc RepSpec)
begin
  record ActVc Act;
  row ActVc Actrw;
  Integer i,rwcnt;
 
  StartReportJob(USetStr(10132));
  EndHeader;
  Act.CUCode = RepSpec.f1;
  while LoopKey("CUCode",Act,1,true) begin
    if (Act.CUCode<>RepSpec.f1) then begin 
      goto LListCheckinMessRn;
    end;
    if ((Act.ActType == RepSpec.f2) and (SetInSet(RepSpec.f3,Act.Resources))) then begin
      if (Act.OKFlag == 0) then begin
        StartFormat(15);
        OutDateID(20,"DblActRec",Act.TransDate,false,Act.SerNr);
        OutString(90,0,Act.StartTime,false);
        OutString(150,0,Act.MainPersons,false);
        OutString(250,0,Act.Comment,false);
        EndFormat;
        rwcnt = MatRowCnt(Act);
        for (i=0;i<rwcnt;i=i+1) begin
          MatRowGet(Act,i,Actrw);
          StartFormat(15);
          OutStringID(50,"DblNewObs",Actrw.TextCode,false,RepSpec.f6);
          OutString(100,0,Actrw.Text,false);
          EndFormat;
        end;
      end;
    end;  
  end;
  
LListCheckinMessRn:;  
  EndJob;
  return;
end;
*/