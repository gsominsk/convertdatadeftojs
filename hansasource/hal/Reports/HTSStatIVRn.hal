/*
proper code is in EInvoiceStatusRn file

function LongInt EInvoiceStatusInfoNotSentDetailed(record RcVc RepSpec,string filename)
begin
  LongInt res,custat;
  record EInvoiceQueVc EIQr;
  Boolean TrHs,testf;
  string 20 dblstr,custcode;
  Integer Media;
  record IVVc IVr;
 
  Media = RepSpec.Media;
  custat = 0;
  res = 0;
  TrHs = true;
  EIQr.FileName = filename;
  EIQr.Status = 0;
  while (LoopKey("FileNameStatus",EIQr,2,TrHs)) begin
    if (EIQr.FileName!=filename) then begin TrHs = false; end;
    if (EIQr.Status!=0) then begin TrHs = false; end;
    if (TrHs) then begin
      testf = true;
      if (DateInRange(EIQr.CreationDate,RepSpec.sStartDate,RepSpec.sEndDate)==false) then begin testf = false; end;
      if (testf) then begin        
        custat = custat + 1;      
        res = res + 1;      
        switch (EIQr.FileName) begin
          case "IVVc": 
            dblstr = "DblIVVc";
            IVr.SerNr = EIQr.RecSerNr;
            if (ReadFirstMain(IVr,1,true)) then begin end;
            custcode = IVr.CustCode;
        end;
        StartFormat(15);
         OutString(15,0,IVr.CustCode,false);
         OutString(85,0,IVr.Addr0,false);
         OutLongInt(230,dblstr,EIQr.RecSerNr,false);
         OutDate(300,0,EIQr.CreationDate,false);
         OutString(380,0,EIQr.Comment,false);
        EndFormat;
      end;
    end;
  end;
  EInvoiceStatusInfoNotSentDetailed = res; 
  return;
end;

function LongInt EInvoiceStatusInfoDetailed(Integer status,record RcVc RepSpec,string filename)
BEGIN
  LongInt res,custat;
  record ERecordStatusVc ERSr;
  Boolean TrHs,testf;
  string 20 lastcustid,dblstr,custcode;
  Boolean percustomerf,newpagepercustf;
  Integer Media;
  record IVVc IVr;
 
  percustomerf = RepSpec.flags[0]!=0;
  newpagepercustf = RepSpec.flags[1]!=0;
  Media = RepSpec.Media;
  custat = 0;
  res = 0;
  TrHs = true;
  ERSr.FileName = filename;
  ERSr.Status = status;
  while (LoopKey("FileNameStatus",ERSr,2,TrHs)) begin
    if (ERSr.FileName!=filename) then begin TrHs = false; end;
    if (ERSr.Status!=status) then begin TrHs = false; end;
    if (TrHs) then begin
      testf = true;
      if (DateInRange(ERSr.CreationDate,RepSpec.sStartDate,RepSpec.sEndDate)==false) then begin testf = false; end;
      if (testf) then begin
        if (percustomerf) then begin
          if (nonblank(lastcustid)) then begin
            if (ERSr.CustID!=lastcustid) then begin
              StartFormat(15);
               OutString(0,0,ERSr.CustID,false);
              EndFormat;
              Gray_Divider(0,1);
              custat = 0;
              if (newpagepercustf) then begin
                if (Media!=mtScreen) then begin
                  NewPage(false);
                end;  
              end;
            end;
          end;
        end;        
        custat = custat + 1;      
        res = res + 1;      
        lastcustid = ERSr.CustID;
        switch (ERSr.FileName) begin
          case "IVVc": 
            dblstr = "DblIVVc";
            IVr.SerNr = ERSr.CustSerNr;
            if (ReadFirstMain(IVr,1,true)) then begin end;
            custcode = IVr.CustCode;
          case "OPVc": dblstr = "DblOPVc";
        end;
        if (blank(custcode)) then begin
          custcode = ERSr.CustID;
        end;
        StartFormat(15);
         OutString(15,0,IVr.CustCode,false);
         OutString(85,0,IVr.Addr0,false);
         OutLongInt(230,dblstr,ERSr.CustSerNr,false);
         OutDate(300,0,ERSr.CreationDate,false);
         OutString(380,0,ERSr.Comment,false);
        EndFormat;
      end;
    end;
  end;
  if (nonblank(lastcustid)) then begin
  if (percustomerf) then begin
    StartFormat(15);
     OutString(15,0,lastcustid,false);
     OutLongInt(200,0,custat,false);
    EndFormat;
    Gray_Divider(0,1);
  end;
  end;  
  EInvoiceStatusInfoDetailed = res; 
  RETURN;
END;

function LongInt EInvoiceStatusInfoNotSentOverview(record RcVc RepSpec,string filename)
begin
  record EInvoiceQueVc EIQr;
  Boolean found,testf;
  LongInt res;
  
  res = 0;
  found = true;
  EIQr.Status = 0;
  EIQr.FileName = filename;
  while (LoopKey("Status",EIQr,2,found)) begin
    if (EIQr.Status!=0) then begin found = false; end;
    if (EIQr.FileName!=filename) then begin found = false; end;
    if (found) then begin
      testf = true;
      if (DateInRange(EIQr.CreationDate,RepSpec.sStartDate,RepSpec.sEndDate)==false) then begin testf = false; end;
      if (testf) then begin
        res = res + 1;      
      end;
    end;
  end;
  EInvoiceStatusInfoNotSentOverview = res;
  return;
end;

function LongInt EInvoiceStatusInfoOverview(Integer status,record RcVc RepSpec,string filename)
BEGIN
  LongInt res,custat;
  record ERecordStatusVc ERSr;
  Boolean TrHs,testf;
  string 20 lastcustid;
  Boolean percustomerf;
 
  percustomerf = RepSpec.flags[0]!=0;
  res = 0;
  custat = 0;
  TrHs = true;
  ERSr.FileName = filename;
  ERSr.Status = status;
  while (LoopKey("FileNameStatus",ERSr,2,TrHs)) begin
    if (ERSr.Status!=status) then begin TrHs = false; end;
    if (ERSr.FileName!=filename) then begin TrHs = false; end;
    if (TrHs) then begin
      testf = true;
      if (DateInRange(ERSr.CreationDate,RepSpec.sStartDate,RepSpec.sEndDate)==false) then begin testf = false; end;
      if (testf) then begin
        if (percustomerf) then begin
          if (nonblank(lastcustid)) then begin
            if (ERSr.CustID!=lastcustid) then begin
              StartFormat(15);
               OutString(15,0,ERSr.CustID,false);
               OutLongInt(200,0,custat,false);
              EndFormat;
              Gray_Divider(0,1);
              custat = 0;
            end;
          end;
        end;
        custat = custat + 1;      
        res = res + 1;      
        lastcustid = ERSr.CustID;
      end;
    end;
  end;
  if (nonblank(lastcustid)) then begin
  if (percustomerf) then begin
    StartFormat(15);
     OutString(15,0,lastcustid,false);
     OutLongInt(200,0,custat,false);
    EndFormat;
    Gray_Divider(0,1);
  end;
  end;
  EInvoiceStatusInfoOverview = res; 
  RETURN;
END;

procedure HTSStatRn(record RcVc RepSpec,string filename,Integer id)
BEGIN
  LongInt senttoelma,accpetedbyelma,rejectedbyelma,receivedbyrecipient,notsent;
  
  StartReportJob(USetStr(id));
  EndHeader;
  
  Gray_Divider(0,1);  
  switch (RepSpec.ArtMode) begin
    case 0:
      if (RepSpec.flags[0]!=0) then begin
        if (RepSpec.flags[10]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15101),false);
          EndFormat;
          senttoelma = EInvoiceStatusInfoOverview(4,RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15104),false);
           OutLongInt(200,0,senttoelma,false);
          EndFormat;
        end;
        if (RepSpec.flags[11]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15102),false);
           EndFormat;
           accpetedbyelma = EInvoiceStatusInfoOverview(1,RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15104),false);
           OutLongInt(200,0,accpetedbyelma,false);
          EndFormat;
        end;
        if (RepSpec.flags[12]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15103),false);
          EndFormat;
          rejectedbyelma = EInvoiceStatusInfoOverview(0,RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15104),false);
           OutLongInt(200,0,rejectedbyelma,false);
          EndFormat;
        end;
        if (RepSpec.flags[13]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15103),false);
          EndFormat;
          receivedbyrecipient = EInvoiceStatusInfoOverview(5,RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15105),false);
           OutLongInt(200,0,receivedbyrecipient,false);
          EndFormat;
        end;
        if (RepSpec.flags[14]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15109),false);
          EndFormat;
          notsent = EInvoiceStatusInfoNotSentOverview(RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15105),false);
           OutLongInt(200,0,notsent,false);
          EndFormat;
        end;
      end else begin
        if (RepSpec.flags[10]!=0) then begin
          senttoelma = EInvoiceStatusInfoOverview(4,RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15101),false);
           OutLongInt(200,0,senttoelma,false);
          EndFormat;
        end;
        if (RepSpec.flags[11]!=0) then begin
          accpetedbyelma = EInvoiceStatusInfoOverview(1,RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15102),false);
           OutLongInt(200,0,accpetedbyelma,false);
          EndFormat;
        end;
        if (RepSpec.flags[12]!=0) then begin
          rejectedbyelma = EInvoiceStatusInfoOverview(0,RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15103),false);
           OutLongInt(200,0,rejectedbyelma,false);
          EndFormat;
        end;
        if (RepSpec.flags[13]!=0) then begin
          receivedbyrecipient = EInvoiceStatusInfoOverview(5,RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15105),false);
           OutLongInt(200,0,receivedbyrecipient,false);
          EndFormat;
        end;
        if (RepSpec.flags[14]!=0) then begin
          notsent = EInvoiceStatusInfoNotSentOverview(RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15109),false);
           OutLongInt(200,0,notsent,false);
          EndFormat;
        end;
      end;
    case 1:
      if (RepSpec.flags[0]!=0) then begin
        
        if (RepSpec.flags[10]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15101),false);
          EndFormat;
          StartFormat(15);
           OutString(30,0,USetStr(15105),false);
           OutString(130,0,USetStr(15106),false);
           OutString(220,0,USetStr(15108),false);
           OutString(280,0,USetStr(15107),false);
          EndFormat;
          Gray_Divider(0,1);
          senttoelma = EInvoiceStatusInfoDetailed(4,RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15104),false);
           OutLongInt(200,0,senttoelma,false);
          EndFormat;
        end;
        if (RepSpec.flags[11]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15102),false);
          EndFormat;
          StartFormat(15);
           OutString(30,0,USetStr(15105),false);
           OutString(130,0,USetStr(15106),false);
           OutString(220,0,USetStr(15108),false);
           OutString(280,0,USetStr(15107),false);
          EndFormat;
          Gray_Divider(0,1);
          accpetedbyelma = EInvoiceStatusInfoDetailed(1,RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15104),false);
           OutLongInt(200,0,accpetedbyelma,false);
          EndFormat;
        end;
        if (RepSpec.flags[12]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15103),false);
          EndFormat;
          StartFormat(15);
           OutString(30,0,USetStr(15105),false);
           OutString(130,0,USetStr(15106),false);
           OutString(220,0,USetStr(15108),false);
           OutString(280,0,USetStr(15107),false);
          EndFormat;
          Gray_Divider(0,1);
          rejectedbyelma = EInvoiceStatusInfoDetailed(0,RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15104),false);
           OutLongInt(200,0,rejectedbyelma,false);
          EndFormat;
        end;
      end else begin
        if (RepSpec.flags[10]!=0) then begin
          StartFormat(15);
           OutString(30,0,USetStr(15105),false);
           OutString(130,0,USetStr(15106),false);
           OutString(220,0,USetStr(15108),false);
           OutString(280,0,USetStr(15107),false);
          EndFormat;
          Gray_Divider(0,1);
          senttoelma = EInvoiceStatusInfoDetailed(4,RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15101),false);
           OutLongInt(200,0,senttoelma,false);
          EndFormat;
        end;
        if (RepSpec.flags[11]!=0) then begin
          StartFormat(15);
           OutString(30,0,USetStr(15105),false);
           OutString(130,0,USetStr(15106),false);
           OutString(220,0,USetStr(15108),false);
           OutString(280,0,USetStr(15107),false);
          EndFormat;
          Gray_Divider(0,1);
          accpetedbyelma = EInvoiceStatusInfoDetailed(1,RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15102),false);
           OutLongInt(200,0,accpetedbyelma,false);
          EndFormat;
        end;
        if (RepSpec.flags[12]!=0) then begin
          StartFormat(15);
           OutString(30,0,USetStr(15105),false);
           OutString(130,0,USetStr(15106),false);
           OutString(220,0,USetStr(15108),false);
           OutString(280,0,USetStr(15107),false);
          EndFormat;
          Gray_Divider(0,1);
          rejectedbyelma = EInvoiceStatusInfoDetailed(0,RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15103),false);
           OutLongInt(200,0,rejectedbyelma,false);
          EndFormat;
        end;
        if (RepSpec.flags[13]!=0) then begin
          receivedbyrecipient = EInvoiceStatusInfoDetailed(5,RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15105),false);
           OutLongInt(200,0,receivedbyrecipient,false);
          EndFormat;
        end;

        if (RepSpec.flags[14]!=0) then begin
          notsent = EInvoiceStatusInfoNotSentDetailed(RepSpec,filename);
          StartFormat(15);
           OutString(0,0,USetStr(15109),false);
           OutLongInt(200,0,notsent,false);
          EndFormat;
        end;

      end;
  end;
  EndJob;
  RETURN;
END;

global
procedure HTSStatIVRn(record RcVc RepSpec)
BEGIN

  HTSStatRn(RepSpec,"IVVc",15100);
  RETURN;
END;

global
procedure HTSStatOPRn(record RcVc RepSpec)
BEGIN

  HTSStatRn(RepSpec,"OPVc",15099);
  RETURN;
END;

*/