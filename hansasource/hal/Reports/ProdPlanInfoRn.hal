global
procedure ProdPlanInfoRn(record RcVc RepSpec)
begin
  record ProdPlanVc PPr;
  record ProdSettingsBlock PSb;
  row ProdPlanVc PPrw;
  Integer i,rwcnt;
  Boolean found;
  LongInt fr,to;
  
  BlockLoad(PSb);
  fr = FirstInRange(RepSpec.f1,10);
  StartReportJob(USetStr(16380));    
  EndHeader;
// there should not be an extra space after StartFormat, don't put it back again...
  StartFormat(15);
  OutString(0,0,USetStr(16381),false);
  OutString(100,0,USetStr(16382),false);
  EndFormat;
  Gray_Divider(0,1);

  PPr.SerNr = fr;
  found = true;
  while (LoopMain(PPr,1,found)) begin
    if (nonblank(RepSpec.f1)) then begin
      if (PPr.SerNr!=fr) then begin found = false; end;
    end;
    if (found) then begin
      rwcnt = MatRowCnt(PPr);
      for (i=0;i<rwcnt;i=i+1) begin
        MatRowGet(PPr,i,PPrw);
        StartFormat(15);
        OutString(0,0,PPrw.ItemCode,false);
        if (PSb.AutoGenProd==0) then begin
          OutLongInt(100,"DblProdVcID",PPrw.ProdOrder,false);
        end else begin
          OutLongInt(100,"DblProdOrderVc",PPrw.ProdOrder,false);
        end;
        EndFormat;
      end;
    end;
  end;
  EndJob;  
  return;
end;