procedure PrintUserWOEmailAddress(record RcVc RepSpec)
begin
  record UserVc Userr;
  Boolean found,testf;

  found = true;
  while (LoopMain(Userr,1,found)) begin
    if (found) then begin
      testf = true;
      if (RepSpec.flags[0]==0) then begin
        if (Userr.Closed!=0) then begin testf = false; end;
      end;
      if (nonblank(Userr.emailAddr)) then begin testf = false; end;
      if (testf) then begin
        StartFormat(15);
         OutString(2,0,Userr.Code,false);
         OutString(3,0,Userr.Name,false);
        EndFormat;
      end;
    end;
  end;
  return;
end;

global
procedure UserWOEmailAddressRn(record RcVc RepSpec)
begin
  record CompaniesBlock Cb;
  row CompaniesBlock Cbrw;
  Integer i,rwcnt;
  Integer oldcomp;

  StartReportJob(USetStr(38080));
  EndHeader;
  if (RepSpec.IncDaughter!=0) then begin
    SetRepCol(2,50);
    SetRepCol(3,130);
  end else begin
    SetRepCol(2,0);
    SetRepCol(3,80);
  end;
  StartFormat(15);
   OutString(2,0,USetStr(38081),false);
   OutString(3,0,USetStr(38082),false);
  EndFormat;
  Gray_Divider(0,1);
  if (RepSpec.IncDaughter!=0) then begin
    oldcomp = CurrentCompany;
    BlockLoad(Cb);

    rwcnt = MatRowCnt(Cb);
    for (i=0;i<rwcnt;i=i+1) begin
      MatRowGet(Cb,i,Cbrw);
      if (SetCompanyCode(Cbrw.CompCode,false)) then begin
        StartFormat(15);
         OutString(0,0,Cbrw.CompCode,false);
         OutString(80,0,Cbrw.CompName,false);
        EndFormat;
        Gray_Divider(0,200);
        PrintUserWOEmailAddress(RepSpec);
        Gray_Divider(0,200);
      end;
    end;
    ResetCompany(oldcomp);
  end else begin
    PrintUserWOEmailAddress(RepSpec);
  end;
  EndJob;
  return;
end;