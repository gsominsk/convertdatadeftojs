global
procedure ShortTermEnabRn(record RcVc RepSpec)
begin  
  Boolean found,testf;
  record CustContModuleVc CCMr;
  record COCUServiceVc COCUSr;
  record CUVc CUr;
  
  StartReportJob("Short Term Enablers");
  EndHeader;

  StartFormat(15);
   OutString(0,0,"Customer",false);
   OutString(50,0,"Name",false);
   OutString(300,0,"Contract",false);
   OutString(400,0,"Enabler Until",false);
  EndFormat;
  Gray_Divider(0,1); 
  
  found = true;
  while (LoopMain(CCMr,1,found)) begin
    if (found) then begin
      testf = true;
      if (nonblank(RepSpec.d1)) then begin
        if (CCMr.NoEnablersOlderThan>RepSpec.d1) then begin testf = false; end;
      end;
      if (blank(CCMr.NoEnablersOlderThan)) then begin testf = false; end;
      if (nonblank(RepSpec.FirstAcc)) then begin
        COCUSr.SerNr = CCMr.ContractNr;
        ReadFirstMain(COCUSr,1,true);
        if (COCUSr.Class!=RepSpec.FirstAcc) then begin testf = false; end;
      end;
      if (testf) then begin
        StartFormat(15);
         OutString(0,0,CCMr.CustCode,false);
         CUr.Code = CCMr.CustCode;
         ReadFIrstMain(CUr,1,true);
         OutString(50,0,CUr.Name,false);
         OutLongInt(300,"DblCOCUServiceVc",CCMr.ContractNr,false);
         OutDate(400,0,CCMr.NoEnablersOlderThan,false);
        EndFormat;
      end;
    end;
  end;
  EndJob;
  return;
end;
