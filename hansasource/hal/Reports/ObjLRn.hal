#ifdef HAL
// where is it(module)
external procedure HTObjS(string, string, var string);

global
procedure ObjLRn(record RcVc RepSpec)
begin

  record ObjVc Objr;
  Boolean TrHs;
  Val i;
  Boolean test;
  String 20 ObjFr,ObjTo;
  String 255 res;
  Integer rw;


  ObjFr = FirstInRange(RepSpec.f1,20);
  ObjTo = LastInRange(RepSpec.f1,20);

  StartReportJob(USetStr(3326));
  HTObjS(ObjFr, ObjTo, res);
  Header(1,res,0);
  EndHeader;
  StartFormat(15);
  OutString(0,0,USetStr(3282),false);
  OutString(60,0,USetStr(4063),false);
  OutString(120,0,USetStr(3324),false);
  EndFormat;
  Gray_Divider(0,1); 
  TrHs = true;
  i = 0;
  Objr.Code = ObjFr;
  while LoopMain(Objr,1,TrHs) begin
      if (nonblank(ObjTo)) then begin
        if (Objr.Code > ObjTo) then begin
          TrHs = false;
        end;
      end;
      test = false;
      if (Objr.OTCode == RepSpec.ObjType) then begin
        test = true;
      end else begin
        if (RepSpec.ObjType == "") then begin
          test = true;
        end;
      end;

      if (test) then begin
        StartFormat(15);
          OutString(0,0,Objr.Code,false);
          OutString(60,0,Objr.Comment,false);
          OutString(120,0,Objr.OTCode,false);
        EndFormat;
        i = i + 1;
      end;
    end;
    Gray_Divider(0,1); 
    OutVal(1,0,i,M4Val,true);
  EndJob;
  return;
end;
#endif
