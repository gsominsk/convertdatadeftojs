external function string 255 FormatLinkForBrowser(string,boolean,string,boolean);

global
procedure WebSiteInfoRn(record RCVc RepSpec)
begin
  record WebNGStructVc WSr;
  Boolean testf;
  string 255 lasturl;
  record VisitedURLVc URLr;
  row VisitedURLVc URLrw;
  Integer i,rwcnt;
  
  StartReportJob(USetStr(40040));
  
  EndHeader;
  
  SetRepCol(3,0);
  SetRepCol(4,150);
  SetRepCol(5,300);
  SetRepCol(6,400);
  
  GetWebSiteData(URLr,RepSpec.long1,RepSpec.f1,RepSpec.f2,RepSpec.f2);

  rwcnt = MatRowCnt(URLr);
  for (i=0;i<rwcnt;i=i+1) begin
    MatRowGet(URLr,i,URLrw);
    if (lasturl!=URLrw.FromURL) then begin
      StartFormat(1);
      Gray_Divider(0,1);
      EndFormat;
      StartFormat(15);
      OutString(3,0,URLrw.FromURL,false);
      OutString(4,0,URLrw.Title,false);
      OutString(5,0,URLrw.KeyWords,false);
      OutString(6,0,URLrw.Description,false);
      EndFormat;
      lasturl = URLrw.FromURL;
    end;
    StartFormat(15);
    OutString(3,"",URLrw.Link,false);
    EndFormat;
  
  end;
  
  EndJob;

  return;
end;

