external function LongInt DateDiff(Date,Date);external procedure ChStateName(Integer,Boolean, var String, Boolean);external procedure HT2Per(Date,Date, var string );globalprocedure HisCheckRn(record RcVc RepSpec)begin  Integer i;  Record CheckVc Chq;  Boolean TsHr;  Val tt;  Val Promedio;  LongInt Dias,sumdias;  Integer p1,p2,p3,p4,p5,p6,p7,p8,p9,pA,pB,p10;  Boolean Skip;  String 30 tstr,AmntOfCheques;  String 100 HdrStr;  Integer HdrLn;// Positions  p1= 0;  p2= 45;  p3= 120;  p4= 180;  p5= 210;  p6= 270;  p7= 330;  p8= 415;  p10= 420;  p9= 480;// Get parameters & Init  tt = 0;   TsHr = true;  i = 0;    sumdias = 0;  StartReportJob(USetStr(8490));   HdrLn = 1;   HT2Per(RepSpec.sStartDate,RepSpec.sEndDate,HdrStr);   Header(HdrLn,HdrStr,1);   if nonblank(RepSpec.f1) then begin     HdrLn = HdrLn + 1;     HdrStr = USetStr(8515) & RepSpec.f1;     Header(HdrLn,HdrStr,1);   end;          if nonblank(RepSpec.vals0) then begin     HdrLn = HdrLn + 1;     HdrStr = USetStr(8516) & RepSpec.vals0;     Header(HdrLn,HdrStr,1);   end;         EndHeader;  StartFormat(15);  OutString(p1,0,"",false);  EndFormat;  StartFormat(15);  OutString(p1,0,USetStr(8491),false);  OutString(p2,0,USetStr(8492),false);  OutString(p3,0,USetStr(8493),false);  OutString(p4,0,USetStr(8494),false);  OutString(p6,0,USetStr(8495),false);  OutString(p7,0,USetStr(8496),false);  OutStringAdjustBiDi(p8,0,USetStr(8497),true,M4Val,p8+50);  OutString(p9,0,USetStr(8498),true);  EndFormat;  Gray_Divider(0,1);  while (LoopKey("SerNr",Chq,1,TsHr)) begin        Skip = false;       If ((Chq.TransDate>RepSpec.sEndDate) or (Chq.TransDate<RepSpec.sStartDate)) then begin         Skip = true;       end;       if ( (not blank(RepSpec.vals0)) and (Chq.Amount < RepSpec.vals0)) then begin                  Skip = true;       end;       if ( (not blank(RepSpec.f1)) and (RepSpec.f1<>Chq.CUCode)) then begin          Skip = true;       end;       if (not Skip) then begin         StartFormat(15);         OutString(p1,0,Chq.SerNr,false);         OutString(p2,0,Chq.CheckNr,false);         OutDate(p3,0,Chq.EmissionDate,false);         OutDate(p4,0,Chq.TransDate,false);         OutDate(p6,0,Chq.EffectDate,false);         OutDate(p7,0,Chq.ClearingDate,false);         OutValBiDi(p8,0,Chq.Amount,M4Val,true,p8+50);         Dias = Datediff(Chq.EffectDate,Chq.TransDate);         OutStringBiDi(p10,0,Chq.CurncyCode,false,p10+8);         OutLongInt(p9,0,Dias,true);         EndFormat;         tt = tt + Chq.Amount;         i = i + 1;         sumdias = sumdias + Dias;     end; end;  // Footer  if (i==0) then begin    Promedio =   0;  end else begin    Promedio = sumdias / i;  end;   Gray_Divider(0,1);  StartFormat(15);  AmntOfCheques = i;  AmntOfCheques = AmntOfCheques & USetStr(8459);  OutString(p1,0,USetStr(8513),false);  OutString(p2,0,AmntOfCheques,false);  OutValBiDi(p8,0,tt,M4Val,true,p8+50);  OutValBiDi(p9,0,Promedio,M4Val,true,p9+50);  EndFormat;  EndJob;  return;end;//  ***********************************// DESC: Own Cheque historyglobalprocedure HisOwnCheckRn(record RcVc RepSpec)begin  Integer i;  Record OwnCheckVc Chq;  Boolean TsHr;  Val tt;  Val Promedio;  LongInt Dias,sumdias;  Integer p1,p2,p3,p4,p5,p6,p7,p8,p9,pA,pB,p10;  Boolean Skip;  String 30 tstr,AmntOfCheques;  String 100 HdrStr;  Integer HdrLn;// Positions  p1= 0;  p2= 35;  p4= 110;  p6= 205;  p7= 300;  p8= 415;  p10= 420;  p9= 480;// Get parameters & Init  tt = 0;  TsHr = true;  i = 0;    sumdias = 0;  StartReportJob(USetStr(8505));   HdrLn = 1;   HT2Per(RepSpec.sStartDate,RepSpec.sEndDate,HdrStr);   Header(HdrLn,HdrStr,1);   if nonblank(RepSpec.f1) then begin     HdrLn = HdrLn + 1;     HdrStr = USetStr(8517) & RepSpec.f1;     Header(HdrLn,HdrStr,1);   end;   if nonblank(RepSpec.vals0) then begin     HdrLn = HdrLn + 1;     HdrStr = USetStr(8516) & RepSpec.vals0;     Header(HdrLn,HdrStr,1);   end;  EndHeader;  StartFormat(15);  OutString(p1,0,"",false);  EndFormat;  StartFormat(15);  OutString(p1,0,USetStr(8506),false);  OutString(p2,0,USetStr(8507),false);  OutString(p4,0,USetStr(8508),false);  OutString(p6,0,USetStr(8509),false);  OutString(p7,0,USetStr(8510),false);  OutStringAdjustBiDi(p8,0,USetStr(8511),true,M4Val,p8+50);  OutString(p9,0,USetStr(8512),true);  EndFormat;  Gray_Divider(0,1);  while (LoopKey("SerNr",Chq,1,TsHr)) begin       Skip = false;       If ((Chq.TransDate>RepSpec.sEndDate) or (Chq.TransDate<RepSpec.sStartDate)) then begin         Skip = true;       end;       if ( (not blank(RepSpec.vals0)) and (Chq.Amount < RepSpec.vals0)) then begin                  Skip = true;       end;       if ( (not blank(RepSpec.f1)) and (RepSpec.f1<>Chq.VECode)) then begin          Skip = true;       end;       if ((RepSpec.FirstAcc <> Chq.OrigAccNr) and (not Blank(repSpec.FirstAcc)))then begin         Skip = true;       end;       if (Chq.Openf==5) or (Chq.Openf==5) then begin         Skip = true;       end;       if (not Skip) then begin         StartFormat(15);         OutString(p1,0,Chq.SerNr,false);         OutString(p2,0,Chq.CheckNr,false);         OutDate(p4,0,Chq.TransDate,false);         OutDate(p6,0,Chq.EffectDate,false);         OutDate(p7,0,Chq.ClearingDate,false);         OutValBiDi(p8,0,Chq.Amount,M4Val,true,p8+50);         if blankdate(Chq.ClearingDate) or blankdate(Chq.TransDate) then begin             Dias = Datediff(Chq.EffectDate,Chq.TransDate);         end else begin             Dias = Datediff(Chq.ClearingDate,Chq.TransDate);         end;         OutStringBiDi(p10,0,Chq.CurncyCode,false,p10+8);         OutLongInt(p9,0,Dias,true);         EndFormat;         tt = tt + Chq.Amount;         i = i + 1;         sumdias = sumdias + Dias;       end;  end;  // Footer  if (i==0) then begin    Promedio =   0;  end else begin    Promedio = sumdias / i;  end;   Gray_Divider(0,1);  StartFormat(15);  AmntOfCheques = i;  AmntOfCheques = AmntOfCheques & USetStr(8459);  OutString(p1,0,USetStr(8513),false);  OutString(p2,0,AmntOfCheques,false);  OutValBiDi(p8,0,tt,M4Val,true,p8+50);  OutValBiDi(p9,0,Promedio,M4Val,true,p9+50);  EndFormat;  EndJob;  return;end;