global
procedure DanTRJRn(record RcVc RepSpec)
begin
// Variabler
  Record DanTRVc DanTr;
  Row DanTRVc DanTrw;
  Boolean foundf;
  Integer i, DanTrwcnt;
  string 5 TypeStr;
  string 20 InvStr;
  LongInt lastnr;
  Longint frtr,totr;

  frtr = FirstInRange(RepSpec.f1,10);
  totr = LastInRange(RepSpec.f1,10);
  StartReportJob(USetStr(17280));
//  Header
  EndHeader;

  SetRepCol(2,70);
  SetRepCol(3,120);
  SetRepCol(4,145);
  SetRepCol(5,180);
  SetRepCol(6,240);
  SetRepCol(7,330);
  SetRepCol(8,390);
  SetRepCol(9,405);
  //SetRepCol(10,445);
    
  foundf=true;
    
  DanTr.Number = frtr;
  while LoopMain(DanTr,1,foundf) begin
    if (nonblank(RepSpec.f1)) then begin
      if (DanTr.Number>totr) then begin foundf = false; end;
    end;
    if (foundf) then begin
      StartFormat(15);
      OutString(0,0,USetStr(17281),false);
      OutString(3,0,DanTr.Number,false);
      EndFormat;
      StartFormat(15);
      OutString(0,0,USetStr(17282),false);
      OutString(3,0,DanTr.TransDate,false);
      if (DanTr.OKFlag==1) then begin
        OutString(7,0,USetStr(17283),false);
      end else begin
        OutString(7,0,USetStr(17284),false);
      end;
      EndFormat;
      StartFormat(15);
      OutString(0,0,"Kommentar",false);  
      OutString(3,0,DanTr.Comment,false);  
      EndFormat;

      StartFormat(15);
      EndFormat;

      StartFormat(15);
      OutString(0,0,USetStr(17285),false);
      OutString(2,0,USetStr(17281),false);
      OutString(3,0,USetStr(17286),false);
      OutString(4,0,USetStr(17287),false);
      OutString(5,0,USetStr(17288),false);
      OutString(6,0,USetStr(17289),false);
      OutString(7,0,USetStr(17290),true);
      OutString(8,0,USetStr(17291),true);
      OutString(9,0,USetStr(17292),false);
      OutString(445,0,USetStr(17293),false);
      EndFormat;
      StartFormat(15);
      OutString(0,0,USetStr(17294),false);
      OutString(6,0,USetStr(17295),false);
      OutString(9,0,USetStr(17296),false);
      OutString(445,0,USetStr(17297),false);
      EndFormat;

      DanTrwcnt=MatRowCnt(DanTr);
      for(i=0;i<DanTrwcnt;i=i+1) begin
        MatRowGet(DanTr,i,DanTrw);
        if (DanTrw.TransNr!=lastnr) then begin
          Gray_divider(0,1);
        end;
        StartFormat(15);
        OutString(0,0,DanTrw.RowTransDate,false);
        OutString(2,0,DanTrw.RefStr,false);
        OutString(3,0,DanTrw.PayMode,false);
        
        if DanTrw.Typ == 0 then begin TypeStr = "M"; end;
        if DanTrw.Typ == 1 then begin TypeStr = "K"; end;
        if DanTrw.Typ == 2 then begin TypeStr = "L"; end;
        OutString(4,0,TypeStr,false);
        
        if DanTrw.InvoiceNr == -1 then begin InvStr = ""; end;
        if DanTrw.InvoiceNr <> -1 then begin InvStr = DanTrw.InvoiceNr; end;
        OutString(5,0,InvStr,false);
        
        OutString(6,0,DanTrw.AccNumber1,false);
        OutString(7,0,DanTrw.DebVal,true);
        OutString(8,0,DanTrw.CredVal,true);
        OutString(9,0,DanTrw.VATCode,false);
        OutString(445,0,DanTrw.CompCode,false);
        EndFormat;
        StartFormat(15);
        OutString(0,0,DanTrw.Text,false);
        OutString(6,0,DanTrw.AccNumber2,false);
//        OutString(8,0,DanTrw.Objects,true);  Fjernet midlertidigt !! CON 
        OutString(9,0,DanTrw.TransNr,false);
        OutString(445,0,DanTrw.RefStr,false);
        EndFormat;
        lastnr = DanTrw.TransNr;
      end;
    end;
    Black_Divider(0,1);
    StartFormat(15);
    EndFormat;
  end;
  EndJob;
  return;
end;  
