external procedure HT2Per(Date, Date , var string);

global
procedure TransactionCountRn(record RcVc RepSpec)
begin
  record QTVc QTr;
  record ORVc ORr;
  record IVVc IVr;
  record IPVc IPr;
  record SHVc SHr;
  record PUVc PUr;
  record RetVc Retr;
  record RetPUVc RetPUr;
  record SDVc SDr;
  record StockMovVc StockMovr;
  record StockTakeVc STr;
  record TRVc TRr;
  record SMVc SMr;
  record POVc POr;
  record IntORVc IntORr;
  record VIVc VIr;
  record OPVc OPr;
  record ProdOrderVc ProdOrderr;
  record ProdVc Prodr;
  record TSVc TSr;
  record PRVc PRr;
  record WayListVc WLr;
  record ExpVc Expr;
  record CLInVc CLInr;
  record CLOutVc CLOutr;
  record IVCashVc IVCashr;
  record CashVc Cashr;
  record MailVc Mailr;
  record ActVc Actr;
  record SVOVc SVOr;
  record WSVc WSr;
  date sdate,edate;
  longint cntall,cntperiod;
  integer i,rwcnt,rw;
  string 255 tstr;
  
  sdate = RepSpec.sStartDate;
  edate = RepSpec.sEndDate;
  
  StartReportJob("Transaction Count");
  HT2Per(RepSpec.sStartDate,RepSpec.sEndDate,tstr);
  Header(rw,tstr,1);
  EndHeader;
  
  StartFormat(15);
  OutString(0,0,"Register",false);
  OutString(200,0,"Count",false);
  OutString(300,0,"Period Count",false);
  EndFormat;
  
  Gray_Divider(0,1);
  
  //QTVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(QTr,1,true) begin
    cntall = cntall + 1;
    if (QTr.QTDate >= sdate) and (QTr.QTDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    StartFormat(15);
    OutString(0,0,"QTVc - Quotations",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;
  end;
  
  

  //ORVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(ORr,1,true) begin
    cntall = cntall + 1;
    if (ORr.OrdDate >= sdate) and (ORr.OrdDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    StartFormat(15);
    OutString(0,0,"ORVc - Sales orders",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;
  end;
  
  
  //IVVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(IVr,1,true) begin
    cntall = cntall + 1;
    if (IVr.TransDate >= sdate) and (IVr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    StartFormat(15);
    OutString(0,0,"IVVc - Invoices",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;
  end;
  
  //IPVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(IPr,1,true) begin
    rwcnt = MatRowCnt(IPr);
    cntall = cntall + rwcnt;
    if (IPr.TransDate >= sdate) and (IPr.TransDate <= edate) then begin
      cntperiod = cntperiod + rwcnt;
    end;
  end;
  if (cntall > 0) then begin
    StartFormat(15);
    OutString(0,0,"IPVc - Received payments",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;    
  end;
  
  //SHVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(SHr,1,true) begin
    cntall = cntall + 1;
    if (SHr.ShipDate >= sdate) and (SHr.ShipDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    StartFormat(15);
    OutString(0,0,"SHVc - Shipments",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;
  
  //PUVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(PUr,1,true) begin
    cntall = cntall + 1;
    if (PUr.TransDate >= sdate) and (PUr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"PUVc - Goods receipt",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //StockMovVc ---------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(StockMovr,1,true) begin
    cntall = cntall + 1;
    if (StockMovr.TransDate >= sdate) and (StockMovr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"StockMovVc - Stock movements",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //RetVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(Retr,1,true) begin
    cntall = cntall + 1;
    if (Retr.TransDate >= sdate) and (Retr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"RetVc - Goods return",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //RetPUVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(RetPUr,1,true) begin
    cntall = cntall + 1;
    if (RetPUr.TransDate >= sdate) and (RetPUr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"RetPUVc - Goods return to the supplier",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //StockTakeVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(STr,1,true) begin
    cntall = cntall + 1;
    if (STr.TransDate >= sdate) and (STr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"StockTakeVc - Stock take",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //SDVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(SDr,1,true) begin
    cntall = cntall + 1;
    if (SDr.TransDate >= sdate) and (SDr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"SDVc - Stock depreciations",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //TRVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(TRr,1,true) begin
    cntall = cntall + 1;
    if (TRr.TransDate >= sdate) and (TRr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"TRVc - NL Transactions",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //SMVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(SMr,1,true) begin
    cntall = cntall + 1;
    if (SMr.TransDate >= sdate) and (SMr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"SMVc - NL Simulations",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //POVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(POr,1,true) begin
    cntall = cntall + 1;
    if (POr.TransDate >= sdate) and (POr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"POVc - Purchase orders",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //IntORVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(IntORr,1,true) begin
    cntall = cntall + 1;
    if (IntORr.TransDate >= sdate) and (IntORr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"IntORVc - Internal orders",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //VIVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(VIr,1,true) begin
    cntall = cntall + 1;
    if (VIr.TransDate >= sdate) and (VIr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"VIVc - Supplier invoice",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //OPVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(OPr,1,true) begin
    rwcnt = MatRowCnt(OPr);
    cntall = cntall + rwcnt;
    if (OPr.TransDate >= sdate) and (OPr.TransDate <= edate) then begin
      cntperiod = cntperiod + rwcnt;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"OPVc - Payments",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //ProdVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(Prodr,1,true) begin
    cntall = cntall + 1;
    if (Prodr.ProdDate >= sdate) and (Prodr.ProdDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"ProdVc - Productions",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //ProdOrderVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(ProdOrderr,1,true) begin
    cntall = cntall + 1;
    if (ProdOrderr.StartDate >= sdate) and (ProdOrderr.StartDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"ProdOrderVc - Production orders",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //TSVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(TSr,1,true) begin
    cntall = cntall + 1;
    if (TSr.RegDate >= sdate) and (TSr.RegDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"TSVc - Time sheets",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //PRVc ---------------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(PRr,1,true) begin
    cntall = cntall + 1;
    if (PRr.StartDate >= sdate) and (PRr.StartDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"PRVc - Projects",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //WayListVc -----------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(WLr,1,true) begin
    cntall = cntall + 1;
    if (WLr.TransDate >= sdate) and (WLr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"WayListVc - Mileages",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //ExpVc -----------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(Expr,1,true) begin
    cntall = cntall + 1;
    if (Expr.TransDate >= sdate) and (Expr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"ExpVc - Expenses",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //CLInVc -----------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(CLInr,1,true) begin
    cntall = cntall + 1;
    if (CLInr.TransDate >= sdate) and (CLInr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"CLInVc - Cash in",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //CLOutVc -----------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(CLOutr,1,true) begin
    cntall = cntall + 1;
    if (CLOutr.TransDate >= sdate) and (CLOutr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"CLOutVc - Cash out",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //IVCashVc -----------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(IVCashr,1,true) begin
    cntall = cntall + 1;
    if (IVCashr.TransDate >= sdate) and (IVCashr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"IVCashVc - POS Invoices",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //CashVc -----------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(Expr,1,true) begin
    cntall = cntall + 1;
    if (Cashr.TransDate >= sdate) and (Cashr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"CashVc - Cash events",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //MailVc -----------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(Mailr,1,true) begin
    cntall = cntall + 1;
    if (Mailr.TransDate >= sdate) and (Mailr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"MailVc - Mail",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //ActVc -----------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(Actr,1,true) begin
    cntall = cntall + 1;
    if (Actr.TransDate >= sdate) and (Actr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"ActVc - Activities",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //SVOVc -----------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(SVOr,1,true) begin
    cntall = cntall + 1;
    if (SVOr.TransDate >= sdate) and (SVOr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    
    StartFormat(15);
    OutString(0,0,"SVOVc - Service orders",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;   
    
  end;

  //WSVc -----------------------------------------------------------
  cntall = 0;
  cntperiod = 0;
  while LoopMain(WSr,1,true) begin
    cntall = cntall + 1;
    if (WSr.TransDate >= sdate) and (WSr.TransDate <= edate) then begin
      cntperiod = cntperiod + 1;
    end;
  end;
  if (cntall > 0) then begin
    StartFormat(15);
    OutString(0,0,"WSVc - Work sheets",false);
    OutString(200,0,cntall,false);
    OutString(300,0,cntperiod,false);
    EndFormat;
    
  end;
  
  EndJob;
  return;
end;
