// A very similar report exists in FollowUpRn.hal (that is from the Report list)
global
procedure JobFollowUpRn(Record RcVc RepSpec)
begin
  Record FollowUpVc FollowUpr;
  Integer rw,i,rwcnt;
  boolean testf, foundf;
  String 255 tstr;
  Date vDate;
  Val mTotal;

  mTotal = 0;
  StartReportJob(USetStr(12440));
  EndHeader;
  StartFormat(15);
  SetRepCol(2,0);
  SetRepCol(3,50);
  SetRepCol(4,110);
  SetRepCol(5,175);
  SetRepCol(6,275);
  SetRepCol(7,480);
  SetRepCol(8,215);
  OutString(2,0,USetStr(12441),false);
  OutString(3,0,USetStr(12443),false);
  OutString(4,0,USetStr(12450),false);
  OutString(5,0,USetStr(12451),false);
  OutString(8,0,USetStr(12447),false);
  OutString(6,0,USetStr(12446),false);
  OutString(7,0,USetStr(12448),true);
  EndFormat;
  Gray_Divider(0,1);
  foundf = true;
  FollowUpr.JobNr = RepSpec.long1;
  while LoopKey("JobNr",FollowUpr,1,foundf) begin
    if (FollowUpr.JobNr <> RepSpec.long1) then begin
      foundf = false;
    end;
    if (foundf) then begin
      StartFormat(15);
      OutLongInt(2,"DblFollowUpVc",FollowUpr.SerNr,false);
      OutString(3,0,DateToString(FollowUpr.TransDate,"DD/MM"),false);
      OutString(4,0,FollowUpr.NReservationStatus,false);
      OutString(5,0,FollowUpr.MainPersons,false);
      if (FollowUpr.OKFlag==1) then begin
        OutString(8,0,"Ã",false);
      end else begin
        OutString(8,0," ",false);
      end;
      OutString(6,0,FollowUpr.Comment,false);
      OutVal(7,0,FollowUpr.Amount,M4Val,true);
      EndFormat;
      mTotal = mTotal + FollowUpr.Amount;
    end;
  end;
  if (mTotal!=0) then begin
    Gray_Divider(0,1);
    StartFormat(15);
    OutString(0,0,USetStr(12449),false);
    OutVal(7,0,mTotal,M4Val,true);
    EndFormat;
  end;
  EndJob;
  return;
end;
