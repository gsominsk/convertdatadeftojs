global
updating procedure DropSHORMn(record RcVc RepSpec)
begin
  record SHVc SHr;
  record SHVc oldSHr;
  
  SHr.SerNr = RepSpec.long1;
  if (ReadFirstMain(SHr,1,true)) then begin
    RecordCopy(oldSHr,SHr);
    SHr.OrderNr = -1;
    if (RecordUpdate(oldSHr,SHr,false)==0) then begin end;
  end;
  return;
end;

global
updating procedure DropRetORMn(record RcVc RepSpec)
begin
  record RetVc Retr;
  record RetVc oldRetr;
  
  Retr.SerNr = RepSpec.long1;
  if (ReadFirstMain(Retr,1,true)) then begin
    RecordCopy(oldRetr,Retr);
    Retr.OrdNr = -1;
    if (RecordUpdate(oldRetr,Retr,false)==0) then begin end;
  end;
  return;
end;

global
procedure ORIntCheckRn(record RcVc RepSpec)
begin
  record SHVc SHr;
  record RetVc Retr;
  record ORVc ORr;
  Boolean foundf;
  Boolean wrongf;

  StartReportJob(USetStr(11500));
  EndHeader;
  SetRepCol(2,90);
  SetRepCol(3,150);
  SetRepCol(4,300);
  if (RepSpec.flags[1]!=0) then begin
    StartFormat(15);
    OutString(0,0,USetStr(2582),false);
    OutString(2,0,USetStr(2585),false);
    OutString(3,0,USetStr(2586),false);
    OutString(1,0,USetStr(2584),true);
    EndFormat;
    Gray_Divider(0,1);
    SHr.SerNr = -1;
    foundf = true;
    while (LoopMain(SHr,1,foundf)) begin
     if (SHr.OrderNr>-1) then begin
        ORr.SerNr = SHr.OrderNr;
        wrongf = false;
        if (ReadFirstMain(ORr,1,true)==false) then begin
          wrongf = true;
        end else begin
          if (ORr.CustCode!=SHr.CustCode) then begin
            wrongf = true;
          end;
        end;
        if (wrongf) then begin
          StartFormat(15);
          OutString(0,"DblSHVc",SHr.SerNr,false);
          OutString(2,0,SHr.CustCode,false);
          OutString(3,0,SHr.Addr0,false);
          OutStringID(4,"DblDropSHToOR",USetStr(11501),false,SHr.SerNr);
          OutString(1,0,SHr.OrderNr,true);
          EndFormat;
        end;
      end;
    end;
    StartFormat(15);
    EndFormat;
    Black_Divider(0,1);
    StartFormat(15);
    EndFormat;
  end;
  if (RepSpec.flags[2]!=0) then begin
    StartFormat(15);
    OutString(0,0,USetStr(10782),false);
    OutString(2,0,USetStr(2585),false);
    OutString(3,0,USetStr(2586),false);
    OutString(1,0,USetStr(2584),true);
    EndFormat;
    Gray_Divider(0,1);
    Retr.SerNr = -1;
    foundf = true;
    while (LoopMain(Retr,1,foundf)) begin
      if (Retr.OrdNr>-1) then begin
        ORr.SerNr = Retr.OrdNr;
        wrongf = false;
        if (ReadFirstMain(ORr,1,true)==false) then begin
          wrongf = true;
        end else begin
          if (ORr.CustCode!=Retr.CustCode) then begin
            wrongf = true;
          end;
        end;
        if (wrongf) then begin
          StartFormat(15);
          OutString(0,"DblRetVc",Retr.SerNr,false);
          OutString(2,0,Retr.CustCode,false);
          OutString(3,0,Retr.CustName,false);
          OutStringID(4,"DblDropRetToOR",USetStr(11501),false,Retr.SerNr);
          OutString(1,0,Retr.OrdNr,true);
          EndFormat;
        end;
      end;
    end;
  end;
  EndJob;
  return;
end;
