global
procedure WOStatRn(record RcVc RepSpec)
begin
  record POVc POr;
  record SVOVc SVOr;
  record SVGMVc SVGMr;
  record WOVc WOr;
  record WSVc WSr;
  row POVc POrw;
  row SVGMVc SVGMrw;
  row WSVc WSrw;
  Boolean TrHs;
  Integer i,rwcnt;
  
  StartReportJob(USetStr(8265));
  EndHeader;
  WOr.SerNr = RepSpec.long1;
  
  if (ReadFirstMain(WOr,1,true)) then begin
    StartFormat(15);
    OutLongInt(50,"DblWOVc",WOr.SerNr,false);
    OutString(150,0,USetStr(8266),false);
    OutLongInt(230,"DblSVOVc",WOr.SVOSerNr,false);
    EndFormat;
    StartFormat(15);
    OutString(50,0,WOr.CustCode,false);
    OutString(150,0,WOr.Addr0,false);
    EndFormat;
    StartFormat(15);
    OutString(50,0,USetStr(8267),false);
    OutDate(100,0,WOr.TransDate,false);
    OutString(200,0,USetStr(8268),false);
    OutDate(300,0,WOr.PlanDate,false);
    OutString(380,0,USetStr(8269),false);
    OutString(440,0,WOr.PlanWork,false);
    EndFormat;
    StartFormat(15);
    OutString(50,0,WOr.EMCode,false);
    OutString(150,0,WOr.EMName,false);
    EndFormat;
    StartFormat(5);
    EndFormat;
    Black_Divider(0,1);
    
    StartFormat(15);
    OutString(0,0,USetStr(8270),false);
    EndFormat;      
    Gray_Divider(0,200);
    StartFormat(15);
    OutString(0,0,USetStr(8271),false);
    OutString(60,0,USetStr(8272),false);
    OutString(130,0,USetStr(8273),false);
    OutString(230,0,USetStr(8274),false);
    OutString(290,0,USetStr(8275),false);
    EndFormat; 
    StartFormat(15);
    OutString(20,0,USetStr(8276),false);
    OutString(80,0,USetStr(8277),false);
    OutString(160,0,USetStr(8278),false);
    EndFormat;      
    Gray_Divider(0,1);
    
    TrHs = true;
    WSr.WONr = WOr.SerNr;
    while (LoopKey("WONr",WSr,1,TrHs)) begin
      if (WSr.WONr<>WOr.SerNr) then begin 
        TrHs = false;
      end;  
      if (TrHs)  then begin
        StartFormat(15);
        OutLongInt(0,"DblWSVc",WSr.SerNr,false);
        OutString(60,0,WSr.EMCode,false);
        OutString(130,0,WSr.EMName,false);
        OutString(230,0,WSr.CustCode,false);
        OutString(290,0,WSr.Addr0,false);
        EndFormat;
        StartFormat(15);
        OutDate(20,0,WSr.TransDate,false);
        OutString(80,0,WSr.Phone,false);
        OutString(160,0,WSr.Fax,false);
        EndFormat;
        
        Gray_Divider(0,300);
        StartFormat(15);
        OutString(0,0,USetStr(8279),false);
        OutString(50,0,USetStr(8280),false);
        OutString(260,0,USetStr(8281),false);
        OutString(350,0,USetStr(8282),false);
        OutString(480,0,USetStr(8283),true);
        EndFormat;      
        Gray_Divider(0,300);
        rwcnt = MatRowCnt(WSr);
        for (i=0;i<rwcnt;i=i +1) begin
          MatRowGet(WSr,i,WSrw);
          StartFormat(15);
          OutString(0,0,WSrw.ArtCode,false);
          OutString(50,0,WSrw.Spec,false);
          OutString(260,0,WSrw.MotherNr,false);
          OutString(350,0,WSrw.SerialNr,false);
          OutVal(480,0,WSrw.Quant,M4Qty,true);
          EndFormat; 
        end;  
        Gray_Divider(0,480);    
        StartFormat(15);
        EndFormat;
      end;
    end;  
    Gray_Divider(0,1);
    StartFormat(15);
    OutString(0,0,USetStr(8284),false);
    EndFormat;      
    Gray_Divider(0,200);
    
    StartFormat(15);
    OutString(0,0,USetStr(8285),false);
    OutString(60,0,USetStr(8286),false);
    OutString(100,0,USetStr(8273),false);
    OutString(300,0,USetStr(8287),false);
    OutString(400,0,USetStr(8288),false);
    EndFormat; 
    StartFormat(15);
    OutString(20,0,USetStr(8289),false);
    OutString(80,0,USetStr(8290),false);
    OutString(160,0,USetStr(8291),false);
    EndFormat;      
    Gray_Divider(0,1);
    
    TrHs = true;
    POr.WONr = WOr.SerNr;
    while (LoopKey("WONr",POr,1,TrHs)) begin
      if (POr.WONr<>WOr.SerNr) then begin 
        TrHs = false;
      end;  
      if (TrHs)  then begin
        StartFormat(15);
        OutLongInt(0,"DblPOVc",POr.SerNr,false);
        OutString(60,0,POr.VECode,false);
        OutString(100,0,POr.Addr0,false);
        OutString(300,0,POr.VEContact,false);
        OutString(400,0,POr.OurContact,false);
        EndFormat;
        StartFormat(15);
        OutDate(20,0,POr.TransDate,false);
        OutString(80,0,POr.PlanShip,false);
        OutString(160,0,POr.Comment,false);
        EndFormat;
        Gray_Divider(0,300);
        StartFormat(15);
        OutString(0,0,USetStr(8279),false);
        OutString(50,0,USetStr(8280),false);
        OutString(260,0,USetStr(8293),false);
        OutString(400,0,USetStr(8283),true);
        OutString(480,0,USetStr(8292),true);
        EndFormat;      
        Gray_Divider(0,300);

        rwcnt = MatRowCnt(POr);
        for (i=0;i<rwcnt;i=i +1) begin
          MatRowGet(POr,i,POrw);
          StartFormat(15);
          OutString(0,0,POrw.ArtCode,false);
          OutString(50,0,POrw.Spec,false);
          OutString(260,0,POrw.VEArtCode,false);
          OutVal(400,0,POrw.Quant,M4Qty,true);
          OutVal(480,0,POrw.Shipd2,M4Qty,true);
          EndFormat; 
        end;  
        Gray_Divider(0,480);    
        StartFormat(15);
        EndFormat;
        
/*        
        found = true;
        PUr.PONr = POr.SerNr;
        ResetLoop(PUr);
        while (LoopKey("WONr",PUr,1,found)) begin
          if (PUr.WONr<>POr.SerNr) then begin 
            found = false;
          end;  
          
        end;   
  */          
      end;
    end;  
    Gray_Divider(0,1);
    StartFormat(15);
    OutString(0,0,USetStr(8157),false);
    EndFormat;      
    Gray_Divider(0,300);
    StartFormat(15);
    OutString(0,0,USetStr(8279),false);
    OutString(80,0,USetStr(8273),false);
    OutString(260,0,USetStr(8282),false);
    OutString(350,0,USetStr(8286),false);
    OutString(480,0,USetStr(8283),true);
    EndFormat;
    Gray_Divider(0,1);
    SVOr.SerNr = WOr.SVOSerNr;
    TrHs = true;
    if (ReadFirstMain(SVOr,1,true)) then begin
      SVGMr.SVONr = SVOr.SerNr;
      while (LoopKey("SVONr",SVGMr,1,TrHs)) begin
         if (SVGMr.SVONr<>SVOr.SerNr) then begin 
           TrHs = false;
         end;  
         if (TrHs) then begin
           rwcnt = MatRowCnt(SVGMr);
           for (i=0;i<rwcnt;i=i +1) begin
             MatRowGet(SVGMr,i,SVGMrw);
             if (SVGMrw.OutQuant<>0) then begin
               StartFormat(15);
               OutString(0,0,SVGMrw.ArtCode,false);
               OutString(80,0,SVGMrw.Spec,false);
               OutString(260,0,SVGMrw.SerialNr,false);
               OutString(350,0,SVGMrw.VECode,false);
               OutVal(480,0,SVGMrw.OutQuant,M4Qty,true);
               EndFormat; 
             end;
           end;  
         end;        
      end;
    end;    
  end;
  
  EndJob
  return;
end;
