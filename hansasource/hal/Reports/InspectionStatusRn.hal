
external function Boolean SetInSet2(string,string);

global procedure InspectionStatusRn(record RcVc RepSpec)
begin
  record QualConVc QualConVr;
  boolean TrHs,testf;
  string 255 tstr;
  val rw, qty;
  
  StartReportJob(USetStr(13115));
  rw = 1;
  if (nonblank(RepSpec.f1)) then begin
    tstr = USetStr(13116) & RepSpec.f1;
    Header(rw,tstr,1);
    rw = rw + 1;
  end;
  EndHeader;
  
  StartFormat(15);
  OutString(0,0,USetStr(13117),false);
  OutString(60,0,USetStr(13118),false);
  OutString(140,0,USetStr(13119),false);
  OutString(300,0,USetStr(13120),false);
  EndFormat;
  Gray_Divider(0,1);  
  TrHs = true;
  QualConVr.OKFlag = 0;
  while LoopKey("AnalyseDone",QualConVr,1,TrHs) begin
    if (TrHs) then begin
      if (QualConVr.OKFlag > 0) then begin
        TrHs = false;  
      end;
    end;
    if (TrHs) then begin
      testf = true;     
      if (nonblank(RepSpec.f1)) then begin
        if ((SetInSet2(RepSpec.f1,QualConVr.TestedBy)) == false) then begin
          testf = false;
        end;
      end;
      if (testf) then begin
        StartFormat(15);
        OutString(0,0,QualConVr.TestedBy,false);
        OutString(60,0,QualConVr.AnalyseDate,false);
        OutString(140,0,QualConVr.ArtCode,false);
        OutString(300,0,QualConVr.SerialNr,false);
        EndFormat;
        qty = qty + 1;
      end;    
  
    end;
  end;
  Gray_Divider(0,1);
  StartFormat(15);
  OutString(0,0,USetStr(13121),false);
  OutVal(80,0,qty,M40Val,false);
  EndJob;
return;
end;