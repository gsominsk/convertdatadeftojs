external function Integer FirstToRow(record MailVc,var string); 

procedure PrintConference(record ConfVc Confr)
begin
  StartFormat(15);
  OutString(0,0,"Conference",false);
  OutStringID(2,"DblConfVc",Confr.AddrName,false,Confr.SerNr);
  OutString(3,0,Confr.Comment,false);
  OutString(4,0,Confr.Identifier,false);
  EndFormat;
  return;
end;

procedure PrintMail(record MailVc Mailr)
begin
  string 200 tstr;
  
  StartFormat(15);
  if (FirstToRow(Mailr,tstr)==0) then begin end;
  OutString(0,0,"Mail",false);
  OutStringID(2,"DblMailVc",tstr,false,Mailr.SerNr);
  OutString(3,0,Mailr.Header,false);
  OutString(4,0,Mailr.Identifier,false);
  EndFormat;
  return;
end;

global
procedure MailIdentRn(record RcVc RepSpec)
begin
  record ConfVc Confr;
  record MailVc Mailr;
  Boolean foundf;

  StartReportJob("Mail Identifiers List");
  EndHeader;
  SetRepCol(2,70);
  SetRepCol(3,220);
  SetRepCol(4,400);
  StartFormat(15);
  OutString(0,0,"Type",false);
  OutString(2,0,"Name/To",false);
  OutString(3,0,"Comment",false);
  OutString(4,0,"Identifier",false);
  EndFormat;
  Gray_Divider(0,1);
  if (blank(RepSpec.f2)) then begin
    Confr.Identifier = RepSpec.f1;
    if (blank(Confr.Identifier)) then begin
      Confr.Identifier = " "; // Low ascii value to find first non blank...
    end;
    foundf = true;
    while (LoopKey("Identifier",Confr,1,foundf)) begin
      if (nonblank(RepSpec.f1)) then begin
        if (Confr.Identifier!=RepSpec.f1) then begin
          foundf = false;
        end;
      end;
      if (foundf) then begin
        if (nonblank(Confr.Identifier)) then begin
          PrintConference(Confr);
        end;
      end;
    end;
    Mailr.Identifier = RepSpec.f1;
    if (blank(Mailr.Identifier)) then begin
      Mailr.Identifier = " "; // Low ascii value to find first non blank...
    end;
    foundf = true;
    while (LoopKey("Identifier",Mailr,1,foundf)) begin
      if (nonblank(RepSpec.f1)) then begin
        if (Mailr.Identifier!=RepSpec.f1) then begin
          foundf = false;
        end;
      end;
      if (foundf) then begin
        if (nonblank(Mailr.Identifier)) then begin
          PrintMail(Mailr);
        end;
      end;
    end;
  end else begin
    
  end;
  EndJob;
  return;
end;

