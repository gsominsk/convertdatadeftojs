


global
procedure ActivityReadHistoryRn(record RCVc RepSpec)
begin
  record ActVc Actr;
  record ActHistVc ActHistr;
  Boolean TrHs;
  Longint tot,cnt;
  
  StartReportJob(UsetStr(38430));
  
  EndHeader;
  
  StartFormat(15);
  OutString(0,0,USetStr(38431),false);
  OutString(60,0,USetStr(38432),false);
  OutString(130,0,"",false);
  OutString(220,0,USetStr(38433),false);
  EndFormat;
  
  tot = 0;cnt = 0;
  TrHs = true;
  Actr.ActType = RepSpec.f1;
  Actr.TransDate = RepSpec.sStartDate;
  while (LoopKey("ActType",Actr,2,TrHs)) begin
    if (Actr.ActType!=RepSpec.f1 or Actr.TransDate>RepSpec.sEndDate) then begin
      TrHs = false;
    end else begin
      StartFormat(15);
      OutString(0,"DblActVc",Actr.SerNr,false);
      OutString(60,"DblCUVc",Actr.CUCode,false);
      OutString(130,0,Actr.CUName,false);
      ActHistr.RecordNr = Actr.SerNr;
      tot = tot + 1;
      if (ReadFirstKey("RecordNr",ActHistr,1,true)) then begin
        OutString(220,0,"Ã",false);
        cnt = cnt + 1;
      end else begin
        OutString(220,0,"-",false);
      end;
      EndFormat;
    end;
  end;
  
  StartFormat(1);
  Gray_Divider(0,1);
  EndFormat;
  
  StartFormat(15);
  OutString(0,0,USetStr(38434),false);
  OutString(60,0,tot,false);
  EndFormat;
  StartFormat(15);
  OutString(0,0,USetStr(38435),false);
  OutString(60,0,cnt,false);
  EndFormat;

  EndJob;

  return;
end;