external procedure PrintEInvoiceStatus(LongInt,string,Integer,Integer);

function LongInt EInvoiceStatusInfoNotSentDetailed(record RcVc RepSpec,string filename)
begin
  LongInt res,custat;
  record EInvoiceQueVc EIQr;
  Boolean TrHs,testf;
  string 20 dblstr,custcode;
  Integer Media;
  record IVVc IVr;
  LongInt friv,toiv;
  Date ivsd,ived;
 
  friv = FirstInRange(RepSpec.f1,11);
  toiv = LastInRange(RepSpec.f1,11);
  ivsd = StringToDate(FirstInRange(RepSpec.Stext,10));
  if (blankdate(ivsd)) then begin ivsd = RepSpec.sStartDate; end;    
  ived = StringToDate(LastInRange(RepSpec.Stext,10));
  if (blankdate(ived)) then begin ived = RepSpec.sEndDate; end;    

  Media = RepSpec.Media;
  custat = 0;
  res = 0;
  TrHs = true;
  EIQr.FileName = filename;
  EIQr.Status = 0;
  while (LoopKey("FileNameStatus",EIQr,2,TrHs)) begin
    if (EIQr.FileName!=filename) then begin TrHs = false; end;
    if (EIQr.Status!=0) then begin TrHs = false; end;
    if (TrHs) then begin
      testf = true;
      if (DateInRange(EIQr.CreationDate,RepSpec.sStartDate,RepSpec.sEndDate)==false) then begin testf = false; end;
      switch (EIQr.FileName) begin
        case "IVVc": 
          IVr.SerNr = EIQr.RecSerNr;
          if (ReadFirstMain(IVr,1,true)) then begin end;
          if (DateInRange(IVr.TransDate,ivsd,ived)==false) then begin testf = false; end;
        case "VEIVVc": 
          IVr.SerNr = EIQr.RecSerNr;
          if (ReadFirstMain(IVr,1,true)) then begin end;
          if (DateInRange(IVr.TransDate,ivsd,ived)==false) then begin testf = false; end;
      end;
      if (nonblank(RepSpec.f1)) then begin
        if (EIQr.RecSerNr<friv) then begin testf = false; end;
        if (EIQr.RecSerNr>toiv) then begin testf = false; end;
      end;
      if (testf) then begin        
        custat = custat + 1;      
        res = res + 1;      
        switch (EIQr.FileName) begin
          case "IVVc": 
            dblstr = "DblIVVc";
            custcode = IVr.CustCode;
          case "VEIVVc": 
            dblstr = "DblIVVc";
            custcode = IVr.CustCode;
        end;
        StartFormat(15);
         OutString(2,0,IVr.CustCode,false);
         OutString(3,0,IVr.Addr0,false);
         OutLongInt(5,dblstr,EIQr.RecSerNr,false);
         OutDate(6,0,EIQr.CreationDate,false);
         OutString(7,0,EIQr.Comment,false);
        EndFormat;
      end;
    end;
  end;
  EInvoiceStatusInfoNotSentDetailed = res; 
  return;
end;

function LongInt EInvoiceStatusInfoDetailed(Integer status,record RcVc RepSpec,string filename)
BEGIN
  LongInt res,custat;
  record ERecordStatusVc ERSr;
  Boolean TrHs,testf;
  string 20 lastcustid,dblstr,custcode;
  Boolean percustomerf,newpagepercustf;
  Integer Media;
  record IVVc IVr;
  record IPVc IPr;
  LongInt friv,toiv;
  Date ivsd,ived;
 
  friv = FirstInRange(RepSpec.f1,11);
  toiv = LastInRange(RepSpec.f1,11);
  ivsd = StringToDate(FirstInRange(RepSpec.Stext,10));
  if (blankdate(ivsd)) then begin ivsd = RepSpec.sStartDate; end;    
  ived = StringToDate(LastInRange(RepSpec.Stext,10));
  if (blankdate(ived)) then begin ived = RepSpec.sEndDate; end;    
  percustomerf = RepSpec.flags[0]!=0;
  newpagepercustf = RepSpec.flags[1]!=0;
  Media = RepSpec.Media;
  custat = 0;
  res = 0;
  TrHs = true;
  ERSr.FileName = filename;
  ERSr.Status = status;
  while (LoopKey("FileNameStatus",ERSr,2,TrHs)) begin
    if (ERSr.FileName!=filename) then begin TrHs = false; end;
    if (ERSr.Status!=status) then begin TrHs = false; end;
    if (TrHs) then begin
      testf = true;
      if (DateInRange(ERSr.CreationDate,RepSpec.sStartDate,RepSpec.sEndDate)==false) then begin testf = false; end;
      if (nonblank(RepSpec.f1)) then begin
        if (StringToLongInt(ERSr.CustSerNr)<friv) then begin testf = false; end;
        if (StringToLongInt(ERSr.CustSerNr)>toiv) then begin testf = false; end;
      end;
      switch (ERSr.FileName) begin
        case "IVVc": 
          IVr.SerNr = StringToLongInt(ERSr.CustSerNr);
          if (ReadFirstMain(IVr,1,true)) then begin end;
          if (DateInRange(IVr.TransDate,ivsd,ived)==false) then begin testf = false; end;
        case "VEIVVc": 
          IVr.SerNr = StringToLongInt(ERSr.CustSerNr);
          if (ReadFirstMain(IVr,1,true)) then begin end;
          if (DateInRange(IVr.TransDate,ivsd,ived)==false) then begin testf = false; end;
        case "IPVc": 
          IPr.SerNr = StringToLongInt(ERSr.CustSerNr);
          if (ReadFirstMain(IPr,1,true)) then begin end;
          if (DateInRange(IPr.TransDate,ivsd,ived)==false) then begin testf = false; end;
      end;
      if (testf) then begin
        if (percustomerf) then begin
          if (nonblank(lastcustid)) then begin
            if (ERSr.CustID!=lastcustid) then begin
              StartFormat(15);
               OutString(0,0,ERSr.CustID,false);
              EndFormat;
              Gray_Divider(0,1);
              custat = 0;
              if (newpagepercustf) then begin
                if (Media!=mtScreen) then begin
                  NewPage(false);
                end;  
              end;
            end;
          end;
        end;        
        custat = custat + 1;      
        res = res + 1;      
        lastcustid = ERSr.CustID;
        switch (ERSr.FileName) begin
          case "IVVc": 
            dblstr = "DblIVVc";
            custcode = IVr.CustCode;
          case "VEIVVc": 
            dblstr = "DblIVVc";
            custcode = IVr.CustCode;
          case "OPVc": 
            dblstr = "DblOPVc";
        end;
        if (blank(custcode)) then begin
          custcode = ERSr.CustID;
        end;
        StartFormat(15);
         OutString(2,0,IVr.CustCode,false);
         OutString(3,0,IVr.Addr0,false);
         OutLongInt(5,dblstr,StringToLongInt(ERSr.CustSerNr),false);
         OutDate(6,0,ERSr.CreationDate,false);
         OutString(7,0,ERSr.Comment,false);
        EndFormat;
      end;
    end;
  end;
  if (nonblank(lastcustid)) then begin
  if (percustomerf) then begin
    StartFormat(15);
     OutString(2,0,lastcustid,false);
     OutLongInt(4,0,custat,true);
    EndFormat;
    Gray_Divider(0,1);
  end;
  end;  
  EInvoiceStatusInfoDetailed = res; 
  RETURN;
END;

function LongInt EInvoiceStatusInfoNotSentOverview(record RcVc RepSpec,string filename)
begin
  record EInvoiceQueVc EIQr;
  Boolean found,testf;
  LongInt res;
  LongInt friv,toiv;
  record IVVc IVr;
  Date ivsd,ived;
 
  friv = FirstInRange(RepSpec.f1,11);
  toiv = LastInRange(RepSpec.f1,11);
  ivsd = StringToDate(FirstInRange(RepSpec.Stext,10));
  if (blankdate(ivsd)) then begin ivsd = RepSpec.sStartDate; end;    
  ived = StringToDate(LastInRange(RepSpec.Stext,10));
  if (blankdate(ived)) then begin ived = RepSpec.sEndDate; end;    
  res = 0;
  found = true;
  EIQr.Status = 0;
  EIQr.FileName = filename;
  while (LoopKey("Status",EIQr,2,found)) begin
    if (EIQr.Status!=0) then begin found = false; end;
    if (EIQr.FileName!=filename) then begin found = false; end;
    if (found) then begin
      testf = true;
      if (DateInRange(EIQr.CreationDate,RepSpec.sStartDate,RepSpec.sEndDate)==false) then begin testf = false; end;
      if (nonblank(RepSpec.f1)) then begin
        if (EIQr.RecSerNr<friv) then begin testf = false; end;
        if (EIQr.RecSerNr>toiv) then begin testf = false; end;
      end;
      switch (EIQr.FileName) begin
        case "IVVc": 
          IVr.SerNr = EIQr.RecSerNr;
          if (ReadFirstMain(IVr,1,true)) then begin end;
          if (DateInRange(IVr.TransDate,ivsd,ived)==false) then begin testf = false; end;
        case "VEIVVc": 
          IVr.SerNr = EIQr.RecSerNr;
          if (ReadFirstMain(IVr,1,true)) then begin end;
          if (DateInRange(IVr.TransDate,ivsd,ived)==false) then begin testf = false; end;
      end;
      if (testf) then begin
        res = res + 1;      
      end;
    end;
  end;
  EInvoiceStatusInfoNotSentOverview = res;
  return;
end;

function LongInt EInvoiceStatusInfoOverview(Integer status,record RcVc RepSpec,string filename)
BEGIN
  LongInt res,custat;
  record ERecordStatusVc ERSr;
  Boolean TrHs,testf;
  string 20 lastcustid;
  Boolean percustomerf;
  LongInt friv,toiv;
  Date ivsd,ived;
  record IVVc IVr;
 
  friv = FirstInRange(RepSpec.f1,11);
  toiv = LastInRange(RepSpec.f1,11);
  ivsd = StringToDate(FirstInRange(RepSpec.Stext,10));
  if (blankdate(ivsd)) then begin ivsd = RepSpec.sStartDate; end;    
  ived = StringToDate(LastInRange(RepSpec.Stext,10));
  if (blankdate(ived)) then begin ived = RepSpec.sEndDate; end;    
  percustomerf = RepSpec.flags[0]!=0;
  res = 0;
  custat = 0;
  TrHs = true;
  ERSr.FileName = filename;
  ERSr.Status = status;
  while (LoopKey("FileNameStatus",ERSr,2,TrHs)) begin
    if (ERSr.Status!=status) then begin TrHs = false; end;
    if (ERSr.FileName!=filename) then begin TrHs = false; end;
    if (TrHs) then begin
      testf = true;
      if (DateInRange(ERSr.CreationDate,RepSpec.sStartDate,RepSpec.sEndDate)==false) then begin testf = false; end;
      if (nonblank(RepSpec.f1)) then begin
        if (StringToLongInt(ERSr.CustSerNr)<friv) then begin testf = false; end;
        if (StringToLongInt(ERSr.CustSerNr)>toiv) then begin testf = false; end;
      end;
      switch (ERSr.FileName) begin
        case "IVVc": 
          IVr.SerNr = StringToLongInt(ERSr.CustSerNr);
          if (ReadFirstMain(IVr,1,true)) then begin end;
          if (DateInRange(IVr.TransDate,ivsd,ived)==false) then begin testf = false; end;
        case "VEIVVc": 
          IVr.SerNr = StringToLongInt(ERSr.CustSerNr);
          if (ReadFirstMain(IVr,1,true)) then begin end;
          if (DateInRange(IVr.TransDate,ivsd,ived)==false) then begin testf = false; end;
      end;
      if (testf) then begin
        if (percustomerf) then begin
          if (nonblank(lastcustid)) then begin
            if (ERSr.CustID!=lastcustid) then begin
              StartFormat(15);
               OutString(2,0,ERSr.CustID,false);
               OutLongInt(4,0,custat,true);
              EndFormat;
              Gray_Divider(0,1);
              custat = 0;
            end;
          end;
        end;
        custat = custat + 1;      
        res = res + 1;      
        lastcustid = ERSr.CustID;
      end;
    end;
  end;
  if (nonblank(lastcustid)) then begin
  if (percustomerf) then begin
    StartFormat(15);
     OutString(2,0,lastcustid,false);
     OutLongInt(4,0,custat,true);
    EndFormat;
    Gray_Divider(0,1);
  end;
  end;
  EInvoiceStatusInfoOverview = res; 
  return;
end;

procedure PrintLatestStatus(record RcVc RepSpec,string afilename)
begin
  record IVVc IVr;
  Boolean found,testf;
  Date ivsd,ived;
  string 255 filename,index;
  Integer status;
  LongInt friv,toiv;
  
  friv = FirstInRange(RepSpec.f1,11);
  toiv = LastInRange(RepSpec.f1,11);
  filename = afilename;  
  ivsd = StringToDate(FirstInRange(RepSpec.Stext,10));
  if (blankdate(ivsd)) then begin ivsd = RepSpec.sStartDate; end;    
  ived = StringToDate(LastInRange(RepSpec.Stext,10));
  if (blankdate(ived)) then begin ived = RepSpec.sEndDate; end;    
  index = "TransDate";
  if (nonblank(RepSpec.f1)) then begin
    index = "SerNr";
  end;
  IVr.TransDate = ivsd;
  IVr.SerNr = friv;
  found = true;
  while (LoopKey(index,IVr,1,found)) begin
    if (nonblank(RepSpec.f1)) then begin
      if (IVr.SerNr<friv) then begin found = false; end;
      if (IVr.SerNr>toiv) then begin found = false; end;
    end else begin
      if (DateInRange(IVr.TransDate,ivsd,ived)==false) then begin found = false; end;
    end;
    if (found) then begin
      testf = true;
      if (nonblank(RepSpec.f1)) then begin
        if (DateInRange(IVr.TransDate,ivsd,ived)==false) then begin testf = false; end;
      end;
      if (testf) then begin
        StartFormat(15);
        OutLongInt(0,"DblIVVc",IVr.SerNr,false);
        PrintEInvoiceStatus(IVr.SerNr,IVr.CustCode,80,200);
        EndFormat;
      end;
    end;
  end;
  return;
end;

procedure HTSStatRn(record RcVc RepSpec,string filename,Integer id)
begin
  LongInt senttoelma,accpetedbyelma,rejectedbyelma,receivedbyrecipient,notsent,failed,txerror;
  
  StartReportJob(USetStr(id));
  EndHeader;
  
  SetRepCol(2,15);
  SetRepCol(3,65);
  SetRepCol(4,120);
  SetRepCol(5,190);
  SetRepCol(6,240);
  SetRepCol(7,290);
  
  Gray_Divider(0,1);  
  switch (RepSpec.ArtMode) begin
    case 0:
      if (RepSpec.flags[0]!=0) then begin
        if (RepSpec.flags[10]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15101),false);
          EndFormat;
          senttoelma = EInvoiceStatusInfoOverview(4,RepSpec,filename);
          senttoelma = senttoelma + EInvoiceStatusInfoOverview(4,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15104),false);
           OutLongInt(4,0,senttoelma,true);
          EndFormat;
        end;
        if (RepSpec.flags[11]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15102),false);
           EndFormat;
           accpetedbyelma = EInvoiceStatusInfoOverview(1,RepSpec,filename);
           accpetedbyelma = accpetedbyelma + EInvoiceStatusInfoOverview(1,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15104),false);
           OutLongInt(4,0,accpetedbyelma,true);
          EndFormat;
        end;
        if (RepSpec.flags[12]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15103),false);
          EndFormat;
          rejectedbyelma = EInvoiceStatusInfoOverview(0,RepSpec,filename);
          rejectedbyelma = rejectedbyelma + EInvoiceStatusInfoOverview(0,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15104),false);
           OutLongInt(4,0,rejectedbyelma,true);
          EndFormat;
        end;
        if (RepSpec.flags[13]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15096),false);
          EndFormat;
          receivedbyrecipient = EInvoiceStatusInfoOverview(5,RepSpec,filename);
          receivedbyrecipient = receivedbyrecipient + EInvoiceStatusInfoOverview(5,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15105),false);
           OutLongInt(4,0,receivedbyrecipient,true);
          EndFormat;
        end;
        if (RepSpec.flags[15]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15096),false);
          EndFormat;
          failed = EInvoiceStatusInfoOverview(6,RepSpec,filename);
          failed = failed + EInvoiceStatusInfoOverview(6,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(17741),false);
           OutLongInt(4,0,failed,true);
          EndFormat;
        end;
        if (RepSpec.flags[14]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15109),false);
          EndFormat;
          notsent = EInvoiceStatusInfoNotSentOverview(RepSpec,filename);
          notsent = notsent + EInvoiceStatusInfoNotSentOverview(RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15105),false);
           OutLongInt(4,0,notsent,true);
          EndFormat;
        end;
        if (RepSpec.flags[16]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15093),false);
          EndFormat;
          txerror = EInvoiceStatusInfoOverview(3,RepSpec,filename);
          txerror = txerror + EInvoiceStatusInfoOverview(3,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15105),false);
           OutLongInt(4,0,txerror,true);
          EndFormat;
        end;
      end else begin
        if (RepSpec.flags[10]!=0) then begin
          senttoelma = EInvoiceStatusInfoOverview(4,RepSpec,filename);
          senttoelma = senttoelma + EInvoiceStatusInfoOverview(4,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15101),false);
           OutLongInt(4,0,senttoelma,true);
          EndFormat;
        end;
        if (RepSpec.flags[11]!=0) then begin
          accpetedbyelma = EInvoiceStatusInfoOverview(1,RepSpec,filename);
          accpetedbyelma = accpetedbyelma + EInvoiceStatusInfoOverview(1,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15102),false);
           OutLongInt(4,0,accpetedbyelma,true);
          EndFormat;
        end;
        if (RepSpec.flags[12]!=0) then begin
          rejectedbyelma = EInvoiceStatusInfoOverview(0,RepSpec,filename);
          rejectedbyelma = rejectedbyelma + EInvoiceStatusInfoOverview(0,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15103),false);
           OutLongInt(4,0,rejectedbyelma,true);
          EndFormat;
        end;
        if (RepSpec.flags[13]!=0) then begin
          receivedbyrecipient = EInvoiceStatusInfoOverview(5,RepSpec,filename);
          receivedbyrecipient = receivedbyrecipient + EInvoiceStatusInfoOverview(5,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15105),false);
           OutLongInt(4,0,receivedbyrecipient,true);
          EndFormat;
        end;
        if (RepSpec.flags[15]!=0) then begin
          failed = EInvoiceStatusInfoOverview(6,RepSpec,filename);
          failed = failed + EInvoiceStatusInfoOverview(6,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(17741),false);
           OutLongInt(4,0,failed,true);
          EndFormat;
        end;
        if (RepSpec.flags[14]!=0) then begin
          notsent = EInvoiceStatusInfoNotSentOverview(RepSpec,filename);
          notsent = notsent + EInvoiceStatusInfoNotSentOverview(RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15109),false);
           OutLongInt(4,0,notsent,true);
          EndFormat;
        end;
        if (RepSpec.flags[16]!=0) then begin
          txerror = EInvoiceStatusInfoOverview(3,RepSpec,filename);
          txerror = failed + EInvoiceStatusInfoOverview(3,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15093),false);
           OutLongInt(4,0,txerror,true);
          EndFormat;
        end;
      end;
    case 1:
      if (RepSpec.flags[0]!=0) then begin
        
        if (RepSpec.flags[10]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15101),false);
          EndFormat;
          StartFormat(15);
           OutString(2,0,USetStr(15105),false);
           OutString(5,0,USetStr(15106),false);
           OutString(6,0,USetStr(15108),false);
           OutString(7,0,USetStr(15107),false);
          EndFormat;
          Gray_Divider(0,1);
          senttoelma = EInvoiceStatusInfoDetailed(4,RepSpec,filename);
          senttoelma = senttoelma + EInvoiceStatusInfoDetailed(4,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15104),false);
           OutLongInt(4,0,senttoelma,true);
          EndFormat;
        end;
        if (RepSpec.flags[11]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15102),false);
          EndFormat;
          StartFormat(15);
           OutString(2,0,USetStr(15105),false);
           OutString(5,0,USetStr(15106),false);
           OutString(6,0,USetStr(15108),false);
           OutString(7,0,USetStr(15107),false);
          EndFormat;
          Gray_Divider(0,1);
          accpetedbyelma = EInvoiceStatusInfoDetailed(1,RepSpec,filename);
          accpetedbyelma = accpetedbyelma + EInvoiceStatusInfoDetailed(1,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15104),false);
           OutLongInt(4,0,accpetedbyelma,true);
          EndFormat;
        end;
        if (RepSpec.flags[12]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15103),false);
          EndFormat;
          StartFormat(15);
           OutString(2,0,USetStr(15105),false);
           OutString(5,0,USetStr(15106),false);
           OutString(6,0,USetStr(15108),false);
           OutString(7,0,USetStr(15107),false);
          EndFormat;
          Gray_Divider(0,1);
          rejectedbyelma = EInvoiceStatusInfoDetailed(0,RepSpec,filename);
          rejectedbyelma = rejectedbyelma + EInvoiceStatusInfoDetailed(0,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15104),false);
           OutLongInt(4,0,rejectedbyelma,true);
          EndFormat;
        end;
        if (RepSpec.flags[16]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15093),false);
          EndFormat;
          StartFormat(15);
           OutString(2,0,USetStr(15105),false);
           OutString(5,0,USetStr(15106),false);
           OutString(6,0,USetStr(15108),false);
           OutString(7,0,USetStr(15107),false);
          EndFormat;
          Gray_Divider(0,1);
          txerror = EInvoiceStatusInfoDetailed(3,RepSpec,filename);
          txerror = txerror + EInvoiceStatusInfoDetailed(3,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15093),false);
           OutLongInt(4,0,txerror,true);
          EndFormat;
        end;
      end else begin
        if (RepSpec.flags[10]!=0) then begin
          StartFormat(15);
           OutString(2,0,USetStr(15105),false);
           OutString(5,0,USetStr(15106),false);
           OutString(6,0,USetStr(15108),false);
           OutString(7,0,USetStr(15107),false);
          EndFormat;
          Gray_Divider(0,1);
          senttoelma = EInvoiceStatusInfoDetailed(4,RepSpec,filename);
          senttoelma = senttoelma + EInvoiceStatusInfoDetailed(4,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15101),false);
           OutLongInt(4,0,senttoelma,true);
          EndFormat;
        end;
        if (RepSpec.flags[11]!=0) then begin
          StartFormat(15);
           OutString(2,0,USetStr(15105),false);
           OutString(5,0,USetStr(15106),false);
           OutString(6,0,USetStr(15108),false);
           OutString(7,0,USetStr(15107),false);
          EndFormat;
          Gray_Divider(0,1);
          accpetedbyelma = EInvoiceStatusInfoDetailed(1,RepSpec,filename);
          accpetedbyelma = accpetedbyelma + EInvoiceStatusInfoDetailed(1,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15102),false);
           OutLongInt(4,0,accpetedbyelma,true);
          EndFormat;
        end;
        if (RepSpec.flags[12]!=0) then begin
          StartFormat(15);
           OutString(2,0,USetStr(15105),false);
           OutString(5,0,USetStr(15106),false);
           OutString(6,0,USetStr(15108),false);
           OutString(7,0,USetStr(15107),false);
          EndFormat;
          Gray_Divider(0,1);
          rejectedbyelma = EInvoiceStatusInfoDetailed(0,RepSpec,filename);
          rejectedbyelma = rejectedbyelma + EInvoiceStatusInfoDetailed(0,RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15103),false);
           OutLongInt(4,0,rejectedbyelma,true);
          EndFormat;
        end;
        if (RepSpec.flags[13]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15096),false);
          EndFormat;
          StartFormat(15);
           OutString(2,0,USetStr(15105),false);
           OutString(5,0,USetStr(15106),false);
           OutString(6,0,USetStr(15108),false);
           OutString(7,0,USetStr(15107),false);
          EndFormat;
          Gray_Divider(0,1);
          receivedbyrecipient = EInvoiceStatusInfoDetailed(5,RepSpec,filename);
          receivedbyrecipient = receivedbyrecipient + EInvoiceStatusInfoDetailed(5,RepSpec,"VEIVVc");
          Gray_Divider(0,1);
          StartFormat(15);
           OutString(0,0,USetStr(15096),false);
           OutLongInt(4,0,receivedbyrecipient,true);
          EndFormat;
        end;
        if (RepSpec.flags[15]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15096),false);
          EndFormat;
          StartFormat(15);
           OutString(2,0,USetStr(15105),false);
           OutString(5,0,USetStr(15106),false);
           OutString(6,0,USetStr(15108),false);
           OutString(7,0,USetStr(15107),false);
          EndFormat;
          Gray_Divider(0,1);
          failed = EInvoiceStatusInfoDetailed(6,RepSpec,filename);
          failed = failed + EInvoiceStatusInfoDetailed(6,RepSpec,"VEIVVc");
          Gray_Divider(0,1);
          StartFormat(15);
           OutString(0,0,USetStr(17741),false);
           OutLongInt(4,0,failed,true);
          EndFormat;
        end;

        if (RepSpec.flags[14]!=0) then begin
          notsent = EInvoiceStatusInfoNotSentDetailed(RepSpec,filename);
          notsent = notsent + EInvoiceStatusInfoNotSentDetailed(RepSpec,"VEIVVc");
          StartFormat(15);
           OutString(0,0,USetStr(15109),false);
           OutLongInt(4,0,notsent,true);
          EndFormat;
        end;
        
        if (RepSpec.flags[16]!=0) then begin
          StartFormat(15);
           OutString(0,0,USetStr(15093),false);
          EndFormat;
          StartFormat(15);
           OutString(2,0,USetStr(15105),false);
           OutString(5,0,USetStr(15106),false);
           OutString(6,0,USetStr(15108),false);
           OutString(7,0,USetStr(15107),false);
          EndFormat;
          Gray_Divider(0,1);
          txerror = EInvoiceStatusInfoDetailed(3,RepSpec,filename);
          txerror = txerror + EInvoiceStatusInfoDetailed(3,RepSpec,"VEIVVc");
          Gray_Divider(0,1);
          StartFormat(15);
           OutString(0,0,USetStr(15093),false);
           OutLongInt(4,0,txerror,true);
          EndFormat;
        end;
      end;
    case 2:
      StartFormat(15);
      OutString(0,0,USetStr(6762),false);
      OutString(80,0,USetStr(7013),false);
      EndFormat;
      Gray_Divider(0,1);
      PrintLatestStatus(RepSpec,filename);
  end;
  EndJob;
  return;
end;

global
procedure HTSStatIVRn(record RcVc RepSpec)
begin
  if (HasLocalization("EST")) then begin
    HTSStatRn(RepSpec,"estIVVc",15100);
  end else begin
    HTSStatRn(RepSpec,"IVVc",15100);
  end;
  return;
end;

global
procedure HTSStatOPRn(record RcVc RepSpec)
begin

  HTSStatRn(RepSpec,"OPVc",15099);
  return;
end;
