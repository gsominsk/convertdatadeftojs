#ifdef HAL
global
procedure TSJRn(record RcVc RepSpec)
BEGIN
  record TSVc TSr;
  row TSVc TSrw;
  Integer i,rwcnt;
  Boolean TrHs,testf;
  LongInt frts,tots;

  frts = FirstInRange(RepSpec.f1,20);
  tots = LastInRange(RepSpec.f1,20);
  
  StartReportJob(USetStr(8870));
  EndHeader;
  TrHs = true;
  TSr.SerNr = frts;
  while (LoopMain(TSr,1,TrHs)) begin
    testf = true;
    if (tots>0) then begin 
      if (TSr.SerNr>tots) then begin
        TrHs = false;
      end;
    end;
    if (TSr.RegDate<RepSpec.sStartDate) then begin testf = false; end;    
    if (TSr.RegDate>RepSpec.sEndDate) then begin testf = false; end;    
    if (TrHs and testf) then begin
      StartFormat(15);
       OutLongInt(0,0,TSr.SerNr,false);
       OutDate(50,0,TSr.RegDate,false);
       OutString(150,0,TSr.Comment,false);
      EndFormat;
      Gray_Divider(20,300);
      rwcnt = MatRowCnt(TSr);      
      for (i=0;i<rwcnt;i=i+1) begin
        MatRowGet(TSr,i,TSrw);
        StartFormat(15);
         OutDateOvst(20,0,TSrw.date,false,TSrw.ovst);
         OutStringOvst(90,0,TSrw.EMCode,false,TSrw.ovst);
         OutStringOvst(140,0,TSrw.PRCode,false,TSrw.ovst);
         OutStringOvst(210,0,TSrw.ArtCode,false,TSrw.ovst);
         OutValOvst(270,0,TSrw.Qty,M4Qty,true,TSrw.ovst);
         OutStringOvst(300,0,TSrw.Spec,false,TSrw.ovst);
        EndFormat;      
      end;
      Gray_Divider(20,300);      
    end;
  end;
  EndJob;
  RETURN;
END;
#endif
