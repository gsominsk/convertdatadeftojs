global
function string 255 GetRegionName(string region)
begin
  record RegionVc Regionr;
  string 255 res;
  
  res = region;
  if (nonblank(region)) then begin
    Regionr.Code = region;
    if (ReadFirstMain(Regionr,1,true)) then begin
      res = Regionr.Name;
    end;
  end;
  GetRegionName = res;
  return;
end;

global
procedure AddToRegionVATCodeJ(string region,val sum,val tax,Array string regiontot,Array val regiontotv,Array val regiontaxv,var Integer regioncnt)
begin
  Integer i;

  for (i=0;i<regioncnt;i=i+1) begin
    if (regiontot[i]==region) then begin
      regiontotv[i] = regiontotv[i] + sum;
      regiontaxv[i] = regiontaxv[i] + tax;
      goto LAddToRegionVATCodeJ;
    end;
  end;
  regiontot[regioncnt] = region;
  regiontotv[regioncnt] = sum;
  regiontaxv[regioncnt] = tax;
  regioncnt = regioncnt + 1;
LAddToRegionVATCodeJ:;  
  return;
end;

global
procedure PrintRegionVATCodeJ(Array string regiontot,Array val regiontotv,Array val regiontaxv,var Integer regioncnt)
begin
  Integer i;

  Gray_Divider(3,1);
  for (i=0;i<regioncnt;i=i+1) begin
		StartFormat(15);
     OutString(3,0,GetRegionName(regiontot[i]),false);
     OutVal(7,0,regiontotv[i],M4Val,true);
     OutVal(1,0,regiontaxv[i],M4Val,true);
		EndFormat;    
  end;
  Gray_Divider(3,1);
  return;
end;
