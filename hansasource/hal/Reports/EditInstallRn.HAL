globalprocedure EditInstallRn(record RcVc RepSpec)begin  record ARInstallVc ARInstallr;  record IVVc IVr;  Boolean foundf,testf,instfoundf;  val totv;  Date lastdate;  totv = 0;  instfoundf = false;  StartReportJob(USetStr(7800));  EndHeader;  SetRepCol(2,80);  SetRepCol(3,160);  SetRepCol(4,280);  SetRepCol(5,380);  SetRepCol(6,40);  SetRepCol(7,320);  SetRepCol(8,400);  IVr.SerNr = RepSpec.long1;  if (ReadFirstMain(IVr,1,true)) then begin    StartFormat(15);    OutLongInt(0,"DblIVVc",IVr.SerNr,false);    OutString(2,0,IVr.CustCode,false);    OutString(3,0,IVr.Addr0,false);    OutString(4,0,IVr.InvDate,false);    OutString(5,0,IVr.PayDate,false);    OutVal(1,0,IVr.Sum4,M4Val,true);    EndFormat;    StartFormat(15);    OutString(6,0,USetStr(7801),false);    OutString(7,0,USetStr(7807),true);    OutString(8,0,USetStr(7805),true);    OutString(1,0,USetStr(7806),true);    EndFormat;        Gray_Divider(0,1);    foundf = true;    ARInstallr.InvoiceNr = IVr.SerNr;    while (LoopMain(ARInstallr,1,foundf)) begin      if (ARInstallr.InvoiceNr!=IVr.SerNr) then begin        foundf = false;      end;      testf = foundf;      If (testf) then begin        totv = totv + ARInstallr.RVal;        StartFormat(15);        OutStringID(6,"DblARInstallVc",ARInstallr.DueDate,false,ARInstallr.InvoiceNr);        OutVal(7,0,ARInstallr.BookRVal,M4Val,true);              OutVal(8,0,ARInstallr.RVal,M4Val,true);              OutVal(1,0,totv,M4Val,true);              EndFormat;        instfoundf = true;        lastdate = ARInstallr.DueDate;      end;    end;    if (instfoundf==false) then begin      StartFormat(15);      OutString(0,0,USetStr(12102),false);      EndFormat;    end;    Gray_Divider(0,1);  end;  if (instfoundf) then begin    StartFormat(15);    OutVal(1,0,totv,M4Val,true);          EndFormat;    StartFormat(15);    OutString(0,"DblRecalculate",USetStr(12103),false);    OutStringID(150,"DblNewARInstallVc",USetStr(12104),false,"" & IVr.SerNr & ":" & lastdate);    EndFormat;  end;  EndJob;  return;end;