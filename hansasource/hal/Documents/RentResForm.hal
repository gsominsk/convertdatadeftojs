global
procedure RentResForm(record RcVc RepSpec)
BEGIN
  record RentResVc RentResr;
  Boolean TrHs,tmpf;
  LongInt afr,ato;
  string 20 keystr;
  
  StartPrintDialogGroup;
  if (blank(RepSpec.f1)) then begin
    goto LRentResForm;
  end;
  afr = FirstInRange(RepSpec.f1,10);
  ato = LastInRange(RepSpec.f1,10);
  if (RepSpec.long1<>-1) then begin
    keystr = "AgreementNr";
  end else begin
    keystr = "SerNr";
  end;
  RentResr.AgreementNr = RepSpec.long1;
  RentResr.SerNr = afr;
  TrHs = true;
  while (LoopKey(keystr,RentResr,1,TrHs)) begin
    if (TrHs) then begin
      if (RepSpec.long1<>-1) then begin
        if (RentResr.AgreementNr<>RepSpec.long1) then begin
          TrHs = false;
        end;
      end else begin
        if (nonblank(RepSpec.f1)) then begin
          if (RentResr.SerNr>ato) then begin
            TrHs = false;
          end;
        end;
      end;
    end;
    if (TrHs) then begin
      tmpf = PrintDocument(RentResr,RepSpec.repname,false);
    end;
  end;
LRentResForm:;
  EndPrintDialogGroup;
  RETURN;
END;

