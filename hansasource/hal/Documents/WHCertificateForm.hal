
global
procedure WHCertificateForm(record RcVc RepSpec)
BEGIN
  Boolean TrHs,testf;
  record WHCertificateVc WHCertificater;
  LongInt afr,ato;
  string 255 frve,tove;
  Boolean tmpf;
  string 255 keystr;
  
  StartPrintDialogGroup;
  afr = FirstInRange(RepSpec.f1,10);
  ato = LastInRange(RepSpec.f1,10);
  frve = FirstInRange(RepSpec.f2,10);
  tove = LastInRange(RepSpec.f2,10);
  keystr = "OPTransDate";
  if (afr!=-1) then begin 
    WHCertificater.OPNr = afr; 
    keystr = "OPNr";
  end else begin 
    WHCertificater.OPTransDate = RepSpec.sStartDate;
  end;
  TrHs = true;
  while (LoopKey(keystr,WHCertificater,1,TrHs)) begin
    if (TrHs) then begin
      if (ato!=-1) then begin
        if (WHCertificater.OPNr>ato) then begin
          TrHs = false;
        end;
      end else begin
        if (DateInRange(WHCertificater.OPTransDate,RepSpec.sStartDate,RepSpec.sEndDate)==false) then begin TrHs = false; end;
      end;
    end;
    if (TrHs) then begin
      testf = true;
      if (nonblank(RepSpec.f2)) then begin
        if (WHCertificater.VECode>frve) then begin testf = false; end;
        if (WHCertificater.VECode<tove) then begin testf = false; end;
      end;
      if (testf) then begin
        tmpf = PrintDocument(WHCertificater,"WHCertificateForm",false);
      end;
    end;
  end;
  EndPrintDialogGroup;
  RETURN;
END;

