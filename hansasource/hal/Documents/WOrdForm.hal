external updating procedure RecordActionWO_Print(var record WOVc,string,Boolean);

global
updating procedure WOrdForm(record RcVc RepSpec)
BEGIN
  record WOVc WOr;
  Boolean TrHs,testf;
  LongInt afr,ato;
  
  StartPrintDialogGroup;
  if ((blank(RepSpec.f1)) and (RepSpec.OnlyUnprntd==0)) then begin
    goto LWOrdForm;
  end;
  afr = FirstInRange(RepSpec.f1,10);
  ato = LastInRange(RepSpec.f1,10);
  WOr.SerNr = afr;
  TrHs = true;
  while (LoopMain(WOr,1,TrHs)) begin
    testf = true;
    if (TrHs) then begin
      if (ato!=-1) then begin
        if (WOr.SerNr>ato) then begin
          TrHs = false;
        end;
      end;     
      if (nonblankdate(RepSpec.d1)) then begin
        if (WOr.TransDate!=RepSpec.d1) then begin
          testf = false;
        end;  
      end;     
    end;
    if (TrHs==false) then begin testf = false; end;
    if (testf) then begin
        if (RepSpec.OnlyUnprntd==0) then begin
          if (WOr.Prntdf==0) then begin
            RecordActionWO_Print(WOr,"",false);
          end;  
        end;
        if (RepSpec.OnlyUnprntd==1) then begin
          RecordActionWO_Print(WOr,"",false);
        end;
    end;
  end;
LWOrdForm:;
  EndPrintDialogGroup;
  RETURN;
END;