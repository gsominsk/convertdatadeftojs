function Boolean ShouldBuild()
begin
  Boolean res;
  
  res = false;
  if ((FIELDINFORM("F_VARMATTOP01")) or
      (FIELDINFORM("F_VARMATTOP02")) or
/* Commented out due to pure speedup, no point in having column 3 and up if you don't have one....
      (FIELDINFORM("F_VARMATTOP03")) or
      (FIELDINFORM("F_VARMATTOP04")) or
      (FIELDINFORM("F_VARMATTOP05")) or
      (FIELDINFORM("F_VARMATTOP06")) or
      (FIELDINFORM("F_VARMATTOP07")) or
      (FIELDINFORM("F_VARMATTOP08")) or
      (FIELDINFORM("F_VARMATTOP09")) or
      (FIELDINFORM("F_VARMATTOP10")) or
      (FIELDINFORM("F_VARMATTOP11")) or
      (FIELDINFORM("F_VARMATTOP12")) or
      (FIELDINFORM("F_VARMATTOP13")) or
      (FIELDINFORM("F_VARMATTOP14")) or
      (FIELDINFORM("F_VARMATTOP15")) or
*/
      (FIELDINFORM("F_VARMATCONT01")) or
      (FIELDINFORM("F_VARMATCONT02")) or
/* Commented out due to pure speedup, no point in having column 3 and up if you don't have one....
      (FIELDINFORM("F_VARMATCONT03")) or
      (FIELDINFORM("F_VARMATCONT04")) or
      (FIELDINFORM("F_VARMATCONT05")) or
      (FIELDINFORM("F_VARMATCONT06")) or
      (FIELDINFORM("F_VARMATCONT07")) or
      (FIELDINFORM("F_VARMATCONT08")) or
      (FIELDINFORM("F_VARMATCONT09")) or
      (FIELDINFORM("F_VARMATCONT10")) or
      (FIELDINFORM("F_VARMATCONT11")) or
      (FIELDINFORM("F_VARMATCONT12")) or
      (FIELDINFORM("F_VARMATCONT13")) or
      (FIELDINFORM("F_VARMATCONT14")) or
      (FIELDINFORM("F_VARMATCONT15")) or
*/
      (FIELDINFORM("F_VARMATROWQTY")) ) then begin
    res = true;
  end;
  ShouldBuild = res;
  return;
end;

global
procedure BuildORVarMatrix(record ORVc ORr,var record VarMatrxEntryVc VMEr)
begin
  row ORVc ORrw;
  Integer i,rwcnt;
  
  
  if (ShouldBuild) then begin
    rwcnt = MatRowCnt(ORr);
    for (i=0;i<rwcnt;i=i+1) begin
      MatRowGet(ORr,i,ORrw);
      
    end;
  end;
  return;
end;

