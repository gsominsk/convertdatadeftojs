global
procedure BatchDepForm(record RcVc RepSpec)
begin
  LongInt frombatchdep,tobatchdep;
  record ChqDepVc BatchDepp;
  Boolean found,tmpf;

  StartPrintDialogGroup;
  frombatchdep = FirstInRange(RepSpec.f1,20);
  tobatchdep = LastInRange(RepSpec.f1,20);
  found = true;
  BatchDepp.SerNr = frombatchdep;
  while (LoopKey("SerNr",BatchDepp,1,found)) begin  
    if (nonblank(RepSpec.f1)) then begin
      if (BatchDepp.SerNr>tobatchdep) then begin
        found = false;
      end;
    end;
    if (found) then begin
      tmpf = PrintDocument(BatchDepp,"BatchDepForm",false);
    end;
  end;
  EndPrintDialogGroup;
  return;
end;