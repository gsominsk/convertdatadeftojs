global
procedure GlobalVIE999(record LangNrVc LangNrr,Integer n,Integer kind,var string res,Integer curgender,string StrOut)
BEGIN
  row LangNrVc LNrw; 
  Integer a,b,c,temp;
  Integer rwcnt;
  string 255 tstr;
  
  a = (n/100)*100;
  b = ((n-a)/10)*10;
  c = (n-a-b);
  rwcnt = MatRowCnt(LangNrr);
  res = "";
  if (a>=100) then begin
    temp = a/100;
    switch(temp) begin
      case 1: 
        tstr = LangNrr.Houn1;
/*
        if ((b==0) and (c==0)) then begin
          if (nonblank(LangNrr.Houn1Single)) then begin
            tstr = LangNrr.Houn1Single;
          end;
        end;
*/
        res = res & tstr;     
      case 2: res = res & LangNrr.Houn2; 
      case 3: res = res & LangNrr.Houn3; 
      case 4: res = res & LangNrr.Houn4; 
      case 5: res = res & LangNrr.Houn5; 
      case 6: res = res & LangNrr.Houn6; 
      case 7: res = res & LangNrr.Houn7; 
      case 8: res = res & LangNrr.Houn8; 
      case 9: res = res & LangNrr.Houn9; 
    end;
  end else begin
    if (nonblank(StrOut) and (b+c)>0) then begin
      res = res & LangNrr.Houn1Single;
    end;
  end;
  temp = b + c;
//StopAlert("a " & a & " b " & b & " c " & c & " temp " & temp);
  if ((temp>=1) and (temp<=99)) then begin
//    if (a>=100) then begin /* We cant solve if it is 20020 it will say Twenty thousand twenty, not Twenty thousand AND twenty */
//StopAlert("StrOut " & StrOut & " temp " & temp & " res " & res & " kind " & kind);
    if (kind!=-1 and temp<=9) then begin
      if (nonblank(res) or nonblank(StrOut))then begin//I think we can solve it this way// or (kind==0) 
        res = res & " ";
        res = res & LangNrr.MainPart;
      end;
    end;
//    end;
    if (kind==-1) then begin
      res = res & " ";
      res = res & LangNrr.DeciPart;
    end;
    if (rwcnt>=temp) then begin
      MatRowGet(LangNrr,temp-1,LNrw);
      if (nonblank(res)) then begin
        res = res & " ";
      end;  
      if (curgender==0) then begin
        res = res & LNrw.ValText;
      end else begin
        res = res & LNrw.ValTextF;
      end;  
    end;
  end else begin
    if (temp==0) and ((Mod(a,100)!=0))  then begin    //or (a==0) is zero needed here ?, for exmple 42000?    
      switch (kind) begin
        case -1:
          if (nonblank(LangNrr.Zero)) then begin
            res = res & " ";
            res = res & LangNrr.DeciPart;
            res = res & " ";
            res = res & LangNrr.Zero;
          end;
        case 0:
          if (nonblank(LangNrr.Zero)) then begin
            res = res & LangNrr.Zero;
          end;
      end;
    end else begin
      switch (kind) begin
        case -1:
          if (nonblank(LangNrr.Zero)) then begin
            res = res & " ";
            res = res & LangNrr.DeciPart;
            res = res & " ";
            res = res & LangNrr.Zero;
          end;
      end;
    end;
  end;
  if (kind==1) then begin
    if (a+b+c==1) then begin
      if (nonblank(res)) then begin
        res = res & " ";
      end;
      res = res & LangNrr.Thou1;
    end else begin
      if ((c>=2) and (c<=4) and (b!=10)) then begin
        if (nonblank(res)) then begin
          res = res & " ";
        end;  
        res = res & LangNrr.Thou4;
      end else begin
        if (a+b+c!=0) then begin
          if (nonblank(res)) then begin
            res = res & " ";
          end;  
          res = res & LangNrr.Thou9;
        end;
      end;
    end;
  end;
  if (kind==2) then begin
    if (a+b+c==1) then begin
      if (nonblank(res)) then begin
        res = res & " ";
      end;  
      res = res & LangNrr.Mill1;
    end else begin
      if ((c>=2) and (c<=4) and (b!=10)) then begin
        if (nonblank(res)) then begin
          res = res & " ";
        end;  
        res = res & LangNrr.Mill4;
      end else begin
        if (a+b+c!=0) then begin
          if (nonblank(res)) then begin
            res = res & " ";
          end;  
          res = res & LangNrr.Mill9;
        end;
      end;
    end;
  end;
  if (kind==3) then begin
    if (a+b+c==1) then begin
      if (nonblank(res)) then begin
        res = res & " ";
      end;  
      res = res & LangNrr.Bill1;
    end else begin
      if ((c>=2) and (c<=4) and (b!=10)) then begin
        if (nonblank(res)) then begin
          res = res & " ";
        end;  
        res = res & LangNrr.Bill4;
      end else begin
        if (a+b+c!=0) then begin
          if (nonblank(res)) then begin
            res = res & " ";
          end;  
          res = res & LangNrr.Bill9;
        end;
      end;
    end;
  end;
  RETURN;
END;