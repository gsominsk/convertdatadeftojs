
procedure PrintVATIV(record RcVc RepSpec)
begin
  record VATIVVc VATIVr;
  Boolean TrHs,testf,tmpf;
  LongInt afr,ato;
  Integer tf;
  
  StartPrintDialogGroup;
  afr = FirstInRange(RepSpec.f1,10);
  ato = LastInRange(RepSpec.f1,10);
  VATIVr.SerNr = afr;
  TrHs = true;
  while (LoopMain(VATIVr,1,TrHs)) begin
    if (TrHs) then begin
      if (ato!=-1) then begin
        if (VATIVr.SerNr>ato) then begin
          TrHs = false;
        end;
      end;
    end;    
    if (TrHs) then begin
      testf = true;
      if (nonblank(RepSpec.Language)) then begin
        if (VATIVr.LangCode!=RepSpec.Language) then begin
          testf = false;
        end;  
      end; 
      tf = 1;
/*       
      tf = RepSpec.flags[1];
      if (VATIVr.InvType==kInvoiceTypeCash) then begin
        tf = RepSpec.flags[2];
      end;
      if (VATIVr.InvType==kInvoiceTypeCredit or VATIVr.InvType==kInvoiceTypeCreditSpecialSales) then begin
        tf = RepSpec.flags[3];
      end;
      if (VATIVr.InvType==kInvoiceTypeInterest) then begin
        tf = RepSpec.flags[4];
      end;
*/      
      if (tf==0) then begin testf = false; end;
      if (testf) then begin  
        tmpf = PrintDocument(VATIVr,"VATIVForm",false);    
      end;  
    end;
  end;
  EndPrintDialogGroup;
  return;
end;

global
procedure VATIVForm(record RcVc RepSpec)
begin
  PrintVATIV(RepSpec);
  return;
end;

procedure PrintVATCIV(record RcVc RepSpec)
begin
  record VATIVVc VATIVr;
  Boolean TrHs,testf,tmpf;
  LongInt afr,ato;
  Integer tf;
  
  afr = FirstInRange(RepSpec.f1,10);
  ato = LastInRange(RepSpec.f1,10);
  VATIVr.SerNr = afr;
  TrHs = true;
  while (LoopMain(VATIVr,1,TrHs)) begin
    if (TrHs) then begin
      if (ato!=-1) then begin
        if (VATIVr.SerNr>ato) then begin
          TrHs = false;
        end;
      end;
    end;    
    if (TrHs) then begin
      testf = true;
      if (nonblank(RepSpec.Language)) then begin
        if (VATIVr.LangCode!=RepSpec.Language) then begin testf = false; end;  
      end; 
      if ((VATIVr.InvType!=kInvoiceTypeCredit and VATIVr.InvType!=kInvoiceTypeCreditSpecialSales) and (VATIVr.InvType!=0)) then begin testf = false; end;
      if (testf) then begin  
        tmpf = PrintDocument(VATIVr,"VATCIVForm",false);    
      end;  
    end;
  end;
  return;
end;

global
procedure VATCIVForm(record RcVc RepSpec)
begin
  PrintVATCIV(RepSpec);
  return;
end;

function Boolean RecordActionPrintVATIV(var record VATIVVc VATIVp,string arg1,string docname,Boolean orgflag)
begin
  Boolean res;
  Boolean previewf;
  Boolean testf;
  
  testf = true;
  if (orgflag) then begin
    VATIVp.Prntdf = 0;
  end;  
  if (nonblank(arg1)) then begin
    if (StringToInt(arg1)!=0) then begin
      previewf = true;
    end;
  end;      
  switch (docname) begin
    case "VATCIVForm":
      if ((VATIVp.InvType!=kInvoiceTypeCredit and VATIVp.InvType!=kInvoiceTypeCreditSpecialSales) and (VATIVp.InvType!=0)) then begin testf = false; end;
  end;
  if (testf) then begin
    if (PrintDocument(VATIVp,docname,previewf)) then begin
      if (VATIVp.Prntdf==0) then begin
        res = true;
      end;  
      VATIVp.Prntdf = 1;
    end;
  end;
  RecordActionPrintVATIV = res;
  return;
end;

global
updating procedure RecordActionVATIV_Print(var record VATIVVc VATIVp,string arg1,string docname,Boolean readf)
begin
  record VATIVVc oldVATIVr;
  
  if (readf) then begin
    if (ReadFirstMain(VATIVp,0,true)) then begin end;  
  end;
  RecordCopy(oldVATIVr,VATIVp);
  if (RecordActionPrintVATIV(VATIVp,arg1,docname,false)) then begin
    if (RecordUpdate(oldVATIVr,VATIVp,false)==0) then begin
    end;
  end;
  return;
end;

