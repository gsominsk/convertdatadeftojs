global
procedure CustSTEn(record RcVc RepSpec)
begin
  record CUVc CUr;
  Boolean TrHs,testf;
  string 255 fromcust,tocust;
  Date i;
  val v;
  
  TrHs = false;  
  ExportString(USetStr(2482));
  ExportString(USetStr(1318));
  NewLine;
  fromcust = FirstInRange(RepSpec.f1,20);
  tocust = LastInRange(RepSpec.f1,20);
  CUr.Code = fromcust;
  TrHs = true;
  while (LoopMain(CUr,1,TrHs)) begin
    if (nonblank(tocust)) then begin
      if (CUr.Code>tocust) then begin
        TrHs = false;
      end;
    end; 
    testf = true;
    if (CUr.CUType==0) then begin testf = false; end;
    if (TrHs) then begin
      v=GetTurnover(CUr,"salesexclvat",RepSpec.sStartDate,RepSpec.sEndDate);
      if (v<>0) then begin
        ExportString(CUr.Code);
        for (i=RepSpec.sStartDate;i<=RepSpec.sEndDate;i=AddMonth(i,1)) begin
          v=GetTurnover(CUr,"salesexclvat",i,i);
          ExportVal(v,M4Val);
        end;
        NewLine;
        UserTrace(CUr.Code,0);
      end;  
    end;
  end;
  return;
end;
