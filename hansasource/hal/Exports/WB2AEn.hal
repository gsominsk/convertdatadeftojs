procedure PrintHeaderWB2A(record RcVc RepSpec)
BEGIN
  record CYBlock CompYear;
  string 255 tstr;
  
  BlockLoad(CompYear);
 
  ExportString(CompYear.CompName);
  ExportString("");
  ExportString("");
  ExportString("");
  ExportString("");
  ExportString("");
  ExportString("");
  ExportString("");
  ExportString("");
  ExportString("");
  ExportString(USetStr(18950));
  NewLine;
  ExportString(USetStr(18951));
  NewLine;
  ExportString(USetStr(18952));
  NewLine;
  NewLine;
   ExportString(USetStr(18953));
   ExportString("");
   ExportString(USetStr(18954));
   ExportString(USetStr(18955));
   ExportString(USetStr(18956));
   ExportString(USetStr(18957));
   ExportString(USetStr(18958));
   ExportString("");
   ExportString(USetStr(18959));
   ExportString("");
   ExportString(USetStr(18960));
   NewLine;
   ExportString("");
   ExportString("");
   ExportString(USetStr(18961));
   ExportString(USetStr(18961));
   ExportString(USetStr(18961));
   ExportString("");
   ExportString(USetStr(18962));
   ExportString("");
   ExportString(USetStr(18962));
   ExportString("");
   NewLine    
   ExportString(USetStr(18963));
   ExportString(USetStr(18964));
   ExportString(USetStr(18965));
   ExportString("");
   ExportString("");
   ExportString("");
   ExportString(USetStr(18966));
   ExportString(USetStr(18967));
   ExportString(USetStr(18966));
   ExportString(USetStr(18967));
   NewLine    
   RETURN;
END;

global
procedure WB2AEn(record RcVc RepSpec)
BEGIN
  record POCQStatVc POCQr;
  record VEVc VEr;
  boolean testf, TrHs;
  String 255 ostr;
  Integer i,pos;
  LongInt frsh,tosh;
  frsh = FirstInRange(RepSpec.f1,10);
  tosh = LastInRange(RepSpec.f1,10);

  PrintHeaderWB2A(RepSpec);
  i = 0;
  TrHs = true;
  POCQr.SerNr = frsh;
  
  while (LoopMain(POCQr,1,TrHs)) begin
   testf = true;
   if (TrHs) then begin
   if (tosh<>-1) then begin
     if (POCQr.SerNr > tosh) then begin 
        TrHs = false;
     end;
   end;
   if (nonblank(RepSpec.f2)) then begin
     if (RepSpec.f2<>POCQr.VECode) then begin 
        testf = false;
      end;
   end;
  /*    if (RepSpec.flags[1] == 0) then begin
        if (POCQr.OKFlag<>0) then begin
          testf = false;
        end;
      end;
      if (RepSpec.flags[2] == 0) then begin
        if (POCQr.Closed<>0) then begin
          testf = false;
        end;
      end;
  */
      if (testf) then begin
        ExportString(POCQr.SerNr);  //Serial Number
        ExportString(POCQr.Comment);  // Description
        ExportString("");  // Actual Progress (no data in Hansa 3.6)
        ExportString(""); // Actual Cost
        ExportString("");  // Variance
        ExportString("");   //Variance
        ExportString("");  //Revised Cost
        ExportDate(POCQr.ContrEndPl);  // Revised Completion Date
        ExportVal(POCQr.Sum,M4Val);
        ExportString(POCQr.ContrEndAct);  //Revised Completion Date
        ExportString(POCQr.CurncyCode); //Currency
        NewLine;
      end; //end testf    
     end; //TrHs;
    end; //while
  EndJob;
  RETURN;
END;

#endif 
