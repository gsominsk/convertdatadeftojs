// CustAdrEn.hal
global
procedure CustAdrEn(record RcVc RepSpec)
begin
  record CUVc CUr;
  Boolean TrHs,testf;
  String 20 fromcust,tocust;

  fromcust = FirstInRange(RepSpec.f1,20);
  tocust = LastInRange(RepSpec.f1,20);
  CUr.Code = fromcust;
  TrHs = true;
  while (LoopMain(CUr,1,TrHs)) begin
    if (nonblank(tocust)) then begin
      if (CUr.Code>tocust) then begin
        TrHs = false;
      end;
    end;
    testf = true;
    if (CUr.CUType==0) then begin testf = false; end;
    if (TrHs and testf) then begin
      if ((RepSpec.f3 == "") or (RepSpec.f3 == CUr.CustCat)) then begin
        ExportString(CUr.Code);
        ExportString(CUr.CustCat);
        ExportString(CUr.Name);
        ExportString(CUr.Person);
        ExportString(CUr.InvAddr0);
        ExportString(CUr.InvAddr1);
        ExportString(CUr.InvAddr2);
        ExportString(CUr.Phone);
        ExportString(CUr.Fax);
        ExportString(CUr.Comment);
        ExportString(CUr.SalesMan);
        NewLine;
        UserTrace(CUr.Code,0);
      end;
    end;
  end;
  NewLine;
  return;
end;
