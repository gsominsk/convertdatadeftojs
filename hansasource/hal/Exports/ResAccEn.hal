
global
procedure ExTabRowsEn(record RcVc RepSpec)
begin
  Record RestAccVc Tabr;
  Row RestAccVc Tabrw;
  Boolean found,Skip;
  Integer rwcnt,i;


  ExportString(USetStr(11190));
  ExportString(USetStr(11191));
  ExportString(USetStr(11192));
  ExportString(USetStr(11193));
  ExportString(USetStr(11194));
  ExportString(USetStr(11195));
  ExportString(USetStr(11196));
  ExportString(USetStr(11197));
  ExportString(USetStr(11198));
  ExportString(USetStr(11199));
  ExportString(USetStr(11200));
  ExportString(USetStr(11201));
  ExportString(USetStr(11202));
  ExportString(USetStr(11203));
  NewLine;

  found = true;
  Tabr.TransDate = RepSpec.sStartDate;
  while (LoopKey("TransDate",Tabr,1,found)) begin
	if (Tabr.TransDate>RepSpec.sEndDate) then begin
	  found = false;
	end;
	if (found) then begin
      rwcnt = MatRowCnt(Tabr);
      for (i = 0 ; i<rwcnt ;i=i+1) begin
        MatRowGet(Tabr,i,Tabrw);
        Skip = false;
        If ((Tabr.TransDate>RepSpec.sEndDate) or (Tabr.TransDate<RepSpec.sStartDate)) then begin
          Skip = true;
        end;
        if (Tabrw.stp!=1) then begin 
          Skip = true;    
        end; 
        if (false) then begin
          Skip = true;    
        end;             
        if (not Skip) then begin    
  	      ExportString(Tabr.SerNr);
  	      ExportString(Tabr.TransDate);
  	      ExportString(Tabr.Waiter2);
  	      ExportString(Tabr.Cashier);
  	      ExportString(Tabr.MachineName);
  	      ExportString(Tabr.Resource);
  	      ExportString(Tabr.CUCode);
  	      ExportString(Tabr.GuestCode);
  	      ExportString(Tabr.PayDeal);
  	      ExportString(Tabrw.ArtCode);
  	      ExportString(Tabrw.Spec);
  	      ExportVal(Tabrw.Quant,M4Qty);
  	      ExportVal(Tabrw.Price,M4Val);
          Usertrace(Tabr.SerNr,0);
          NewLine;
        end;
      end;  
	end;
  end; 
  return;
end;


