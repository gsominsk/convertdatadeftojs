external function Boolean CanRegisterOnMedia(string,Integer);
external procedure ExpBackupString(string);

procedure ExportCheckVc(LongInt afr,LongInt ato)
begin
  record CheckVc Checkr;
  Boolean TrHs,first;
  
  TrHs = true;
  Checkr.SerNr = afr;
  first = true;
  while (LoopMain(Checkr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (Checkr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("CheckVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(Checkr);
      NewLine;
      UserTrace(Checkr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  return;
end;

procedure ExportOwnCheckVc(LongInt afr,LongInt ato)
begin
  record OwnCheckVc OwnCheckr;
  Boolean TrHs,first;
  
  TrHs = true;
  OwnCheckr.SerNr = afr;
  first = true;
  while (LoopMain(OwnCheckr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (OwnCheckr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("OwnCheckVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(OwnCheckr);
      NewLine;
      UserTrace(OwnCheckr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  return;
end;

procedure ExportDropSHVc(LongInt afr,LongInt ato)
begin
  record DropSHVc DropSHr;
  Boolean TrHs,first;
  
  TrHs = true;
  DropSHr.SerNr = afr;
  first = true;
  while (LoopMain(DropSHr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (DropSHr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("DropSHVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(DropSHr);
      NewLine;
      UserTrace(DropSHr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  return;
end;

procedure ExportCOVc(LongInt afr,LongInt ato)
BEGIN
  record COVc COr;
  Boolean TrHs,first;
  
  TrHs = true;
  COr.SerNr = afr;
  first = true;
  while (LoopMain(COr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (COr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("COVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(COr);
      NewLine;
      UserTrace(COr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportExpVc(LongInt afr,LongInt ato)
BEGIN
  record ExpVc Expr;
  Boolean TrHs,first;
  
  TrHs = true;
  Expr.SerNr = afr;
  first = true;  
  while (LoopMain(Expr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (Expr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("ExpVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(Expr);
      NewLine;
      UserTrace(Expr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportPUVc(LongInt afr,LongInt ato)
BEGIN
  record PUVc PUr;
  Boolean TrHs,first;
  
  TrHs = true;
  PUr.SerNr = afr;
  first = true;
  while (LoopMain(PUr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (PUr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("PUVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(PUr);
      NewLine;
      UserTrace(PUr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportIVVc(LongInt afr,LongInt ato)
BEGIN
  record IVVc IVr;
  Boolean TrHs,first;
  
  TrHs = true;
  first = true;
  IVr.SerNr = afr;
  while (LoopMain(IVr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (IVr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("IVVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(IVr);
      NewLine;
      UserTrace(IVr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportOPVc(LongInt afr,LongInt ato)
BEGIN
  record OPVc OPr;
  Boolean TrHs,first;
  
  TrHs = CanRegisterOnMedia("OPVc",mtFile);
  OPr.SerNr = afr;
  first = true;
  while (LoopMain(OPr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (OPr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("OPVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(OPr);
      NewLine;
      UserTrace(OPr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportPPVc(LongInt afr,LongInt ato)
BEGIN
  record PPVc PPr;
  Boolean TrHs,first;
  
  TrHs = CanRegisterOnMedia("PPVc",mtFile);
  PPr.SerNr = afr;
  first = true;
  while (LoopMain(PPr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (PPr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("PPVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(PPr);
      NewLine;
      UserTrace(PPr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportProdVc(LongInt afr,LongInt ato)
BEGIN
  record ProdVc Prodr;
  Boolean TrHs,first;
  
  TrHs = true;
  Prodr.SerNr = afr;
  first = true;
  while (LoopMain(Prodr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (Prodr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("ProdVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(Prodr);
      NewLine;
      UserTrace(Prodr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportVIVc(LongInt afr,LongInt ato)
BEGIN
  record VIVc VIr;
  Boolean TrHs,first;
  
  TrHs = true;
  VIr.SerNr = afr;
  first = true;
  while (LoopMain(VIr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (VIr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("VIVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(VIr);
      NewLine;
      UserTrace(VIr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportPOVc(LongInt afr,LongInt ato)
BEGIN
  record POVc POr;
  Boolean TrHs,first;
  
  TrHs = true;
  POr.SerNr = afr;
  first = true;
  while (LoopMain(POr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (POr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("POVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(POr);
      NewLine;
      UserTrace(POr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportPOQTVc(LongInt afr,LongInt ato)
BEGIN
  record POQTVc POQTr;
  Boolean TrHs,first;
  
  TrHs = true;
  POQTr.SerNr = afr;
  first = true;
  while (LoopMain(POQTr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (POQTr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("POQTVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(POQTr);
      NewLine;
      UserTrace(POQTr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportIVCashVc(LongInt afr,LongInt ato)
BEGIN
  record IVCashVc IVCashr;
  Boolean TrHs,first;
  
  TrHs = true;
  IVCashr.SerNr = afr;
  first = true;
  while (LoopMain(IVCashr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (IVCashr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("IVCashVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(IVCashr);
      NewLine;
      UserTrace(IVCashr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportQTVc(LongInt afr,LongInt ato)
BEGIN
  record QTVc QTr;
  Boolean TrHs,first;
  
  TrHs = true;
  QTr.SerNr = afr;
  first = true;
  while (LoopMain(QTr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (QTr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("QTVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(QTr);
      NewLine;
      UserTrace(QTr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportIPVc(LongInt afr,LongInt ato)
BEGIN
  record IPVc IPr;
  Boolean TrHs,first;
  
  TrHs = true;
  IPr.SerNr = afr;
  first = true;
  while (LoopMain(IPr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (IPr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("IPVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(IPr);
      NewLine;
      UserTrace(IPr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportIntORVc(LongInt afr,LongInt ato)
BEGIN
  record IntORVc IntORr;
  Boolean TrHs,first;
  
  TrHs = true;
  IntORr.SerNr = afr;
  first = true;
  while (LoopMain(IntORr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (IntORr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("IntORVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(IntORr);
      NewLine;
      UserTrace(IntORr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportORVc(LongInt afr,LongInt ato)
BEGIN
  record ORVc ORr;
  Boolean TrHs,first;
  
  TrHs = true;
  ORr.SerNr = afr;
  first = true;
  while (LoopMain(ORr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (ORr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("ORVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(ORr);
      NewLine;
      UserTrace(ORr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportSHVc(LongInt afr,LongInt ato)
BEGIN
  record SHVc SHr;
  Boolean TrHs,first;
  
  TrHs = true;
  SHr.SerNr = afr;
  first = true;
  while (LoopMain(SHr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (SHr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("SHVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(SHr);
      NewLine;
      UserTrace(SHr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportSMVc(LongInt afr,LongInt ato)
BEGIN
  record SMVc SMr;
  Boolean TrHs,first;
  
  TrHs = true;
  SMr.SerNr = afr;
  first = true;
  while (LoopMain(SMr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (SMr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("SMVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(SMr);
      NewLine;
      UserTrace(SMr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportStockMovVc(LongInt afr,LongInt ato)
BEGIN
  record StockMovVc StockMovr;
  Boolean TrHs,first;
  
  TrHs = true;
  StockMovr.SerNr = afr;
  first = true;
  while (LoopMain(StockMovr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (StockMovr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("StockMovVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(StockMovr);
      NewLine;
      UserTrace(StockMovr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportTSVc(LongInt afr,LongInt ato)
BEGIN
  record TSVc TSr;
  Boolean TrHs,first;
  
  TrHs = true;
  TSr.SerNr = afr;
  first = true;
  while (LoopMain(TSr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (TSr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        ExportString(GetRegisterTag("TSVc"));
        NewLine;
        first = false;
      end;
      ExportRecord(TSr);
      NewLine;
      UserTrace(TSr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportRetVc(LongInt afr,LongInt ato)
BEGIN
  record RetVc Retr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  Retr.SerNr = afr;
  first = true;
  while (LoopMain(Retr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (Retr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("RetVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(Retr);
      NewLine;
      UserTrace(Retr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportStockTakeVc(LongInt afr,LongInt ato)
BEGIN
  record StockTakeVc StockTaker;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  StockTaker.SerNr = afr;
  first = true;
  while (LoopMain(StockTaker,1,TrHs)) begin
    if (ato!=-1) then begin
      if (StockTaker.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("StockTakeVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(StockTaker);
      NewLine;
      UserTrace(StockTaker.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportSDVc(LongInt afr,LongInt ato)
BEGIN
  record SDVc SDr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  SDr.SerNr = afr;
  first = true;
  while (LoopMain(SDr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (SDr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("SDVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(SDr);
      NewLine;
      UserTrace(SDr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportAT2TakeVc(LongInt afr,LongInt ato)
BEGIN
  record AT2TakeVc AT2Taker;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  AT2Taker.SerNr = afr;
  first = true;
  while (LoopMain(AT2Taker,1,TrHs)) begin
    if (ato!=-1) then begin
      if (AT2Taker.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("AT2TakeVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(AT2Taker);
      NewLine;
      UserTrace(AT2Taker.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportAT2WrofVc(LongInt afr,LongInt ato)
BEGIN
  record AT2WrofVc AT2Wrofr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  AT2Wrofr.SerNr = afr;
  first = true;
  while (LoopMain(AT2Wrofr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (AT2Wrofr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("AT2WrofVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(AT2Wrofr);
      NewLine;
      UserTrace(AT2Wrofr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportAT2DprVc(LongInt afr,LongInt ato)
BEGIN
  record AT2DprVc AT2Dprr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  AT2Dprr.SerNr = afr;
  first = true;
  while (LoopMain(AT2Dprr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (AT2Dprr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("AT2DprVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(AT2Dprr);
      NewLine;
      UserTrace(AT2Dprr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportSVOVc(LongInt afr,LongInt ato)
BEGIN
  record SVOVc SVOr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  SVOr.SerNr = afr;
  first = true;
  while (LoopMain(SVOr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (SVOr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("SVOVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(SVOr);
      NewLine;
      UserTrace(SVOr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportWOVc(LongInt afr,LongInt ato)
BEGIN
  record WOVc WOr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  WOr.SerNr = afr;
  first = true;
  while (LoopMain(WOr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (WOr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("WOVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(WOr);
      NewLine;
      UserTrace(WOr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportWSVc(LongInt afr,LongInt ato)
BEGIN
  record WSVc WSr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  WSr.SerNr = afr;
  first = true;
  while (LoopMain(WSr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (WSr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("WSVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(WSr);
      NewLine;
      UserTrace(WSr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportSVGMVc(LongInt afr,LongInt ato)
BEGIN
  record SVGMVc SVGMr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  SVGMr.SerNr = afr;
  first = true;
  while (LoopMain(SVGMr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (SVGMr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("SVGMVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(SVGMr);
      NewLine;
      UserTrace(SVGMr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportCLInVc(LongInt afr,LongInt ato)
BEGIN
  record CLInVc CLInr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  CLInr.SerNr = afr;
  first = true;
  while (LoopMain(CLInr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (CLInr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("CLInVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(CLInr);
      NewLine;
      UserTrace(CLInr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportCLOutVc(LongInt afr,LongInt ato)
BEGIN
  record CLOutVc CLOutr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  CLOutr.SerNr = afr;
  first = true;
  while (LoopMain(CLOutr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (CLOutr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("CLOutVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(CLOutr);
      NewLine;
      UserTrace(CLOutr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportCQVc(LongInt afr,LongInt ato)
BEGIN
  record CQVc CQr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  CQr.SerNr = afr;
  first = true;
  while (LoopMain(CQr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (CQr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("CQVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(CQr);
      NewLine;
      UserTrace(CQr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportCustomsVc(LongInt afr,LongInt ato)
BEGIN
  record CustomsVc Customsr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  Customsr.SerNr = afr;
  first = true;
  while (LoopMain(Customsr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (Customsr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("CustomsVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(Customsr);
      NewLine;
      UserTrace(Customsr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  RETURN;
END;

procedure ExportActVc(LongInt afr,LongInt ato)
begin
  record ActVc Actr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  Actr.SerNr = afr;
  first = true;
  while (LoopMain(Actr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (Actr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("ActVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(Actr);
      NewLine;
      UserTrace(Actr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  return;
end;

procedure ExportRestAccVc(LongInt afr,LongInt ato)
begin
  record RestAccVc RestAccr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  RestAccr.SerNr = afr;
  first = true;
  while (LoopMain(RestAccr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (RestAccr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("RestAccVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(RestAccr);
      NewLine;
      UserTrace(RestAccr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  return;
end;

procedure ExportPOSBalanceVc(LongInt afr,LongInt ato)
begin
  record POSBalanceVc POSBalancer;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  POSBalancer.SerNr = afr;
  first = true;
  while (LoopMain(POSBalancer,1,TrHs)) begin
    if (ato!=-1) then begin
      if (POSBalancer.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("POSBalanceVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(POSBalancer);
      NewLine;
      UserTrace(POSBalancer.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  return;
end;

procedure ExportProdOperationsVc(LongInt afr,LongInt ato)
begin
  record ProdOperationVc ProdOperationr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  ProdOperationr.SerNr = afr;
  first = true;
  while (LoopMain(ProdOperationr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (ProdOperationr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("ProdOperationVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(ProdOperationr);
      NewLine;
      UserTrace(ProdOperationr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  return;
end;

procedure ExportProdOrdersVc(LongInt afr,LongInt ato)
begin
  record ProdOrderVc ProdOrdr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  ProdOrdr.SerNr = afr;
  first = true;
  while (LoopMain(ProdOrdr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (ProdOrdr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("ProdOrderVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(ProdOrdr);
      NewLine;
      UserTrace(ProdOrdr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  return;
end;

procedure ExportRetPUVc(LongInt afr,LongInt ato)
begin
  record RetPUVc RetPUr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  RetPUr.SerNr = afr;
  first = true;
  while (LoopMain(RetPUr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (RetPUr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("RetPUVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(RetPUr);
      NewLine;
      UserTrace(RetPUr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  return;
end;

procedure ExportSRVc(LongInt afr,LongInt ato)
begin
  record SRVc SRr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  SRr.SerNr = afr;
  first = true;
  while (LoopMain(SRr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (SRr.SerNr>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("SRVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(SRr);
      NewLine;
      UserTrace(SRr.SerNr,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  return;
end;

procedure ExportTRVc(LongInt afr,LongInt ato)
begin
  record TRVc TRr;
  Boolean TrHs,first;
  string 255 tstr;
  
  TrHs = true;
  TRr.Number = afr;
  first = true;
  while (LoopMain(TRr,1,TrHs)) begin
    if (ato!=-1) then begin
      if (TRr.Number>ato) then begin
        TrHs = false;
      end;
    end;
    if (TrHs) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("TRVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(TRr);
      NewLine;
      UserTrace(TRr.Number,M4Long);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;  
  return;
end;

global
procedure GTransEn(record RcVc RepSpec)
BEGIN
  LongInt afr,ato;
  
  ExportFormat;
  ExpBackupString(RepSpec.f3);
  afr = FirstInRange(RepSpec.f1,10);
  ato = LastInRange(RepSpec.f1,10);

  if (RepSpec.flags[0]==0) then begin
    ExportCOVc(afr,ato);
  end;
  if (RepSpec.flags[0]==1) then begin
    ExportExpVc(afr,ato);
  end;
  if (RepSpec.flags[0]==2) then begin
    ExportPUVc(afr,ato);
  end;
  if (RepSpec.flags[0]==3) then begin
    ExportIVVc(afr,ato);
  end;
  if (RepSpec.flags[0]==4) then begin
    ExportOPVc(afr,ato);
  end;
  if (RepSpec.flags[0]==5) then begin
    ExportPPVc(afr,ato);
  end;
  if (RepSpec.flags[0]==6) then begin
    ExportProdVc(afr,ato);
  end;
  if (RepSpec.flags[0]==7) then begin
    ExportVIVc(afr,ato);
  end;
  if (RepSpec.flags[0]==8) then begin
    ExportPOQTVc(afr,ato);
  end;
  if (RepSpec.flags[0]==9) then begin
    ExportIVCashVc(afr,ato);
  end;
  if (RepSpec.flags[0]==10) then begin
    ExportPOVc(afr,ato);
  end;
  if (RepSpec.flags[0]==11) then begin
    ExportQTVc(afr,ato);
  end;
  if (RepSpec.flags[0]==12) then begin
    ExportIPVc(afr,ato);
  end;
  if (RepSpec.flags[0]==13) then begin
    ExportIntORVc(afr,ato);
  end;
  if (RepSpec.flags[0]==14) then begin
    ExportORVc(afr,ato);
  end;
  if (RepSpec.flags[0]==15) then begin
    ExportSHVc(afr,ato);
  end;
  if (RepSpec.flags[0]==16) then begin
    ExportSMVc(afr,ato);
  end;
  if (RepSpec.flags[0]==17) then begin
    ExportStockMovVc(afr,ato);
  end;
  if (RepSpec.flags[0]==18) then begin
    ExportTSVc(afr,ato);
  end;
  if (RepSpec.flags[0]==19) then begin
    ExportRetVc(afr,ato);
  end;
  if (RepSpec.flags[0]==20) then begin
    ExportStockTakeVc(afr,ato);
  end;
  if (RepSpec.flags[0]==22) then begin
    ExportSDVc(afr,ato);
  end;
  if (RepSpec.flags[0]==23) then begin
    ExportAT2TakeVc(afr,ato);
  end;
  if (RepSpec.flags[0]==24) then begin
    ExportAT2WrofVc(afr,ato);
  end;
  if (RepSpec.flags[0]==25) then begin
    ExportAT2DprVc(afr,ato);
  end;
  if (RepSpec.flags[0]==26) then begin
    ExportSVOVc(afr,ato);
  end;
  if (RepSpec.flags[0]==27) then begin
    ExportWOVc(afr,ato);
  end;
  if (RepSpec.flags[0]==28) then begin
    ExportWSVc(afr,ato);
  end;
  if (RepSpec.flags[0]==29) then begin
    ExportSVGMVc(afr,ato);
  end;
  if (RepSpec.flags[0]==30) then begin
    ExportCLInVc(afr,ato);
  end;
  if (RepSpec.flags[0]==31) then begin
    ExportCLOutVc(afr,ato);
  end;
  if (RepSpec.flags[0]==32) then begin
    ExportCQVc(afr,ato);
  end;
  if (RepSpec.flags[0]==33) then begin
    ExportCustomsVc(afr,ato);
  end;
  if (RepSpec.flags[0]==34) then begin
    ExportActVc(afr,ato);
  end;
  if (RepSpec.flags[0]==35) then begin
    ExportRestAccVc(afr,ato);
  end;
  if (RepSpec.flags[0]==36) then begin
    ExportPOSBalanceVc(afr,ato);
  end;
  if (RepSpec.flags[0]==37) then begin
    ExportProdOperationsVc(afr,ato);
  end;
  if (RepSpec.flags[0]==38) then begin
    ExportProdOrdersVc(afr,ato);
  end;
  if (RepSpec.flags[0]==39) then begin
    ExportRetPUVc(afr,ato);
  end;
  if (RepSpec.flags[0]==40) then begin
    ExportTRVc(afr,ato);
  end;
  if (RepSpec.flags[0]==41) then begin
    ExportSRVc(afr,ato);
  end;
  if (RepSpec.flags[0]==42) then begin
    ExportCheckVc(afr,ato);
  end;
  if (RepSpec.flags[0]==43) then begin
    ExportOwnCheckVc(afr,ato);
  end;
  if (RepSpec.flags[0]==44) then begin
    ExportDropSHVc(afr,ato);
  end;

  RETURN;
END;
