procedure OutTSRows(record TSVc TSp, record RcVc RepSpec)
begin
  Integer i,rwcnt;
  row TSVc TSrw;
  record PRVc PRr;
  Boolean testf;

  rwcnt = MatRowCnt(TSp);
  for (i = 0 ; i<rwcnt ;i=i+1) begin
    MatRowGet(TSp,i,Tsrw);
    testf = true;
    if (RepSpec.flags[1]==1) then begin
      if (TSrw.ItemType<>3) then begin testf = false; end;
    end;
    if (testf) then begin
      PRr.Code = TSrw.PRCode;
      if ReadFirstMain(PRr,1,true) then begin
      ExportLongInt(TSp.SerNr);
      ExportDate(TSp.RegDate);
      ExportString(TSp.Comment);
      ExportDate(TSrw.date);
      ExportString(TSrw.EMCode);
      ExportString(TSrw.PRCode);
      ExportString(TSrw.ArtCode);
      ExportVal(TSrw.Qty,M4Qty);
      ExportString(TSrw.Spec);
      ExportString(PRr.Leader);
      NewLine;
      end;
    end;
  end;
  return;
end;
/* defined in tsrowen.hal
global
procedure TSRowEn(record RcVc RepSpec)
begin
  record TSVc MR;
  Boolean TrHs;
  LongInt frnr,tonr;

  frnr = FirstInRange(RepSpec.f1,30);
  tonr = LastInRange(RepSpec.f1,30);
  ExportString("Nummer");
  ExportString("Regdag");
  ExportString("Tekst");
  ExportString("Dato");
  ExportString("Medarb");
  ExportString("Prosj");
  ExportString("Artikkel");
  ExportString("Antall");
  ExportString("Spesifikasjon");
  ExportString("Leder");
  NewLine;
  MR.SerNr = frnr;
  TrHs = true;
  while (TrHs == LoopMain(MR,1,TrHs)) begin
    if (TrHs) then begin
      if (tonr<>-1) then begin
        if (MR.SerNr>tonr) then begin TrHs = false; end;
      end;
    end;
    if (TrHs) then begin
     if ((MR.RegDate>=RepSpec.sStartDate) and (MR.RegDate<=RepSpec.sEndDate)) then begin
       OutTSRows(MR, RepSpec);
       UserTrace(MR.SerNr,0);
     end;
L22:;
    end;
  end;
  NewLine;
  return;
end;
*/

