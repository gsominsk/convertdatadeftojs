#ifdef HAL

// THIS FILE ISN'T EVEN IN USE..... Wierd
external procedure ExpBackupString(string);

procedure Exp2GBaseAccVc(record RcVc RepSpec)
BEGIN
  record AccVc Accr;
  Boolean first,TrHs,testf;
  string 255 tstr;
  string 255 afr,ato;

  first = true;
  afr = FirstInRange(RepSpec.f1,10);
  ato = LastInRange(RepSpec.f1,10);
  Accr.AccNumber = afr;
  TrHs = true;
  while (LoopMain(Accr,1,TrHs)) begin
    if (TrHs) then begin
      if (nonblank(ato)) then begin
        if (Accr.AccNumber>ato) then begin
          TrHs = false;
        end;
      end;    
    end;
    testf = true;
    if (TrHs==false) then begin testf = false; end;
    if (RepSpec.ArtMode==1) then begin
      if (Accr.blockedFlag!=0) then begin
        testf = false;
      end;
    end;    
    if (testf) then begin
      if (first==true) then begin
        tstr = GetRegisterTag("AccVc");
        ExportString(tstr);
        NewLine;
        first = false;
      end;
      ExportRecord(Accr);
      NewLine;
      UserTrace(Accr.AccNumber,M4Str);
    end;
  end;
  if (first==false) then begin
    NewLine;
    NewLine;
  end;
  RETURN;
END;

global
procedure SysEn(record RcVc RepSpec)
BEGIN

  ExportFormat;
  ExpBackupString(RepSpec.f3);

  if (RepSpec.flags[4]!=0) then begin BlockExport("SalesCodeBlock"); end;
  if (RepSpec.flags[5]!=0) then begin RegisterExport("PDVc"); end;
//  if (RepSpec.flags[6]!=0) then begin RegisterExport("AccVc"); end;
  if (RepSpec.flags[6]!=0) then begin Exp2GBaseAccVc(RepSpec); end;
  if (RepSpec.flags[7]!=0) then begin RegisterExport("RebVc"); end;
  if (RepSpec.flags[8]!=0) then begin RegisterExport("UnitVc"); end;
  if (RepSpec.flags[9]!=0) then begin BlockExport("PMBlock"); end;
  if (RepSpec.flags[11]!=0) then begin
    BlockExport("CYBlock");
    BlockExport("YearBlock");
  end;
  if (RepSpec.flags[13]!=0) then begin RegisterExport("OTVc"); end;
  if (RepSpec.flags[14]!=0) then begin BlockExport("VATCodeBlock"); end;
  if (RepSpec.flags[12]!=0 or RepSpec.flags[15]!=0 or RepSpec.flags[21]!=0) then begin
    RegisterExport("UserDefRepVc");
    RegisterExport("UserDefRepLinesVc");
    RegisterExport("UserDefRepColumnsVc");
    if (RepSpec.flags[21]!=0) then begin
      BlockExport("RepDefBlock");
    end;
  end;
  if (RepSpec.flags[16]!=0) then begin RegisterExport("AutVc"); end;
  if (RepSpec.flags[17]!=0) then begin RegisterExport("BFVc"); end; 
  if (RepSpec.flags[18]!=0) then begin RegisterExport("Bud1Vc"); end; 
  if (RepSpec.flags[19]!=0) then begin RegisterExport("Bud2Vc"); end;
  if (RepSpec.flags[22]!=0) then begin RegisterExport("ResVc"); end;
  if (RepSpec.flags[23]!=0) then begin
    BlockExport("ODBCLinkBlock");
    RegisterExport("ODBCEventVc");
  end;
  if (RepSpec.flags[24]!=0) then begin
    BlockExport("APAccBlock");
    BlockExport("AT2AccBlock");
    BlockExport("CheckAccBlock");
    BlockExport("AccBlock");
    BlockExport("PPAccBlock");
    BlockExport("SVOAccBlock");
    BlockExport("CuAccBlock");
  end;
  if (RepSpec.flags[25]!=0) then begin
    BlockExport("CustomsSerBlock");
    BlockExport("ChqDepSerBlock");
    BlockExport("OwnCheckSerBlock");
    BlockExport("CheckSerBlock");
    BlockExport("CLInSerBlock");
    BlockExport("CLOutSerBlock");
    BlockExport("AT2TakeSerBlock");
    BlockExport("AT2WrofSerBlock");
    BlockExport("AT2DprSerBlock");
    BlockExport("AT2RevSerBlock");
    BlockExport("SHSerBlock");
    BlockExport("PUSerBlock");
    BlockExport("RetSerBlock");
    BlockExport("RetPUSerBlock");
    BlockExport("SDSerBlock");
    BlockExport("StockMovSerBlock");
    BlockExport("StockTakeSerBlock");
    BlockExport("ExpSerBlock");
    BlockExport("PPersSerBlock");
    BlockExport("WayListSerBlock");
    BlockExport("IntORSerBlock");
    BlockExport("POSerBlock");
    BlockExport("POCQStatSerBlock");
    BlockExport("POQTSerBlock");
    BlockExport("SPLSerBlock");
    BlockExport("ProdSerBlock");
    BlockExport("ProdOrdSerBlock");
    BlockExport("QTSerBlock");
    BlockExport("ORSerBlock");
    BlockExport("FEIVSerBlock");
    BlockExport("GCSerBlock");
    BlockExport("IntIVSerBlock");
    BlockExport("IVSerBlock");
    BlockExport("IPSerBlock");
    BlockExport("LetSerBlock");
    BlockExport("SMSerBlock");
    BlockExport("TRSerBlock");
    BlockExport("FEVISerBlock");
    BlockExport("VISerBlock");
    BlockExport("OPSerBlock");
    BlockExport("PRSerBlock");
    BlockExport("TSSerBlock");
    BlockExport("IVCashSerBlock");
    BlockExport("CashSerBlock");
    BlockExport("ResAvSerBlock");
    BlockExport("JobSerBlock");
    BlockExport("RentAgrSerBlock");
    BlockExport("RentQTSerBlock");
    BlockExport("RentResSerBlock");
    BlockExport("OffHireSerBlock");
    BlockExport("DispatchSerBlock");
    BlockExport("INTransferSerBlock");
    BlockExport("SVOSerBlock");
    BlockExport("SVGMSerBlock");
    BlockExport("WOSerBlock");
    BlockExport("WSSerBlock");
    BlockExport("COCUServiceSerBlock");
    BlockExport("CUSerBlock");
    BlockExport("VATDeclSerBlock");
  end;
  if (RepSpec.flags[26]!=0) then begin
    BlockExport("CustomsDefBlock");
    BlockExport("OwnChkDefBlock");
    BlockExport("CLInDefBlock");
    BlockExport("CLIn2DefBlock");
    BlockExport("CLIn1DefBlock");
    BlockExport("CLOutDefBlock");
    BlockExport("CLOut1DefBlock");
    BlockExport("CLOut2DefBlock");
    BlockExport("CLOut3DefBlock");
    BlockExport("CLInColDefBlock");
    BlockExport("CLOutColDefBlock");
    BlockExport("AT2WrofDefBlock");
    BlockExport("AT2InDefBlock");
    BlockExport("AT2DefBlock");
    BlockExport("AT2TakeDefBlock");
    BlockExport("AT2RevDefBlock");
    BlockExport("ContractDefBlock");
    BlockExport("ContQuoteDefBlock");
    BlockExport("CuLabDefBlock");
    BlockExport("ContLabDefBlock");
    BlockExport("PalletLabDefBlock");
    BlockExport("AdrLabDefBlock");
    BlockExport("BPChangeDefBlock");
    BlockExport("Sh1DefBlock");
    BlockExport("SHLabDefBlock");
    BlockExport("PurchaseDefBlock");
    BlockExport("ItemLabelDefBlock");
    BlockExport("Sh2DefBlock");
    BlockExport("Sh3DefBlock");
    BlockExport("PULabDefBlock");
    BlockExport("RetDefBlock");
    BlockExport("RetPUDefBlock");
    BlockExport("SDDefBlock");
    BlockExport("StockMovDefBlock");
    BlockExport("ExpenseDefBlock");
    BlockExport("PersPayDefBlock");
    BlockExport("WayListDefBlock");
    BlockExport("IntORDefBlock");
    BlockExport("PODefBlock");
    BlockExport("POConfDefBlock");
    BlockExport("POQTDefBlock");
    BlockExport("PORemDefBlock");
    BlockExport("ProdOrderDefBlock");
    BlockExport("ProdLabelDefBlock");
    BlockExport("ProdOrder2DefBlock");
    BlockExport("QTDefBlock");
    BlockExport("Or2DefBlock");
    BlockExport("OrdDefBlock");
    BlockExport("CashDefBlock");
    BlockExport("CredDefBlock");
    BlockExport("FEIVDefBlock");
    BlockExport("GCDefBlock");
    BlockExport("IIDefBlock");
    BlockExport("IntIVDefBlock");
    BlockExport("InStaDefBlock");
    BlockExport("InvDefBlock");
    BlockExport("ARSDefBlock");
    BlockExport("CuPerDefBlock");
    BlockExport("Inv1DefBlock");
    BlockExport("PRInvDefBlock");
    BlockExport("IPDDefBlock");
    BlockExport("RemDefBlock");
    BlockExport("SLEUVATDefBlock");
    BlockExport("VATIVDefBlock");
    BlockExport("ActDocDefBlock");
    BlockExport("CoLabDefBlock");
    BlockExport("LetDefBlock");
    BlockExport("VATRepDefBlock");
    BlockExport("TAXRepDefBlock");
    BlockExport("OP2DDefBlock");
    BlockExport("InStaPuDefBlock");
    BlockExport("APSDefBlock");
    BlockExport("OPDDefBlock");
    BlockExport("VIDefBlock");
    BlockExport("DebVIDefBlock");
    BlockExport("TBBudgetDefBlock");
    BlockExport("ProjectInfoDefBlock");
    BlockExport("ProjectDefBlock");
    BlockExport("TimeSheetDefBlock");
    BlockExport("IVCashDefBlock");
    BlockExport("RestAccDefBlock");
    BlockExport("GuestDocDefBlock");
    BlockExport("JobDefBlock");
    BlockExport("ResAvDefBlock");
    BlockExport("ExcurDocDefBlock");
    BlockExport("TransferDocDefBlock");
    BlockExport("AgreementDefBlock");
    BlockExport("CollectionDefBlock");
    BlockExport("AgreementDetDefBlock");
    BlockExport("RentResDefBlock");
    BlockExport("RentQTDefBlock");
    BlockExport("InternMovDefBlock");
    BlockExport("OffHireDefBlock");
    BlockExport("DispatchDefBlock");
    BlockExport("INTransferDefBlock");
    BlockExport("ORProgDefBlock");
    BlockExport("SVODefBlock");
    BlockExport("SVGMFDefBlock");
    BlockExport("WOrdDefBlock");
    BlockExport("WSDefBlock");
    BlockExport("MailDefBlock");
  end;

  RETURN;
END;
#endif
