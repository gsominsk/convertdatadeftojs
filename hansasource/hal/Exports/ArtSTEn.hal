
global
procedure ArtSTEn(record RcVc RepSpec)
begin
  record INVc INr;
  Boolean TrHs, testf;
  string 255 fromart,toart;
  string 255 fromgrp, togrp;
  Date i;
  val v,t,q;
  string 255 tstr;
  
  fromart = FirstInRange(RepSpec.f1,20);
  toart = LastInRange(RepSpec.f1,20);
  fromgrp = FirstInRange(RepSpec.f3,20);
  togrp = LastInRange(RepSpec.f3,20);
  ExportString(USetStr(2325));
  ExportString(USetStr(2620));
  NewLine;
  INr.Code = fromart;
  INr.Group = fromgrp;
  TrHs = true;
  while (LoopMain(INr,1,TrHs)) begin
  testf = true;
    if (nonblank(toart)) then begin
        if (INr.Code>toart) then begin
          TrHs = false;
        end;
     end;    
     if (TrHs) then begin
      if (nonblank(RepSpec.f3)) then begin
         if (INr.Group<>RepSpec.f3) then begin
            testf = false;
         end;
        end;
        if (testf) then begin 
          if (nonblank(INr.Code)) then begin
            q=GetTurnover(INr,"quant",RepSpec.sStartDate,RepSpec.sEndDate);
            v=GetTurnover(INr,"salesexclvat",RepSpec.sStartDate,RepSpec.sEndDate);
            if (q<>0 or v <>0) then begin
              ExportString(INr.Code);
              for (i=RepSpec.sStartDate;i<=RepSpec.sEndDate;i=AddMonth(i,1)) begin
                q=GetTurnover(INr,"quant",i,i);
                ExportVal(q,M4Qty);
              end;
              for (i=RepSpec.sStartDate;i<=RepSpec.sEndDate;i=AddMonth(i,1)) begin
                v=GetTurnover(INr,"salesexclvat",i,i);
                ExportVal(v,M4Val);
              end;
              NewLine;
              UserTrace(INr.Code,0);
            end;
          end;
        end;  
     end;
  end;
  return;
end;
