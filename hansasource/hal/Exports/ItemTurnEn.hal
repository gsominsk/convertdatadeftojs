
procedure NewDate(var Date sdate,var Date edate)
begin
  sdate = AddMonth(sdate,1);
  edate = AddMonth(sdate,1);
  edate = AddDay(edate,-1);
 return;
end;

procedure PrintOutItemRow(string INCode, string INName,val c1,val c2,val c3,val c4,val c5,val c6,
   val c7,val c8,val c9,val c10,val c11, val c12)
begin
  val trow;
  trow = c1+c2+c3+c4+c5+c6+c7+c8+c9+c10+c11+c12;
  ExportString(INCode);
  ExportString(INName);
  ExportVal(c1,M4Val);
  ExportVal(c2,M4Val);
  ExportVal(c3,M4Val);
  ExportVal(c4,M4Val);
  ExportVal(c5,M4Val);
  ExportVal(c6,M4Val);
  ExportVal(c7,M4Val);
  ExportVal(c8,M4Val);
  ExportVal(c9,M4Val);
  ExportVal(c10,M4Val);
  ExportVal(c11,M4Val);
  ExportVal(c12,M4Val);
  ExportVal(trow,M4Val);
  NewLine;
  return;
end;
 
procedure SumUpTotals(val c1,val c2,val c3,val c4,val c5,val c6,val c7,val c8,val c9,
     val c10,val c11,val c12,var val tc1,var val tc2,var val tc3,var val tc4,var val tc5,
     var val tc6,var val tc7,var val tc8,var val tc9,var val tc10,var val tc11,var val tc12)
begin
    tc1 = tc1 + c1;
    tc2 = tc2 + c2;
    tc3 = tc3 + c3;
    tc4 = tc4 + c4;
    tc5 = tc5 + c5;
    tc6 = tc6 + c6;
    tc7 = tc7 + c7;
    tc8 = tc8 + c8;
    tc9 = tc9 + c9;
    tc10 = tc10 + c10;
    tc11 = tc11 + c11;
    tc12 = tc12 + c12;

  return;
end;

procedure OneItemSpec(record RcVc RepSpec,record INVc INr,var val tc1,var val tc2,var val tc3,
    var val tc4,var val tc5,var val tc6,var val tc7,var val tc8,var val tc9,var val tc10,
    var val tc11,var val tc12)
BEGIN
  Date sdate,edate;
  val c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12;
  Integer i,rwcnt,dinm;
  Boolean firstf;
 
  if (RepSpec.ArtMode == 0) then begin
   sdate = RepSpec.d1;
   edate = AddMonth(sdate,1);
   edate = AddDay(edate,-1);
   c1 = GetTurnover(INr,"quant",sdate,edate);
   NewDate(sdate,edate)
   c2 = GetTurnover(INr,"quant",sdate,edate);
   NewDate(sdate,edate)
   c3 = GetTurnover(INr,"quant",sdate,edate);
   NewDate(sdate,edate)
   c4 = GetTurnover(INr,"quant",sdate,edate);
   NewDate(sdate,edate)
   c5 = GetTurnover(INr,"quant",sdate,edate);
   NewDate(sdate,edate)
   c6 = GetTurnover(INr,"quant",sdate,edate);
   NewDate(sdate,edate)
   c7 = GetTurnover(INr,"quant",sdate,edate);
   NewDate(sdate,edate)
   c8 = GetTurnover(INr,"quant",sdate,edate);
   NewDate(sdate,edate)
   c9 = GetTurnover(INr,"quant",sdate,edate);
   NewDate(sdate,edate)
   c10 = GetTurnover(INr,"quant",sdate,edate);
   NewDate(sdate,edate)
   c11 = GetTurnover(INr,"quant",sdate,edate);
   NewDate(sdate,edate)
   c12 = GetTurnover(INr,"quant",sdate,edate);
   NewDate(sdate,edate)
  end;
  if (RepSpec.ArtMode == 1) then begin
    sdate = RepSpec.d1;
    edate = AddMonth(sdate,1);
    edate = AddDay(edate,-1);
    c1 = GetTurnover(INr,"salesexclvat",sdate,edate); 
    NewDate(sdate,edate)
    c2 = GetTurnover(INr,"salesexclvat",sdate,edate); 
    NewDate(sdate,edate)
    c3 = GetTurnover(INr,"salesexclvat",sdate,edate); 
    NewDate(sdate,edate)
    c4 = GetTurnover(INr,"salesexclvat",sdate,edate); 
    NewDate(sdate,edate)
    c5 = GetTurnover(INr,"salesexclvat",sdate,edate); 
    NewDate(sdate,edate)
    c6 = GetTurnover(INr,"salesexclvat",sdate,edate); 
    NewDate(sdate,edate)
    c7 = GetTurnover(INr,"salesexclvat",sdate,edate); 
    NewDate(sdate,edate)
    c8 = GetTurnover(INr,"salesexclvat",sdate,edate); 
    NewDate(sdate,edate)
    c9 = GetTurnover(INr,"salesexclvat",sdate,edate); 
    NewDate(sdate,edate)
    c10 = GetTurnover(INr,"salesexclvat",sdate,edate); 
    NewDate(sdate,edate)
    c11 = GetTurnover(INr,"salesexclvat",sdate,edate); 
    NewDate(sdate,edate)
    c12 = GetTurnover(INr,"salesexclvat",sdate,edate); 
  end;
  if (c1<>0) or (c2<>0) or (c3<>0) or (c4<>0) or (c5<>0) or (c6<>0) or (c7<>0) or (c8<>0) or (c9<>0) or (c10<>0) or (c11<>0) or (c12<>0) then begin
    PrintOutItemRow(INr.Code,INr.Name,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12);
  end;
  SumUpTotals(c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,tc1,tc2,tc3,tc4,tc5,tc6,tc7,tc8,tc9,tc10,tc11,tc12)
  RETURN;     
END;

procedure PrintHeader(record RcVc RepSpec)
begin
  Date sdate;
  sdate = RepSpec.d1;
  ExportString("Item");
  ExportString("Description");
  ExportString(sdate);
  sdate = AddMonth(sdate,1);
  ExportString(sdate);
  sdate = AddMonth(sdate,1);
  ExportString(sdate);
  sdate = AddMonth(sdate,1);
  ExportString(sdate);
  sdate = AddMonth(sdate,1);
  ExportString(sdate);
  sdate = AddMonth(sdate,1);
  ExportString(sdate);
  sdate = AddMonth(sdate,1);
  ExportString(sdate);
  sdate = AddMonth(sdate,1);
  ExportString(sdate);
  sdate = AddMonth(sdate,1);
  ExportString(sdate);
  sdate = AddMonth(sdate,1);
  ExportString(sdate);
  sdate = AddMonth(sdate,1);
  ExportString(sdate);
  sdate = AddMonth(sdate,1);
  ExportString(sdate);
  ExportString("Total");
  NewLine;
  return;
end;
   
global
procedure ItemTurnEn(record RcVc RepSpec)
BEGIN
  record INVc INr;
  string 20 fromart,toart;
  Boolean TrHs,testf;
  string 255 tstr;
  val tc1,tc2,tc3,tc4,tc5,tc6,tc7,tc8,tc9,tc10,tc11,tc12;
  
  if (GetDay(RepSpec.d1)!=1) then begin
    MessageBox(1163,"");
    goto LItemTurnEn;
  end;  
  fromart = FirstInRange(RepSpec.f1,20);
  toart = LastInRange(RepSpec.f1,20);
  PrintHeader(RepSpec);
  INr.Code = fromart;
  TrHs = true;
  while (LoopMain(INr,1,TrHs)) begin
     if (nonblank(toart)) then begin
        if (INr.Code>toart) then begin
          TrHs = false;
        end;
     end;    
     if (TrHs) then begin
       testf = true;
       if (nonblank(RepSpec.FirstAcc)) then begin
         if (INr.Group<>RepSpec.FirstAcc) then begin
           testf = false;
         end;
       end;
       if (testf) then begin
         OneItemSpec(RepSpec,INr,tc1,tc2,tc3,tc4,tc5,tc6,tc7,tc8,tc9,tc10,tc11,tc12);
       end;  
     end;
  end;
  PrintOutItemRow("Total","",tc1,tc2,tc3,tc4,tc5,tc6,tc7,tc8,tc9,tc10,tc11,tc12);
LItemTurnEn:;
  RETURN;
END;
