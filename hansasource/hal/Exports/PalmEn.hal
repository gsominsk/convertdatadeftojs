global
procedure PalmEn(record RcVc RepSpec)
begin
  record CUVc CUr;
  String 60 fr,to;
  string 100 firstname;
  Boolean found,testf;
  record MailSettingsBlock MBr;

  BlockLoad(MBr);
  ExportString("First Name");
  ExportString("Last Name");
  ExportString("Nickname");
  ExportString("Prefix");
  ExportString("Suffix");
  ExportString("Title");
  ExportString("Company");
  ExportString("Division");
  ExportString("Address 1 Label");
  ExportString("Street 1 (Line 1)");
  ExportString("Street 1 (Line 2)");
  ExportString("City 1");
  ExportString("State 1");
  ExportString("Zip 1");
  ExportString("Country 1");
  ExportString("Address 2 Label");
  ExportString("Street 2 (Line 1)");
  ExportString("Street 2 (Line 2)");
  ExportString("City 2");
  ExportString("State 2");
  ExportString("Zip 2");
  ExportString("Country 2");
  ExportString("Phone 1 Label");
  ExportString("Phone 1");
  ExportString("Extension 1");
  ExportString("Phone 2 Label");
  ExportString("Phone 2");
  ExportString("Extension 2");
  ExportString("Phone 3 Label");
  ExportString("Phone 3");
  ExportString("Extension 3");
  ExportString("Phone 4 Label");
  ExportString("Phone 4");
  ExportString("Extension 4");
  ExportString("Comments");
  ExportString("Birthday");
  ExportString("Email");
  ExportString("Web Site");
  ExportString("Custom 1");
  ExportString("Custom 2");
  ExportString("Custom 3");
  ExportString("Custom 4");
  ExportString("Custom 5");
  ExportString("Custom 6");
  ExportString("Custom 7");
  ExportString("Custom 8");
  ExportString("Custom 9");
  ExportString("Modified");
  ExportString("Marked");
  ExportString("Category 1");
  ExportString("Category 2");
  NewLine;
  fr = FirstInRange(RepSpec.f1,20);
  to = LastInRange(RepSpec.f1,20);
  CUr.Code = fr;
  found = true;
  while (LoopMain(CUr,1,found)) begin
    testf = true;
    if (CUr.Code>to) then begin
      found = false;
    end;
    if (CUr.blockedFlag<>0) then begin testf = false; end;
    if (found==false) then begin
      testf = false;
    end;
    if (testf) then begin
      firstname = FirstInRange(CUr.Name,100);
      ExportString(firstname);
      ExportString(Right(CUr.Name,len(CUr.Name)-len(firstname) -1));
      ExportString(""); // Nickname
      ExportString(""); // Prefix
      ExportString(""); // Suffix
      ExportString(CUr.Title);
      ExportString(CUr.Name);
      ExportString(CUr.Department);
      ExportString("Home");
      ExportString(CUr.InvAddr0);
      ExportString(CUr.InvAddr1);
      ExportString(CUr.InvAddr2);
      ExportString(""); // State 1
      ExportString(""); // Zip 1
      ExportString(""); // Country 1
      ExportString("Work");
      ExportString(CUr.InvAddr0); // Street 2
      ExportString(CUr.InvAddr1); // Street 2
      ExportString(CUr.InvAddr2); // City 2
      ExportString(""); // State 2
      ExportString(""); // Zip 2
      ExportString(""); // Country 2
      ExportString("Home"); // Phone 1 Label
      ExportString(CUr.Phone);
      ExportString(""); // Extension 1
      ExportString("Mobile"); // Phone 2 Label
      ExportString(CUr.Mobile);
      ExportString(""); // Extension 2
      ExportString("Other"); // Phone 3 Label
      ExportString(CUr.AltPhone);
      ExportString(""); // Extension 3
      ExportString("Fax"); // Phone 4 Label
      ExportString(CUr.Fax);
      ExportString(""); // Extension 4
      ExportString(CUr.Comment0 & " " & CUr.Comment1 & " " & CUr.Comment2);
      ExportString(DateToString(CUr.BirthDate,"DD MMM YY"));
      if (MBr.ExclEmail==0) then begin
        ExportString(CUr.eMail);
      end else begin
        ExportString("");
      end;
      ExportString(""); // WEB Site
      ExportString(""); // Custom 1
      ExportString(CUr.JobDesc);
      ExportString(""); // Custom 3
      ExportString(CUr.Classification);
      ExportString(""); // Custom 5
      ExportString(""); // Custom 6
      ExportString(""); // Custom 7
      ExportString(""); // Custom 8
      ExportString(""); // Custom 9
      ExportString(""); // Modified
      ExportString(""); // Marked
      ExportString(RepSpec.f2); // Category 1
      ExportString(""); // Category 1
      NewLine;
      UserTrace(CUr.Name,0);
    end;
  end;
  return;
end;

