// Just copy the loop from the below function and Export the IVr:s and set the EInvExpFlag to 1 and start the loop again using goto
global
updating procedure ElecInvEn(record RcVc RepSpec)
BEGIN
  RETURN;
END;

global
procedure ElecInvRn(record RcVc RepSpec)
BEGIN
  record IVVc IVr;
  record CUVc CUr;
  Boolean foundf,testf;
  val totsum;
  
  StartReportJob(USetStr(13820));
  EndHeader;
  SetRepCol(2,65);
  SetRepCol(3,120);
  SetRepCol(4,280);
  SetRepCol(5,360);
  StartFormat(15);
  OutString(0,0,USetStr(13821),false);
  OutString(2,0,USetStr(13822),false);
  OutString(3,0,USetStr(13823),false);
  OutString(4,0,USetStr(13824),false);
//  OutString(5,0,USetStr(13825),false);
  OutString(5,0,USetStr(13826),false);
  OutString(1,0,USetStr(13827),true);
  totsum = totsum + IVr.Sum4;
  EndFormat;
  Gray_Divider(0,1);
  foundf = true;
  IVr.OKFlag = 1;
  IVr.EInvFunc = 1;
  IVr.EInvExpFlag = 0;
  while (LoopKey("EInvToExport",IVr,3,foundf)) begin
    if (IVr.OKFlag==0) then begin foundf = false; end;
    if (IVr.EInvFunc==0) then begin foundf = false; end;
    if (IVr.EInvExpFlag==1) then begin foundf = false; end;
    testf = true;
    if (foundf==false) then begin
      testf = false;
    end;
    CUr.Code = IVr.CustCode;
    if (ReadFirstMain(CUr,1,true)==false) then begin
      CUr.IBANCode = "MISSING";
    end;
    if (testf) then begin
      StartFormat(15);
      OutLongInt(0,"Dbl2IVVc",IVr.SerNr,false);
      OutString(2,"DblCUVc",IVr.CustCode,false);
      OutString(3,0,IVr.Addr0,false);
      OutDate(4,0,IVr.InvDate,false);
//      OutDate(5,0,IVr.PayDate,false);
      OutString(5,0,CUr.IBANCode,false);
      OutVal(1,0,IVr.Sum4,M4Val,true);
      totsum = totsum + IVr.Sum4;
      EndFormat;
    end;
  end;
  if (totsum>0) then begin
    Gray_Divider(0,1);
    StartFormat(15);
    OutVal(1,0,totsum,M4Val,true);
    EndFormat;
  end;
  EndJob;
  RETURN;
END;
