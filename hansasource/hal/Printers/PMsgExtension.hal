external function string 255 PMsgExtension_FPrint02K(integer,integer,string,var array integer,var array string,array string); 
external function string 255 PMsgExtension_Default(integer,integer,string,var array integer,var array string,array string); 

global
function string 255 PMsgExtensionEx2(record LSerialPortDeviceVc LSPDr,integer Type,integer PMsgCommandConst,string KeyWord2,var array integer format,var array string msgstack,array string altparams) 
begin
  string 255 res;

  switch(LSPDr.Printer) begin
    case kSerialPortDeviceModelFiscPrinterFPRINT02K:
      res = PMsgExtension_FPrint02K(Type,PMsgCommandConst,KeyWord2,format,msgstack,altparams);
  end;  

  if((res=="-1" or blank(res)) and format[0]==0) then begin
      res = PMsgExtension_Default(Type,PMsgCommandConst,KeyWord2,format,msgstack,altparams);
  end;

  PMsgExtensionEx2 = res;
  return;
end;

global
function string 255 PMsgExtensionEx(record LSerialPortDeviceVc LSPDr,integer Type,integer PMsgCommandConst,string KeyWord2,var array integer format,var array string msgstack) 
begin
  array string 255 dummy;
  
  PMsgExtensionEx = PMsgExtensionEx2(LSPDr,Type,PMsgCommandConst,KeyWord2,format,msgstack,dummy);
  return;
end;

global
function string 255 PMsgExtension(record LSerialPortDeviceVc LSPDr,integer Type,integer PMsgCommandConst,string KeyWord2) 
begin
  array integer dummy1;
  array string 255 dummy2,dummy3;

  PMsgExtension = PMsgExtensionEx2(LSPDr,Type,PMsgCommandConst,KeyWord2,dummy1,dummy2,dummy3);
  return;
end;