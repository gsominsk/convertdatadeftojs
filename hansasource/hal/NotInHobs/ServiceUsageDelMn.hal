
event startup
begin
  SetLangMode(LangEnglish,"ENG",0);
  
  Maintenance("Delete Service Usage",ServiceUsageDelVClass,ServiceUsageDelMn,modHTS);
  
  return;
end;

event DefineWindows
begin
  Real h,h1,h2,h3,h4,h5,h6,h7,hs,hm,v,v3,l,vs,vm,f,t,x,v2;
  
  SetLangMode(LangEnglish,"ENG",0);
  
  WindowBegin("Specify Delete Service Usage",ServiceUsageDelVClass,CGMnt,RcType);
  SetWRect(20,80,450,200);
  vs = 20;
  PeriodField(h=150,v=6,"Period");
  EndWindow;

  return;
end;


global
updating procedure ServiceUsageDelMn(record RcVc RepSpec)
begin
  record ServiceUsageVc SUr;
  Boolean found;
  
  found = true;
  SUr.TransDate = RepSpec.sStartDate;
  while (LoopKey("TransDate",SUr,1,found)) begin
    if (SUr.TransDate>RepSpec.sEndDate) then begin
      found = false;
    end;
    if (found) then begin
      RecordDelete(SUr);
      StepBack(SUR);
    end;
  end;
  return;
end;
