external procedure ToolWebHBSDivSetMainTitle();
external procedure ToolWebHBSDivStartPage();
external procedure ToolWebHBSDivStartBody(string,string);
external procedure ToolWebHBSDivEndPage();
external procedure ToolWebStartTable();
external procedure ToolWebEndTable();

procedure GetConfInfo(string thecode,var string confname,var string confcode,var LongInt maxmail)
begin
  record ConfAliasVc CFr;
  Integer oldcomp;
  Boolean res;
  
  oldcomp = CurrentCompany;  
  res = SetCompany(1,false);
  CFr.Code = thecode;
  if (ReadFirstMain(CFr,1,true)) then begin
    confname = CFr.WebConf;
    confname = confname & CFr.Comment;
    maxmail = CFr.MailQty;
  end;
  ResetCompany(oldcomp);
  return;
end;

global
procedure WebPlayMovie()
begin
  string 60 confcode;
  string 255 confname;
  LongInt cx,cy;
  
  GetConfInfo(WebGetArg("whattoplay"),confname,confcode,cx);
  if (cx<=0) then begin
    cx = 800;
  end;
  switch (cx) begin
    case 640: cy = 480;
    case 800: cy = 600;
    case 1024: cy = 768;
    otherwise cy = cx / 1.33;
  end;
  ToolWebHBSDivStartPage;
  ToolWebHBSDivSetMainTitle;
  ToolWebHBSDivStartBody("","");
  
  WebOutString("<table cellspacing=""0"" cellpadding=""0"" border=""0"" width=""100%"">"); WebOutNL;
  WebOutString("<tr valign=""top"">"); WebOutNL;

  WebOutString("<td width=""16"">&nbsp;</td>"); WebOutNL;
  WebOutString("<td width=""289"" class=""welcome"">"); WebOutNL;
  WebOutString("<table cellspacing=""0"" cellpadding=""0"" border=""0"">"); WebOutNL;
  WebOutString("<tr valign=""top"">"); WebOutNL;
  WebOutString("<td class=""heading2"">"); WebOutNL;
	  
	WebOutString("</td>"); WebOutNL;
  WebOutString("</tr>"); WebOutNL;
  WebOutString("<tr valign=""top"">"); WebOutNL;
  WebOutString("<td class=""welcome"">"); WebOutNL;
  WebOutString("<p>"); WebOutNL;
  WebOutString("<center>"); WebOutNL;
  WebOutString("<div class=""mf"">"); WebOutNL;
  WebOutString("<div class=""c tl""></div><div class=""c tr""></div>"); WebOutNL;
  WebOutString("<div class=""c bl""></div><div class=""c br""></div>"); WebOutNL;

  WebOutString("<div id=""mv"">"); WebOutNL;
  WebOutString("<script type=""text/javascript"">"); WebOutNL;
  WebOutString("// <![CDATA["); WebOutNL;
  WebOutString("var qto = new QTObject(""" & confname & """, ""outbound"", """ & cx & """, """ & cy & """);"); WebOutNL;
  WebOutString("qto.addParam(""target"", ""myself"");"); WebOutNL;
  WebOutString("qto.addParam(""controller"", ""true"");"); WebOutNL;
  WebOutString("qto.addParam(""scale"", ""tofit"");"); WebOutNL;
  WebOutString("qto.addParam(""autoplay"", ""true"");"); WebOutNL;
  WebOutString("qto.write();"); WebOutNL;
  WebOutString("// ]]>"); WebOutNL;
  WebOutString("</script>"); WebOutNL;
  WebOutString("</div>"); WebOutNL;
  WebOutString("</div>"); WebOutNL;
  WebOutString("</center>"); WebOutNL;

  WebOutString("</td>"); WebOutNL;
  WebOutString("</tr>"); WebOutNL;
  WebOutString("</table>"); WebOutNL;
  WebOutString("<br><br><br>"); WebOutNL;
  WebOutString("</td>"); WebOutNL;
  WebOutString("</tr>"); WebOutNL;
  WebOutString("</table>"); WebOutNL;
  ToolWebHBSDivEndPage;

  return;
end;
