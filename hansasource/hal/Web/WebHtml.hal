external procedure ToolWebGetDispGroup(string,var string);

global
procedure ToolWebOutMailText(record MailVc Mailr,string param)
begin
  record WebControlBlock WCb;
  Integer htmltrans;
  
/*
  if (IsOldStyle(sortorder)) then begin
    WebOutText(Mailr,Mailr.HtmlTranslation,"");
  end else begin
    WebOutText(Mailr,Mailr.HtmlTranslation,param);
  end;
*/
  htmltrans = Mailr.HtmlTranslation;
  if (htmltrans==0) then begin
    BlockLoad(WCb);
    htmltrans = WCb.HtmlTranslation;
  end;
  WebOutText(Mailr,htmltrans,param);
  return;
end;

global
procedure ToolWebOutNoteText(record NoteVc Noter,Integer htmltrans,string param)
begin
  record WebControlBlock WCb;
  Integer lhtmltrans;

/*
  if (IsOldStyle(sortorder)) then begin
    WebOutText(Noter,Noter.HtmlTranslation,"");
  end else begin
    WebOutText(Noter,Noter.HtmlTranslation,param);
  end;
*/
  lhtmltrans = htmltrans;
  if (lhtmltrans==0) then begin
    BlockLoad(WCb);
    lhtmltrans = WCb.HtmlTranslation;
  end;
  WebOutText(Noter,lhtmltrans,param);
  return;
end;

global
procedure ToolWebOutWebHTMLText(record WebHTMLVc WebHTMLr,Integer htmltrans,string param)
begin
  record WebControlBlock WCb;
  Integer lhtmltrans;

/*
  if (IsOldStyle(sortorder)) then begin
    WebOutText(WebHTMLr,WebHTMLr.HtmlTranslation,"");
  end else begin
    WebOutText(WebHTMLr,WebHTMLr.HtmlTranslation,param);
  end;
*/
  lhtmltrans = htmltrans;
  if (lhtmltrans==0) then begin
    BlockLoad(WCb);
    lhtmltrans = WCb.HtmlTranslation;
  end;
  WebOutText(WebHTMLr,lhtmltrans,param);
  return;
end;

global
procedure ToolWebWinBarTitle(String title)
begin
  WebOutString("<title>");
  WebOutString(title);
  WebOutString("</title>");
  WebOutNL;
  return;
end;

global
procedure ToolWebSetMainTitle()
begin
  record WebControlBlock WCr;
  string 60 wcharset;
  
  BlockLoad(WCr);
  wcharset = WCr.WebCharSet;
  if (blank(wcharset)) then begin
    wcharset = "iso-8859-1";
  end;
  ToolWebWinBarTitle("Hansa Corporate Portal");
	WebOutString("<X-SAS-WINDOW TOP=60 BOTTOM=759 LEFT=92 RIGHT=830>");
  WebOutNL;
	WebOutString("<meta http-equiv=""Content-Type"" content=""text/html; charset=" & wcharset & """>");
  WebOutNL;
	 //charset=windows-1257"">");
  return;
end;

global
procedure ToolWebHiddenField(string mname,string mvalue)
begin
  WebOutString("<input  type=""hidden"" name=""" & mname & """ value=""" & mvalue & """>");
  WebOutNL;
  return;
end;

global
procedure ToolWebLineStart()
begin
  WebOutString("<tr>");
  WebOutNL;
  return;
end;

global
procedure ToolWebLineEnd()
begin
  WebOutString("</tr>");
  WebOutNL;
  return;
end;

global
procedure WebCellStart()
begin
  WebOutString("<td>");
  WebOutNL;
  return;
end;

global
procedure WebCellEnd()
begin
  WebOutString("</td>");
  WebOutNL;
  return;
end;

global
procedure WebEditField(string webname,string webtype,string wvalue,string wwidth,Integer wsize,Integer wlen)
begin
  WebOutString("<td width=""" & wwidth & """ valign=""top"" align=""left"">");
  WebOutString("<input type=""" & webtype & """ name=""" & webname & """ SIZE=""" & wsize & """ MAXLENGTH=""" & wlen & """ value=""" & wvalue & """></td>");
  WebOutNL;
  return;
end;

global
procedure WebTextArea(string webname,record MailVc Mailr,string wwidth,Integer rows,Integer cols)
begin
  WebOutString("<td width=""" & "100%" & """ valign=""top"" align=""left"">");
  WebOutString("<textarea style=""font-family: verdana; font-size: 10;"" rows=""" & rows & """ name=""" & webname & """ cols=""" & cols & """>");
  ToolWebOutMailText(Mailr,"");
  WebOutString("</textarea>");
  WebOutString("</td>");
  WebOutNL;
  return;
end;

global
procedure WebEditFieldBrowse(string webname,string webtype,string wvalue,string wwidth,Integer wsize,Integer wlen,Integer rwt)
begin
  string 20 bgcolr;

  if (rwt==1) then begin
    bgcolr = "#CCCCFF";
  end;
  if (rwt!=1) then begin
    bgcolr = "#FFFFFF";
  end;
  WebOutString("<td bordercolor=white bgcolor=""" & bgcolr & """ width=""" & wwidth & """ valign=""center"" align=""left"">");
  WebOutString("<input style=""font-family: verdana; font-size: 10;"" type=""" & webtype & """ name=""" & webname & """  size=""" & wsize & """ MAXLENGTH=""" & wlen & """ value=""" & wvalue & """></td>");
  WebOutNL;
  return;
end;

global
procedure WebLeadText(string webname,string wwidth)
begin
  WebOutString("<td width=""" & wwidth & """ valign=""center"" align=""right"">");
  WebOutString("<font size=""2"" face=""Verdana, Arial, Helvetica, sans-serif"" color=""#000099""><b>" & webname & " </font>");
  WebOutString("</td>");
  WebOutNL;
  return;
end;

global
procedure WebLeadText2(string webname,string wwidth)
begin
  WebOutString("<td width=""" & wwidth & """ valign=""center"" align=""left"">");
  WebOutString("<font size=""1"" face=""Verdana, Arial, Helvetica, sans-serif"" color=""#000099""><b>" & webname & " </font>");
  WebOutString("</td>");
  WebOutNL;
  return;
end;

global
procedure WebCommentText(string webname,string wwidth)
begin
  WebOutString("<td width=""" & wwidth & """ valign=""center"" align=""left"">");
  WebOutString("<font size=""2"" face=""Verdana, Arial, Helvetica, sans-serif"" color=""#000099""><b>" & webname & " </font>");
  WebOutString("</td>");
  WebOutNL;
  return;
end;

global
procedure ToolWebPushButton(string webtext,string webtype,string webname)
begin
  WebOutString("<input type=""" & webtype & """ name=""" & webname & """ value=""" & webtext & """ style=""font-family: Verdana; font-size: 8pt"">");
  WebOutNL;
  return;
end;

global
procedure WebPushButtonImage(string webtext,string webtype,string webname, string imagename, string width, string height)
begin
  WebOutString("<input type=""image"" border=""0"" valign=""center"" src=""" & imagename & """ name=""" & webname & """ value=""" & webtext & """");
  if nonblank(width) then begin
    WebOutString(" width=""" & width &""" height="""& height & """");
  end;
  WebOutString(">");
  WebOutNL;
  return;
end;

global
procedure ToolWebStartPage()
begin
  WebOutString("<html>");
  WebOutString("<head>");
  WebOutNL;
  return;
end;  

global
procedure ToolWebStartBody(string wfocusfield)
begin
  WebOutString("</head>");
  WebOutNL;
//  WebOutString("<body link=white vlink=white alink=white text=white background=""mainbg.jpg"" bgcolor=""#000066""");
//  WebOutString("<body link=""#000099"" vlink=""#000099"" alink=""#000099"" text=white background=""mainbg.jpg"" bgcolor=""#000066""");
  WebOutString("<body link=""#000099"" vlink=""#000099"" alink=""#000099"" text=""#000099"" bgcolor=""#F0F0FF""");
  if (nonblank(wfocusfield)) then begin
    WebOutString(" onload=""document.HansaForm." & wfocusfield & ".focus()""");
  end;
  WebOutString(">");
  WebOutNL;
  return;
end;  

global
procedure WebStartBodyText(string wfocusfield)
begin
  WebOutString("</head>");
  WebOutNL;
  WebOutString("<body link=white vlink=white alink=white text=""#000099"" bgcolor=""#3366FF""");//""#9AA8E7""");
  if (nonblank(wfocusfield)) then begin
    WebOutString(" onload=""document.HansaForm." & wfocusfield & ".focus()""");
  end;
  WebOutString(">");
  WebOutNL;
  return;
end;  

global
procedure ToolWebEndPage(Boolean hansalink)
begin
  if (hansalink and false) then begin
    WebOutString("<table border=""0"" cols=""1"" height=""70"" width=""100%"" cellspacing=""0"">");
    WebOutNL;
    WebOutString("<tr><td align=""right"" width=""100%"" height=""18"">");
    WebOutNL;
    WebOutString("<small><small><font color=""#000099"" face=""Verdana, Arial, Helvetica, sans-serif"">");
    WebOutNL;
    WebOutString("<A href=""http://www.hansaworld.com"">HansaWorld</A>");
    WebOutNL;
    WebOutString("</font></small></small></td></tr>");
    WebOutNL;
    WebOutString("</table>");
    WebOutNL;
  end;
  WebOutString("</body></html>");
  WebOutNL;
  return;
end;

global
procedure WebLabelFont()
begin
  WebOutString("<font SIZE=""2""color=""#000099""><strong>");
  return;
end;

global
procedure ToolWebStartHeader()
begin
//  WebOutString("<table background=""top.jpg"" border=0 bgcolor=#0000CC cellspacing=0 cellpadding=0 width=""100%"" height=""95"">");
  WebOutString("<table border=""0"" cellspacing=""0"" cellpadding=""0"" width=""100%"">");
  WebOutNL;
  return;
end;

global
procedure ToolWebStartHeaderText()
begin
  WebOutString("<table bgcolor=""#000099"" border=""1"" cellspacing=""0"" cellpadding=""1"" width=""100%"">");
  WebOutNL;
  return;
end;

global
procedure ToolWebStartHeaderEnd()
begin
  WebOutString("</table>");
  return;
end;

global
procedure WebLabelFontEnd()
begin
  WebOutString("</strong></font>");
  return;
end;

global
procedure ToolWebStartTable()
begin
  WebOutString("<p></p><table border=""0"" cellspacing=""0"" cellpadding=""1"">");
  WebOutNL;
  return;
end;

global
procedure ToolWebEndTable()
begin
  WebOutString("</table>");
  return;
end;

global
procedure ToolWebInfoCell(string weba,string wwidth,string thealign)
begin
  string 20 localign;

  localign = thealign;
  if (blank(localign)) then begin
    localign = "left";
  end;
  WebOutString("<td  width=""" & wwidth & """ align=""" & localign & """>");
  WebLabelFont;
  WebOutString(weba);
  WebLabelFontEnd;
  WebOutString("</td> ");
  return;
end;

global
procedure ToolWebListTable(Integer wcols,Integer wwidth,string bsize)
begin
  string 20 locwidth;
  string 5 thebsize;
  
  thebsize = bsize;
  if (blank(thebsize)) then begin
    thebsize = "1";
  end;
  locwidth = "100%";
  if (wwidth>0) then begin
    locwidth = wwidth;
  end;
  WebOutString("<table BORDER=""" & thebsize & """ cellpadding=""0"" cellspacing=""0"" bordercolorlight=black ");
  WebOutSTring("bordercolordark=black bordercolor=black COLS=""" & wcols & """ WIDTH=""" & locwidth & """ align=center>");
  WebOutNL;
  return;
end;

global
procedure ToolWebListTableEnd()
begin
  WebOutString("</table>");
  return;
end;

global
procedure WebStartNavBar()
begin
  WebOutString("<table border=""0"" WIDTH=""100%""><tr>"); // #9AA8E7
  return;
end;

global
procedure WebEndNavBar()
begin
  WebOutString("</tr></table>");
  return;
end;

global
procedure WebLink(string webname,string weblink,string webarg,string webtarget)
begin
  string 255 llink;
  
  WebOutString("<A href=""");
  llink = weblink & "?sessionid=" & WebGetArg("sessionid");
  if (nonblank(webarg)) then begin
    llink = llink & "&" & webarg;
  end;
  WebOutLink(llink);
  if (nonblank(webtarget)) then begin
    WebOutString(""" target=""" & webtarget & """>");  
  end else begin
    WebOutString(""">");  
  end;
  WebOutString("<font color=""#000099"" face=""Verdana, Arial, Helvetica, sans-serif"" size=""1"">");
  WebOutString(webname);
  WebOutString("</font");
  WebOutString("</A>");  
  WebOutNL;
  return;
end;

global
procedure ToolWebPictLink(string pictname,string pwidth,string pheight,string weblink,string webarg,string webtarget)
begin
  string 255 llink;

  if (nonblank(weblink)) then begin
    WebOutString("<A href=""");
    llink = weblink & "?sessionid=" & WebGetArg("sessionid");
    if (nonblank(webarg)) then begin
      llink = llink & "&" & webarg;
    end;
    WebOutLink(llink);
    if (nonblank(webtarget)) then begin
      WebOutString(""" target=""" & webtarget & """>");  
    end else begin
      WebOutString(""">");  
    end;
  end;
  WebOutString("<img src=""" & pictname & """ border=""0"" width=""" & pwidth & """ height=""" & pheight & """>");
  WebOutString("</A>");  
  WebOutNL;
  return;
end;

global
procedure ToolWebMenuItem(string webname,string weblink,string webarg,string webtarget,var Integer rwt)
begin
  string 255 llink;
  string 60 bgcolr;
  
  if (rwt!=0) then begin
    bgcolr = "#CCCCFF";
    rwt = 0;
  end else begin
    bgcolr = "#FFFFFF";
    rwt = 1;
  end;

//  tstr = "<td size=""2"" bordercolor=white align=""" & localign & """ bgcolor=" & bgcolr & " ";
  WebOutString("<TR><TD VALIGN=top width=""100%"" align=""left"" bgcolor=" & bgcolr & ">");
  WebOutNL;
  WebOutString("<font size=2 color=""#000099"" face=""Verdana, Arial, Helvetica, sans-serif""><strong><small><small>");
  WebOutString("<A href=""");
  llink = weblink & "?sessionid=" & WebGetArg("sessionid");
  if (nonblank(webarg)) then begin
    llink = llink & "&" & webarg;
  end;
  WebOutLink(llink);
  if (nonblank(webtarget)) then begin
    WebOutString(""" target=""" & webtarget & """>");  
  end else begin
    WebOutString(""">");  
  end;
  WebOutString(webname);
  WebOutNL;
  WebOutString("</A>");  
  WebOutString("</font>");
  WebOutString("</TD></TR>");  
  WebOutNL;
  return;
end;

global
procedure WebMenuItemNoSess(string webname,string weblink,string webarg)
begin
  string 255 llink;
  
  WebOutString("<TR><TD VALIGN=top width=""100%"" align=""left"">");
  WebOutString("<font size=2 color=""#000099"" face=""Verdana, Arial, Helvetica, sans-serif"">");
  WebOutString("<A href=""");
  llink = weblink;
  if (nonblank(webarg)) then begin
    llink = llink & "&" & webarg;
  end;
  WebOutLink(llink);
  WebOutString(""">");  
  WebOutString(webname);
  WebOutString("</A>");  
  WebOutString("</font>");
  WebOutString("</TD></TR>");  
  WebOutNL;
  return;
end;

global
procedure WebNavLink(string webname,string weblink,string webarg,string webtarget)
begin
  string 255 llink;

  WebOutString("<td border=1 width=""80"" bgcolor=""#C0C0C0"">");
  WebOutString("<strong><font size=1 color=""#000099"" face=""Verdana, Arial, Helvetica, sans-serif"">");

  if (nonblank(weblink)) then begin
    WebOutString("<A href=""");  
    llink = weblink & "?sessionid=" & WebGetArg("sessionid");
    if (nonblank(webarg)) then begin
      llink = llink & "&" & webarg;
    end;
    WebOutLink(llink);
    if (nonblank(webtarget)) then begin
      WebOutString(""" target=""" & webtarget & """>");  
    end else begin
      WebOutString(""">");  
    end;
  end;
  WebOutString(webname);
//  WebOutString("<img src=""" & pictname & """ border=""0"" width=""" & pwidth & """ height=""" & pheight & """>");
//  WebOutString("<input type=""button"" value=""" & webname & """ style=""font-family: Verdana; font-size: 8pt"">");
  if (nonblank(weblink)) then begin
    WebOutString("</A>");
  end;
  WebOutString("</font></strong></td>");

  return;
end;

global
procedure ToolWebTableHdr(string webname,string thealign,string webwidth)
begin
  string 20 localign;

  localign = thealign;
  if (blank(localign)) then begin
    localign = "left";
  end;
  WebOutString("<td width=""" & webwidth & """ bordercolor=white align=""" & thealign & """>");
  WebOutString("<font color=""#000099"" face=""Verdana, Arial, Helvetica, sans-serif"" size=""1"">");
  WebOutString("<b>" & webname & "</b>");
  WebOutString("</font>");
  WebOutString("</td>");
  return;
end;

global
procedure ToolWebTableData(string webname,string weblink,string webarg,string thealign,string thesize,string target,Integer rwt)
begin
  string 255 llink,tstr;
  string 20 bgcolr;
  string 20 localign;

  localign = thealign;
  if (blank(localign)) then begin
    localign = "left";
  end;
  if (rwt==1) then begin
    bgcolr = "#CCCCFF";
  end;
  if (rwt!=1) then begin
    bgcolr = "#FFFFFF";
  end;

  tstr = "<td size=""2"" bordercolor=white align=""" & localign & """ bgcolor=" & bgcolr & " ";
  if (nonblank(thesize)) then begin
    tstr = tstr & "width=""" & thesize & """";
  end;
  tstr = tstr & ">";
  WebOutString(tstr);
  WebOutString("<font color=""#000099"" face=""Verdana, Arial, Helvetica, sans-serif"" size=""1"">");
  if (nonblank(weblink)) then begin
//    tstr = "<a style=""font-family: verdana,sans-serif;color: rgb(0,0,255)""";
    tstr = "<a style=""font-family: Verdana,Arial,Helvetica,sans-serif;color: rgb(0,0,153)""";
    if (nonblank(target)) then begin
      tstr = tstr & " target =""" & target & """";
    end;
    tstr = tstr & " href=""";
    WebOutString(tstr);
    llink = weblink & "?sessionid=" & WebGetArg("sessionid");
    if (nonblank(webarg)) then begin
      llink = llink & "&" & webarg;
    end;
    WebOutLink(llink);
    WebOutString(""">");
  end;
  
  WebOutNL;
  
  if (webname=="READ") then begin
    WebOutSTring("<img src=""read.jpg"" border=""0"">");
    goto L55;
  end;
  if (webname=="UNREAD") then begin
    WebOutSTring("<img src=""unread.jpg"" border=""0"">");
    goto L55;
  end;
  
  if (nonblank(webname)) then begin
    WebOutString(webname);
  end else begin
    WebOutString("&nbsp;");
  end;

L55:;
  if (nonblank(weblink)) then begin
    WebOutString("</a>");
  end;
  WebOutString("</font>");
  WebOutString("</td>");
  return;
end;

global
procedure ToolWebOutHeaderBegin(string hstr)
begin
//  ToolWebLineStart;
// <A href=""http://www.hansaworld.com""> insert this into next line if You want clickable logo
//  WebOutString("<td width=160><img src=""Logo.gif"" border=""0""></A></td>");
//  WebOutNL;
//  ToolWebLineEnd;
//  WebOutNL;
  ToolWebLineStart;
  WebOutString("<td border=0>");
  WebOutNL;
  WebOutString("<font color=""#000099"" FACE=""Verdana, Arial, Helvetica, sans-serif"">");
  WebOutNL;
  WebOutString("<b><big>" & hstr & "</big></b>");
  WebOutNL;
  WebOutString("</font></td>");
  WebOutNL;
  ToolWebLineEnd;
  WebOutNL;
  return;
end;

global
procedure ToolWebOutHeaderEnd()
begin
  WebOutString("</table>");
  WebOutString("</td></tr>");
  WebOutNL;
  return;
end;

global
procedure ToolWebRadioButtonDiv(string webname,string varname,Integer ival,Boolean checked)
begin

  WebOutString("<div id=""" & varname & """><input type=""radio"" name=""" & varname & """");
  WebOutString(" value=""" & ival & """ ");
  if (checked) then begin
    WebOutString("checked ");
  end;
  WeboutString(">" & webname & "</div>");
  WebOutNL;
  return;
end;

global
procedure WebPlainText(string comment)
begin
  WebLabelFont;
  WebOutString(comment);
  WebLabelFontEnd;
  return;
end;

