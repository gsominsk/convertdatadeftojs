external procedure ToolWebHBSShopLine(string,string,string,string,Boolean);
external procedure ToolWebPushButton(string,string,string);
external procedure ToolWebHiddenField(string,string);
external procedure ToolWebHBSInfoCell(string,string,string);
external function Boolean LoggedInTest();
external function string 200 ToolWebReturnTheText(Integer);
external procedure ToolWebLineStart();
external procedure ToolWebLineEnd();
external procedure ToolWebHBSSetMainTitle();
external procedure ToolWebStartPage();
external procedure ToolWebHBSStartBody(string,string);
external procedure ToolWebEndPage(Boolean);
external procedure ToolWebStartTable();
external procedure ToolWebEndTable();
external procedure ToolWebHBSContactLine(string,string,string,Boolean);
external updating procedure ToolWebAddCounter(string);
//external procedure ToolWebFAQNewQuestion(string,LongInt,LongInt);
external procedure ToolWebFAQNewQuestionThanks(string,LongInt,LongInt);
external procedure ToolWebHBSPublicNews(string,LongInt);
external procedure ToolWebFAQDoNewQuest(string);
external procedure ToolWebFAQSearchResult(var string,string,string,string,string);
external Function Boolean ToolWebHBSPublicMain(string,LongInt,LongInt,Boolean,Boolean);
external Function Boolean CustHasEmail(string);
external procedure ToolWebHBSFirstPart();
external procedure ToolWebHBSSecondPart();
external procedure ToolWebHBSThirdPart();
external function Boolean LoggedInHBSTest();

/*
global
updating procedure WebHBSNewQuest()
begin
  ToolWebStartPage;
  ToolWebHBSSetMainTitle;
  ToolWebHBSStartBody("customercode","");
  ToolWebHBSFirstPart;
  ToolWebFAQNewQuestion("FAQNEWQUEST",-1,-1);
  ToolWebHBSThirdPart;
  ToolWebEndPage(false);
  return;
end;
*/
global
updating procedure WebHBSFAQDoNewQuest()
begin
  Boolean res;
  
  if (LoggedInHBSTest) then begin
    if (CustHasEmail(CurrentCust)==false) then begin
      res = ToolWebHBSPublicMain("WWWFAQNOEMAIL",-1,-1,false,false);
    end else begin
      res = ToolWebHBSPublicMain("WWWFAQHASEMAIL",-1,-1,false,false);
    end;
    ToolWebAddCounter("NEWQUEST");
    ToolWebStartPage;
    ToolWebHBSSetMainTitle;
    ToolWebHBSStartBody("from_field","");
    ToolWebFAQDoNewQuest(CurrentCust);
    ToolWebEndPage(false);
  end;
  return;
end;

global
updating procedure WebHBSNewQuestThanks()
begin
//  if (LoggedInHBSTest) then begin
    ToolWebStartPage;
    ToolWebHBSSetMainTitle;
    ToolWebHBSStartBody("","");
    ToolWebHBSFirstPart;
    ToolWebFAQNewQuestionThanks("WWWFAQQUESTTHANKS",-1,-1);
    ToolWebHiddenField("backpage","WebHBSNewQuestThanks.hal");
    ToolWebHBSThirdPart;
    ToolWebEndPage(false);
//  end;
  return;
end;

procedure WebShowSearchOption(string conftoshow)
begin
  string 200 comment;
  string 200 langstr;
  Boolean res;

  res = ToolWebHBSPublicMain(conftoshow,-1,-1,false,false);
  WebOutString("<form method=""post"" action=""");
  WebOutLink("WebHBSFAQSearch.hal?sessionid=" & WebGetArg("sessionid") & "&WEBPAGE=" & WebGetArg("WEBPAGE") &"&langcode=" & WebGetArg("langcode"));
  WebOutString(""">");
  WebOutNL;
  WebOutString("<table width=""100%""  border=""0"" cellspacing=""0"" cellpadding=""0"">");
  WebOutNL;
  ToolWebLineStart;
  WebOutString("<td class=""deftxt"">");
  WebOutString("<input type=""text"" name=""searchstr"" size=""40"">");
  WebOutString("</td>");
  WebOutNL;
  WebOutString("<td class=""deftxt"">");
  WebOutString("<input type=""submit"" name=""butt"" value=""Search"">");
  WebOutString("</td>");
  WebOutNL;
  ToolWebLineEnd;
  ToolWebEndTable;
  WebOutString("</form>");

  WebOutString("<p class=""deftxt"">");
  WebOutString("<a href=""");
  WebOutLink("WebHBSFAQSearch.hal?sessionid=" & WebGetArg("sessionid")  & WebGetArg("langcode") & "&searchstr=*" & "&WEBPAGE=" & WebGetArg("WEBPAGE") & "&langcode=");
  WebOutString(""">");
  WebOutString("Show all Questions");
  WebOutString("</a>");
  WebOutNL;
  WebOutString("</p>");
  WebOutNL;
  WebOutString("<p class=""deftxt"">");
  WebOutString("<a href=""");
  WebOutLink("WebHBSFAQDoNewQuest.hal?sessionid=" & WebGetArg("sessionid") & "&WEBPAGE=" & WebGetArg("WEBPAGE") & "&langcode=" & WebGetArg("langcode"));
  WebOutString(""">");
  WebOutString("Ask a New Question");
  WebOutString("</a>");
  WebOutNL;
  WebOutString("</p>");
  WebOutNL;
  ToolWebLineEnd;
  ToolWebEndTable;
  return;
end;

global
procedure WebHBSFAQ()
begin
  string 200 comment;
  string 200 langstr;
  Boolean res;
  
  if (LoggedInHBSTest) then begin
    langstr = WebGetArg("langcode");
    ToolWebStartPage;
    ToolWebHBSSetMainTitle;
    ToolWebHBSStartBody("","");
    WebShowSearchOption("WWWFAQBEFSEARCH");
    ToolWebEndPage(false);
  end;
  return;
end;

global
updating procedure WebHBSFAQSearch()
begin
  string 200 searchstr;
  
  if (LoggedInHBSTest) then begin
    searchstr = WebGetArg("searchstr");
    if (nonblank(searchstr)) then begin
      ToolWebAddCounter("FAQSEARCH");
      ToolWebStartPage;
      ToolWebHBSSetMainTitle;
      ToolWebHBSStartBody("","");
      WebShowSearchOption("WWWFAQBEFSEARCH2");
      WebOutString("<p>");
      WebOutString("<table width=""100%""  border=""0"" cellspacing=""0"" cellpadding=""0"">");
      WebOutNL;
      ToolWebFAQSearchResult(searchstr,WebGetArg("WEBPAGE"),WebGetArg("prod"),WebGetArg("langcode"),WebGetArg("where"));
      ToolWebEndTable;
      ToolWebEndPage(false);
    end else begin
      WebHBSFAQ;
    end;
  end;
  return;
end;

global
procedure WebHBSFAQHome()
begin
  Boolean res;
  
  if (LoggedInHBSTest) then begin
    ToolWebStartPage;
    ToolWebHBSSetMainTitle;
    ToolWebHBSStartBody("","");
    res = ToolWebHBSPublicMain("WWWFAQWELCOME",-1,-1,false,false);
    ToolWebEndPage(false);
  end;
  return;
end;

global
procedure WebHBSFAQLogin()
begin
  string 255 tstr;
  Integer oldcomp,newcomp;
  Boolean res,res1;

  if (WebLoginStatus==3) then begin
    WebHBSFAQHome;
  end else begin
    oldcomp = CurrentCompany;
    newcomp = StringToInt(WebGetArg("company"));
    if ((newcomp>0) and (oldcomp!=newcomp)) then begin
      res1 = SetCompany(newcomp,false);
    end;  
    ToolWebStartPage;
    ToolWebHBSSetMainTitle;
    ToolWebHBSStartBody("","");
    res = ToolWebHBSPublicMain("WWWFAQLOGIN",-1,-1,false,false);
    WebOutString("<form name=""HansaForm"" action=""dologin?company=" & WebGetArg("company") & "&failed=WebHBSFAQIndexFail.hal"" METHOD=""POST"" target=""_parent"">");
    ToolWebStartTable;
    if (nonblank(WebGetArg("failed_log_in"))) then begin
      ToolWebLineStart;
      ToolWebHBSInfoCell("","28%","left");
      ToolWebHBSInfoCell(ToolWebReturnTheText(20081),"72%","left");
      ToolWebLineEnd;
    end;
    ToolWebHBSContactLine(ToolWebReturnTheText(20051),"login",WebGetArg("login"),false);
    ToolWebHBSShopLine(ToolWebReturnTheText(20083),"passwd","password",WebGetArg("passwd"),false);
    ToolWebHiddenField("custpage","WebHBSFAQIndex.hal?langcode=" & WebGetArg("langcode"));
    ToolWebEndTable;
    ToolWebPushButton(ToolWebReturnTheText(20049),"submit","name");
    WebOutString("</form>");
    ToolWebEndPage(false);
    if (res1) then begin
      ResetCompany(oldcomp);
    end;
  end;
  return;
end;

procedure AddFAQCountryLink(string thetext,Integer company)
begin
  WebOutString("<p class=mnu-lvl-2>");
  WebOutString("<a href=""");
  WebOutLink("WebHBSFAQIndex.hal?sessionid=" & WebGetArg("sessionid") & "&company=" & company & "&langcode=" & WebGetArg("langcode"));
  WebOutString(""" target=""_parent"">");
  WebOutString(thetext);
  WebOutString("</a>");
  WebOutString("</p>");
  return;
end;

global
procedure WebHBSFAQChoose()
begin
  Boolean res;

  ToolWebStartPage;
  ToolWebHBSSetMainTitle;
  ToolWebHBSStartBody("","");
  res = ToolWebHBSPublicMain("FAQCOUNTRY",-1,-1,false,false);
  AddFAQCountryLink("Denmark",19);
  AddFAQCountryLink("Estonia",25);
//  AddFAQCountryLink("Estonia HansaRaama",74);
  AddFAQCountryLink("Finland",40);
  AddFAQCountryLink("Latvia",26);
  AddFAQCountryLink("Lithuania",28);
  AddFAQCountryLink("Norway",24);
  AddFAQCountryLink("Poland",36);
  AddFAQCountryLink("Russia",29);
  AddFAQCountryLink("South Africa",37);
  AddFAQCountryLink("Sweden",39);
  AddFAQCountryLink("United Kingdom",63);
  ToolWebEndPage(false);
  return;
end;

