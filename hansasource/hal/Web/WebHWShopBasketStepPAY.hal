external procedure FindCCAccountID(string,string,Integer,var record CCAccountIDVc,Integer);
external function Boolean FindStringInString(string,string);
external updating function Boolean BuildWebOrd2(string,LongInt,var record ORVc, var Boolean,string);
external function Boolean LoggedInHWTest();
external procedure ToolWebHWStartPage();
external procedure ToolWebHWEndPage();
external procedure ToolWebHWStartSecureBody();
external procedure ToolWebHiddenField(string,string); 
external Function Boolean WebHWPublicMain(string,LongInt,LongInt,Boolean,Boolean);
external function string 200 ToolWebReturnTheText(Integer);
external function string 200 GetWebLanguage();

function string 100 errorset(Integer err)
begin
  string 100 errstr;
  
  switch(err) begin
    case 1: errstr=ToolWebReturnTheText(20172);//Creditcard number may only contain numbers
    case 2: errstr=ToolWebReturnTheText(20173);//Creditcard number must be 16 characters long
    case 3: errstr=ToolWebReturnTheText(20174);//CVC number may only contain numbers
    case 4: errstr=ToolWebReturnTheText(20175);//CVC number must be 3 characters long
    case 5: errstr=ToolWebReturnTheText(20176);//Error in startdate entry
    case 6: errstr=ToolWebReturnTheText(20177);//Error in startdate, month must be 2 digits long
    case 7: errstr=ToolWebReturnTheText(20178);//Error in startdate, year must be 4 digits long
    case 8: errstr=ToolWebReturnTheText(20179);//Order has already been paid, please return to the Web Shop
    case 9: errstr=ToolWebReturnTheText(20180);//Payment failed due to technical reasons, please try again
  end;
  errorset = errstr;
  return;
end;

global
procedure ToolWebHWSpecialDisplayLine(string thetext,string thename,string thevalue,string extrainfo,LongInt tsize,LongInt maxchar,Boolean hidden)
begin
  WebOutString("<TR bgcolor=""#EEEEEE"">");
  WebOutNL;
  if (nonblank(extrainfo)) then begin
    WebOutString("<td class=""EditFieldHeader"" align=""left"">" & thetext & "</td>");
    WebOutString("<td class=""EditFieldHeader"" width=""10"" align=""left"">" & extrainfo & "</td>");
  end else begin
    WebOutString("<td class=""EditFieldHeader"" colspan=""2"" align=""left"">" & thetext & "</td>");
  end;
  if (hidden) then begin
    WebOutString("<TD class=""TableData"" align=""left"">&nbsp;" & thevalue); 
    WebOutNL;
    WebOutString("<INPUT autocomplete=""off"" type=hidden name=""" & thename & """ size=""" & tsize & """ value=""" & thevalue & """>");
    WebOutNL;
  end else begin
    WebOutString("<TD class=""TableData"">");
    WebOutNL;
    WebOutString("<INPUT autocomplete=""off"" name=""" & thename & """ size=""" & tsize & """ maxlength=""" & maxchar & """");
    if (nonblank(thevalue)) then begin
      WebOutString(" value=""" & thevalue & """");
    end;
    WebOutString(">");
    WebOutNL;
  end;
  WebOutString("</TD>");
  WebOutNL;
  WebOutString("</TR>");
  WebOutNL;
  return;
end;

global
procedure ToolWebHWDisplayErrorLine(Integer error,string errstr,string errorcode)
begin
  string 100 thestr;
  LongInt tl;
  Boolean techf;
  
  tl = StringToLongInt(errorcode);
  if (tl>0) then begin
    thestr = ToolWebReturnTheText(20181);//Transaction unsuccessful. Please use an alternative card.
  end else begin
    if (tl<0) then begin
      techf = false;
      if (error==10) then begin techf = true; end;
      if (techf==false) then begin
        techf = FindStringInString(errstr,"GUID");
      end;
      if (techf) then begin
        thestr = ToolWebReturnTheText(20182);//Payment failed due to technical reasons, please try again
      end else begin
        thestr = ToolWebReturnTheText(20183);//Please check your card details and try again
      end;
    end else begin
      thestr = errorset(error);
      if (nonblank(thestr) and nonblank(errstr)) then begin
        thestr = thestr & "<br>";
      end;
      thestr = thestr & errstr;
    end;
  end;
  WebOutString("<TR valign=""top"">");
  WebOutNL;
  WebOutString("<TD colspan=""3"" align=""center""><font size=3 color=""red"">" & thestr & "</font></TD>");
  WebOutNL;
  WebOutString("</TR>");
  WebOutNL;
  return;
end;

global
procedure CreateFormToPaySite(string halfunc,string webargs)
begin
  record WebControlBlock WCr;
  
  BlockLoad(WCr);
  WebOutString("<form name=""HansaForm"" method=""POST"" action=""");
  if (nonblank(WCr.ToPaySSLURL)) then begin
    WebOutString(WCr.ToPaySSLURL);
    if (right(WCr.ToPaySSLURL,1)!="/") then begin
      WebOutString("/");
    end;
  end;
  WebOutLink(halfunc & "?sessionid=" & WebGetArg("sessionid") & "&" & webargs);
  WebOutString(""" target=""_parent"">");
  return;
end;

global
procedure CreateLinkFromPaySite(string thetext)
begin
  record WebControlBlock WCr;
  string 200 nexturl;
  string 255 frompayurl;
  
  BlockLoad(WCr);
  frompayurl = "http://" & WebHost; //WCr.FromPaySSLURL
  if (nonblank(frompayurl)) then begin
    nexturl = frompayurl;
    if (right(frompayurl,1)!="/") then begin
      nexturl = nexturl & "/";
    end;
    WebOutString("<a href=""" & nexturl);
    if (WCr.FromPayNoSession==0) then begin 
      WebOutLink("?sessionid=" & WebGetArg("sessionid"));
    end;
    WebOutString(""" target=""_parent""><b>" & thetext & "</b></a>");
  end;
  return;
end;

global
updating procedure WebHWShopBasketStepPAY(Integer error,string errstr,string errorcode)
begin
  record INVC INr;
  record ORVc ORr;
  row ORVc ORrw;
  record CUVc CUr;
  record DMVc DMr;
  record DelAddrVc DelAddrr;
  record CredCardTypeVc CCTr;
  string 10 defdelmodcode;
  string 60 defdelmod;
  Boolean foundf,testf;
  Boolean res,proceedf,freight;
  LongInt rwcnt;
  integer i,rwt;
  string 60 tstr;
  record CCAccountIDVc CCAccountIDr;  

  proceedf = false;
  if (LoggedInHWTest()) then begin
    CUr.Code = CurrentCust;
    if (ReadFirstMain(CUr,1,true)==false) then begin
      CUr.Name = "";
    end;
    res = BuildWebOrd2(CurrentCust,-1,ORr,freight,GetWebLanguage);
    rwcnt = MatRowCnt(ORr);
    if (rwcnt>0) then begin proceedf = true; end;

    ToolWebHWStartPage;
    ToolWebHWStartSecureBody;
  
    WebOutString("<BODY onload=""document.HansaForm.ccnumber.focus()"">");
    WebOutString("<script language=""JavaScript"">");
    WebOutNL;
    WebOutString("<!--");
    WebOutNL;
    WebOutString("function MM_openBrWindow(theURL,winName,features) { //v2.0");
    WebOutNL;
    WebOutString("  window.open(theURL,'',features);");
    WebOutNL;
    WebOutString("}");
    WebOutNL;
    WebOutString("//-->");
    WebOutNL;
    WebOutString("</script>");
    WebOutNL;
    WebOutString("<table width=""633"" border=""0"" align=""center"" cellpadding=""0"" cellspacing=""0"">");
    WebOutString("<tr> ");
    WebOutString("<td>");
    WebOutString("<TABLE border=""0""  align=""center"" cellPadding=""2"" cellSpacing=""4"" width=""595"">");
  
    WebOutString("<form name=""HansaForm"" method=""POST"" action=""");
    WebOutLink("WebHWSendPayment.hal?sessionid=" & WebGetArg("sessionid"));
    WebOutString(""">");
  
    WebOutString("<tr><td colspan=""3"" align=""center""><h1>Credit Card Payment</h1></td></tr>");
    if ((error>0) or (nonblank(errorcode)) or (nonblank(errstr))) then begin
      ToolWebHWDisplayErrorLine(error,errstr,errorcode);
    end;
    ToolWebHWSpecialDisplayLine("Payment reference number:","orderid",ORr.CustOrdNr,"",30,0,true);
    tstr = ORr.CurncyCode & " ";
    tstr = tstr & ORr.Sum4;
    ToolWebHWSpecialDisplayLine("&nbsp;Amount to pay:","payval",tstr,"",30,0,true);
    ToolWebHiddenField("currency",ORr.CurncyCode);
    ToolWebHiddenField("amount",ORr.Sum4); 
//    ToolWebHiddenField("deladdr",WebGetArg("deladdr"));//causes problems on Credit card payment page. What problems?
    ToolWebHiddenField("delmode",WebGetArg("delmode"));
    ToolWebHiddenField("custref",WebGetArg("custref"));
    WebOutString("<TR><TD colspan=""3""><hr></TD></TR>");
    
//    WebOutString("<TR>");
    WebOutString("<TR bgcolor=""#EEEEEE"">");
    WebOutString("<TD class=""EditFieldHeader"" width=""160"">&nbsp;Payment with:</TD>");
    WebOutString("<TD class=""EditFieldHeader"" width=""10"">M</TD>");
    WebOutString("<TD>");

    WebOutString("<SELECT NAME=""CreditCardType"" TABINDEX=-1"">");
    CCTr.Code = "";
    foundf = true;
    while (LoopMain(CCTr,1,foundf)) begin
      testf = foundf;
      if (blank(CCTr.Code)) then begin testf = false; end;
      if (blank(CCTr.Comment)) then begin testf = false; end;
      if (CCTr.UseOnWeb==0) then begin testf = false; end;
      if (testf) then begin
        WebOutString("<OPTION VALUE=""" & CCTr.Code & """>" & CCTr.Comment & "</OPTION>");
      end;
    end;
    WebOutString("</SELECT>");
    WebOutString("</TD>");
    WebOutString("</TR>");

    ToolWebHWSpecialDisplayLine("&nbsp;Credit card number:","ccnumber","","M",22,19,false);

    WebOutString("<TR bgcolor=""#EEEEEE"">");
    WebOutString("<TD class=""EditFieldHeader"">&nbsp;Credit card expiry date (MM/YYYY)</TD>");
    WebOutString("<TD class=""EditFieldHeader"">M</TD>");
    WebOutString("<TD class=""TableData"">");
    WebOutString("  <SELECT name=""ExpirationMonth"">");
    WebOutString("    <OPTION VALUE=""01"">01</OPTION>");
    WebOutString("    <OPTION VALUE=""02"">02</OPTION>");
    WebOutString("    <OPTION VALUE=""03"">03</OPTION>");
    WebOutString("    <OPTION VALUE=""04"">04</OPTION>");
    WebOutString("    <OPTION VALUE=""05"">05</OPTION>");
    WebOutString("    <OPTION VALUE=""06"">06</OPTION>");
    WebOutString("    <OPTION VALUE=""07"">07</OPTION>");
    WebOutString("    <OPTION VALUE=""08"">08</OPTION>");
    WebOutString("    <OPTION VALUE=""09"">09</OPTION>");
    WebOutString("    <OPTION VALUE=""10"">10</OPTION>");
    WebOutString("    <OPTION VALUE=""11"">11</OPTION>");
    WebOutString("    <OPTION VALUE=""12"">12</OPTION>");
    WebOutString("  </SELECT>");
    WebOutString("<SELECT name=""ExpirationYear"">");
    WebOutString("    <OPTION VALUE=""2007"">2007</OPTION>");
    WebOutString("    <OPTION VALUE=""2008"">2008</OPTION>");
    WebOutString("    <OPTION VALUE=""2009"">2009</OPTION>");
    WebOutString("    <OPTION VALUE=""2010"">2010</OPTION>");
    WebOutString("    <OPTION VALUE=""2011"">2011</OPTION>");
    WebOutString("    <OPTION VALUE=""2012"">2012</OPTION>");
    WebOutString("    <OPTION VALUE=""2013"">2013</OPTION>");
    WebOutString("    <OPTION VALUE=""2014"">2014</OPTION>");
    WebOutString("    <OPTION VALUE=""2015"">2015</OPTION>");
    WebOutString("    <OPTION VALUE=""2016"">2016</OPTION>");
    WebOutString("    <OPTION VALUE=""2017"">2017</OPTION>");
    WebOutString("    <OPTION VALUE=""2018"">2018</OPTION>");
    WebOutString("    <OPTION VALUE=""2019"">2019</OPTION>");
    WebOutString("    <OPTION VALUE=""2020"">2020</OPTION>");
    WebOutString("    <OPTION VALUE=""2021"">2021</OPTION>");
    WebOutString("    <OPTION VALUE=""2022"">2022</OPTION>");
    WebOutString("    <OPTION VALUE=""2023"">2023</OPTION>");
    WebOutString("    <OPTION VALUE=""2024"">2024</OPTION>");
    WebOutString("    <OPTION VALUE=""2025"">2025</OPTION>");
    WebOutString("    <OPTION VALUE=""2026"">2026</OPTION>");
    WebOutString("    <OPTION VALUE=""2027"">2027</OPTION>");
    WebOutString("    <OPTION VALUE=""2028"">2028</OPTION>");
    WebOutString("    <OPTION VALUE=""2029"">2029</OPTION>");
    WebOutString("</SELECT>");
    WebOutString("</TD>");
    WebOutString("</TR>");
    ToolWebHWSpecialDisplayLine("&nbsp;Card Verification Code","cvcsecurity","","M",6,4,false);

    WebOutString("<TR bgcolor=""#EEEEEE"">");
    WebOutString("  <TD class=""EditFieldHeader"">&nbsp;Credit card start date (MM/YYYY)</TD>");
    WebOutString("  <TD class=""EditFieldHeader"">S</TD>");
    WebOutString("  <TD class=""TableData""><INPUT autocomplete=""off"" name=""amexstartmonth"" size=""4"" maxlength=""2"""">");
    WebOutString("  <INPUT autocomplete=""off"" name=""amexstartyear"" size=""6"" maxlength=""4""""></TD>");
    WebOutString("</TR>");
    ToolWebHWSpecialDisplayLine("&nbsp;Issue Number","issuenumber","","I",6,2,false);
    FindCCAccountID(ORr.CurncyCode,"",1,CCAccountIDr,kCardHolderNotPresent);
    if (CCAccountIDr.TestAddress!=0) then begin
      ToolWebHWSpecialDisplayLine("&nbsp;Address 1","ccaddr1","","M",50,50,false);
      ToolWebHWSpecialDisplayLine("&nbsp;Address 2","ccaddr2","","O",50,50,false);
      ToolWebHWSpecialDisplayLine("&nbsp;Address 3","ccaddr3","","O",50,50,false);
      ToolWebHWSpecialDisplayLine("&nbsp;Address 4","ccaddr4","","O",50,50,false);
      ToolWebHWSpecialDisplayLine("&nbsp;Post Code","ccaddr6","","M",10,10,false);
//      ToolWebHWSpecialDisplayLine("&nbsp;Country","cccountry","","M",10,10,false);
      

      WebOutString("<TR bgcolor=""#EEEEEE"">");
      WebOutString("<TD class=""EditFieldHeader"">&nbsp;Country</TD>");
      WebOutString("<TD class=""EditFieldHeader"">M</TD>");
      WebOutString("<TD class=""TableData"">");
      WebOutString("<SELECT name=""cccountry"">");
      WebOutString("    <OPTION VALUE=""AF"">Afghanistan</OPTION>");
      WebOutString("    <OPTION VALUE=""AL"">Albania</OPTION>");
      WebOutString("    <OPTION VALUE=""DZ"">Algeria</OPTION>");
      WebOutString("    <OPTION VALUE=""AS"">American Samoa (US)</OPTION>");
      WebOutString("    <OPTION VALUE=""AD"">Andorra</OPTION>");
      WebOutString("    <OPTION VALUE=""AO"">Angola</OPTION>");
      WebOutString("    <OPTION VALUE=""AI"">Anguilla (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""AG"">Antigua and Barbuda</OPTION>");
      WebOutString("    <OPTION VALUE=""AR"">Argentina</OPTION>");
      WebOutString("    <OPTION VALUE=""AM"">Armenia</OPTION>");
      WebOutString("    <OPTION VALUE=""AW"">Aruba</OPTION>");
      WebOutString("    <OPTION VALUE=""AU"">Australia</OPTION>");
      WebOutString("    <OPTION VALUE=""AT"">Austria</OPTION>");
      WebOutString("    <OPTION VALUE=""AZ"">Azerbaijan</OPTION>");
      WebOutString("    <OPTION VALUE=""BS"">Bahamas</OPTION>");
      WebOutString("    <OPTION VALUE=""BH"">Bahrain</OPTION>");
      WebOutString("    <OPTION VALUE=""BD"">Bangladesh</OPTION>");
      WebOutString("    <OPTION VALUE=""BB"">Barbados</OPTION>");
      WebOutString("    <OPTION VALUE=""BY"">Belarus</OPTION>");
      WebOutString("    <OPTION VALUE=""BE"">Belgium</OPTION>");
      WebOutString("    <OPTION VALUE=""BZ"">Belize</OPTION>");
      WebOutString("    <OPTION VALUE=""BJ"">Benin</OPTION>");
      WebOutString("    <OPTION VALUE=""BM"">Bermuda (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""BT"">Bhutan</OPTION>");
      WebOutString("    <OPTION VALUE=""BO"">Bolivia</OPTION>");
      WebOutString("    <OPTION VALUE=""BA"">Bosnia and Herzegovina</OPTION>");
      WebOutString("    <OPTION VALUE=""BW"">Botswana</OPTION>");
      WebOutString("    <OPTION VALUE=""BR"">Brazil</OPTION>");
      WebOutString("    <OPTION VALUE=""VG"">British Virgin Islands (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""BN"">Brunei Darussalam</OPTION>");
      WebOutString("    <OPTION VALUE=""BG"">Bulgaria</OPTION>");
      WebOutString("    <OPTION VALUE=""BF"">Burkina Faso</OPTION>");
      WebOutString("    <OPTION VALUE=""BI"">Burundi</OPTION>");
      WebOutString("    <OPTION VALUE=""KH"">Cambodia</OPTION>");
      WebOutString("    <OPTION VALUE=""CM"">Cameroon</OPTION>");
      WebOutString("    <OPTION VALUE=""CA"">Canada</OPTION>");
      WebOutString("    <OPTION VALUE=""CV"">Cape Verde</OPTION>");
      WebOutString("    <OPTION VALUE=""KY"">Cayman Islands (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""CF"">Central African Republic</OPTION>");
      WebOutString("    <OPTION VALUE=""TD"">Chad</OPTION>");
      WebOutString("    <OPTION VALUE=""CL"">Chile</OPTION>");
      WebOutString("    <OPTION VALUE=""CN"">China</OPTION>");
      WebOutString("    <OPTION VALUE=""CX"">Christmas Island (AU)</OPTION>");
      WebOutString("    <OPTION VALUE=""CC"">Cocos (Keeling) Islands (AU)</OPTION>");
      WebOutString("    <OPTION VALUE=""CO"">Colombia</OPTION>");
      WebOutString("    <OPTION VALUE=""KM"">Comoros</OPTION>");
      WebOutString("    <OPTION VALUE=""CD"">Congo, Democratic Republic of the</OPTION>");
      WebOutString("    <OPTION VALUE=""CG"">Congo, Republic of the</OPTION>");
      WebOutString("    <OPTION VALUE=""CK"">Cook Islands (NZ)</OPTION>");
      WebOutString("    <OPTION VALUE=""CR"">Costa Rica</OPTION>");
      WebOutString("    <OPTION VALUE=""CI"">Cote D'Ivoire</OPTION>");
      WebOutString("    <OPTION VALUE=""HR"">Croatia</OPTION>");
      WebOutString("    <OPTION VALUE=""CU"">Cuba</OPTION>");
      WebOutString("    <OPTION VALUE=""CY"">Cyprus</OPTION>");
      WebOutString("    <OPTION VALUE=""CZ"">Czech Republic</OPTION>");
      WebOutString("    <OPTION VALUE=""DK"">Denmark</OPTION>");
      WebOutString("    <OPTION VALUE=""DJ"">Djibouti</OPTION>");
      WebOutString("    <OPTION VALUE=""DM"">Dominica</OPTION>");
      WebOutString("    <OPTION VALUE=""DO"">Dominican Republic</OPTION>");
      WebOutString("    <OPTION VALUE=""EC"">Ecuador</OPTION>");
      WebOutString("    <OPTION VALUE=""EG"">Egypt</OPTION>");
      WebOutString("    <OPTION VALUE=""SV"">El Salvador</OPTION>");
      WebOutString("    <OPTION VALUE=""GQ"">Equatorial Guinea</OPTION>");
      WebOutString("    <OPTION VALUE=""ER"">Eritrea</OPTION>");
      WebOutString("    <OPTION VALUE=""EE"">Estonia</OPTION>");
      WebOutString("    <OPTION VALUE=""ET"">Ethiopia</OPTION>");
      WebOutString("    <OPTION VALUE=""FK"">Falkland Islands (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""FO"">Faroe Islands (DK)</OPTION>");
      WebOutString("    <OPTION VALUE=""FJ"">Fiji</OPTION>");
      WebOutString("    <OPTION VALUE=""FI"">Finland</OPTION>");
      WebOutString("    <OPTION VALUE=""FR"">France</OPTION>");
      WebOutString("    <OPTION VALUE=""GF"">French Guiana (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""PF"">French Polynesia (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""GA"">Gabon</OPTION>");
      WebOutString("    <OPTION VALUE=""GM"">Gambia</OPTION>");
      WebOutString("    <OPTION VALUE=""GE"">Georgia</OPTION>");
      WebOutString("    <OPTION VALUE=""DE"">Germany</OPTION>");
      WebOutString("    <OPTION VALUE=""GH"">Ghana</OPTION>");
      WebOutString("    <OPTION VALUE=""GI"">Gibraltar (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""GR"">Greece</OPTION>");
      WebOutString("    <OPTION VALUE=""GL"">Greenland (DK)</OPTION>");
      WebOutString("    <OPTION VALUE=""GD"">Grenada</OPTION>");
      WebOutString("    <OPTION VALUE=""GP"">Guadeloupe (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""GU"">Guam (US)</OPTION>");
      WebOutString("    <OPTION VALUE=""GT"">Guatemala</OPTION>");
      WebOutString("    <OPTION VALUE=""GN"">Guinea</OPTION>");
      WebOutString("    <OPTION VALUE=""GW"">Guinea-Bissau</OPTION>");
      WebOutString("    <OPTION VALUE=""GY"">Guyana</OPTION>");
      WebOutString("    <OPTION VALUE=""HT"">Haiti</OPTION>");
      WebOutString("    <OPTION VALUE=""VA"">Holy See (Vatican City)</OPTION>");
      WebOutString("    <OPTION VALUE=""HN"">Honduras</OPTION>");
      WebOutString("    <OPTION VALUE=""HK"">Hong Kong (CN)</OPTION>");
      WebOutString("    <OPTION VALUE=""HU"">Hungary</OPTION>");
      WebOutString("    <OPTION VALUE=""IS"">Iceland</OPTION>");
      WebOutString("    <OPTION VALUE=""IN"">India</OPTION>");
      WebOutString("    <OPTION VALUE=""ID"">Indonesia</OPTION>");
      WebOutString("    <OPTION VALUE=""IR"">Iran</OPTION>");
      WebOutString("    <OPTION VALUE=""IQ"">Iraq</OPTION>");
      WebOutString("    <OPTION VALUE=""IE"">Ireland</OPTION>");
      WebOutString("    <OPTION VALUE=""IL"">Israel</OPTION>");
      WebOutString("    <OPTION VALUE=""IT"">Italy</OPTION>");
      WebOutString("    <OPTION VALUE=""JM"">Jamaica</OPTION>");
      WebOutString("    <OPTION VALUE=""JP"">Japan</OPTION>");
      WebOutString("    <OPTION VALUE=""JO"">Jordan</OPTION>");
      WebOutString("    <OPTION VALUE=""KZ"">Kazakhstan</OPTION>");
      WebOutString("    <OPTION VALUE=""KE"">Kenya</OPTION>");
      WebOutString("    <OPTION VALUE=""KI"">Kiribati</OPTION>");
      WebOutString("    <OPTION VALUE=""KP"">Korea, Democratic People's Republic (North)</OPTION>");
      WebOutString("    <OPTION VALUE=""KR"">Korea, Republic of (South)</OPTION>");
      WebOutString("    <OPTION VALUE=""KW"">Kuwait</OPTION>");
      WebOutString("    <OPTION VALUE=""KG"">Kyrgyzstan</OPTION>");
      WebOutString("    <OPTION VALUE=""LA"">Laos</OPTION>");
      WebOutString("    <OPTION VALUE=""LV"">Latvia</OPTION>");
      WebOutString("    <OPTION VALUE=""LB"">Lebanon</OPTION>");
      WebOutString("    <OPTION VALUE=""LS"">Lesotho</OPTION>");
      WebOutString("    <OPTION VALUE=""LR"">Liberia</OPTION>");
      WebOutString("    <OPTION VALUE=""LY"">Libya</OPTION>");
      WebOutString("    <OPTION VALUE=""LI"">Liechtenstein</OPTION>");
      WebOutString("    <OPTION VALUE=""LT"">Lithuania</OPTION>");
      WebOutString("    <OPTION VALUE=""LU"">Luxembourg</OPTION>");
      WebOutString("    <OPTION VALUE=""MO"">Macau (CN)</OPTION>");
      WebOutString("    <OPTION VALUE=""MK"">Macedonia</OPTION>");
      WebOutString("    <OPTION VALUE=""MG"">Madagascar</OPTION>");
      WebOutString("    <OPTION VALUE=""MW"">Malawi</OPTION>");
      WebOutString("    <OPTION VALUE=""MY"">Malaysia</OPTION>");
      WebOutString("    <OPTION VALUE=""MV"">Maldives</OPTION>");
      WebOutString("    <OPTION VALUE=""ML"">Mali</OPTION>");
      WebOutString("    <OPTION VALUE=""MT"">Malta</OPTION>");
      WebOutString("    <OPTION VALUE=""MH"">Marshall Islands</OPTION>");
      WebOutString("    <OPTION VALUE=""MQ"">Martinique (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""MR"">Mauritania</OPTION>");
      WebOutString("    <OPTION VALUE=""MU"">Mauritius</OPTION>");
      WebOutString("    <OPTION VALUE=""YT"">Mayotte (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""MX"">Mexico</OPTION>");
      WebOutString("    <OPTION VALUE=""FM"">Micronesia, Federated States of</OPTION>");
      WebOutString("    <OPTION VALUE=""MD"">Moldova Republic of</OPTION>");
      WebOutString("    <OPTION VALUE=""MC"">Monaco</OPTION>");
      WebOutString("    <OPTION VALUE=""MN"">Mongolia</OPTION>");
      WebOutString("    <OPTION VALUE=""MS"">Montserrat (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""MA"">Morocco</OPTION>");
      WebOutString("    <OPTION VALUE=""MZ"">Mozambique</OPTION>");
      WebOutString("    <OPTION VALUE=""MM"">Myanmar</OPTION>");
      WebOutString("    <OPTION VALUE=""NA"">Namibia</OPTION>");
      WebOutString("    <OPTION VALUE=""NR"">Nauru</OPTION>");
      WebOutString("    <OPTION VALUE=""NP"">Nepal</OPTION>");
      WebOutString("    <OPTION VALUE=""AN"">Netherlands Antilles (NL)</OPTION>");
      WebOutString("    <OPTION VALUE=""NL"">Netherlands</OPTION>");
      WebOutString("    <OPTION VALUE=""NC"">New Caledonia (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""NZ"">New Zealand</OPTION>");
      WebOutString("    <OPTION VALUE=""NI"">Nicaragua</OPTION>");
      WebOutString("    <OPTION VALUE=""NE"">Niger</OPTION>");
      WebOutString("    <OPTION VALUE=""NG"">Nigeria</OPTION>");
      WebOutString("    <OPTION VALUE=""NU"">Niue</OPTION>");
      WebOutString("    <OPTION VALUE=""NF"">Norfolk Island (AU)</OPTION>");
      WebOutString("    <OPTION VALUE=""MP"">Northern Mariana Islands (US)</OPTION>");
      WebOutString("    <OPTION VALUE=""NO"">Norway</OPTION>");
      WebOutString("    <OPTION VALUE=""OM"">Oman</OPTION>");
      WebOutString("    <OPTION VALUE=""PK"">Pakistan</OPTION>");
      WebOutString("    <OPTION VALUE=""PW"">Palau</OPTION>");
      WebOutString("    <OPTION VALUE=""PA"">Panama</OPTION>");
      WebOutString("    <OPTION VALUE=""PG"">Papua New Guinea</OPTION>");
      WebOutString("    <OPTION VALUE=""PY"">Paraguay</OPTION>");
      WebOutString("    <OPTION VALUE=""PE"">Peru</OPTION>");
      WebOutString("    <OPTION VALUE=""PH"">Philippines</OPTION>");
      WebOutString("    <OPTION VALUE=""PN"">Pitcairn Islands (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""PL"">Poland</OPTION>");
      WebOutString("    <OPTION VALUE=""PT"">Portugal</OPTION>");
      WebOutString("    <OPTION VALUE=""PR"">Puerto Rico (US)</OPTION>");
      WebOutString("    <OPTION VALUE=""QA"">Qatar</OPTION>");
      WebOutString("    <OPTION VALUE=""RE"">Reunion (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""RO"">Romania</OPTION>");
      WebOutString("    <OPTION VALUE=""RU"">Russia</OPTION>");
      WebOutString("    <OPTION VALUE=""RW"">Rwanda</OPTION>");
      WebOutString("    <OPTION VALUE=""SH"">Saint Helena (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""KN"">Saint Kitts and Nevis</OPTION>");
      WebOutString("    <OPTION VALUE=""LC"">Saint Lucia</OPTION>");
      WebOutString("    <OPTION VALUE=""PM"">Saint Pierre & Miquelon (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""VC"">Saint Vincent and the Grenadines</OPTION>");
      WebOutString("    <OPTION VALUE=""WS"">Samoa</OPTION>");
      WebOutString("    <OPTION VALUE=""SM"">San Marino</OPTION>");
      WebOutString("    <OPTION VALUE=""ST"">Sao Tome and Principe</OPTION>");
      WebOutString("    <OPTION VALUE=""SA"">Saudi Arabia</OPTION>");
      WebOutString("    <OPTION VALUE=""SN"">Senegal</OPTION>");
      WebOutString("    <OPTION VALUE=""CS"">Serbia and Montenegro</OPTION>");
      WebOutString("    <OPTION VALUE=""SC"">Seychelles</OPTION>");
      WebOutString("    <OPTION VALUE=""SL"">Sierra Leone</OPTION>");
      WebOutString("    <OPTION VALUE=""SG"">Singapore</OPTION>");
      WebOutString("    <OPTION VALUE=""SK"">Slovakia</OPTION>");
      WebOutString("    <OPTION VALUE=""SI"">Slovenia</OPTION>");
      WebOutString("    <OPTION VALUE=""SB"">Solomon Islands</OPTION>");
      WebOutString("    <OPTION VALUE=""SO"">Somalia</OPTION>");
      WebOutString("    <OPTION VALUE=""ZA"">South Africa</OPTION>");
      WebOutString("    <OPTION VALUE=""GS"">South Georgia & South Sandwich Islands (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""ES"">Spain</OPTION>");
      WebOutString("    <OPTION VALUE=""LK"">Sri Lanka</OPTION>");
      WebOutString("    <OPTION VALUE=""SD"">Sudan</OPTION>");
      WebOutString("    <OPTION VALUE=""SR"">Suriname</OPTION>");
      WebOutString("    <OPTION VALUE=""SZ"">Swaziland</OPTION>");
      WebOutString("    <OPTION VALUE=""SE"">Sweden</OPTION>");
      WebOutString("    <OPTION VALUE=""CH"">Switzerland</OPTION>");
      WebOutString("    <OPTION VALUE=""SY"">Syria</OPTION>");
      WebOutString("    <OPTION VALUE=""TW"">Taiwan</OPTION>");
      WebOutString("    <OPTION VALUE=""TJ"">Tajikistan</OPTION>");
      WebOutString("    <OPTION VALUE=""TZ"">Tanzania</OPTION>");
      WebOutString("    <OPTION VALUE=""TH"">Thailand</OPTION>");
      WebOutString("    <OPTION VALUE=""TL"">Timor-Leste</OPTION>");
      WebOutString("    <OPTION VALUE=""TG"">Togo</OPTION>");
      WebOutString("    <OPTION VALUE=""TK"">Tokelau</OPTION>");
      WebOutString("    <OPTION VALUE=""TO"">Tonga</OPTION>");
      WebOutString("    <OPTION VALUE=""TT"">Trinidad and Tobago</OPTION>");
      WebOutString("    <OPTION VALUE=""TN"">Tunisia</OPTION>");
      WebOutString("    <OPTION VALUE=""TR"">Turkey</OPTION>");
      WebOutString("    <OPTION VALUE=""TM"">Turkmenistan</OPTION>");
      WebOutString("    <OPTION VALUE=""TC"">Turks and Caicos Islands (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""TV"">Tuvalu</OPTION>");
      WebOutString("    <OPTION VALUE=""UG"">Uganda</OPTION>");
      WebOutString("    <OPTION VALUE=""UA"">Ukraine</OPTION>");
      WebOutString("    <OPTION VALUE=""AE"">United Arab Emirates</OPTION>");
      WebOutString("    <OPTION VALUE=""GB"">United Kingdom</OPTION>");
      WebOutString("    <OPTION VALUE=""US"">United States</OPTION>");
      WebOutString("    <OPTION VALUE=""UY"">Uruguay</OPTION>");
      WebOutString("    <OPTION VALUE=""UZ"">Uzbekistan</OPTION>");
      WebOutString("    <OPTION VALUE=""VU"">Vanuatu</OPTION>");
      WebOutString("    <OPTION VALUE=""VE"">Venezuela</OPTION>");
      WebOutString("    <OPTION VALUE=""VN"">Vietnam</OPTION>");
      WebOutString("    <OPTION VALUE=""VI"">Virgin Islands (US)</OPTION>");
      WebOutString("    <OPTION VALUE=""WF"">Wallis and Futuna (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""EH"">Western Sahara</OPTION>");
      WebOutString("    <OPTION VALUE=""YE"">Yemen</OPTION>");
      WebOutString("    <OPTION VALUE=""ZM"">Zambia</OPTION>");
      WebOutString("    <OPTION VALUE=""ZW"">Zimbabwe</OPTION>");
      WebOutString("</SELECT>");
      WebOutString("</TD>");
      WebOutString("</TR>");
    end;

    WebOutString("<TR bgcolor=""#EEEEEE"">");
    WebOutString("<TD colspan=""3"" class=""Normal""><a href=""Javascript:void(0)"" onClick=""MM_openBrWindow('./CreditCardPayment.html','Item view','scrollbars=no,rezisable=yes,width=550,height=610')"">What is Card Verification Code?</a></TD>");
    WebOutString("</TR>");
    WebOutString("<TR bgcolor=""#EEEEEE"">");
    WebOutString("<TD colspan=""3"" class=""Normal"">M = Mandatory field</TD>");
    WebOutString("</TR>");
    WebOutString("<TR bgcolor=""#EEEEEE"">");
    WebOutString("<TD colspan=""3"" class=""Normal"">S = For AMEX, Maestro and Solo</TD>");
    WebOutString("</TR>");
    WebOutString("<TR bgcolor=""#EEEEEE"">");
    WebOutString("<TD colspan=""3"" class=""Normal"">I = Required by some Switch, Solo and Laser cards</TD>");
    WebOutString("</TR>");
    WebOutString("<TR>");
    WebOutString("<TD align=""center"" colSpan=""3""><br><b>The payment will be authorised online. This process may take up to 60 seconds.</b><br><br></TD>");
    WebOutString("</TR>");
    WebOutString("<TR>");
    WebOutString("<TD colspan=""3"" align=""center"">");
    WebOutString("<INPUT autocomplete=""off"" onmouseout=""self.status=''; return true"" onmouseover=""self.status='Confirm'; return true"" name=""submit"" type=""submit"" value=""Submit"">");
    WebOutString("<IMG alt="""" border=""0"" height=""1"" src=""pics/spacer.gif"" width=""1"">");

    WebOutString("<br><br><br>");
    CreateLinkFromPaySite("Back to the Web Shop");

    WebOutString("</TD>");
    WebOutString("</TR>");
    WebOutString("</FORM>");
    WebOutString("</TABLE>");
    WebOutString("&nbsp;</td>");
    WebOutString("</tr>");
    WebOutString("</table>");
    ToolWebHWEndPage;
  end;
  return;
end;

//WNS:begin
global
updating procedure WebHBSDivShopBasketStepPAY(Integer error,string errstr,string errorcode,string langcode)
begin
  record INVC INr;
  record ORVc ORr;
  row ORVc ORrw;
  record CUVc CUr;
  record DMVc DMr;
  record DelAddrVc DelAddrr;
  record CredCardTypeVc CCTr;
  string 10 defdelmodcode;
  string 60 defdelmod;
  Boolean foundf,testf;
  Boolean res,proceedf,freight;
  LongInt rwcnt;
  integer i,rwt;
  string 60 tstr;
  record CCAccountIDVc CCAccountIDr;  

  proceedf = false;
  if (LoggedInHWTest()) then begin
    CUr.Code = CurrentCust;
    if (ReadFirstMain(CUr,1,true)==false) then begin
      CUr.Name = "";
    end;
    res = BuildWebOrd2(CurrentCust,-1,ORr,freight,langcode);
    rwcnt = MatRowCnt(ORr);
    if (rwcnt>0) then begin proceedf = true; end;

    ToolWebHWStartPage;
    ToolWebHWStartSecureBody;
  
    WebOutString("<BODY onload=""document.HansaForm.ccnumber.focus()"">");
    WebOutString("<script language=""JavaScript"">");
    WebOutNL;
    WebOutString("<!--");
    WebOutNL;
    WebOutString("function MM_openBrWindow(theURL,winName,features) { //v2.0");
    WebOutNL;
    WebOutString("  window.open(theURL,'',features);");
    WebOutNL;
    WebOutString("}");
    WebOutNL;
    WebOutString("//-->");
    WebOutNL;
    WebOutString("</script>");
    WebOutNL;
    WebOutString("<table width=""503"" border=""0"" align=""center"" cellpadding=""0"" cellspacing=""0"">");
    WebOutString("<tr> ");
    WebOutString("<td>");
    WebOutString("<TABLE border=""0""  align=""center"" cellPadding=""2"" cellSpacing=""4"" width=""465"">");
  
    WebOutString("<form name=""HansaForm"" method=""POST"" action=""");
    WebOutLink("WebHBSDivMainUpdate.hal?langcode=" & GetWebLanguage & "&function=WebHBSDivSendPayment&sessionid=" & WebGetArg("sessionid"));
    WebOutString(""">");
  
    WebOutString("<tr><td colspan=""3"" align=""center""><h1>" & ToolWebReturnTheText(20171) & "</h1></td></tr>");
    if ((error>0) or (nonblank(errorcode)) or (nonblank(errstr))) then begin
      ToolWebHWDisplayErrorLine(error,errstr,errorcode);
    end;
    ToolWebHWSpecialDisplayLine(ToolWebReturnTheText(20155) & ":","orderid",ORr.CustOrdNr,"",30,0,true);
    tstr = ORr.CurncyCode & " ";
    tstr = tstr & ORr.Sum4;
    ToolWebHWSpecialDisplayLine("&nbsp;" & ToolWebReturnTheText(20156) & ":","payval",tstr,"",30,0,true);
    ToolWebHiddenField("currency",ORr.CurncyCode);
    ToolWebHiddenField("amount",ORr.Sum4); 
//    ToolWebHiddenField("deladdr",WebGetArg("deladdr"));//causes problems on Credit card payment page. What problems?
    ToolWebHiddenField("delmode",WebGetArg("delmode"));
    ToolWebHiddenField("custref",WebGetArg("custref"));
    WebOutString("<TR><TD colspan=""3""><hr></TD></TR>");
    
//    WebOutString("<TR>");
    WebOutString("<TR bgcolor=""#EEEEEE"">");
    WebOutString("<TD class=""EditFieldHeader"" width=""160"">&nbsp;" & ToolWebReturnTheText(20157) & ":</TD>");
    WebOutString("<TD class=""EditFieldHeader"" width=""10"">M</TD>");
    WebOutString("<TD>");

    WebOutString("<SELECT NAME=""CreditCardType"" TABINDEX=-1"">");
    CCTr.Code = "";
    foundf = true;
    while (LoopMain(CCTr,1,foundf)) begin
      testf = foundf;
      if (blank(CCTr.Code)) then begin testf = false; end;
      if (blank(CCTr.Comment)) then begin testf = false; end;
      if (CCTr.UseOnWeb==0) then begin testf = false; end;
      if (testf) then begin
        WebOutString("<OPTION VALUE=""" & CCTr.Code & """>" & CCTr.Comment & "</OPTION>");
      end;
    end;
    WebOutString("</SELECT>");
    WebOutString("</TD>");
    WebOutString("</TR>");

    ToolWebHWSpecialDisplayLine("&nbsp;" & ToolWebReturnTheText(20158) & ":","ccnumber","","M",22,19,false);

    WebOutString("<TR bgcolor=""#EEEEEE"">");
    WebOutString("<TD class=""EditFieldHeader"">&nbsp;" & ToolWebReturnTheText(20159) & "</TD>");
    WebOutString("<TD class=""EditFieldHeader"">M</TD>");
    WebOutString("<TD class=""TableData"">");
    WebOutString("  <SELECT name=""ExpirationMonth"">");
    WebOutString("    <OPTION VALUE=""01"">01</OPTION>");
    WebOutString("    <OPTION VALUE=""02"">02</OPTION>");
    WebOutString("    <OPTION VALUE=""03"">03</OPTION>");
    WebOutString("    <OPTION VALUE=""04"">04</OPTION>");
    WebOutString("    <OPTION VALUE=""05"">05</OPTION>");
    WebOutString("    <OPTION VALUE=""06"">06</OPTION>");
    WebOutString("    <OPTION VALUE=""07"">07</OPTION>");
    WebOutString("    <OPTION VALUE=""08"">08</OPTION>");
    WebOutString("    <OPTION VALUE=""09"">09</OPTION>");
    WebOutString("    <OPTION VALUE=""10"">10</OPTION>");
    WebOutString("    <OPTION VALUE=""11"">11</OPTION>");
    WebOutString("    <OPTION VALUE=""12"">12</OPTION>");
    WebOutString("  </SELECT>");
    WebOutString("<SELECT name=""ExpirationYear"">");
    WebOutString("    <OPTION VALUE=""2007"">2007</OPTION>");
    WebOutString("    <OPTION VALUE=""2008"">2008</OPTION>");
    WebOutString("    <OPTION VALUE=""2009"">2009</OPTION>");
    WebOutString("    <OPTION VALUE=""2010"">2010</OPTION>");
    WebOutString("    <OPTION VALUE=""2011"">2011</OPTION>");
    WebOutString("    <OPTION VALUE=""2012"">2012</OPTION>");
    WebOutString("    <OPTION VALUE=""2013"">2013</OPTION>");
    WebOutString("    <OPTION VALUE=""2014"">2014</OPTION>");
    WebOutString("    <OPTION VALUE=""2015"">2015</OPTION>");
    WebOutString("    <OPTION VALUE=""2016"">2016</OPTION>");
    WebOutString("    <OPTION VALUE=""2017"">2017</OPTION>");
    WebOutString("    <OPTION VALUE=""2018"">2018</OPTION>");
    WebOutString("    <OPTION VALUE=""2019"">2019</OPTION>");
    WebOutString("    <OPTION VALUE=""2020"">2020</OPTION>");
    WebOutString("    <OPTION VALUE=""2021"">2021</OPTION>");
    WebOutString("    <OPTION VALUE=""2022"">2022</OPTION>");
    WebOutString("    <OPTION VALUE=""2023"">2023</OPTION>");
    WebOutString("    <OPTION VALUE=""2024"">2024</OPTION>");
    WebOutString("    <OPTION VALUE=""2025"">2025</OPTION>");
    WebOutString("    <OPTION VALUE=""2026"">2026</OPTION>");
    WebOutString("    <OPTION VALUE=""2027"">2027</OPTION>");
    WebOutString("    <OPTION VALUE=""2028"">2028</OPTION>");
    WebOutString("    <OPTION VALUE=""2029"">2029</OPTION>");
    WebOutString("</SELECT>");
    WebOutString("</TD>");
    WebOutString("</TR>");
    ToolWebHWSpecialDisplayLine("&nbsp;" & ToolWebReturnTheText(20160),"cvcsecurity","","M",6,4,false);

    WebOutString("<TR bgcolor=""#EEEEEE"">");
    WebOutString("  <TD class=""EditFieldHeader"">&nbsp;" & ToolWebReturnTheText(20161) & "</TD>");
    WebOutString("  <TD class=""EditFieldHeader"">S</TD>");
    WebOutString("  <TD class=""TableData""><INPUT autocomplete=""off"" name=""amexstartmonth"" size=""4"" maxlength=""2"""">");
    WebOutString("  <INPUT autocomplete=""off"" name=""amexstartyear"" size=""6"" maxlength=""4""""></TD>");
    WebOutString("</TR>");
    ToolWebHWSpecialDisplayLine("&nbsp;" & ToolWebReturnTheText(20162),"issuenumber","","I",6,2,false);
    FindCCAccountID(ORr.CurncyCode,"",1,CCAccountIDr,kCardHolderNotPresent);
    if (CCAccountIDr.TestAddress!=0) then begin
      ToolWebHWSpecialDisplayLine("&nbsp;" & ToolWebReturnTheText(20163) & " 1","ccaddr1","","M",50,50,false);
      ToolWebHWSpecialDisplayLine("&nbsp;" & ToolWebReturnTheText(20163) & " 2","ccaddr2","","M",50,50,false);
      ToolWebHWSpecialDisplayLine("&nbsp;" & ToolWebReturnTheText(20163) & " 3","ccaddr3","","M",50,50,false);
      ToolWebHWSpecialDisplayLine("&nbsp;" & ToolWebReturnTheText(20163) & " 4","ccaddr4","","M",50,50,false);
      ToolWebHWSpecialDisplayLine("&nbsp;" & ToolWebReturnTheText(20164),"ccaddr6","","M",10,10,false);
//      ToolWebHWSpecialDisplayLine("&nbsp;Country","cccountry","","M",10,10,false);
      

      WebOutString("<TR bgcolor=""#EEEEEE"">");
      WebOutString("<TD class=""EditFieldHeader"">&nbsp;" & ToolWebReturnTheText(20065) & "</TD>");
      WebOutString("<TD class=""EditFieldHeader"">M</TD>");
      WebOutString("<TD class=""TableData"">");
      WebOutString("<SELECT name=""cccountry"">");
      WebOutString("    <OPTION VALUE=""AF"">Afghanistan</OPTION>");
      WebOutString("    <OPTION VALUE=""AL"">Albania</OPTION>");
      WebOutString("    <OPTION VALUE=""DZ"">Algeria</OPTION>");
      WebOutString("    <OPTION VALUE=""AS"">American Samoa (US)</OPTION>");
      WebOutString("    <OPTION VALUE=""AD"">Andorra</OPTION>");
      WebOutString("    <OPTION VALUE=""AO"">Angola</OPTION>");
      WebOutString("    <OPTION VALUE=""AI"">Anguilla (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""AG"">Antigua and Barbuda</OPTION>");
      WebOutString("    <OPTION VALUE=""AR"">Argentina</OPTION>");
      WebOutString("    <OPTION VALUE=""AM"">Armenia</OPTION>");
      WebOutString("    <OPTION VALUE=""AW"">Aruba</OPTION>");
      WebOutString("    <OPTION VALUE=""AU"">Australia</OPTION>");
      WebOutString("    <OPTION VALUE=""AT"">Austria</OPTION>");
      WebOutString("    <OPTION VALUE=""AZ"">Azerbaijan</OPTION>");
      WebOutString("    <OPTION VALUE=""BS"">Bahamas</OPTION>");
      WebOutString("    <OPTION VALUE=""BH"">Bahrain</OPTION>");
      WebOutString("    <OPTION VALUE=""BD"">Bangladesh</OPTION>");
      WebOutString("    <OPTION VALUE=""BB"">Barbados</OPTION>");
      WebOutString("    <OPTION VALUE=""BY"">Belarus</OPTION>");
      WebOutString("    <OPTION VALUE=""BE"">Belgium</OPTION>");
      WebOutString("    <OPTION VALUE=""BZ"">Belize</OPTION>");
      WebOutString("    <OPTION VALUE=""BJ"">Benin</OPTION>");
      WebOutString("    <OPTION VALUE=""BM"">Bermuda (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""BT"">Bhutan</OPTION>");
      WebOutString("    <OPTION VALUE=""BO"">Bolivia</OPTION>");
      WebOutString("    <OPTION VALUE=""BA"">Bosnia and Herzegovina</OPTION>");
      WebOutString("    <OPTION VALUE=""BW"">Botswana</OPTION>");
      WebOutString("    <OPTION VALUE=""BR"">Brazil</OPTION>");
      WebOutString("    <OPTION VALUE=""VG"">British Virgin Islands (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""BN"">Brunei Darussalam</OPTION>");
      WebOutString("    <OPTION VALUE=""BG"">Bulgaria</OPTION>");
      WebOutString("    <OPTION VALUE=""BF"">Burkina Faso</OPTION>");
      WebOutString("    <OPTION VALUE=""BI"">Burundi</OPTION>");
      WebOutString("    <OPTION VALUE=""KH"">Cambodia</OPTION>");
      WebOutString("    <OPTION VALUE=""CM"">Cameroon</OPTION>");
      WebOutString("    <OPTION VALUE=""CA"">Canada</OPTION>");
      WebOutString("    <OPTION VALUE=""CV"">Cape Verde</OPTION>");
      WebOutString("    <OPTION VALUE=""KY"">Cayman Islands (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""CF"">Central African Republic</OPTION>");
      WebOutString("    <OPTION VALUE=""TD"">Chad</OPTION>");
      WebOutString("    <OPTION VALUE=""CL"">Chile</OPTION>");
      WebOutString("    <OPTION VALUE=""CN"">China</OPTION>");
      WebOutString("    <OPTION VALUE=""CX"">Christmas Island (AU)</OPTION>");
      WebOutString("    <OPTION VALUE=""CC"">Cocos (Keeling) Islands (AU)</OPTION>");
      WebOutString("    <OPTION VALUE=""CO"">Colombia</OPTION>");
      WebOutString("    <OPTION VALUE=""KM"">Comoros</OPTION>");
      WebOutString("    <OPTION VALUE=""CD"">Congo, Democratic Republic of the</OPTION>");
      WebOutString("    <OPTION VALUE=""CG"">Congo, Republic of the</OPTION>");
      WebOutString("    <OPTION VALUE=""CK"">Cook Islands (NZ)</OPTION>");
      WebOutString("    <OPTION VALUE=""CR"">Costa Rica</OPTION>");
      WebOutString("    <OPTION VALUE=""CI"">Cote D'Ivoire</OPTION>");
      WebOutString("    <OPTION VALUE=""HR"">Croatia</OPTION>");
      WebOutString("    <OPTION VALUE=""CU"">Cuba</OPTION>");
      WebOutString("    <OPTION VALUE=""CY"">Cyprus</OPTION>");
      WebOutString("    <OPTION VALUE=""CZ"">Czech Republic</OPTION>");
      WebOutString("    <OPTION VALUE=""DK"">Denmark</OPTION>");
      WebOutString("    <OPTION VALUE=""DJ"">Djibouti</OPTION>");
      WebOutString("    <OPTION VALUE=""DM"">Dominica</OPTION>");
      WebOutString("    <OPTION VALUE=""DO"">Dominican Republic</OPTION>");
      WebOutString("    <OPTION VALUE=""EC"">Ecuador</OPTION>");
      WebOutString("    <OPTION VALUE=""EG"">Egypt</OPTION>");
      WebOutString("    <OPTION VALUE=""SV"">El Salvador</OPTION>");
      WebOutString("    <OPTION VALUE=""GQ"">Equatorial Guinea</OPTION>");
      WebOutString("    <OPTION VALUE=""ER"">Eritrea</OPTION>");
      WebOutString("    <OPTION VALUE=""EE"">Estonia</OPTION>");
      WebOutString("    <OPTION VALUE=""ET"">Ethiopia</OPTION>");
      WebOutString("    <OPTION VALUE=""FK"">Falkland Islands (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""FO"">Faroe Islands (DK)</OPTION>");
      WebOutString("    <OPTION VALUE=""FJ"">Fiji</OPTION>");
      WebOutString("    <OPTION VALUE=""FI"">Finland</OPTION>");
      WebOutString("    <OPTION VALUE=""FR"">France</OPTION>");
      WebOutString("    <OPTION VALUE=""GF"">French Guiana (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""PF"">French Polynesia (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""GA"">Gabon</OPTION>");
      WebOutString("    <OPTION VALUE=""GM"">Gambia</OPTION>");
      WebOutString("    <OPTION VALUE=""GE"">Georgia</OPTION>");
      WebOutString("    <OPTION VALUE=""DE"">Germany</OPTION>");
      WebOutString("    <OPTION VALUE=""GH"">Ghana</OPTION>");
      WebOutString("    <OPTION VALUE=""GI"">Gibraltar (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""GR"">Greece</OPTION>");
      WebOutString("    <OPTION VALUE=""GL"">Greenland (DK)</OPTION>");
      WebOutString("    <OPTION VALUE=""GD"">Grenada</OPTION>");
      WebOutString("    <OPTION VALUE=""GP"">Guadeloupe (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""GU"">Guam (US)</OPTION>");
      WebOutString("    <OPTION VALUE=""GT"">Guatemala</OPTION>");
      WebOutString("    <OPTION VALUE=""GN"">Guinea</OPTION>");
      WebOutString("    <OPTION VALUE=""GW"">Guinea-Bissau</OPTION>");
      WebOutString("    <OPTION VALUE=""GY"">Guyana</OPTION>");
      WebOutString("    <OPTION VALUE=""HT"">Haiti</OPTION>");
      WebOutString("    <OPTION VALUE=""VA"">Holy See (Vatican City)</OPTION>");
      WebOutString("    <OPTION VALUE=""HN"">Honduras</OPTION>");
      WebOutString("    <OPTION VALUE=""HK"">Hong Kong (CN)</OPTION>");
      WebOutString("    <OPTION VALUE=""HU"">Hungary</OPTION>");
      WebOutString("    <OPTION VALUE=""IS"">Iceland</OPTION>");
      WebOutString("    <OPTION VALUE=""IN"">India</OPTION>");
      WebOutString("    <OPTION VALUE=""ID"">Indonesia</OPTION>");
      WebOutString("    <OPTION VALUE=""IR"">Iran</OPTION>");
      WebOutString("    <OPTION VALUE=""IQ"">Iraq</OPTION>");
      WebOutString("    <OPTION VALUE=""IE"">Ireland</OPTION>");
      WebOutString("    <OPTION VALUE=""IL"">Israel</OPTION>");
      WebOutString("    <OPTION VALUE=""IT"">Italy</OPTION>");
      WebOutString("    <OPTION VALUE=""JM"">Jamaica</OPTION>");
      WebOutString("    <OPTION VALUE=""JP"">Japan</OPTION>");
      WebOutString("    <OPTION VALUE=""JO"">Jordan</OPTION>");
      WebOutString("    <OPTION VALUE=""KZ"">Kazakhstan</OPTION>");
      WebOutString("    <OPTION VALUE=""KE"">Kenya</OPTION>");
      WebOutString("    <OPTION VALUE=""KI"">Kiribati</OPTION>");
      WebOutString("    <OPTION VALUE=""KP"">Korea, Democratic People's Republic (North)</OPTION>");
      WebOutString("    <OPTION VALUE=""KR"">Korea, Republic of (South)</OPTION>");
      WebOutString("    <OPTION VALUE=""KW"">Kuwait</OPTION>");
      WebOutString("    <OPTION VALUE=""KG"">Kyrgyzstan</OPTION>");
      WebOutString("    <OPTION VALUE=""LA"">Laos</OPTION>");
      WebOutString("    <OPTION VALUE=""LV"">Latvia</OPTION>");
      WebOutString("    <OPTION VALUE=""LB"">Lebanon</OPTION>");
      WebOutString("    <OPTION VALUE=""LS"">Lesotho</OPTION>");
      WebOutString("    <OPTION VALUE=""LR"">Liberia</OPTION>");
      WebOutString("    <OPTION VALUE=""LY"">Libya</OPTION>");
      WebOutString("    <OPTION VALUE=""LI"">Liechtenstein</OPTION>");
      WebOutString("    <OPTION VALUE=""LT"">Lithuania</OPTION>");
      WebOutString("    <OPTION VALUE=""LU"">Luxembourg</OPTION>");
      WebOutString("    <OPTION VALUE=""MO"">Macau (CN)</OPTION>");
      WebOutString("    <OPTION VALUE=""MK"">Macedonia</OPTION>");
      WebOutString("    <OPTION VALUE=""MG"">Madagascar</OPTION>");
      WebOutString("    <OPTION VALUE=""MW"">Malawi</OPTION>");
      WebOutString("    <OPTION VALUE=""MY"">Malaysia</OPTION>");
      WebOutString("    <OPTION VALUE=""MV"">Maldives</OPTION>");
      WebOutString("    <OPTION VALUE=""ML"">Mali</OPTION>");
      WebOutString("    <OPTION VALUE=""MT"">Malta</OPTION>");
      WebOutString("    <OPTION VALUE=""MH"">Marshall Islands</OPTION>");
      WebOutString("    <OPTION VALUE=""MQ"">Martinique (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""MR"">Mauritania</OPTION>");
      WebOutString("    <OPTION VALUE=""MU"">Mauritius</OPTION>");
      WebOutString("    <OPTION VALUE=""YT"">Mayotte (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""MX"">Mexico</OPTION>");
      WebOutString("    <OPTION VALUE=""FM"">Micronesia, Federated States of</OPTION>");
      WebOutString("    <OPTION VALUE=""MD"">Moldova Republic of</OPTION>");
      WebOutString("    <OPTION VALUE=""MC"">Monaco</OPTION>");
      WebOutString("    <OPTION VALUE=""MN"">Mongolia</OPTION>");
      WebOutString("    <OPTION VALUE=""MS"">Montserrat (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""MA"">Morocco</OPTION>");
      WebOutString("    <OPTION VALUE=""MZ"">Mozambique</OPTION>");
      WebOutString("    <OPTION VALUE=""MM"">Myanmar</OPTION>");
      WebOutString("    <OPTION VALUE=""NA"">Namibia</OPTION>");
      WebOutString("    <OPTION VALUE=""NR"">Nauru</OPTION>");
      WebOutString("    <OPTION VALUE=""NP"">Nepal</OPTION>");
      WebOutString("    <OPTION VALUE=""AN"">Netherlands Antilles (NL)</OPTION>");
      WebOutString("    <OPTION VALUE=""NL"">Netherlands</OPTION>");
      WebOutString("    <OPTION VALUE=""NC"">New Caledonia (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""NZ"">New Zealand</OPTION>");
      WebOutString("    <OPTION VALUE=""NI"">Nicaragua</OPTION>");
      WebOutString("    <OPTION VALUE=""NE"">Niger</OPTION>");
      WebOutString("    <OPTION VALUE=""NG"">Nigeria</OPTION>");
      WebOutString("    <OPTION VALUE=""NU"">Niue</OPTION>");
      WebOutString("    <OPTION VALUE=""NF"">Norfolk Island (AU)</OPTION>");
      WebOutString("    <OPTION VALUE=""MP"">Northern Mariana Islands (US)</OPTION>");
      WebOutString("    <OPTION VALUE=""NO"">Norway</OPTION>");
      WebOutString("    <OPTION VALUE=""OM"">Oman</OPTION>");
      WebOutString("    <OPTION VALUE=""PK"">Pakistan</OPTION>");
      WebOutString("    <OPTION VALUE=""PW"">Palau</OPTION>");
      WebOutString("    <OPTION VALUE=""PA"">Panama</OPTION>");
      WebOutString("    <OPTION VALUE=""PG"">Papua New Guinea</OPTION>");
      WebOutString("    <OPTION VALUE=""PY"">Paraguay</OPTION>");
      WebOutString("    <OPTION VALUE=""PE"">Peru</OPTION>");
      WebOutString("    <OPTION VALUE=""PH"">Philippines</OPTION>");
      WebOutString("    <OPTION VALUE=""PN"">Pitcairn Islands (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""PL"">Poland</OPTION>");
      WebOutString("    <OPTION VALUE=""PT"">Portugal</OPTION>");
      WebOutString("    <OPTION VALUE=""PR"">Puerto Rico (US)</OPTION>");
      WebOutString("    <OPTION VALUE=""QA"">Qatar</OPTION>");
      WebOutString("    <OPTION VALUE=""RE"">Reunion (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""RO"">Romania</OPTION>");
      WebOutString("    <OPTION VALUE=""RU"">Russia</OPTION>");
      WebOutString("    <OPTION VALUE=""RW"">Rwanda</OPTION>");
      WebOutString("    <OPTION VALUE=""SH"">Saint Helena (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""KN"">Saint Kitts and Nevis</OPTION>");
      WebOutString("    <OPTION VALUE=""LC"">Saint Lucia</OPTION>");
      WebOutString("    <OPTION VALUE=""PM"">Saint Pierre & Miquelon (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""VC"">Saint Vincent and the Grenadines</OPTION>");
      WebOutString("    <OPTION VALUE=""WS"">Samoa</OPTION>");
      WebOutString("    <OPTION VALUE=""SM"">San Marino</OPTION>");
      WebOutString("    <OPTION VALUE=""ST"">Sao Tome and Principe</OPTION>");
      WebOutString("    <OPTION VALUE=""SA"">Saudi Arabia</OPTION>");
      WebOutString("    <OPTION VALUE=""SN"">Senegal</OPTION>");
      WebOutString("    <OPTION VALUE=""CS"">Serbia and Montenegro</OPTION>");
      WebOutString("    <OPTION VALUE=""SC"">Seychelles</OPTION>");
      WebOutString("    <OPTION VALUE=""SL"">Sierra Leone</OPTION>");
      WebOutString("    <OPTION VALUE=""SG"">Singapore</OPTION>");
      WebOutString("    <OPTION VALUE=""SK"">Slovakia</OPTION>");
      WebOutString("    <OPTION VALUE=""SI"">Slovenia</OPTION>");
      WebOutString("    <OPTION VALUE=""SB"">Solomon Islands</OPTION>");
      WebOutString("    <OPTION VALUE=""SO"">Somalia</OPTION>");
      WebOutString("    <OPTION VALUE=""ZA"">South Africa</OPTION>");
      WebOutString("    <OPTION VALUE=""GS"">South Georgia & South Sandwich Islands (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""ES"">Spain</OPTION>");
      WebOutString("    <OPTION VALUE=""LK"">Sri Lanka</OPTION>");
      WebOutString("    <OPTION VALUE=""SD"">Sudan</OPTION>");
      WebOutString("    <OPTION VALUE=""SR"">Suriname</OPTION>");
      WebOutString("    <OPTION VALUE=""SZ"">Swaziland</OPTION>");
      WebOutString("    <OPTION VALUE=""SE"">Sweden</OPTION>");
      WebOutString("    <OPTION VALUE=""CH"">Switzerland</OPTION>");
      WebOutString("    <OPTION VALUE=""SY"">Syria</OPTION>");
      WebOutString("    <OPTION VALUE=""TW"">Taiwan</OPTION>");
      WebOutString("    <OPTION VALUE=""TJ"">Tajikistan</OPTION>");
      WebOutString("    <OPTION VALUE=""TZ"">Tanzania</OPTION>");
      WebOutString("    <OPTION VALUE=""TH"">Thailand</OPTION>");
      WebOutString("    <OPTION VALUE=""TL"">Timor-Leste</OPTION>");
      WebOutString("    <OPTION VALUE=""TG"">Togo</OPTION>");
      WebOutString("    <OPTION VALUE=""TK"">Tokelau</OPTION>");
      WebOutString("    <OPTION VALUE=""TO"">Tonga</OPTION>");
      WebOutString("    <OPTION VALUE=""TT"">Trinidad and Tobago</OPTION>");
      WebOutString("    <OPTION VALUE=""TN"">Tunisia</OPTION>");
      WebOutString("    <OPTION VALUE=""TR"">Turkey</OPTION>");
      WebOutString("    <OPTION VALUE=""TM"">Turkmenistan</OPTION>");
      WebOutString("    <OPTION VALUE=""TC"">Turks and Caicos Islands (UK)</OPTION>");
      WebOutString("    <OPTION VALUE=""TV"">Tuvalu</OPTION>");
      WebOutString("    <OPTION VALUE=""UG"">Uganda</OPTION>");
      WebOutString("    <OPTION VALUE=""UA"">Ukraine</OPTION>");
      WebOutString("    <OPTION VALUE=""AE"">United Arab Emirates</OPTION>");
      WebOutString("    <OPTION VALUE=""GB"">United Kingdom</OPTION>");
      WebOutString("    <OPTION VALUE=""US"">United States</OPTION>");
      WebOutString("    <OPTION VALUE=""UY"">Uruguay</OPTION>");
      WebOutString("    <OPTION VALUE=""UZ"">Uzbekistan</OPTION>");
      WebOutString("    <OPTION VALUE=""VU"">Vanuatu</OPTION>");
      WebOutString("    <OPTION VALUE=""VE"">Venezuela</OPTION>");
      WebOutString("    <OPTION VALUE=""VN"">Vietnam</OPTION>");
      WebOutString("    <OPTION VALUE=""VI"">Virgin Islands (US)</OPTION>");
      WebOutString("    <OPTION VALUE=""WF"">Wallis and Futuna (FR)</OPTION>");
      WebOutString("    <OPTION VALUE=""EH"">Western Sahara</OPTION>");
      WebOutString("    <OPTION VALUE=""YE"">Yemen</OPTION>");
      WebOutString("    <OPTION VALUE=""ZM"">Zambia</OPTION>");
      WebOutString("    <OPTION VALUE=""ZW"">Zimbabwe</OPTION>");
      WebOutString("</SELECT>");
      WebOutString("</TD>");
      WebOutString("</TR>");
    end;

    WebOutString("<TR bgcolor=""#EEEEEE"">");
    WebOutString("<TD colspan=""3"" class=""Normal""><a href=""Javascript:void(0)"" onClick=""MM_openBrWindow('./CreditCardPayment.html','Item view','scrollbars=no,rezisable=yes,width=550,height=610')"">" & ToolWebReturnTheText(20165) & "</a></TD>");
    WebOutString("</TR>");
    WebOutString("<TR bgcolor=""#EEEEEE"">");
    WebOutString("<TD colspan=""3"" class=""Normal"">M = " & ToolWebReturnTheText(20166) & "</TD>");
    WebOutString("</TR>");
    WebOutString("<TR bgcolor=""#EEEEEE"">");
    WebOutString("<TD colspan=""3"" class=""Normal"">O = " & ToolWebReturnTheText(20185) & "</TD>");
    WebOutString("</TR>");
    WebOutString("<TR bgcolor=""#EEEEEE"">");
    WebOutString("<TD colspan=""3"" class=""Normal"">S = " & ToolWebReturnTheText(20167) & "</TD>");
    WebOutString("</TR>");
    WebOutString("<TR bgcolor=""#EEEEEE"">");
    WebOutString("<TD colspan=""3"" class=""Normal"">I = " & ToolWebReturnTheText(20168) & "</TD>");
    WebOutString("</TR>");
    WebOutString("<TR>");
    WebOutString("<TD align=""center"" colSpan=""3""><br><b>" & ToolWebReturnTheText(20169) & "</b><br><br></TD>");
    WebOutString("</TR>");
    WebOutString("<TR>");
    WebOutString("<TD colspan=""3"" align=""center"">");
    WebOutString("<INPUT autocomplete=""off"" onmouseout=""self.status=''; return true"" onmouseover=""self.status='Confirm'; return true"" name=""submit"" type=""submit"" value=""" & ToolWebReturnTheText(20067) &""">");
    WebOutString("<IMG alt="""" border=""0"" height=""1"" src=""pics/spacer.gif"" width=""1"">");

    WebOutString("<br><br><br>");
    CreateLinkFromPaySite(ToolWebReturnTheText(20170));

    WebOutString("</TD>");
    WebOutString("</TR>");
    WebOutString("</FORM>");
    WebOutString("</TABLE>");
    WebOutString("&nbsp;</td>");
    WebOutString("</tr>");
    WebOutString("</table>");
    ToolWebHWEndPage;
  end;
  return;
end;
//WNS:end

global
updating procedure WebHWShopBasketStepPAY2()
begin
  WebHWShopBasketStepPAY(0,"","");
  return;
end;
 

global
updating procedure WebHBSDivShopBasketStepPAY2(string langcode)
begin
  WebHBSDivShopBasketStepPAY(0,"","",langcode);
  return;
end;
