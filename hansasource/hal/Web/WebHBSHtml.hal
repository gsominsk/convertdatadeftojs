external procedure ToolWebWinBarTitle(String);
external procedure ToolWebGetTheText(Integer,var string);

procedure BasicMainTitle(var string wcharset)
begin
  record WebControlBlock WCr;
  string 20 lang;
  
  BlockLoad(WCr);
  wcharset = WCr.WebCharSet;
  if (blank(wcharset)) then begin
    wcharset = "iso-8859-1";
  end;
//  lang = WebLanguage(1);
  lang = WebGetArg("langcode");
  switch(lang) begin
    case "lv":
      wcharset = "windows-1257";
    case "pl":
      wcharset = "iso-8859-2";
  end;
  ToolWebWinBarTitle("Hansa Corporate Portal");
  WebOutString("<X-SAS-WINDOW TOP=60 BOTTOM=759 LEFT=92 RIGHT=830>");
  WebOutNL;
  return;
end;

global
procedure ToolWebHBSSetMainTitle()
begin
  string 60 wcharset;

  BasicMainTitle(wcharset);
  WebOutString("<meta http-equiv=""Content-Type"" content=""text/html; charset=" & wcharset & """>");
  WebOutNL;
  return;
end;

global
procedure ToolWebHBSSetMainWithTimeout(string timeout,string newaddress)
begin
  string 60 wcharset;

  BasicMainTitle(wcharset);
//  WebOutString("<meta http-equiv=""Content-Type"" content=""text/html; charset=" & wcharset & """>");
  WebOutString("<meta http-equiv=""refresh"" content=""" & timeout & "; url=" & newaddress & """>");
  WebOutNL;
  return;
end;

global
procedure ToolWebHBSStartBody(string wfocusfield,string bgcolour)
begin
  string 100 locbgcolour;
  
  locbgcolour = bgcolour;
  if (blank(locbgcolour)) then begin
    locbgcolour = "#FFFFFF";
  end;
  WebOutString("<link rel=""stylesheet"" href=""../lib/hfstyle.css"" type=""text/css"">");
  WebOutString("<script language=""JavaScript"">");
  WebOutNL;
  WebOutString("<!--");
  WebOutNL;
  WebOutString("function jsOpenReadMore(theURL) { //v2.0");
  WebOutNL;
  WebOutString("  hansawindow = window.open(theURL,""HansaWorld"",""menubar=1,resizable=yes,scrollbars=yes,width=450"");");
//  WebOutString("  hansawindow.moveTo(0,0);");
  WebOutNL;
  WebOutString("}");
  WebOutNL;
  WebOutString("//-->");
  WebOutNL;
  WebOutString("</script>");
  WebOutNL;
  WebOutString("</head>");
  WebOutNL;
  WebOutString("<body bgcolor=""" & locbgcolour & """ link=""#FF0000"" vlink=""#FF9933""");
  if (nonblank(wfocusfield)) then begin
    WebOutString(" onload=""document.HansaForm." & wfocusfield & ".focus()""");
  end;
  WebOutString(">");
  WebOutNL;
  return;
end;  

global
procedure ToolWebHBSStartShopBody(string wfocusfield,string bgcolour)
begin
  string 100 locbgcolour;
  
  locbgcolour = bgcolour;
  if (blank(locbgcolour)) then begin
    locbgcolour = "#FFFFFF";
  end;
  WebOutString("<body bgcolor=""" & locbgcolour & """ link=""#000066"" vlink=""#000066""");
  if (nonblank(wfocusfield)) then begin
    WebOutString(" onload=""document.HansaForm." & wfocusfield & ".focus()""");
  end;
  WebOutString(">");
  WebOutNL;
  return;
end;  

global
procedure ToolWebHBSNavLink(string webname,string weblink,string webarg,string webtarget,Boolean nosess)
begin
  string 255 llink;

  WebOutString("<TD class=""mnu-lvl-2"" height=""11"">");
  WebOutNL;
  if (nonblank(weblink)) then begin
    WebOutString("<A HREF=""");  
    if (nosess) then begin
      llink = weblink;
      WebOutString(llink);
    end else begin
      llink = weblink & "?sessionid=" & WebGetArg("sessionid");
      llink = llink & "&company=" & WebGetArg("company");
      llink = llink & "&langcode=" & WebGetArg("langcode");
      if (nonblank(webarg)) then begin
        llink = llink & "&" & webarg;
      end;
      WebOutLink(llink);
    end;
    if (nonblank(webtarget)) then begin
      WebOutString(""" target=""" & webtarget & """>");  
    end else begin
      WebOutString(""">");  
    end;
  end;
  WebOutNL;
  WebOutString(webname);
  WebOutNL;
  if (nonblank(weblink)) then begin
    WebOutString("</A>");
  end;
  WebOutString("&nbsp;</td>");
  WebOutNL;
  return;
end;

global
procedure ToolWebHBSMenuItem(string webname,string weblink,string webarg,string webtarget,Boolean nosess)
begin
  string 255 llink;
  
  WebOutString("<TR>");
  WebOutString("<td class=""mnudot"" width=""21""><img src=""gfx/dot01.gif"" width=""21"" height=""11"" border=""0"" alt=""""><br></td>");
  WebOutString("<TD class=""mnu-lvl-1"" width=""136"">");
  WebOutNL;
  WebOutString("<A HREF=""");
  if (nosess) then begin
    llink = weblink;
    WebOutString(llink);
  end else begin
    llink = weblink & "?sessionid=" & WebGetArg("sessionid");
    llink = llink & "&company=" & WebGetArg("company");
    llink = llink & "&langcode=" & WebGetArg("langcode");
    if (nonblank(webarg)) then begin
      llink = llink & "&" & webarg;
    end;
    WebOutLink(llink);
  end;
  if (nonblank(webtarget)) then begin
    WebOutString(""" target=""" & webtarget & """>");  
  end else begin
    WebOutString(""">");  
  end;
  WebOutString(webname);
  WebOutNL;
  WebOutString("</A>");  
  WebOutString("</TD></TR>");  
  WebOutNL;
  return;
end;

global
procedure ToolWebHBSContactLine(string thetext,string thename,string preval,Boolean freetext)
begin  
  WebOutString("<tr>");
  WebOutNL;
  if (nonblank(thename)) then begin
    WebOutString("<td width=""28%"" class=""feedback-txt"">" & thetext & "</td>");
    WebOutNL;
    WebOutString("<td width=""72%"">");
    WebOutNL;
    if (freetext) then begin
      WebOutString("<textarea name=""" & thename & """ maxlength=255 cols=""30"" rows=""5"" class=""feedback""></textarea>");
    end else begin
      WebOutString("<input value=""" & preval & """ type=""text"" name=""" & thename & """ size=""31"" class=""feedback"">");
    end;
    WebOutNL;
    WebOutString("</td>");
  end else begin
    WebOutString("<td colspan=2 class=""feedback-comment"">" & thetext & "</td>");
  end;
  WebOutNL;
  WebOutString("</tr>");
  WebOutNL;
  return;
end;


// WebHBSShop files uses these functions

global
procedure ToolWebHBSListTable(Integer wcols,Integer wwidth,string bsize)
begin
  string 20 locwidth;
  string 5 thebsize;
  
  thebsize = bsize;
  if (blank(thebsize)) then begin
    thebsize = "1";
  end;
  locwidth = "100%";
  if (wwidth>0) then begin
    locwidth = wwidth;
  end;
  WebOutString("<table BORDER=""" & thebsize & """ cellpadding=""0"" cellspacing=""0"" bordercolorlight=black "); // bgcolor=""#CCCCCC""
  WebOutSTring("bordercolordark=black bordercolor=black COLS=""" & wcols & """ WIDTH=""" & locwidth & """ align=left>");
  WebOutNL;
  return;
end;

global
procedure ToolWebHBSListTableEnd()
begin
  WebOutString("</table>");
  return;
end;

global
procedure ToolWebHBSTableHdr(string webname,string thealign,string webwidth)
begin
  string 20 localign;

  localign = thealign;
  if (blank(localign)) then begin
    localign = "left";
  end;
  WebOutString("<td width=""" & webwidth & """ align=""" & thealign & """ class=""heading3"">");
  WebOutNL;
  WebOutString(webname);
  WebOutNL;
  WebOutString("</td>");
  WebOutNL;
  return;
end;

global
procedure ToolWebHBSEditFieldBrowse(string webname,string webtype,string wvalue,string wwidth,Integer wsize,Integer wlen,Integer rwt)
begin
  string 20 bgcolr;

  if (rwt==1) then begin
    bgcolr = "#CCCCFF";
  end;
  if (rwt!=1) then begin
    bgcolr = "#FFFFFF";
  end;
  WebOutString("<td bgcolor=""" & bgcolr & """ width=""" & wwidth & """ valign=""center"" align=""left"">");
  WebOutString("<input class=""s10"" type=""" & webtype & """ name=""" & webname & """  size=""" & wsize & """ MAXLENGTH=""" & wlen & """ value=""" & wvalue & """></td>");
  WebOutNL;
  return;
end;

global
procedure ToolWebHBSTableData(string webname,string weblink,string webarg,string thealign,string thesize,string target,Integer rwt)
begin
  string 255 llink,tstr;
  string 20 localign;

  localign = thealign;
  if (blank(localign)) then begin
    localign = "left";
  end;

  tstr = "<td size=""2"" align=""" & localign & """ class=""mnu-lvl-2"" ";
  if (nonblank(thesize)) then begin
    tstr = tstr & "width=""" & thesize & """";
  end;
  tstr = tstr & ">";
  WebOutNL;
  WebOutString(tstr);
  WebOutNL;
  if (nonblank(weblink)) then begin
    tstr = "<a";
    if (nonblank(target)) then begin
      tstr = tstr & " target =""" & target & """";
    end;
    tstr = tstr & " href=""";
    WebOutString(tstr);
    llink = weblink & "?sessionid=" & WebGetArg("sessionid");
    if (nonblank(webarg)) then begin
      llink = llink & "&" & webarg;
    end;
    WebOutLink(llink);
    WebOutString(""">");
  end;
  WebOutNL;
  
  if (webname=="READ") then begin
    WebOutSTring("<img src=""read.jpg"" border=""0"">");
    goto L55;
  end;
  if (webname=="UNREAD") then begin
    WebOutSTring("<img src=""unread.jpg"" border=""0"">");
    goto L55;
  end;
  
  if (nonblank(webname)) then begin
    WebOutString(webname);
  end else begin
    WebOutString("&nbsp;");
  end;

L55:;
  if (nonblank(weblink)) then begin
    WebOutString("</a>");
  end;
  WebOutString("</td>");
  return;
end;

global
procedure ToolWebHBSMenuItemList(string webname,string weblink,string webarg,string webtarget,var Integer rwt)
begin
  string 255 llink;

  WebOutString("<TR><TD width=""100%"" align=""left"" class=""mnu-lvl-2"">");
  WebOutNL;
  WebOutString("<A HREF=""");
  llink = weblink & "?sessionid=" & WebGetArg("sessionid");
  if (nonblank(webarg)) then begin
    llink = llink & "&" & webarg;
  end;
  WebOutLink(llink);
  if (nonblank(webtarget)) then begin
    WebOutString(""" target=""" & webtarget & """>");  
  end else begin
    WebOutString(""">");  
  end;
  WebOutString(webname);
  WebOutNL;
  WebOutString("</A>");  
  WebOutString("</TD></TR>");  
  WebOutNL;
  return;
end;

global
procedure ToolWebHBSInfoCell(string weba,string wwidth,string thealign)
begin
  string 20 localign;

  localign = thealign;
  if (blank(localign)) then begin
    localign = "left";
  end;
  WebOutString("<td  width=""" & wwidth & """ align=""" & localign & """ class=""heading3"">");
  WebOutNL;
  WebOutString(weba);
  WebOutNL;
  WebOutString("</td> ");
  WebOutNL;
  return;
end;

global
procedure ToolWebHBSShopLine(string thetext,string thename,string webtype,string preval,Boolean freetext)
begin
  WebOutString("<tr>");
  WebOutNL;
  if (nonblank(thename)) then begin
    WebOutString("<td width=""28%"" class=""feedback-txt"">" & thetext & "</td>");
    WebOutNL;
    WebOutString("<td width=""72%"">");
    WebOutNL;
    if (freetext) then begin
      WebOutString("<textarea name=""" & thename & """ maxlength=255 cols=""30"" rows=""5"" class=""feedback""></textarea>");
    end else begin
      WebOutString("<input value=""" & preval & """ type=""" & webtype & """ type=""text"" name=""" & thename & """ size=""31"" class=""feedback"">");
    end;
    WebOutNL;
    WebOutString("</td>");
  end else begin
    WebOutString("<td colspan=2 class=""feedback-comment"">" & thetext & "</td>");
  end;
  WebOutNL;
  WebOutString("</tr>");
  WebOutNL;
  return;
end;

global
procedure ToolWebHBSSimpleLink(string thetext,string wheretogo)
begin
  WebOutString("<a href=""");
  WebOutLink(wheretogo & "?sessionid=" & WebGetArg("sessionid") & "&company=" & WebGetArg("company") & "&langcode=" & WebGetArg("langcode") & "&WEBPAGE=HOME");
  WebOutString(""" target=""content"">");
  WebOutString(thetext);
  WebOutString("</a>");
  return;
end;

