external procedure FindEndOfTime(var Date);

global
function boolean BankReconRClassOnOKWindow(Integer wn)
begin
  record RcVc RepSpec;
  boolean res;
  date FiscEndDate;
  
  GetWindowRecord(wn,RepSpec);
  FindEndOfTime(FiscEndDate);
  if (RepSpec.sEndDate>FiscEndDate) then begin
    RepSpec.sEndDate = FiscEndDate;
    RepSpec.Period2Str = "" & RepSpec.sStartDate & ":" & RepSpec.sEndDate;
    PutWindowRecord(wn,RepSpec);
    DeselectWindow(wn,false);
    MessageBox(16100,"");
    res = false;
  end else begin
    res = true;
  end;
  BankReconRClassOnOKWindow = res;
  return;
end;