function Boolean ORCODClassCustCodeEFAfter(Integer wn,Integer changedf)
begin
  record ORCOVc ORCOr;
  record CUVc CUr;

  GetWindowRecord(wn,ORCOr);    
  if (changedf!=0) then begin
    CUr.Code = ORCOr.CustCode;
    if (ReadFirstMain(CUr,1,true)) then begin
      ORCOr.CustName = CUr.Name;
      ORCOr.PayDeal = CUr.PayDeal;
      if (nonblank(CUr.WarnText1)) then begin
        MessageBox(0,CUr.WarnText1);
      end;
      PutWindowRecord(wn,ORCOr);    
    end else begin
      Beep;
    end;
  end; 
  ORCODClassCustCodeEFAfter = true;
  return;
end;
 
global
function Boolean ORCODClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
begin
  Boolean res;

  switch (fieldname) begin
    case "CustCode": res = ORCODClassCustCodeEFAfter(wn,changed);
  end;
  ORCODClassAfterEditField = res;
  return;
end;

global
function Boolean ORCODClassActiveEditField(Integer wn,string fieldname,Integer fn,Integer wnst,Integer rownr,Integer changed)
begin
  Boolean res;
  record ORCOVc ORCOr;
  
  res = true;
  GetWindowRecord(wn,ORCOr);
  if (ORCOr.Closed>0) then begin res = false; end;
  switch (fieldname) begin
  end;
  ORCODClassActiveEditField = res;
  return;
end;

global
function Boolean ORCOSClassOnOpenWindow(Integer wn)
begin
  Integer mwn;
  record ORVc ORr;
  record VATIVVc VATIVr;

  mwn = MotherWindow(wn);
  switch (GetWindowClass(mwn)) begin
    case "ORDClass":
      GetWindowRecord(mwn,ORr);
      SetWindowSubset(wn,ORr.CustCode);
    case "VATIVDClass":
      GetWindowRecord(mwn,VATIVr);
      SetWindowSubset(wn,VATIVr.CustCode);
  end;
  ORCOSClassOnOpenWindow = false;
  return;
end;
