global
function Boolean LCMLevelSetTClassOnOKWindow(Integer wn)
begin
  record LCMLevelSetBlock LCMLevelSetBl; 
  Boolean res;
  record LCMemberLevelVc LCMemberLevelr;
  record PLDefVc PLr;
  record RebVc Rebr;
  row LCMLevelSetBlock LCMLevelSetrw;
  Integer i,rwcnt;
  
  res = true;
  GetWindowRecord(wn,LCMLevelSetBl);
  rwcnt = MatRowCnt(LCMLevelSetBl);
  for (i=0;i<rwcnt;i=i+1) begin
    MatRowGet(LCMLevelSetBl,i,LCMLevelSetrw);
    if (LCMLevelSetrw.FromPoints>LCMLevelSetrw.ToPoints and LCMLevelSetrw.ToPoints!=0) then begin
      MessageBox(26430,"");
      WindowFieldGoto(wn,LCMLevelSetBl,i,"FromPoints",true);
      res = -1;
      goto LLCMLevelSetBlockCheck;
    end;
    if (nonblank(LCMLevelSetrw.LCMLevel)) then begin
      LCMemberLevelr.Code = LCMLevelSetrw.LCMLevel;
      if (ReadFirstMain(LCMemberLevelr,1,true)==false) then begin
        MessageBox(26431,"");
        WindowFieldGoto(wn,LCMLevelSetBl,i,"LCMLevel",true);
        res = -1;
        goto LLCMLevelSetBlockCheck;
      end;
    end;
    if (nonblank(LCMLevelSetrw.RebCode)) then begin
      Rebr.Code = LCMLevelSetrw.RebCode;
      if (ReadFirstMain(Rebr,1,true)==false) then begin
        MessageBox(26432,"");
        WindowFieldGoto(wn,LCMLevelSetBl,i,"RebCode",true);
        res = -1;
        goto LLCMLevelSetBlockCheck;
      end;
    end;
    if (nonblank(LCMLevelSetrw.PLCode)) then begin
      PLr.Code = LCMLevelSetrw.PLCode;
      if (ReadFirstMain(PLr,1,true)==false) then begin
        MessageBox(26433,"");
        WindowFieldGoto(wn,LCMLevelSetBl,i,"PLCode",true);
        res = -1;
        goto LLCMLevelSetBlockCheck;
      end;
    end;
  end;
LLCMLevelSetBlockCheck:;
  LCMLevelSetTClassOnOKWindow = res;
  return;
end;
