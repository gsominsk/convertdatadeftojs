external function Boolean ProductInDemoMode();

global
function Boolean RemoteInIClassOnOpenWindow(Integer wn)
begin
  Boolean res;
  record InternetEnablerBlock IEr;
  record RcVc RepSpec;
  
  OpenWindow("ConfRemBackpWClass",0,0,"","",RepSpec);
  
  BlockLoad(IEr);
  if (nonblank(IEr.CustomerCode) and ProductInDemoMode==false) then begin
  end else begin
    res = true;
    if (ProductInDemoMode) then begin
      Trace(USetStr(7553),"");
    end else begin
      Trace(USetStr(7552),"");
      OpenWindow("DemoMsgWClass",0,0,"","",RepSpec);
    end;
  end;

  RemoteInIClassOnOpenWindow = false;
  return;
end;

global
updating function boolean RemoteInIClassOnOKWindow(integer wn)
begin
  record RcVc RepSpec;
  string 10 AllowImport;
  Integer nwn;
  
  AllowImport = GetWindowString(wn,"RemoteInIClassAllow");
  if (blank(AllowImport)) then begin 
    nwn = FindWindow("ConfRemBackpWClass");
    if (nwn!=0) then begin
      AllowImport = "0";
    end;
  end;
  if (AllowImport!="1") then begin 
    goto LRemoteInIClassOnOKWindow;
  end;
  ToolAction(wn,ToolGetRemoteFile,0,false);
  CloseWindow(wn);

LRemoteInIClassOnOKWindow:;
  RemoteInIClassOnOKWindow = false;
  return;
end;
