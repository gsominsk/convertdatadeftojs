function Boolean SerPrintTClassPrinterEFAfter(Integer wn,Boolean changedf)
begin
  Boolean res;
  record SerPrintBlock SPb;
  
  GetWIndowRecord(wn,SPb)
  switch (SPb.Printer) begin
    case 1:
      SPb.BaudRate = 9600;
      SPb.ByteSize = 8;
      SPb.StopBits = 0;
      SPb.Parity = 0;
    case 2:
      SPb.BaudRate = 9600;
      SPb.ByteSize = 8;
      SPb.StopBits = 0;
//      SPb.Parity = 0;
  end;
  PutWIndowRecord(wn,SPb)
  SerPrintTClassPrinterEFAfter = res;
  return;
end;

global
function Boolean SerPrintTClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
begin
  Boolean res;

  switch (fieldname) begin
    case "Printer": res = SerPrintTClassPrinterEFAfter(wn,changed!=0);
  end;
  SerPrintTClassAfterEditField = res;
  return;
end;
