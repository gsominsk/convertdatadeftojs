
global
updating function boolean FrenchFECEClassOnOKWindow(integer wn)
begin
  boolean res;
  record RcVc RepSpec;
  row YearBlock Ybrw;
  date td,sd,ed,sd1;
  longint days;
  integer monthint;

  res = true;
  GetWindowRecord(wn,RepSpec);
  
  //start date
  td = RepSpec.sStartDate;
  days = DaysInMonth(td.Year,td.Month); // gets number of days in a give date
  sd1 = AddDay(td,-td.Day+1);           // gets the first date of the month for a given date
 
  //end date
  td = RepSpec.sEndDate;
  days = DaysInMonth(td.Year,td.Month); // gets number of days in a give date
  sd = AddDay(td,-td.Day+1);            // gets the first date of the month for a given date
  ed = AddDay(sd,days-1);               // gets the last date of the month for a given date
  
  if (RepSpec.sStartDate!=sd1) then begin 
    MessageBox(20851,chr(13) & " : " & RepSpec.sStartDate);
    res = false;      
  end;
  if (res) then begin 
    if (RepSpec.sEndDate!=ed) then begin 
      MessageBox(20851,chr(13) & " : " & RepSpec.sEndDate);
      res = false;  
    end;
  end;
  FrenchFECEClassOnOKWindow = res;
  return;
end;