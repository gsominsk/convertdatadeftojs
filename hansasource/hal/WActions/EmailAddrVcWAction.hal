global
function Boolean EmailAddrDClassAddrNameEFAfter(Integer wn,Boolean changedef)
begin
  Boolean res;
  record EmailAddrVc EmAr;
  record ConfVc Confr;

  if (changedef) then begin
    GetWindowRecord(wn,EmAr);
    Confr.AddrName = EmAr.AddrName;
    if (ReadFirstKey("AddrName",Confr,1,true)) then begin
      EmAr.AddrCode = Confr.AddrCode;
      EmAr.SerNr = Confr.SerNr;
    end;
    PutWindowRecord(wn,EmAr);
    res = true;
  end;
  EmailAddrDClassAddrNameEFAfter = res;
  return;
end;

global
function Boolean EmailAddrDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
begin
  Boolean res;

  switch (fieldname) begin
    case "AddrName": res = EmailAddrDClassAddrNameEFAfter(wn,changed!=0);
  end;
  EmailAddrDClassAfterEditField = res;
  return;
end;
