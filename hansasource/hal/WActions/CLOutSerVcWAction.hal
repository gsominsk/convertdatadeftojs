global 
function Boolean CLOutSerTClassDeleteRowTest(Integer wn,Integer rownr)
begin
  record CLOutSerBlock CLOutSerr;
  row CLOutSerBlock CLOutSerrw;
  Boolean res;
  Integer rwcnt;
  record MainCLBlock MainCLRec;
  record CLOutVc CLOutr;

  res = true;
  if (rownr>-1) then begin
    BlockLoad(MainCLRec);
    GetWindowRecord(wn,CLOutSerr);
    if ((rownr>0) and rownr<MatRowCnt(CLOutSerr)) then begin
      MatRowGet(CLOutSerr,rownr,CLOutSerrw);
      if ((MainCLRec.ChronologyforCLNo!=0)) then begin//update
          if (CLOutSerrw.TSerStart!=-1) then begin
            CLOutr.SerNr = CLOutSerrw.TSerEnd;
            if (ReadLastMain(CLOutr,1,false)) then begin
              if (CLOutr.SerNr>=CLOutSerrw.TSerStart) then begin
                res = false;
                MessageBox(1560,"");
                goto LCLOutSerTClassDeleteRowTest;
              end;
            end;
          end;
      end;
    end;
  end;
LCLOutSerTClassDeleteRowTest:;  
  CLOutSerTClassDeleteRowTest = res;
  return;
end;
