global 
function Boolean VATVITypeTClassDeleteRowTest(Integer wn,Integer rownr)
begin
  record VATVITypeBlock VATVITypeb;
  row VATVITypeBlock VATVITypebrw;
  Boolean res;
  record VATVIVc VATVIr;

  res = true;
  if (rownr>-1) then begin
    GetWindowRecord(wn,VATVITypeb);
    MatRowGet(VATVITypeb,rownr,VATVITypebrw);
    if (nonblank(VATVITypebrw.Code)) then begin
      VATVIr.VATVIType = VATVITypebrw.Code;
      res = not ReadFirstKey("VATVIType",VATVIr,1,true);
      if (res==false) then begin
        MessageBox(22093,"");
      end;
    end;
  end;
  VATVITypeTClassDeleteRowTest = res;
  return;
end;

global
function Boolean VATVITypeTClassActiveEditField(Integer wn,string fieldname,Integer fn,Integer wnst,Integer rownr,Integer changed)
begin
  Boolean res;
  record VATVITypeBlock VATVITypeb;
  row VATVITypeBlock VATVITypebrw;
  record VATVIVc VATVIr;
  
  res = true;
  GetWindowRecord(wn,VATVITypeb);
  switch (fieldname) begin
    case "Code": 
      MatRowGet(VATVITypeb,rownr,VATVITypebrw);
      if (nonblank(VATVITypebrw.Code)) then begin
        VATVIr.VATVIType = VATVITypebrw.Code;
        res = not ReadFirstKey("VATVIType",VATVIr,1,true);
        if (res==false) then begin
          MessageBox(22093,"");
        end;
      end;
  end;
  VATVITypeTClassActiveEditField = res;
  return;
end;
