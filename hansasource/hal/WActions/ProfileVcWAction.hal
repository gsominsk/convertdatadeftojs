//external updating procedure RecordActionProfile_Print(var record ProfileVc,string,Boolean);

/* Can no longer print from old Guest card
global
updating function Boolean ProfileDClassPrint(Integer wn,Boolean previewf)
BEGIN
  record ProfileVc Profiler;
  Integer normalmode,tf;
  string 20 docname;

  normalmode = 0;//Rs_normal
  DeselectWindow(wn,false);
  GetWindowRecord(wn,Profiler);  
  if ((WindowState(wn)==normalmode) and (previewf==false)) then begin
    RecordActionProfile_Print(Profiler,"",true);
  end else begin
    if (PrintDocument(Profiler,"GuestDocForm",true)) then begin end;
  end;

  RETURN;
END;
*/

global
function Boolean ProfileDClassBirthDateEFAfter(integer wn,Integer fn,Integer rownr,Integer changedf)
begin
  record ProfileVc Profiler;
  Boolean res;
  LongInt n;

  res = true;
  if (changedf!=0) then begin
    GetWindowRecord(wn,Profiler);
    n = GetYear(CurrentDate) - GetYear(Profiler.BirthDate);
    if (GetMonth(CurrentDate) < GetMonth(Profiler.BirthDate) ) then begin
      n = n - 1;
    end;
    Profiler.Age = n;
    PutWindowRecord(wn,Profiler);
  end;
  ProfileDClassBirthDateEFAfter = res;  
  RETURN;
END;

global
function Boolean ProfileDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;

  switch (fieldname) begin
    case "BirthDate": res = ProfileDClassBirthDateEFAfter(wn,fn,rownr,changed);
  end;
  ProfileDClassAfterEditField = res;
  RETURN;
END;

/*
global
procedure PrintProfileD(Integer wn,Boolean previewf)
BEGIN
  record ProfileVc Profiler;
  record RcVc RepSpec;
  
  GetWindowRecord(wn,Profiler);
  RepSpec.repname = "CustRn";
  RepSpec.Media = mtScreen;
  RepSpec.JobDf = 0;
  RepSpec.f1 = Profiler.Code;
  RepSpec.flags[2] = 1;
  RunReport(RepSpec,0);
  RETURN;
END;

global
procedure PrintProfileL(Integer wn,Boolean previewf)
BEGIN
  record ProfileVc Profiler;
  record RcVc RepSpec;  
  Integer i;
  
  i = 1;
  while (GetRecordFromBrowse(Profiler,wn,i)) begin
    if (i==1) then begin
      RepSpec.f1 = Profiler.Code;
    end;
    i = i + 1;
  end;
  RepSpec.repname = "CustRn";
  RepSpec.Media = mtScreen;
  RepSpec.JobDf = 0;
  if (nonblank(RepSpec.f1)) then begin
    RepSpec.f1 = RepSpec.f1 & ":";
  end;
  RepSpec.f1 = RepSpec.f1 & Profiler.Code;
  RepSpec.flags[2] = 1;
  RunReport(RepSpec,0);
  RETURN;
END;
*/
