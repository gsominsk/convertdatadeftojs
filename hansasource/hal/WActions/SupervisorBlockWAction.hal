function Boolean SupervisorTClassUserCodeEFAfter(Integer wn,Integer rownr,Boolean changedf)
begin
  record SupervisorBlock Supervisorb;
  row SupervisorBlock Supervisorbrw;
  record UserVc Userr;

  if (changedf) then begin
    if (rownr>=0) then begin
      GetWindowRecord(wn,Supervisorb);        
      MatRowGet(Supervisorb,rownr,Supervisorbrw);
      Userr.Code = Supervisorbrw.UserCode;
      ReadFirstMain(Userr,1,true)
      Supervisorbrw.UserName = Userr.Name;
      MatRowPut(Supervisorb,rownr,Supervisorbrw);
      PutWindowRecord(wn,Supervisorb);    
    end;
  end;
  SupervisorTClassUserCodeEFAfter = true;
  return;
end;

global
function Boolean SupervisorTClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
begin
  Boolean res;

  switch (fieldname) begin
    case "UserCode": res = SupervisorTClassUserCodeEFAfter(wn,rownr,changed!=0);
  end;
  SupervisorTClassAfterEditField = res;
  return;
end;
