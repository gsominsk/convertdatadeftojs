
function Boolean QTAnalysisDClassItemCodeEFAfter(Integer wn,Integer fn,Integer rownr,Integer changedf)
begin
  Boolean res;
  record QTAnalysisVc QTAnalysisr;
  row QTAnalysisVc QTAnalysisrw;
  record INVc INr;
  
  res = true;
  if (changedf!=0) then begin
    GetWindowRecord(wn,QTAnalysisr);
    if (rownr>=0) then begin
      MatRowGet(QTAnalysisr,rownr,QTAnalysisrw);
      INr.Code = QTAnalysisrw.ItemCode;
      if (ReadFirstMain(INr,1,true)) then begin
        QTAnalysisrw.ItemName = INr.Name;
        MatRowPut(QTAnalysisr,rownr,QTAnalysisrw);
      end;
    end else begin
      INr.Code = QTAnalysisr.ItemCode;
      if (ReadFirstMain(INr,1,true)) then begin
        QTAnalysisr.ItemName = INr.Name;
      end;
    end;
    PutWindowRecord(wn,QTAnalysisr);
  end;
  QTAnalysisDClassItemCodeEFAfter = res;
  return;
end;

global
function Boolean QTAnalysisDClassAfterEditField(Integer wn,string fieldname,Integer fn,Integer rownr,Integer changed)
BEGIN
  Boolean res;
  
  res = false;
  switch (fieldname) begin
    case "ItemCode": res = QTAnalysisDClassItemCodeEFAfter(wn,fn,rownr,changed);
  end;
  QTAnalysisDClassAfterEditField = res;
  RETURN;
END;

