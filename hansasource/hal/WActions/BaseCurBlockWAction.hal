//Should be AccBlockCheck but it is called in more places than storing blocks from the interface
global
function Boolean BaseCurTClassOnOKWindow(Integer wn)
begin
  record BaseCurBlock BCb;
  record CurncyCodeVc Curncyr;
  Boolean res;  

  res = true;
  GetWindowRecord(wn,BCb);
  if (nonblank(BCb.BaseCur1)) then begin
    if (BCb.BaseCur1==BCb.BaseCur2) then begin
      MessageBox(20029,"");
      WindowFieldGoto(wn,BCb,-1,"BaseCur2",true);
      res = -1;
      goto LBaseCurBlockCheck;
    end;
  end;
  if (nonblank(BCb.BaseCur1)) then begin
    Curncyr.CurncyCode = BCb.BaseCur1;
    if (ReadFirstMain(Curncyr,1,true)==false) then begin
      MessageBox(1260,BCb.BaseCur1);
      WindowFieldGoto(wn,BCb,-1,"BaseCur1",true);
      res = -1;
      goto LBaseCurBlockCheck;
    end;
  end;  
  if (nonblank(BCb.BaseCur2)) then begin
    Curncyr.CurncyCode = BCb.BaseCur2;
    if (ReadFirstMain(Curncyr,1,true)==false) then begin
      MessageBox(1260,BCb.BaseCur2);
      WindowFieldGoto(wn,BCb,-1,"BaseCur2",true);
      res = -1;
      goto LBaseCurBlockCheck;
    end;
  end;  
LBaseCurBlockCheck:;
  BaseCurTClassOnOKWindow = res;
  return;
end;
