global
function Boolean INEffDClassOKFlagButtonAction(Integer wn,Integer value)
begin
  Boolean res;
  Integer normalmode,updatemode;
  record INEffVc INEffr;

  res = true;
  normalmode = 0;//Rs_normal
  updatemode = 2;//Rs_update
  if (WindowState(wn)==normalmode) then begin
    GetWindowRecord(wn,INEffr);
  end;  
  if (WindowState(wn)==updatemode) then begin
    GetPrevWindowRecord(wn,INEffr);
  end;  
  if (INEffr.OKFlag!=0) then begin
    res = false;
  end;
  INEffDClassOKFlagButtonAction = res;
  return;
end;

global
function Boolean INEffDClassActiveEditField(Integer wn,string fieldname,Integer fn,Integer wnst,Integer rownr,Integer changed)
BEGIN
  Boolean res;
  
  record INEffVc INEffr;
  
  res = true;
  GetWindowRecord(wn,INEffr);
  if (INEffr.OKFlag!=0) then begin
    res = false;
  end;
  INEffDClassActiveEditField = res;
  RETURN;
END;
