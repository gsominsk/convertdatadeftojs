global 
function Boolean CLInSerTClassDeleteRowTest(Integer wn,Integer rownr)
begin
  record CLInSerBlock CLInSerr;
  row CLInSerBlock CLInSerrw;
  Boolean res;
  Integer rwcnt;
  record MainCLBlock MainCLRec;
  record CLInVc CLInr;

  res = true;
  if (rownr>-1) then begin
    BlockLoad(MainCLRec);
    GetWindowRecord(wn,CLInSerr);
    if ((rownr>0) and rownr<MatRowCnt(CLInSerr)) then begin
      MatRowGet(CLInSerr,rownr,CLInSerrw);
      if ((MainCLRec.ChronologyforCLNo!=0)) then begin//update
          if (CLInSerrw.TSerStart!=-1) then begin
            CLInr.SerNr = CLInSerrw.TSerEnd;
            if (ReadLastMain(CLInr,1,false)) then begin
              if (CLInr.SerNr>=CLInSerrw.TSerStart) then begin
                res = false;
                MessageBox(1560,"");
                goto LCLInSerTClassDeleteRowTest;
              end;
            end;
          end;
      end;
    end;
  end;
LCLInSerTClassDeleteRowTest:;  
  CLInSerTClassDeleteRowTest = res;
  return;
end;
