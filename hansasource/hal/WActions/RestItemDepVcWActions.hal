remote function Boolean RestItemDepVc_PasteArtCode(var record RestItemDepVc);

function Boolean RestItemDeptDClassArtCodeEFAfter(Integer wn,Boolean changedf)
begin  
  record RestItemDepVc RestItemDepr;
  record INVc INr;
  boolean updatef;

  DeselectWindow(wn,false);
  if (changedf) then begin
    GetWindowRecord(wn,RestItemDepr);
    if ((changedf) and (nonblank(RestItemDepr.ArtCode))) then begin
      if (RestItemDepVc_PasteArtCode(RestItemDepr)) then begin
        updatef = true;
      end else begin
        Beep;
      end;
    end;
    if (blank(RestItemDepr.ArtCode)) then begin 
      RestItemDepr.ArtName = "";
      updatef = true;
    end;
    if (updatef) then begin 
      PutWindowRecord(wn,RestItemDepr);
    end;
  end;
  RestItemDeptDClassArtCodeEFAfter = true;
  return;
end;

global
function Boolean RestItemDeptDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
begin
  Boolean res;

  switch (fieldname) begin
    case "ArtCode": res = RestItemDeptDClassArtCodeEFAfter(wn,changed!=0);
  end;
  RestItemDeptDClassAfterEditField = res;
  return;
end;
