
global
function string 40 ArtUpdStockDClassSpecPasteName(Integer wn,string defpsname)
begin
  string 255 psname;
  record ArtUpdStockVc ArtUpdStockr;
  row ArtUpdStockVc ArtUpdStockrw;
  Integer rownr;
  
  psname = defpsname;
  switch (WindowActiveField(wn)) begin
    case "ItemGroup":
      GetWindowRecord(wn,ArtUpdStockr);
      rownr = WindowActiveRow(wn);
      if (rownr>=0) then begin
        MatRowGet(ArtUpdStockr,rownr,ArtUpdStockrw);
      end;
      switch (ArtUpdStockrw.CodeType) begin
        case 0: psname = "ITSClass";
        case 1: psname = "INSClass";
      end;
  end;
  ArtUpdStockDClassSpecPasteName = psname;
  return;
end;
