global
function Boolean LoyaltyPointsTCLassOnOKWindow(Integer wn)
begin
  record LoyaltyPointsBlock LoyaltyPointBl; 
  Boolean res;
  record LCMemberLevelVc LCMemberLevelr;
  row LoyaltyPointsBlock LoyaltyPointrw;
  Integer i,rwcnt;

  res = true;
  GetWindowRecord(wn,LoyaltyPointBl);
  rwcnt = MatRowCnt(LoyaltyPointBl);
  for (i=0;i<rwcnt;i=i+1) begin
    MatRowGet(LoyaltyPointBl,i,LoyaltyPointrw);
    if (nonblank(LoyaltyPointrw.LCMLevel)) then begin
      LCMemberLevelr.Code = LoyaltyPointrw.LCMLevel;
      if (ReadFirstMain(LCMemberLevelr,1,true)==false) then begin
        MessageBox(26431,"");
        WindowFieldGoto(wn,LoyaltyPointBl,i,"LCMLevel",true);
        res = -1;
        goto LLoyaltyPointBlockCheck;
      end;
    end;
  end;
LLoyaltyPointBlockCheck:;
  LoyaltyPointsTCLassOnOKWindow = res;
  return;
end;
