remote function Boolean SVOTextVc_PasteSerialNr(var record SVOTextVc);

function Boolean SVOTextDClassSerialNrEFAfter(Integer wn,Integer changed)
BEGIN
  record SVOTextVc SVOTextr;
  
  if (changed!=0) then begin
    GetWindowRecord(wn,SVOTextr);
    DeselectWindow(wn,false);
    if (SVOTextVc_PasteSerialNr(SVOTextr)) then begin
      PutWindowRecord(wn,SVOTextr);
    end else begin
      Beep;
    end;
  end;
  SVOTextDClassSerialNrEFAfter = true;
  RETURN;
END;

global
function Boolean SVOTextDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;

  switch (fieldname) begin
    case "SerialNr": res = SVOTextDClassSerialNrEFAfter(wn,changed);
  end;
  SVOTextDClassAfterEditField = res;
  RETURN;
END;

global
function Boolean SVOTextDClassActiveEditField(Integer wn,string fieldname,Integer fn,Integer wnst,Integer rownr,Integer changed)
BEGIN
  Boolean res;
 
  res = true;
  switch (fieldname) begin
    case "ArtCode": res = false;
    case "SerialNr": res = true;
  end;
  SVOTextDClassActiveEditField = res;
  RETURN;
END;
