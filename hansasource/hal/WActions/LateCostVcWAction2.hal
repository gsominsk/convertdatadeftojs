external function string 40 SerialNrSClassSpecPName(string);

function Boolean LateCostVcRowEFActiveCheck(string fieldname,Integer wn,Integer wnst,Integer rownr)
BEGIN
  Boolean res;
  record LateCostVc LateCostr;
  Integer updatemode;

  updatemode = 2;//Rs_update
  GetWindowRecord(wn,LateCostr);
  switch (fieldname) begin
    case "Quant": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "UPrice": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "Extra": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "CostPrice": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "ShipCost": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "CustomsCost": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "Coefficient": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "BasePrice": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "Sum": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "RowCost1": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "RowCost2": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "RowCost3": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "RowCost4": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "RowCost5": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "PURow": if (LateCostr.OKFlag==0) then begin res = true; end;
//    case "SerialNr": if (LateCostr.OKFlag==0) then begin res = true; end;/?
    otherwise res = false;
  end;
  LateCostVcRowEFActiveCheck = res;
  RETURN;
END;

function Boolean LateCostVcEFActiveCheck(string fieldname,Integer wn,Integer wnst)
BEGIN
  Boolean res;
  record LateCostVc LateCostr;
  Integer updatemode;

  updatemode = 2;//Rs_update
  GetWindowRecord(wn,LateCostr);
  switch (fieldname) begin
    case "PUNr": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "SerNr": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "TransDate": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "ShipCost": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "CustomsCost": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "ExtraCost": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "FrRate": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "ToRateB1": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "ToRateB2": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "BaseRate1": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "BaseRate2": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "Cost1": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "Cost2": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "Cost3": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "Cost4": if (LateCostr.OKFlag==0) then begin res = true; end;
    case "Cost5": if (LateCostr.OKFlag==0) then begin res = true; end;
    otherwise res = false;
  end;
  LateCostVcEFActiveCheck = res;
  RETURN;
END;

global
function Boolean LateCostDClassActiveEditField(Integer wn,string fieldname,Integer fn,Integer wnst,Integer rownr,Integer changed)
BEGIN
  Boolean res;
  
  if (rownr==-1) then begin
    res = LateCostVcEFActiveCheck(fieldname,wn,wnst);
  end else begin
    res = LateCostVcRowEFActiveCheck(fieldname,wn,wnst,rownr);
  end;
  LateCostDClassActiveEditField = res;
  RETURN;
END;

global
function string 40 LateCostDClassSpecPasteName(Integer wn,string defpsname)
begin
  string 255 psname;
  
  psname = defpsname;
  switch (WindowActiveField(wn)) begin
    case "SerialNr": psname = SerialNrSClassSpecPName(defpsname);
  end;
  LateCostDClassSpecPasteName = psname;
  return;
end;
