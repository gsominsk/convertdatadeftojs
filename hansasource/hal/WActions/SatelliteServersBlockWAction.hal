global
procedure OpenSatServers()
begin
  record RcVc RepSpec;
  
  if (IsLoggedIn) then begin
    OpenWindow("SatServersWClass",1,0,"","",RepSpec);
  end;
  return;
end;

global
function Boolean SatServersWClassOnOKWindow(Integer wn)
begin
  record SatServersBlock SSb;
  row SatServersBlock SSrw;
  LongInt line;
  Boolean res;
  Integer i,rwcnt;
  string 255 tstr;

  res = true;
  line = SelectedListLine(wn);
  if (line>=0) then begin
    tstr = GetListString(wn,line);
    BlockLoad(SSb);
    MatRowGet(SSb,line,SSrw);
    if (nonblank(tstr)) then begin
      BlockLoad(SSb);
      rwcnt = MatRowCnt(SSb);
      for (i=0;i<rwcnt;i=i+1) begin
        MatRowGet(SSb,i,SSrw);
        if (SSrw.Name==tstr) then begin
          if (LaunchClient(SSrw.Name)==false) then begin
            InstallClientToServer(SSrw.HostName,SSrw.WebPort,SSrw.HansaPort,SSrw.Name,SSrw.EncKey);
          end;
        end;
      end;
    end;
  end;
  
  SatServersWClassOnOKWindow = res;
  return;
end;

global
function Boolean SatServersWClassOnOpenWindow(Integer wn)
begin
  Integer i,rwcnt;
  record SatServersBlock SSb;
  row SatServersBlock SSrw;
  
  BlockLoad(SSb);

  rwcnt = MatRowCnt(SSb);
  for (i=0;i<rwcnt;i=i+1) begin
    MatRowGet(SSb,i,SSrw);
    SetListString(wn,i,SSrw.Name,false);
  end;
  
  SatServersWClassOnOpenWindow = false;
  return;
end;
