function Boolean WHVEDClassVECodeEFAfter(Integer wn,Boolean changedf)
BEGIN
  record WHVEVc WHVEr;
  record CUVc CUr;
  Boolean res;
  
  if (changedf) then begin
    GetWindowRecord(wn,WHVEr);
    CUr.Code = WHVEr.VECode;
    if (ReadFirstMain(CUr,1,true)) then begin
      WHVEr.Comment = CUr.Name;
    end;
    PutWindowRecord(wn,WHVEr);
    res = true;
  end;
  WHVEDClassVECodeEFAfter = res;
  RETURN;
END;

global
function Boolean WHVEDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;

  switch (fieldname) begin
    case "VECode": res = WHVEDClassVECodeEFAfter(wn,changed!=0);
  end;
  WHVEDClassAfterEditField = res;
  RETURN;
END;
