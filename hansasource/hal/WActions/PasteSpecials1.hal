remote procedure POSButtonsPagesSClassArrayOnOpen(string,LongInt,var Array string);
remote procedure ActPrioLevelSClassArrayOnOpen(var Array string);
external procedure AutomatedSalesOrderly(string);
remote procedure CountryNameSClassOnOpenRemote(var Array string);
remote procedure PL2SClassArrayOnOpen(string,string,string,var Array string,var Array string,var Array string,var Array string);
remote procedure PDPMSClassArrayOnOpen(var Array string,var Array string,var Array string);
remote procedure LegalInvNr2SClassArrayOnOpen(string,LongInt,Date,string,var Array string,var Integer,Integer,string,string,Integer);
external procedure WindowFieldGotoForTouchScreen(Integer,Integer,string,Boolean);
external procedure PasteFromWn(Integer,string);
remote procedure CUDocTypeSClassArrayOnOpen(var Array string,var Array string,var Integer);
remote procedure ApproversSClassArrayOnOpen(var Array string,var Array string,var Integer,string);
external function Boolean IVDClassVoidRow(var record IVVc,Integer);
external procedure IVDClass_RefreshStringList(Integer,record IVVc);
remote function Boolean PasteCust2InInv(var record IVVc,record LocalMachineBlock,string,Boolean,var string,var string,var string,var string,var string);
remote procedure FillPPSClass(string,string,record ExpVc,Integer,var Array string,var Array string,var Integer);
external function val ValFromString(string,string,string);
external procedure ExtractObj(string,var Integer,var string);
remote procedure UserNPTSSClassArrayOnOpen(var Array string,var Integer);
remote function Boolean RestAccVc_PasteCUCode(var record RestAccVc);
external function Boolean RestAccDClasstouchscreenitemEFAfter(Integer ,Boolean);
external function string 255 StringFromSysList(Integer,Integer);
remote procedure BaggerSClassArrayOnOpen(var Array string,var Integer);
remote procedure SupervisorSClassArrayOnOpen(var Array string,var Integer);
remote procedure FillARPay2SClass(string,string,string,Date,var Array string,var Integer);
external procedure SetPOSWindowDisplay(string,string);
external procedure IVCashDClass_RefreshStringList(Integer,record IVCashVc);
external function Boolean IVCashDClassVoidRow(var record IVCashVc,Integer);
remote function Boolean IVCashVc_PasteCustCode(var record IVCashVc,string,string,string,var Integer,var string);
external procedure PasteFromSysList(Integer ,Integer);
remote procedure RestAccClassNPTSSClassArrayOnOpen(var Array string,var Integer);
remote procedure CUNPTSSClassArrayOnOpen(record RcVc,var Array string,var Integer);
remote procedure INNPTSSClassArrayOnOpen(record RcVc,var Array string,var Array string,var Array val,var Integer);
remote procedure ActType3SClassArrayOnOpen(string,var Array string,var Integer);
remote procedure ReservationStatus2SClassArrayOnOpen(string,var Array string,var Integer);
external procedure ActTypeConseqSClassArrayOnOpen(string,var Array string,var Integer);
external procedure ActTypeConseqDataListSClassArrayOnOpen(string,var Array string,var Array string);
external procedure APInstSClassArrayOnOpen(LongInt,var Array string,var Integer);
external procedure ARInstSClassArrayOnOpen(LongInt,var Array string,var Integer);
external procedure ARInstallSClassArrayOnOpen(LongInt,var Array string,var Integer);
external procedure APInstallSClassArrayOnOpen(LongInt,var Array string,var Integer);
external procedure INVc_DIClassSClass(record INVc,var record RcVc);
external procedure DIClassBTSClassArrayOnOpen(integer,integer,var Array string,var Integer);
external procedure VARsubSClassArrayOnOpen(integer,integer,var Array string,var Integer);
external procedure PRClBTSClassArrayOnOpen(integer,integer,var Array string,var Integer);
remote procedure PRVc_AssPRClSClass(record PRVc,var record RcVc);
remote procedure VEBankAccSClassArrayOnOpen(string,var Array string,var Integer);
remote procedure LegalCLInNrSClassArrayOnOpen(LongInt,Date,var Array string,var Integer);
remote procedure LegalInvNrSClassArrayOnOpen(string,LongInt,Date,string,var Array string,var Integer,Integer,string,string,Integer);
remote procedure LegalInvNrSClassArrayOnOpen2(string,LongInt,Date,string,var Array string,var Integer,Integer,Integer,string,string,Integer);
external procedure StripEndingSpaces(var string);
external procedure M4PadString(string,Integer,string,Boolean,var string);
external procedure ModulesSClassArrayOnOpen(var Array string,var Integer);
external procedure TTRFieldSClassArrayOnOpen(var Array string,var Integer);
remote procedure UserDefRepLinesSClassArrayOnOpen(var Array string,var Integer,string);
external function string 255 removenextlistitem(var string,string);
remote procedure XBRLElementSClassArrayOnOpen(var Array string,var Integer,Integer);
external procedure IntrastatTransCodeSClassArrayOnOpen(var Array string,var Integer);
external function string 255 GetIntrastatTransCode(Integer,string);

global
function Boolean ModulesSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt;
  
  ModulesSClassArrayOnOpen(astr,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  ModulesSClassOnOpenWindow = false;
  return;
end;

global
function Boolean TTRFieldSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt;
  
  TTRFieldSClassArrayOnOpen(astr,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  TTRFieldSClassOnOpenWindow = false;
  return;
end;

global
function Boolean AssPRClSClassOnOpenWindow(Integer wn)
begin
  Integer mwn;
  record RcVc RepSpec;
  record PRVc PRr;
  
  mwn = MotherWindow(wn);
  GetWindowRecord(mwn,PRr);
 // GetWindowRecord(wn,RepSpec);
  PRVc_AssPRClSClass(PRr,RepSpec);
  PutWindowRecord(wn,RepSpec);
  AssPRClSClassOnOpenWindow = false;
  return;
end;

global
function Boolean  PRClBTSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt,mwn,fn;  
  
  mwn = MotherWindow(wn);
  switch (WindowActiveField(mwn)) begin
    case "f1": fn = 1;
    case "f2": fn = 2;
    case "f3": fn = 3;
    case "f4": fn = 4;
    case "f5": fn = 5;
    case "ObjStr": fn = 6;
    case "Stext": fn = 7;
    case "LastAcc": fn = 8;
  end;
  PRClBTSClassArrayOnOpen(mwn,fn,astr,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  PRClBTSClassOnOpenWindow = false;
  return;
end;

global
Function Boolean CheckInJobSClassOnOpenWindow(Integer wn)
begin
  record JobVc Jobr;
  record HotelBlock HotelSettings;
  Boolean Cont;
  string 100 tstr,t2;
  
  BlockLoad(HotelSettings); Cont = true;
  Jobr.ResStatus = HotelSettings.ChInSt;
  while LoopKey("ResStatus",Jobr,1,Cont) begin
    if (Jobr.ResStatus <> HotelSettings.ChInSt) then begin
      Cont = false;
    end else begin
      tstr = Jobr.SerNr;
      M4PadString(tstr,8," ",false,t2);
      t2 = t2 & Jobr.CUName;
      SetListString(wn,1,t2,false);
    end;
  end;  
  CheckInJobSClassOnOpenWindow = false;
  return;
end;

global
Function Boolean CheckInJobSClassOnOKWindow(Integer wn)
begin
  Integer mwn;
  string 60 tstr,t2;
  Integer np;
  Boolean nsep;
  
  mwn = MotherWindow(wn);
  tstr = GetListString(wn,SelectedListLine(wn));
  np = 0;
  tstr = left(tstr,6);
  StripEndingSpaces(tstr);
  CloseWindow(wn);
  PasteString(mwn,tstr);
  CheckInJobSClassOnOKWindow = false;
  return;
end;

global
function Boolean LegalInvNrSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt;
  Integer mwn;
  record IVVc IVr;
  record IVCashVc IVCashr;
  record RestAccVc RestAccr;
  record StockMovVc StockMovr;
  record ORVc ORr;
  record SHVc SHr;
  record RetVc Retr;
  record RetPUVc RetPUr;
  record IPVc IPr;
  row IPVc IPrw;
  Integer doctype;
  
  mwn = MotherWindow(wn);
  if (GetWindowFileName(mwn)=="IVVc") then begin
    GetWindowRecord(mwn,IVr);
    LegalInvNrSClassArrayOnOpen2("IVVc",IVr.SerNr,IVr.InvDate,IVr.CustCode,astr,acnt,IVr.InvType,IVr.TaxInvType,IVr.TerminalID,IVr.BranchID,IVr.Status);
    for (i=0;i<acnt;i=i+1) begin
      SetListString(wn,len(astr[i]),astr[i],false);    
    end;
  end;
  if (GetWindowFileName(mwn)=="IVCashVc") then begin
    GetWindowRecord(mwn,IVCashr);
    LegalInvNrSClassArrayOnOpen("IVCashVc",IVCashr.SerNr,IVCashr.InvDate,IVCashr.CustCode,astr,acnt,10,IVCashr.TerminalID,IVCashr.BranchID,IVCashr.Status);
    for (i=0;i<acnt;i=i+1) begin
      SetListString(wn,len(astr[i]),astr[i],false);    
    end;
  end;
  if (GetWindowFileName(mwn)=="RestAccVc") then begin
    GetWindowRecord(mwn,RestAccr);
    LegalInvNrSClassArrayOnOpen("RestAccVc",RestAccr.SerNr,RestAccr.TransDate,RestAccr.CustCode,astr,acnt,16,RestAccr.TerminalID,RestAccr.BranchID,-1);
    for (i=0;i<acnt;i=i+1) begin
      SetListString(wn,len(astr[i]),astr[i],false);    
    end;
  end;
  if (GetWindowFileName(mwn)=="StockMovVc") then begin
    GetWindowRecord(mwn,StockMovr);
    switch (StockMovr.StockMovType) begin
      case kStockMovTypeNormal: LegalInvNrSClassArrayOnOpen("StockMovVc",StockMovr.SerNr,StockMovr.TransDate,"",astr,acnt,11,StockMovr.TerminalID,StockMovr.BranchID,StockMovr.Status);
      case kStockMovTypeOwnGoodsTransport: LegalInvNrSClassArrayOnOpen("StockMovVc",StockMovr.SerNr,StockMovr.TransDate,"",astr,acnt,18,StockMovr.TerminalID,StockMovr.BranchID,StockMovr.Status);
      case kStockMovTypeConsigment: LegalInvNrSClassArrayOnOpen("StockMovVc",StockMovr.SerNr,StockMovr.TransDate,"",astr,acnt,19,StockMovr.TerminalID,StockMovr.BranchID,StockMovr.Status);
      case kStockMovTypeThirdEntGoodsTransport: LegalInvNrSClassArrayOnOpen("StockMovVc",StockMovr.SerNr,StockMovr.TransDate,"",astr,acnt,20,StockMovr.TerminalID,StockMovr.BranchID,StockMovr.Status);
      case kStockMovTypeGlobalTransport: LegalInvNrSClassArrayOnOpen("StockMovVc",StockMovr.SerNr,StockMovr.TransDate,"",astr,acnt,21,StockMovr.TerminalID,StockMovr.BranchID,StockMovr.Status);
    end;
    for (i=0;i<acnt;i=i+1) begin
      SetListString(wn,len(astr[i]),astr[i],false);    
    end;
  end;  
  if (GetWindowFileName(mwn)=="ORVc") then begin
    GetWindowRecord(mwn,ORr);
    LegalInvNrSClassArrayOnOpen("ORVc",ORr.SerNr,ORr.OrdDate,ORr.CustCode,astr,acnt,12,ORr.TerminalID,ORr.BranchID,-1);
    for (i=0;i<acnt;i=i+1) begin
      SetListString(wn,len(astr[i]),astr[i],false);    
    end;
  end;
  if (GetWindowFileName(mwn)=="RetVc") then begin
    GetWindowRecord(mwn,Retr);
    LegalInvNrSClassArrayOnOpen("RetVc",Retr.SerNr,Retr.TransDate,Retr.CustCode,astr,acnt,13,Retr.TerminalID,Retr.BranchID,Retr.Status);
    for (i=0;i<acnt;i=i+1) begin
      SetListString(wn,len(astr[i]),astr[i],false);    
    end;
  end; 
  if (GetWindowFileName(mwn)=="RetPUVc") then begin
    GetWindowRecord(mwn,RetPUr);
    LegalInvNrSClassArrayOnOpen("RetPUVc",RetPUr.SerNr,RetPUr.TransDate,RetPUr.VECode,astr,acnt,15,RetPUr.TerminalID,RetPUr.BranchID,RetPUr.Status);
    for (i=0;i<acnt;i=i+1) begin
      SetListString(wn,len(astr[i]),astr[i],false);    
    end;
  end;
  if (GetWindowFileName(mwn)=="SHVc") then begin
    GetWindowRecord(mwn,SHr);
    LegalInvNrSClassArrayOnOpen("SHVc",SHr.SerNr,SHr.ShipDate,SHr.CustCode,astr,acnt,14,SHr.TerminalID,SHr.BranchID,SHr.Status);
    for (i=0;i<acnt;i=i+1) begin
      SetListString(wn,len(astr[i]),astr[i],false);    
    end;
  end;
  if (GetWindowFileName(mwn)=="IPVc") then begin
    GetWindowRecord(mwn,IPr);
    if (HasLocalization("PRT")) then begin
      LegalInvNrSClassArrayOnOpen("IPVc",IPr.SerNr,IPr.TransDate,"",astr,acnt,17,IPr.TerminalID,IPr.BranchID,IPr.Status);
      for (i=0;i<acnt;i=i+1) begin
        SetListString(wn,len(astr[i]),astr[i],false);    
      end;
    end else begin
      if (MatRowCnt(IPr)>=0) then begin
        MatRowGet(IPr,0,IPrw);
        if (nonblank(IPrw.CustCode)) then begin  
          LegalInvNrSClassArrayOnOpen("IPVc",IPr.SerNr,IPr.TransDate,IPrw.CustCode,astr,acnt,17,IPr.TerminalID,IPr.BranchID,IPr.Status);
          for (i=0;i<acnt;i=i+1) begin
            SetListString(wn,len(astr[i]),astr[i],false);    
          end;
        end;
      end;
    end;
  end;
  LegalInvNrSClassOnOpenWindow = false;
  return;
end;

global
function Boolean LegalInvNr2SClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt;
  Integer mwn;
  record IVVc IVr;
  record IVCashVc IVCashr;
  record StockMovVc StockMovr;
  record ORVc ORr;
  record SHVc SHr;
  record RetVc Retr;
  record RetPUVc RetPUr;
  Integer doctype;
  
  mwn = MotherWindow(wn);
  if (GetWindowFileName(mwn)=="IVVc") then begin
    GetWindowRecord(mwn,IVr);
    LegalInvNr2SClassArrayOnOpen("IVVc",IVr.SerNr,IVr.InvDate,IVr.CustCode,astr,acnt,IVr.InvType,IVr.TerminalID,IVr.BranchID,IVr.Status);
    for (i=0;i<acnt;i=i+1) begin
      SetListString(wn,len(astr[i]),astr[i],false);    
    end;
  end;
  if (GetWindowFileName(mwn)=="IVCashVc") then begin
    GetWindowRecord(mwn,IVCashr);
    doctype = 10;
    if (IVCashr.InvType==kPOSInvoiceTypeCredit) then begin
      doctype = -10;
    end;
    LegalInvNr2SClassArrayOnOpen("IVCashVc",IVCashr.SerNr,IVCashr.InvDate,IVCashr.CustCode,astr,acnt,doctype,IVCashr.TerminalID,IVCashr.BranchID,-1);
    for (i=0;i<acnt;i=i+1) begin
      SetListString(wn,len(astr[i]),astr[i],false);    
    end;
  end;
  if (GetWindowFileName(mwn)=="StockMovVc") then begin
    GetWindowRecord(mwn,StockMovr);
    LegalInvNr2SClassArrayOnOpen("StockMovVc",StockMovr.SerNr,StockMovr.TransDate,"",astr,acnt,11,StockMovr.TerminalID,StockMovr.BranchID,-1);
    for (i=0;i<acnt;i=i+1) begin
      SetListString(wn,len(astr[i]),astr[i],false);    
    end;
  end;  
  if (GetWindowFileName(mwn)=="ORVc") then begin
    GetWindowRecord(mwn,ORr);
    LegalInvNr2SClassArrayOnOpen("ORVc",ORr.SerNr,ORr.OrdDate,ORr.CustCode,astr,acnt,12,ORr.TerminalID,ORr.BranchID,-1);
    for (i=0;i<acnt;i=i+1) begin
      SetListString(wn,len(astr[i]),astr[i],false);    
    end;
  end;
  if (GetWindowFileName(mwn)=="RetVc") then begin
    GetWindowRecord(mwn,Retr);
    LegalInvNr2SClassArrayOnOpen("RetVc",Retr.SerNr,Retr.TransDate,Retr.CustCode,astr,acnt,13,Retr.TerminalID,Retr.BranchID,-1);
    for (i=0;i<acnt;i=i+1) begin
      SetListString(wn,len(astr[i]),astr[i],false);    
    end;
  end; 
  if (GetWindowFileName(mwn)=="RetPUVc") then begin
    GetWindowRecord(mwn,RetPUr);
    LegalInvNr2SClassArrayOnOpen("RetPUVc",RetPUr.SerNr,RetPUr.TransDate,RetPUr.VECode,astr,acnt,15,RetPUr.TerminalID,RetPUr.BranchID,-1);
    for (i=0;i<acnt;i=i+1) begin
      SetListString(wn,len(astr[i]),astr[i],false);    
    end;
  end;
  if (GetWindowFileName(mwn)=="SHVc") then begin
    GetWindowRecord(mwn,SHr);
    LegalInvNr2SClassArrayOnOpen("SHVc",SHr.SerNr,SHr.ShipDate,SHr.CustCode,astr,acnt,14,SHr.TerminalID,SHr.BranchID,-1);
    for (i=0;i<acnt;i=i+1) begin
      SetListString(wn,len(astr[i]),astr[i],false);    
    end;
  end; 
  LegalInvNr2SClassOnOpenWindow = false;
  return;
end;

global
function Boolean LegalCLInNrSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt;
  Integer mwn;
  record CLInVc CLInr;
  
  mwn = MotherWindow(wn);
  if (GetWindowFileName(mwn)=="CLInVc") then begin
    GetWindowRecord(mwn,CLInr);
    LegalCLInNrSClassArrayOnOpen(CLInr.SerNr,CLInr.TransDate,astr,acnt);
    for (i=0;i<acnt;i=i+1) begin
      SetListString(wn,len(astr[i]),astr[i],false);    
    end;
  end;
  LegalCLInNrSClassOnOpenWindow = false;
  return;
end;

global
function Boolean VEBankAccSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt,rownr;
  Integer mwn;
  record VIVc VIr;
  record OPVc OPr;
  row OPVc OPrw;
  string 255 vecode;
  
  mwn = MotherWindow(wn);
  switch (GetWindowFileName(mwn)) begin
    case "VIVc":
      GetWindowRecord(mwn,VIr);
      vecode = VIr.VECode;
    case "OPVc":
      GetWindowRecord(mwn,OPr);
      rownr = WindowActiveRow(mwn);
      if (rownr<MatRowCnt(OPr)) then begin
        MatRowGet(OPr,rownr,OPrw);
        vecode = OPrw.VECode;
      end;
  end;
  if (nonblank(vecode)) then begin
    VEBankAccSClassArrayOnOpen(vecode,astr,acnt);
    for (i=0;i<acnt;i=i+1) begin
      SetListString(wn,len(astr[i]),astr[i],false);    
    end;
  end;
  VEBankAccSClassOnOpenWindow = false;
  return;
end;

global
function Boolean Companies2SClassOnOpenWindow(Integer wn)
begin
  record CompaniesBlock Compb;
  row CompaniesBlock Compbrw;
  Integer i,rwcnt;
  string 255 tstr;

  BlockLoad(Compb);
  rwcnt = MatRowCnt(Compb);
  for (i=0;i<rwcnt;i=i+1) begin
    MatRowGet(Compb,i,Compbrw);  
    M4PadString(Compbrw.CompCode,10," ",false,tstr);
    tstr = tstr & Compbrw.CompName;
    SetListString(wn,1,tstr,false);
  end;
  Companies2SClassOnOpenWindow = false;
  return;
end;

global
function Boolean DaughterCompSClassOnOpenWindow(Integer wn)
begin
  record DaughterCompBlock DCb;
  row DaughterCompBlock DCrw;
  Integer i,rwcnt;
  string 255 tstr;

  BlockLoad(DCb);
  rwcnt = MatRowCnt(DCb);
  for (i=0;i<rwcnt;i=i+1) begin
    MatRowGet(DCb,i,DCrw);  
    M4PadString(DCrw.CompCode,10," ",false,tstr);
    tstr = tstr & DCrw.CompName;
    SetListString(wn,1,tstr,false);
  end;
  DaughterCompSClassOnOpenWindow = false;
  return;
end;

global
function Boolean VARsubSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt,mwn,fn;
  
  mwn = MotherWindow(wn);
  switch (WindowActiveField(mwn)) begin
    case "f1": fn = 1;
    case "f2": fn = 2;
    case "f3": fn = 3;
    case "f4": fn = 4;
    case "f5": fn = 5;
  end;
  VARsubSClassArrayOnOpen(mwn,fn,astr,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  VARsubSClassOnOpenWindow = false;
  return;
end;

global
function Boolean VARINSClassOnOpenWindow(Integer wn)
begin
  Integer mwn,ar;

  mwn = MotherWindow(wn);
  ar = WindowActiveRow(mwn);
  switch (GetWindowFileName(mwn)) begin
    case "TRVc":
//      GetWindowRecord(mwn,TRr);
  end;
  VARINSClassOnOpenWindow = false;
  return;
end;

global
function Boolean DIClassBTSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt,mwn,fn;  
  
  mwn = MotherWindow(wn);
  switch (WindowActiveField(mwn)) begin
    case "f1": fn = 1;
    case "f2": fn = 2;
    case "f3": fn = 3;
    case "f4": fn = 4;
    case "f5": fn = 5;
    case "ObjStr": fn = 6;
    case "Stext": fn = 7;
    case "LastAcc": fn = 8;
  end;
  DIClassBTSClassArrayOnOpen(mwn,fn,astr,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  DIClassBTSClassOnOpenWindow = false;
  return;
end;

global
function Boolean DIClassSClassOnOpenWindow(Integer wn)
begin
  Integer mwn;
  record RcVc RepSpec;
  record INVc INr;
  
  mwn = MotherWindow(wn);
  GetWindowRecord(mwn,INr);
  INVc_DIClassSClass(INr,RepSpec);
  PutWindowRecord(wn,RepSpec);
  DIClassSClassOnOpenWindow = false;
  return;
end;

global
function Boolean ARInstSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt,rownr,mwn;
  record IPVc IPr;
  row IPVc IPrw;
  
  mwn = MotherWindow(wn);
  GetWindowRecord(mwn,IPr);
  rownr = WindowActiveRow(mwn);
  if (rownr<MatRowCnt(IPr)) then begin
    MatRowGet(IPr,rownr,IPrw);
  end;
  ARInstSClassArrayOnOpen(IPrw.InvoiceNr,astr,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  ARInstSClassOnOpenWindow = false;
  return;
end;

global
function Boolean ARInstallSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt,rownr,mwn;
  record IPVc IPr;
  row IPVc IPrw;
  
  mwn = MotherWindow(wn);
  GetWindowRecord(mwn,IPr);
  rownr = WindowActiveRow(mwn);
  if (rownr<MatRowCnt(IPr)) then begin
    MatRowGet(IPr,rownr,IPrw);
  end;
  ARInstallSClassArrayOnOpen(IPrw.InvoiceNr,astr,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  ARInstallSClassOnOpenWindow = false;
  return;
end;

global
function Boolean APInstSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt,rownr,mwn;
  record OPVc OPr;
  row OPVc OPrw;
  
  mwn = MotherWindow(wn);
  GetWindowRecord(mwn,OPr);
  rownr = WindowActiveRow(mwn);
  if (rownr<MatRowCnt(OPr)) then begin
    MatRowGet(OPr,rownr,OPrw);
  end;
  APInstSClassArrayOnOpen(OPrw.VISerNr,astr,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  APInstSClassOnOpenWindow = false;
  return;
end;

global
function Boolean APInstallSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt,rownr,mwn;
  record OPVc OPr;
  row OPVc OPrw;
  
  mwn = MotherWindow(wn);
  GetWindowRecord(mwn,OPr);
  rownr = WindowActiveRow(mwn);
  if (rownr<MatRowCnt(OPr)) then begin
    MatRowGet(OPr,rownr,OPrw);
  end;
  APInstallSClassArrayOnOpen(OPrw.VISerNr,astr,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  APInstallSClassOnOpenWindow = false;
  return;
end;

global
function Boolean ActTypeConseqSClassOnOpenWindow(Integer wn)
begin
  record ActVc Actr;
  Integer mwn;
  Array string 255 acode;
  Array string 255 acomment;
  Integer i;

  mwn = MotherWindow(wn);
  GetWindowRecord(mwn,Actr);
  ActTypeConseqDataListSClassArrayOnOpen(Actr.ActType,acode,acomment);
  for (i=0;i<acode.length;i=i+1) begin
    AddListRow(wn,"ActTypeConseqSClass",1,acode[i],0);
    AddListData(wn,"ActTypeConseqSClass","Code",acode[i]);
    AddListData(wn,"ActTypeConseqSClass","Comment",acomment[i]);
  end;
  return;
end;

global
function Boolean ReservationStatus2SClassOnOpenWindow(Integer wn)
begin
  record JobVc Jobr;
  Integer mwn;
  Array string 255 astr;
  Integer acnt,i;

  mwn = MotherWindow(wn);
  switch (GetWindowFileName(mwn)) begin
    case "JobVc": 
      GetWindowRecord(mwn,Jobr);
      ReservationStatus2SClassArrayOnOpen(Jobr.ResStatus,astr,acnt);
  end;
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  return;
end;

global
function Boolean ActType3SClassOnOpenWindow(Integer wn)
begin
  record ActVc Actr;
  Integer mwn;
  Array string 255 astr;
  Integer acnt,i;

  mwn = MotherWindow(wn);
  if (mwn>0) then begin
    GetWindowRecord(mwn,Actr);
    ActType3SClassArrayOnOpen(Actr.ActType,astr,acnt);
  end;
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  return;
end;

global
function Boolean UserDefRepLinesSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt,rownr,mwn;
  record XBRLSettingsVc XBRLSr;
  row XBRLSettingsVc XBRLSrw;
  string 20 shortname;
  
  mwn = MotherWindow(wn);
  if (GetWindowFileName(mwn)=="XBRLSettingsVc") then begin
    GetWindowRecord(mwn,XBRLSr);
    rownr = WindowActiveRow(mwn);
    if (rownr<MatRowCnt(XBRLSr)) then begin
      MatRowGet(XBRLSr,rownr,XBRLSrw);
      shortname = XBRLSrw.UserDefRep;
    end;
  end;
  
  UserDefRepLinesSClassArrayOnOpen(astr,acnt,shortname);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  
  return;
end;

global
function Boolean UserDefRepLinesSClassOnOKWindow(Integer wn)
begin
  Integer mwn;
  string 60 tstr;
  
  mwn = MotherWindow(wn);
  if (SelectedListLine(wn)!=-1) then begin
    tstr = GetListString(wn,SelectedListLine(wn));
    tstr = removenextlistitem(tstr,chr(9));
    CloseWindow(wn);
    PasteString(mwn,tstr);
  end;
  
  UserDefRepLinesSClassOnOKWindow = false;
  return;
end;

global
function Boolean XBRLElementSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt,mwn;
  record XBRLSettingsVc XBRLSr;
  Integer ReportType;
  
  mwn = MotherWindow(wn);
  if (GetWindowFileName(mwn)=="XBRLSettingsVc") then begin
    GetWindowRecord(mwn,XBRLSr);
    ReportType = XBRLSr.ReportType;
  end;
  
  XBRLElementSClassArrayOnOpen(astr,acnt,ReportType);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  
  return;
end;

global
function Boolean XBRLElementSClassOnOKWindow(Integer wn)
begin
  Integer mwn;
  string 60 tstr;
  
  mwn = MotherWindow(wn);
  if (SelectedListLine(wn)!=-1) then begin
    tstr = GetListString(wn,SelectedListLine(wn));
    tstr = removenextlistitem(tstr,chr(9));
    CloseWindow(wn);
    PasteString(mwn,tstr);
  end;
  
  XBRLElementSClassOnOKWindow = false;
  return;
end;

global
function Boolean INNPTSSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr,astr2;
  Array val aprice;
  Integer i,acnt;
  transaction record RcVc gNPTSRepSpec;
  
  INNPTSSClassArrayOnOpen(gNPTSRepSpec,astr,astr2,aprice,acnt);
  for (i=0;i<acnt;i=i+1) begin
    AddListRow(wn,"NPTSItemSearch",1,astr[i],0);
    AddListData(wn,"NPTSItemSearch","ArtCode",astr[i]);
    AddListData(wn,"NPTSItemSearch","ArtName",astr2[i]);
    AddListData(wn,"NPTSItemSearch","ArtPrice",aprice[i]);
//    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  INNPTSSClassOnOpenWindow = false;
  return;
end;

global
function Boolean INNPTSSClassOnOKWindow(Integer wn)
begin
  Integer mwn;
  string 60 tstr;
  record IVCashVc IVCashr;
  record IVVc IVr;
  Integer sline;
    
  mwn = MotherWindow(wn);
  switch (GetWindowClass(mwn)) begin
    case "NPTSIVCashDClass":
      if (StringFromSysList(wn,-1)!=USetStr(19390)) and (StringFromSysList(wn,-1)!=USetStr(24160)) then begin
        WindowFieldGoto(mwn,IVCashr,-1,"ivcashcommand",false); 
        //WindowFieldGotoForTouchScreen(mwn,-1,"ivcashcommand",false);
//        PasteFromSysList(wn,-2);
        sline = SelectedListLine(wn);
        tstr = GetListTag(wn,sline);
        PasteFromWn(wn,GetListTag(wn,sline));
        KeyPadEnter(mwn);
      end;
    case "IVDClass":
      if (StringFromSysList(wn,-1)!=USetStr(19390)) and (StringFromSysList(wn,-1)!=USetStr(24160)) then begin
        WindowFieldGoto(mwn,IVr,-1,"ivcashcommand",false);
        //WindowFieldGotoForTouchScreen(mwn,-1,"ivcashcommand",false);
//        PasteFromSysList(wn,-2);
        sline = SelectedListLine(wn);
        tstr = GetListTag(wn,sline);
        PasteFromWn(wn,GetListTag(wn,sline));
        KeyPadEnter(mwn);
      end;
    case "RestAccDClass":
      if (StringFromSysList(wn,-1)!=USetStr(19390)) and (StringFromSysList(wn,-1)!=USetStr(24160)) then begin
        sline = SelectedListLine(wn);
        tstr = GetListTag(wn,sline);
        PasteFromWn(wn,tstr);
//        PutWindowString(mwn,"touchscreenitem",StringFromSysList(wn,-2));
        PutWindowString(mwn,"touchscreenitem",tstr);
        PutWindowString(mwn,"touchscreenitemqty",1.00);
        DeselectWindow(mwn,false);
        RestAccDClasstouchscreenitemEFAfter(mwn,true);
      end;
  end;
  INNPTSSClassOnOKWindow = false;
  return;
end;

global
function Boolean INNPTSSClassListClick(Integer wn,Integer rownr)
begin
  INNPTSSClassOnOKWindow(wn);
  INNPTSSClassListClick = true;
  return;
end;

global
function Boolean CUNPTSSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt;
  transaction record RcVc gNPTSRepSpec;
  
  CUNPTSSClassArrayOnOpen(gNPTSRepSpec,astr,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;  
  CUNPTSSClassOnOpenWindow = false;
  return;
end;

global
function Boolean RestAccClassNPTSSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt;
  
  RestAccClassNPTSSClassArrayOnOpen(astr,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;  
  RestAccClassNPTSSClassOnOpenWindow = false;
  return;
end;

global
function Boolean CUNPTSSClassOnOKWindow(Integer wn)
begin
  Integer mwn;
  string 60 tstr;
  record IVCashVc IVCashr;
  record IVCashVc IVCash2r;
  Integer err,i,slen;
  string 255 warning;
  record LocalMachineBlock LMb;
  record RestAccVc RestAccr;
  record RestAccVc RestAcc2r;
  record IVVc IVr;
  record IVVc IV2r;
  string 255 errstr,prepstr,invdatewarn,transdatewarn;
  record RcVc RepSpec;
  record CUVc CUr;
    
  mwn = MotherWindow(wn);
  switch (GetWindowClass(mwn)) begin
    case "NPTSIVCashDClass":
//      PasteFromSysList(wn,-2);
//      KeyPadEnter(mwn);
      if (StringFromSysList(wn,-1)!=USetStr(19391)) then begin
        tstr = GetListString(wn,SelectedListLine(wn));
        slen = len(tstr);
        for (i=1;i<slen;i=i+1) begin
          if (Mid(tstr,i,1)==" ") then begin
            goto L20NPTSIVCash;
          end;
        end;
L20NPTSIVCash:;
        if (slen>1) then begin
          tstr = Left(tstr,i);
        end;
        GetWindowRecord(mwn,IVCashr);
        if (IVCashr.OKFlag==0) and (IVCashr.Invalid==0) then begin
          BlockLoad(LMb);
          GetPrevWindowRecord(mwn,IVCash2r);
          IVCash2r.CustCode = IVCashr.CustCode;
          IVCashr.CustCode = tstr;
          if (IVCashVc_PasteCustCode(IVCashr,IVCash2r.CustCode,LMb.DefLocation,LMb.PLCode,err,warning)) then begin
            if (nonblank(warning)) then begin
              MessageBox(0,warning);
            end;
            if (err!=0) then begin
              MessageBox(0,err);
            end;
          end;
          PutWindowRecord(mwn,IVCashr);
          ReRunWindowDef(mwn);
          IVCashDClass_RefreshStringList(mwn,IVCashr);
          //WindowFieldGoto(mwn,IVCashr,-1,"ivcashcommand",false);
          WindowFieldGotoForTouchScreen(mwn,-1,"ivcashcommand",false);
        end;
        CloseWindow(wn);
      end;
    case "IVDClass":
//      PasteFromSysList(wn,-2);
//      KeyPadEnter(mwn);
      if (StringFromSysList(wn,-1)!=USetStr(19391)) then begin
        tstr = GetListString(wn,SelectedListLine(wn));
        slen = len(tstr);
        for (i=1;i<slen;i=i+1) begin
          if (Mid(tstr,i,1)==" ") then begin
            goto L20IV;
          end;
        end;
L20IV:;
        if (slen>1) then begin
          tstr = Left(tstr,i);
        end;
        GetWindowRecord(mwn,IVr);
        if (IVr.OKFlag==0) and (IVr.Invalid==0) then begin
          GetPrevWindowRecord(mwn,IV2r);
          BlockLoad(LMb);
          IV2r.CustCode = IVr.CustCode;
          IVr.CustCode = tstr;
          if (PasteCust2InInv(IVr,LMb,IV2r.CustCode,true,warning,errstr,prepstr,invdatewarn,transdatewarn)) then begin
            if (nonblank(warning)) then begin
              MessageBox(0,warning);
            end;
            if (err!=0) then begin
              MessageBox(0,err);
            end;
          end;
          PutWindowRecord(mwn,IVr);
          ReRunWindowDef(mwn);
          //WindowFieldGoto(mwn,IVr,-1,"ivcashcommand",false);
          WindowFieldGotoForTouchScreen(mwn,-1,"ivcashcommand",false);
        end;
        CloseWindow(wn);
      end;
    case "RestAccDClass":
      if (StringFromSysList(wn,-1)!=USetStr(19391)) then begin
//      PasteFromSysList(wn,-2);
//      KeyPadEnter(mwn);
        tstr = GetListString(wn,SelectedListLine(wn));
        slen = len(tstr);
        for (i=1;i<slen;i=i+1) begin
          if (Mid(tstr,i,1)==" ") then begin
            goto L20RestAcc;
          end;
        end;
L20RestAcc:;
        if (slen>1) then begin
          tstr = Left(tstr,i);
        end;
        GetWindowRecord(mwn,RestAccr);
        if (RestAccr.Closed==0) then begin
          RestAccr.CUCode = tstr;
          if (RestAccVc_PasteCUCode(RestAccr)) then begin
          end;
          PutWindowRecord(mwn,RestAccr);
          ReRunWindowDef(mwn);
        end;
        CloseWindow(wn);
      end;
    case "ChangeAddressNPTSIVCashSClass":
      if (StringFromSysList(wn,-1)!=USetStr(19391)) then begin
        tstr = GetListString(wn,SelectedListLine(wn));
        slen = len(tstr);
        for (i=1;i<slen;i=i+1) begin
          if (Mid(tstr,i,1)==" ") then begin
            goto L40NPTSIVCash;
          end;
        end;
L40NPTSIVCash:;
        if (slen>1) then begin
          tstr = Left(tstr,i);
        end;
        if (nonblank(tstr)) then begin
          CUr.Code = tstr;
          ReadFirstMain(CUr,1,true);
          DeselectWindow(mwn,false);
          GetWindowRecord(mwn,RepSpec);
          RepSpec.f6 = CUr.Name;
          RepSpec.f1 = CUr.InvAddr0;
          RepSpec.f2 = CUr.InvAddr1;
          RepSpec.f3 = CUr.InvAddr3;
          RepSpec.f4 = CUr.InvAddr4;
//          RepSpec.f5 = CUr.InvAddr5;
          RepSpec.f11 = CUr.RegNr1;
          RepSpec.f11 = CUr.RegNr2;
          RepSpec.f12 = CUr.VATNr;
          PutWindowRecord(mwn,RepSpec);
        end;
      end;
      CloseWindow(wn);
  end;
  CUNPTSSClassOnOKWindow = false;
  return;
end;

global
function Boolean CUNPTS2SClassOnOKWindow(Integer wn)
begin
  Integer mwn;
  string 60 tstr;
  record IVCashVc IVCashr;
  record IVCashVc IVCash2r;
  Integer err,i,slen;
  string 255 warning;
  record LocalMachineBlock LMb;
  record RestAccVc RestAccr;
  record RestAccVc RestAcc2r;
  record CUVc CUr;
    
  mwn = MotherWindow(wn);
  switch (GetWindowClass(mwn)) begin
    case "NPTSIVCashDClass":
//      PasteFromSysList(wn,-2);
//      KeyPadEnter(mwn);
      if (ReadMarkedRecord(wn,CUr)) begin
        GetWindowRecord(mwn,IVCashr);
        if (IVCashr.OKFlag==0) and (IVCashr.Invalid==0) then begin
          GetPrevWindowRecord(mwn,IVCash2r);
          BlockLoad(LMb);
          IVCash2r.CustCode = IVCashr.CustCode;
          IVCashr.CustCode = CUr.Code;
          if (IVCashVc_PasteCustCode(IVCashr,IVCash2r.CustCode,LMb.DefLocation,LMb.PLCode,err,warning)) then begin
            if (nonblank(warning)) then begin
              MessageBox(0,warning);
            end;
            if (err!=0) then begin
              MessageBox(0,err);
            end;
          end;
          PutWindowRecord(mwn,IVCashr);
          ReRunWindowDef(mwn);
          //WindowFieldGoto(mwn,IVCashr,-1,"ivcashcommand",false);
          WindowFieldGotoForTouchScreen(mwn,-1,"ivcashcommand",false);
        end;
        CloseWindow(wn);
      end;
    case "RestAccDClass":
      if (StringFromSysList(wn,-1)!=USetStr(19391)) then begin
//      PasteFromSysList(wn,-2);
//      KeyPadEnter(mwn);
        tstr = GetListString(wn,SelectedListLine(wn));
        slen = len(tstr);
        for (i=1;i<slen;i=i+1) begin
          if (Mid(tstr,i,1)==" ") then begin
            goto L20RestAcc;
          end;
        end;
L20RestAcc:;
        if (slen>1) then begin
          tstr = Left(tstr,i);
        end;
        GetWindowRecord(mwn,RestAccr);
        if (RestAccr.Closed==0) then begin
          RestAccr.CUCode = tstr;
          if (RestAccVc_PasteCUCode(RestAccr)) then begin
          end;
          PutWindowRecord(mwn,RestAccr);
          ReRunWindowDef(mwn);
        end;
        CloseWindow(wn);
      end;
  end;
  CUNPTS2SClassOnOKWindow = false;
  return;
end;

global
function Boolean CUNPTSSClassListClick(Integer wn,Integer rownr)
begin
  CUNPTSSClassOnOKWindow(wn);
  CUNPTSSClassListClick = true;
  return;
end;

global
function Boolean RestAccClassNPTSSClassOnOKWindow(Integer wn)
begin
  PasteFromSysList(wn,-2);
  RestAccClassNPTSSClassOnOKWindow = false;
  return;
end;

global
function Boolean UserNPTSSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt;
  
  UserNPTSSClassArrayOnOpen(astr,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;  
  UserNPTSSClassOnOpenWindow = false;
  return;
end;

global
function Boolean UserNPTSSClassOnOKWindow(Integer wn)
begin
  PasteFromSysList(wn,-2);
  UserNPTSSClassOnOKWindow = false;
  return;
end;

/*
global
function Boolean UserNPTSSClassOnOKWindow(Integer wn)
begin
  Integer mwn;
  string 60 tstr;
  record IVCashVc IVCashr;
  record IVCashVc IVCash2r;
  Integer err,i,slen;
  string 255 warning;
  record LocalMachineBlock LMb;
  record RestAccVc RestAccr;
  record RestAccVc RestAcc2r;
    
  mwn = MotherWindow(wn);
  switch (GetWindowClass(mwn)) begin
    case "NPTSIVCashDClass":
      tstr = GetListString(wn,SelectedListLine(wn));
      slen = len(tstr);
      for (i=1;i<slen;i=i+1) begin
        if (Mid(tstr,i,1)==" ") then begin
          goto L20NPTSIVCash;
        end;
      end;
L20NPTSIVCash:;
      if (slen>1) then begin
        tstr = Left(tstr,i);
      end;
      GetWindowRecord(mwn,IVCashr);
      if (IVCashr.OKFlag==0) and (IVCashr.Invalid==0) then begin
        GetPrevWindowRecord(mwn,IVCash2r);
        BlockLoad(LMb);
        IVCashr.SalesMan = tstr;
        PutWindowRecord(mwn,IVCashr);
        ReRunWindowDef(mwn);
      end;
      CloseWindow(wn);
    case "RestAccDClass":
//      PasteFromSysList(wn,-2);
//      KeyPadEnter(mwn);
      tstr = GetListString(wn,SelectedListLine(wn));
      slen = len(tstr);
      for (i=1;i<slen;i=i+1) begin
        if (Mid(tstr,i,1)==" ") then begin
          goto L20RestAcc;
        end;
      end;
L20RestAcc:;
      if (slen>1) then begin
        tstr = Left(tstr,i);
      end;
      GetWindowRecord(mwn,RestAccr);
      if (RestAccr.Closed==0) then begin
        RestAccr.Cashier = tstr;
        PutWindowRecord(mwn,RestAccr);
        ReRunWindowDef(mwn);
      end;
      CloseWindow(wn);
  end;
  UserNPTSSClassOnOKWindow = false;
  return;
end;
*/
global
function Boolean VoidNPTSSClassOnOpenWindow(Integer wn)
begin
  record IVCashVc IVCashr;
  row IVCashVc IVCashrw;
  row IVCashVc IVCash2rw;
  Integer i,rwcnt,j,mwn;
  Boolean testf;
  
  mwn = MotherWindow(wn);
  switch (GetWindowClass(mwn)) begin
    case "NPTSIVCashDClass":
      GetWindowRecord(mwn,IVCashr);
      rwcnt = MatRowCnt(IVCashr);
      for (i=0;i<rwcnt;i=i+1) begin
        MatRowGet(IVCashr,i,IVCashrw);
        testf = true;
        switch (IVCashrw.stp) begin
          case kInvoiceRowTypeStructuredItemComponent:
            goto LkInvoiceRowTypeNormal;
          case kInvoiceRowTypeNormal:
LkInvoiceRowTypeNormal:;
            for (j=0;j<rwcnt;j=j+1) begin
              MatRowGet(IVCashr,j,IVCash2rw);
              switch (IVCash2rw.stp) begin
                case kInvoiceRowTypeVoid:
                  if (IVCash2rw.VoidedRowNr==i) then begin
                    testf = false;
                    j = rwcnt;
                  end;
              end;
            end;
          otherwise
            testf = false;
        end;
        if (testf) then begin
          SetListStringAndTag(wn,len(IVCashrw.ArtCode),IVCashrw.ArtCode & "     " & IVCashrw.Spec,i);    
        end;
      end;
  end;
  VoidNPTSSClassOnOpenWindow = false;
  return;
end;

global
function Boolean VoidNPTSSClassOnOKWindow(Integer wn)
begin
  Integer mwn;
  string 60 tstr,t2;
  record IVCashVc IVCashr;
  row IVCashVc IVCashrw;
  record IVVc IVr;
  row IVVc IVrw;
  LongInt l;
  Integer rownr;
    
  mwn = MotherWindow(wn);
  switch (GetWindowClass(mwn)) begin
    case "NPTSIVCashDClass":
      l = SelectedListLine(wn);
      rownr = StringToInt(GetListTag(wn,l));
      if (rownr>=0) then begin
        GetWindowRecord(mwn,IVCashr);    
        if (rownr<MatRowCnt(IVCashr)) then begin
          if (IVCashDClassVoidRow(IVCashr,rownr)) then begin
            PutWindowRecord(mwn,IVCashr);    
            MatRowGet(IVCashr,rownr,IVCashrw);
            IVCashDClass_RefreshStringList(mwn,IVCashr);
            tstr = ValToString(-IVCashrw.Quant,M4UVal,ThousandSeparator,DecimalSeparator,0) & "*" & ValToString(IVCashrw.Price,M4Val,ThousandSeparator,DecimalSeparator,0);
            M4PadString(ValToString(IVCashrw.Sum,M4Val,ThousandSeparator,DecimalSeparator,0),30-len(tstr)," ",true,t2);
            tstr = tstr & t2;  
            SetPOSWindowDisplay(IVCashrw.ArtCode & " " & IVCashrw.Spec,tstr);
            DeselectWindow(mwn,false);
            //WindowFieldGoto(mwn,IVCashr,-1,"ivcashcommand",false);
            WindowFieldGotoForTouchScreen(mwn,-1,"ivcashcommand",false);
            CloseWindow(wn);
          end;
        end;
      end;
    case "IVDClass":
      l = SelectedListLine(wn);
      rownr = StringToInt(GetListTag(wn,l));
      if (rownr>=0) then begin
        GetWindowRecord(mwn,IVr);    
        if (rownr<MatRowCnt(IVr)) then begin
          if (IVDClassVoidRow(IVr,rownr)) then begin
            PutWindowRecord(mwn,IVr);    
            MatRowGet(IVr,rownr,IVrw);
            IVDClass_RefreshStringList(mwn,IVr);
            tstr = ValToString(-IVrw.Quant,M4UVal,ThousandSeparator,DecimalSeparator,0) & "*" & ValToString(IVrw.Price,M4Val,ThousandSeparator,DecimalSeparator,0);
            M4PadString(ValToString(IVrw.Sum,M4Val,ThousandSeparator,DecimalSeparator,0),30-len(tstr)," ",true,t2);
            tstr = tstr & t2;  
            SetPOSWindowDisplay(IVrw.ArtCode & " " & IVrw.Spec,tstr);
            DeselectWindow(mwn,false);
            //WindowFieldGoto(mwn,IVr,-1,"ivcashcommand",false);
            WindowFieldGotoForTouchScreen(mwn,-1,"ivcashcommand",false);
            CloseWindow(wn);
          end;
        end;
      end;
  end;
  VoidNPTSSClassOnOKWindow = false;
  return;
end;

procedure IVVc_ARPay2SClass(string index,string sorting,Integer mwn,var Array string astr,var Integer acnt)
begin
  record IVVc IVr;
  
  GetWindowRecord(mwn,IVr);
  FillARPay2SClass(index,sorting,IVr.CustCode,IVr.TransDate,astr,acnt);
  return;
end;

procedure ARPay2SClassOnOpen(string index,string sorting,Integer wn)
begin
  Integer mwn;
  Array string 255 astr;
  Integer acnt,i;

  mwn = MotherWindow(wn);
  if (ProgramType==typTravellingSalesman) then begin
    mwn = MotherWindow(mwn);
  end;
  switch (GetWindowFileName(mwn)) begin
    case "IVVc": IVVc_ARPay2SClass(index,sorting,mwn,astr,acnt);
    case "RcVc": 
      switch (GetWindowClass(mwn)) begin
        case "ConnectToPrepaymentNPTSSClass":
          IVVc_ARPay2SClass(index,sorting,MotherWindow(mwn),astr,acnt);
      end;
  end;
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);
  end;      
  return;
end;

global
function Boolean ARPay2SClassOnOpenWindow(Integer wn)
begin
  ARPay2SClassOnOpen("CustCode","",wn);
  ARPay2SClassOnOpenWindow = false;
  return;
end;

global
procedure ARPay2SClassSortCUPNr()
begin
  ClearStringList(CurWindow);
  ARPay2SClassOnOpen("CUPNr",GetWindowString(CurWindow,"ARPay2SClassSorting"),CurWindow);
  UpdateNamedWindow("ARPay2SClass");
  if (GetWindowString(CurWindow,"ARPay2SClassSorting")=="reverse") then begin
    PutWindowString(CurWindow,"ARPay2SClassSorting","");  
  end else begin
    PutWindowString(CurWindow,"ARPay2SClassSorting","reverse");  
  end;
  return;
end;

global
procedure ARPay2SClassSortOrderNr()
begin
  ClearStringList(CurWindow);
  ARPay2SClassOnOpen("OrderNr",GetWindowString(CurWindow,"ARPay2SClassSorting"),CurWindow);
  UpdateNamedWindow("ARPay2SClass");
  if (GetWindowString(CurWindow,"ARPay2SClassSorting")=="reverse") then begin
    PutWindowString(CurWindow,"ARPay2SClassSorting","");  
  end else begin
    PutWindowString(CurWindow,"ARPay2SClassSorting","reverse");  
  end;
  return;
end;

global
procedure ARPay2SClassSortPayDate()
begin
  ClearStringList(CurWindow);
  ARPay2SClassOnOpen("PayDate",GetWindowString(CurWindow,"ARPay2SClassSorting"),CurWindow);
  UpdateNamedWindow("ARPay2SClass");
  if (GetWindowString(CurWindow,"ARPay2SClassSorting")=="reverse") then begin
    PutWindowString(CurWindow,"ARPay2SClassSorting","");  
  end else begin
    PutWindowString(CurWindow,"ARPay2SClassSorting","reverse");  
  end;
  return;
end;

/*
global
procedure ARPay2SClassSortCustCode()
begin
  ClearStringList(CurWindow);
  ARPay2SClassOnOpen("CustCode",GetWindowString(CurWindow,"ARPay2SClassSorting"),CurWindow);
  UpdateNamedWindow("ARPay2SClass");
  if (GetWindowString(CurWindow,"ARPay2SClassSorting")=="reverse") then begin
    PutWindowString(CurWindow,"ARPay2SClassSorting","");  
  end else begin
    PutWindowString(CurWindow,"ARPay2SClassSorting","reverse");  
  end;
  return;
end;
*/

global
procedure ARPay2SClassOpenARPayClass()
begin
  Integer wn,mwn,nwn;
  record ARPayVc ARPayr;

  wn = CurWindow;
  mwn = MotherWindow(wn);
  CloseWindow(wn);      
  nwn = OpenWindow("ARPaySClass",0,mwn,"","",ARPayr);
  return;
end;

global
function Boolean ARPay2SClassOnOKWindow(Integer wn)
begin
  PasteFromSysList(wn,-2);
  ARPay2SClassOnOKWindow = false;
  return;
end;

global
procedure APPay2SClassOpenAPPayClass()
begin
  Integer wn,mwn,nwn;
  record OPPVc OPPr;

  wn = CurWindow;
  mwn = MotherWindow(wn);
  CloseWindow(wn);      
  nwn = OpenWindow("OPPSClass",0,mwn,"","",OPPr);
  return;
end;

global
function Boolean APPay2SClassOnOKWindow(Integer wn)
begin
  PasteFromSysList(wn,-2);
  APPay2SClassOnOKWindow = false;
  return;
end;

procedure ExpVc_PPSClass(string index,string sorting,Integer mwn,var Array string astr,var Array string atag,var Integer acnt)
begin
  record ExpVc Expr;
  
  GetWindowRecord(mwn,Expr);
  FillPPSClass(index,sorting,Expr,WindowActiveRow(mwn),astr,atag,acnt);
  return;
end;

procedure PPSClassOnOpen(string index,string sorting,Integer wn)
begin
  Integer mwn;
  Array string 255 astr,atag;
  Integer acnt,i;

  mwn = MotherWindow(wn);
  switch (GetWindowFileName(mwn)) begin
    case "ExpVc": ExpVc_PPSClass(index,sorting,mwn,astr,atag,acnt);
  end;
  for (i=0;i<acnt;i=i+1) begin
    SetListStringAndTag(wn,len(astr[i]),astr[i],atag[i]);
  end;      
  return;
end;

global
function Boolean PPSClassOnOpenWindow(Integer wn)
begin
  PPSClassOnOpen("OSPerson","",wn);
  PPSClassOnOpenWindow = false;
  return;
end;

global
procedure PPSClassSortOSFlag()
begin
  ClearStringList(CurWindow);
  PPSClassOnOpen("OSPerson",GetWindowString(CurWindow,"PPSClassSorting"),CurWindow);
  UpdateNamedWindow("PPSClass");
  if (GetWindowString(CurWindow,"PPSClassSorting")=="reverse") then begin
    PutWindowString(CurWindow,"PPSClassSorting","");  
  end else begin
    PutWindowString(CurWindow,"PPSClassSorting","reverse");  
  end;
  return;
end;

global
function Boolean PPSClassOnOKWindow(Integer wn)
begin
  Integer mwn,rownr;
  string 255 ppnr,tstr,tag;
  record ExpVc Expr;
  row ExpVc Exprw;
  row ExpVc Exp2rw;
  Integer j,jrwcnt;
  val ppsum;
  LongInt pos;
  
  ppnr = StringFromSysList(wn,-2);
  tag = GetListTag(wn,SelectedListLine(wn));

  mwn = MotherWindow(wn);
  CloseWindow(wn);
  if (GetWindowFileName(mwn)=="ExpVc") begin
    rownr = WindowActiveRow(mwn);
    DeselectWindow(mwn,false);
    GetWindowRecord(mwn,Expr);
    if (rownr<MatRowCnt(Expr)) then begin
      MatRowGet(Expr,rownr,Exprw);
      pos = 0;
      Exprw.PPNr = StringToLongInt(ppnr);
      GetNextSubstring(tag,pos,",",tstr);
      Exprw.PPRow = StringToLongInt(tstr);
      GetNextSubstring(tag,pos,",",tstr);
      Exprw.Sum = ValFromString(tstr,".","");
      jrwcnt = MatRowCnt(Expr);
      for (j=0;j<jrwcnt;j=j+1) begin
        MatRowGet(Expr,j,Exp2rw);
        switch (Exp2rw.stp) begin
          case kExpenseRowTypePersonnelPayment:
            if (Exp2rw.PPNr==Exprw.PPNr) and (Exp2rw.PPRow==Exprw.PPRow) and (j!=rownr) then begin
              ppsum = ppsum + Exp2rw.Sum; 
            end;
        end;
      end;
      if ((Exprw.Sum+ppsum)>Expr.PayVal) then begin
        Exprw.Sum = Expr.PayVal - ppsum;
      end;
      MatRowPut(Expr,rownr,Exprw);
      PutWindowRecord(mwn,Expr);
    end;
  end;

  PPSClassOnOKWindow = false;
  return;
end;

global
function Boolean BaggerSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt;
  
  BaggerSClassArrayOnOpen(astr,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  BaggerSClassOnOpenWindow = false;
  return;
end;

global
function Boolean SupervisorSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt;
  
  SupervisorSClassArrayOnOpen(astr,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  SupervisorSClassOnOpenWindow = false;
  return;
end;

procedure AddLangMode(Integer wn,string text,string tag)
begin
  SetListStringAndTag(wn,0,tag & chr(9) & "     " & text,tag);
  return;
end;

procedure AddLangModeIfExists(Integer wn,string text,string tag)
begin
  string 255 tstr;
  tstr = ResourceFolder & "/hob/su" & LowerCase(tag) & ".hob";
  if (FileExists(tstr)) then begin
    AddLangMode(wn,text,tag);
  end;
  return;
end;

global
function Boolean LangModeSClassOnOpenWindow(Integer wn)
begin
  AddLangMode(wn,StringFromSet(80,LangAngolanPortuguese),"ANG");
  AddLangMode(wn,StringFromSet(80,LangArabic),"ARB");
  AddLangMode(wn,StringFromSet(80,LangEnglish),"AUS");
  AddLangMode(wn,StringFromSet(80,LangArabic),"BHR");
  AddLangMode(wn,StringFromSet(80,LangBrazilian),"BRA");
  AddLangMode(wn,StringFromSet(80,LangCroatian),"CRO");
  AddLangMode(wn,StringFromSet(80,LangCzech),"CZE");
  AddLangMode(wn,StringFromSet(80,LangDanish),"DAN");
  AddLangMode(wn,StringFromSet(80,LangArabic),"DZA");
  AddLangMode(wn,StringFromSet(80,LangArabic),"EGY");
  AddLangMode(wn,StringFromSet(80,LangEnglish),"IND");
  AddLangMode(wn,StringFromSet(80,LangEnglish),"SAF");
  AddLangMode(wn,StringFromSet(80,LangEnglish),"ENG");
  AddLangMode(wn,StringFromSet(80,LangEnglish),"USA");
  AddLangMode(wn,StringFromSet(80,LangEnglish),"SGP");
  AddLangMode(wn,StringFromSet(80,LangEstonian),"EST");
  AddLangMode(wn,StringFromSet(80,LangFinnish),"FIN");
  AddLangMode(wn,StringFromSet(80,LangFrench),"FRA");
  AddLangMode(wn,StringFromSet(80,LangGerman),"GER");
  AddLangMode(wn,StringFromSet(80,LangHungarian),"HUN");
  AddLangMode(wn,StringFromSet(80,LangIcelandic),"ICE");
  AddLangMode(wn,StringFromSet(80,LangItalian),"ITA");
  AddLangMode(wn,StringFromSet(80,LangArabic),"JOR");
  AddLangMode(wn,StringFromSet(80,LangArabic),"KWT");
  AddLangMode(wn,StringFromSet(80,LangLatvian),"LAT");
  AddLangMode(wn,StringFromSet(80,LangArabic),"LBN");
  AddLangMode(wn,StringFromSet(80,LangLithuanian),"LIT");
  AddLangMode(wn,StringFromSet(80,LangNorwegian),"NOR");
  AddLangMode(wn,StringFromSet(80,LangArabic),"OMN");
  AddLangMode(wn,StringFromSet(80,LangPolish),"POL");
  AddLangMode(wn,StringFromSet(80,LangArabic),"QAT");
  AddLangMode(wn,StringFromSet(80,LangPortuguese),"POR");
  AddLangMode(wn,StringFromSet(80,LangRomanian),"ROM");
  AddLangMode(wn,StringFromSet(80,LangRussian),"RUS");
  AddLangMode(wn,StringFromSet(80,LangArabic),"SAU");
  AddLangMode(wn,StringFromSet(80,LangSerbian),"SER");
  AddLangMode(wn,StringFromSet(80,LangSlovak),"SVK");
  AddLangMode(wn,StringFromSet(80,LangSlovenian),"SLO");
  AddLangMode(wn,StringFromSet(80,LangHondurianSpanish),"HND");
  AddLangMode(wn,StringFromSet(80,LangArgentineanSpanish),"ARG");
  AddLangMode(wn,StringFromSet(80,LangBolivianSpanish),"BOL");
  AddLangMode(wn,StringFromSet(80,LangColombianSpanish),"COL");
  AddLangMode(wn,StringFromSet(80,LangChileanSpanish),"CHL");
  AddLangMode(wn,StringFromSet(80,LangCostaRicanSpanish),"CRI");
  AddLangMode(wn,StringFromSet(80,LangGuatemaleanSpanish),"GTM");
  AddLangMode(wn,StringFromSet(80,LangMexicanSpanish),"MEX");
  AddLangMode(wn,StringFromSet(80,LangMozambicanPortuguese),"MOZ");
  AddLangMode(wn,StringFromSet(80,LangPanamanianSpanish),"PAN");
//  AddLangMode(wn,StringFromSet(80,LangParaguayanSpanish),"HND");
  AddLangMode(wn,StringFromSet(80,LangSalvadorianSpanish),"SLV");
  AddLangMode(wn,StringFromSet(80,LangSpanish),"ESP");
  AddLangMode(wn,StringFromSet(80,LangSwedish),"SWE");
  AddLangMode(wn,StringFromSet(80,LangTurkish),"TUR");
  AddLangMode(wn,StringFromSet(80,LangUkrainian),"UKR");
  AddLangMode(wn,StringFromSet(80,LangArabic),"YEM");
  AddLangMode(wn,StringFromSet(80,LangVietnamese),"VIE");
  AddLangMode(wn,StringFromSet(80,LangZimbabweanEng),"ZWE");
  LangModeSClassOnOpenWindow = false;
  return;
end;

global
function Boolean ClientLangModeTClassOnOpenWindow(Integer wn)
begin
  AddLangModeIfExists(wn,StringFromSet(80,LangAngolanPortuguese),"ANG");
  AddLangModeIfExists(wn,StringFromSet(80,LangArabic),"ARB");
  AddLangModeIfExists(wn,StringFromSet(80,LangArabic),"BHR");
  AddLangModeIfExists(wn,StringFromSet(80,LangBrazilian),"BRA");
  AddLangModeIfExists(wn,StringFromSet(80,LangCroatian),"CRO");
  AddLangModeIfExists(wn,StringFromSet(80,LangCzech),"CZE");
  AddLangModeIfExists(wn,StringFromSet(80,LangDanish),"DAN");
  AddLangModeIfExists(wn,StringFromSet(80,LangArabic),"DZA");
  AddLangModeIfExists(wn,StringFromSet(80,LangArabic),"EGY");
  AddLangModeIfExists(wn,StringFromSet(80,LangEnglish),"AUS");
  AddLangModeIfExists(wn,StringFromSet(80,LangEnglish),"IND");
  AddLangModeIfExists(wn,StringFromSet(80,LangEnglish),"SAF");
  AddLangModeIfExists(wn,StringFromSet(80,LangEnglish),"ENG");
  AddLangModeIfExists(wn,StringFromSet(80,LangEnglish),"SGP");
  AddLangModeIfExists(wn,StringFromSet(80,LangEnglish),"USA");
  AddLangModeIfExists(wn,StringFromSet(80,LangEstonian),"EST");
  AddLangModeIfExists(wn,StringFromSet(80,LangFinnish),"FIN");
  AddLangModeIfExists(wn,StringFromSet(80,LangFrench),"FRA");
  AddLangModeIfExists(wn,StringFromSet(80,LangGerman),"GER");
  AddLangModeIfExists(wn,StringFromSet(80,LangHungarian),"HUN");
  AddLangModeIfExists(wn,StringFromSet(80,LangIcelandic),"ICE");
  AddLangModeIfExists(wn,StringFromSet(80,LangItalian),"ITA");
  AddLangModeIfExists(wn,StringFromSet(80,LangArabic),"JOR");
  AddLangModeIfExists(wn,StringFromSet(80,LangArabic),"KWT");
  AddLangModeIfExists(wn,StringFromSet(80,LangLatvian),"LAT");
  AddLangModeIfExists(wn,StringFromSet(80,LangArabic),"LBN");
  AddLangModeIfExists(wn,StringFromSet(80,LangLithuanian),"LIT");
  AddLangModeIfExists(wn,StringFromSet(80,LangArabic),"OMN");
  AddLangModeIfExists(wn,StringFromSet(80,LangNorwegian),"NOR");
  AddLangModeIfExists(wn,StringFromSet(80,LangPolish),"POL");
  AddLangModeIfExists(wn,StringFromSet(80,LangPortuguese),"POR");
  AddLangModeIfExists(wn,StringFromSet(80,LangArabic),"QAT");
  AddLangModeIfExists(wn,StringFromSet(80,LangRomanian),"ROM");
  AddLangModeIfExists(wn,StringFromSet(80,LangRussian),"RUS");
  AddLangModeIfExists(wn,StringFromSet(80,LangArabic),"SAU");
  AddLangModeIfExists(wn,StringFromSet(80,LangSerbian),"SER");
  AddLangModeIfExists(wn,StringFromSet(80,LangSlovak),"SVK");
  AddLangModeIfExists(wn,StringFromSet(80,LangSlovenian),"SLO");
  AddLangModeIfExists(wn,StringFromSet(80,LangHondurianSpanish),"HND");
  AddLangModeIfExists(wn,StringFromSet(80,LangArgentineanSpanish),"ARG");
  AddLangModeIfExists(wn,StringFromSet(80,LangBolivianSpanish),"BOL");
  AddLangModeIfExists(wn,StringFromSet(80,LangChileanSpanish),"CHL");
  AddLangModeIfExists(wn,StringFromSet(80,LangColombianSpanish),"COL");
  AddLangModeIfExists(wn,StringFromSet(80,LangCostaRicanSpanish),"CRI");
  AddLangModeIfExists(wn,StringFromSet(80,LangGuatemaleanSpanish),"GTM");
  AddLangModeIfExists(wn,StringFromSet(80,LangMexicanSpanish),"MEX");
  AddLangModeIfExists(wn,StringFromSet(80,LangMozambicanPortuguese),"MOZ");
  AddLangModeIfExists(wn,StringFromSet(80,LangPanamanianSpanish),"PAN");
//  AddLangModeIfExists(wn,StringFromSet(80,LangParaguayanSpanish),"HND");
  AddLangModeIfExists(wn,StringFromSet(80,LangSalvadorianSpanish),"SLV");
  AddLangModeIfExists(wn,StringFromSet(80,LangSpanish),"ESP");
  AddLangModeIfExists(wn,StringFromSet(80,LangSwedish),"SWE");
  AddLangModeIfExists(wn,StringFromSet(80,LangTurkish),"TUR");
  AddLangModeIfExists(wn,StringFromSet(80,LangUkrainian),"UKR");
  AddLangModeIfExists(wn,StringFromSet(80,LangArabic),"YEM");
  AddLangModeIfExists(wn,StringFromSet(80,LangVietnamese),"VIE");
  AddLangModeIfExists(wn,StringFromSet(80,LangZimbabweanEng),"ZWE");
  ClientLangModeTClassOnOpenWindow = false;
  return;
end;

global
function Boolean SpecialMenuFunSClassOnOpenWindow(Integer wn)
begin
  
  SetListStringAndTag(wn,0,StringFromStringSet(493,"OpenPOSSessionsm"),"OpenPOSSessionsm");
  SetListStringAndTag(wn,1,StringFromStringSet(493,"ClosePOSSessionsm"),"ClosePOSSessionsm");
  SetListStringAndTag(wn,2,StringFromStringSet(493,"POSMoneyInsm"),"POSMoneyInsm");
  SetListStringAndTag(wn,2,StringFromStringSet(493,"POSMoneyOutsm"),"POSMoneyOutsm");
  SetListStringAndTag(wn,2,StringFromStringSet(493,"IVCashCashupRnsm"),"IVCashCashupRnsm");
  
  return;
end;

global
function Boolean SynkAutoSerFileNameSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt;

  SetListStringAndTag(wn,0,USetStr(24600),"IVCashVc");
  SetListStringAndTag(wn,0,USetStr(24601),"GiftReceiptVc");
  SetListStringAndTag(wn,0,USetStr(24602),"CouponVc");
  SetListStringAndTag(wn,0,USetStr(24603),"POSEventVc");
  SetListStringAndTag(wn,0,USetStr(24604),"POSBalanceVc");
  SetListStringAndTag(wn,0,USetStr(24605),"CashVc");
  SetListStringAndTag(wn,0,USetStr(24606),"GCVc");
//  SetListStringAndTag(wn,0,USetStr(24607),"GCSVc");
//  SetListStringAndTag(wn,0,USetStr(24608),"GCRVc");

  SynkAutoSerFileNameSClassOnOpenWindow = false;
  return;
end;

global
function Boolean ApproversSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Array string 255 astr2;
  Integer i,acnt,mwn;
  record RcVc RepSpec;
  string 255 tstr;
  
  mwn = MotherWindow(wn);
  if (mwn>0) then begin
    GetWindowRecord(mwn,RepSpec);
    switch (WindowActiveField(mwn)) begin
      case "f2":
        tstr = RepSpec.f11;
      otherwise
        tstr = RepSpec.f12;
    end;
  end;
  ApproversSClassArrayOnOpen(astr,astr2,acnt,tstr);
  for (i=0;i<acnt;i=i+1) begin
    AddListRow(wn,"Approvers",1,astr[i],0);
    AddListData(wn,"Approvers","UserCode",astr[i]);
    AddListData(wn,"Approvers","UserName",astr2[i]);
//    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  ApproversSClassOnOpenWindow = false;
  return;
end;

procedure SelectApproverWClassSpecPasteNameSerNr(Integer wn,var string psname)
begin
  record RcVc RepSpec;

  GetWindowRecord(wn,RepSpec);
  if (nonblank(RepSpec.f12)) then begin
    psname = "ApproversSClass";
  end else begin
    psname = "UserSClass";
  end;
  return;
end;

global
function string 40 SelectApproverWClassSpecPasteName(Integer wn,string defpsname)
begin
  string 255 psname;
  
  psname = defpsname;
  switch (WindowActiveField(wn)) begin
    case "f1": SelectApproverWClassSpecPasteNameSerNr(wn,psname);
  end;
  SelectApproverWClassSpecPasteName = psname;
  return;
end;

global
function Boolean CUDocTypeSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Array string 255 astr2;
  Integer i,acnt,mwn;
  string 255 tstr;
  
  mwn = MotherWindow(wn);
  
  CUDocTypeSClassArrayOnOpen(astr,astr2,acnt);
  for (i=0;i<acnt;i=i+1) begin
    AddListRow(wn,"DocType",1,astr[i],0);
    AddListData(wn,"DocType","DocType",astr[i]);
    AddListData(wn,"DocType","Comment",astr2[i]);
  end;
  CUDocTypeSClassOnOpenWindow = false;
  return;
end;

global
function Boolean MailTextRegisterSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt;
  
  SetListString(wn,len(StringFromStringSet(-3,"ActVc")),StringFromStringSet(-3,"ActVc"),false);    
  SetListString(wn,len(StringFromStringSet(-3,"AlarmVc")),StringFromStringSet(-3,"AlarmVc"),false); 
  SetListString(wn,len(StringFromStringSet(-3,"ExpVc")),StringFromStringSet(-3,"ExpVc"),false);    
  SetListString(wn,len(StringFromStringSet(-3,"IVVc")),StringFromStringSet(-3,"IVVc"),false);    
  SetListString(wn,len(StringFromStringSet(-3,"PPVc")),StringFromStringSet(-3,"PPVc"),false);     
  SetListString(wn,len(StringFromStringSet(-3,"OPVc")),StringFromStringSet(-3,"OPVc"),false);    
  SetListString(wn,len(StringFromStringSet(-3,"IVCashVc")),StringFromStringSet(-3,"IVCashVc"),false);    
  SetListString(wn,len(StringFromStringSet(-3,"POVc")),StringFromStringSet(-3,"POVc"),false);    
  SetListString(wn,len(StringFromStringSet(-3,"POQTVc")),StringFromStringSet(-3,"POQTVc"),false); 
  SetListString(wn,len(StringFromStringSet(-3,"QTVc")),StringFromStringSet(-3,"QTVc"),false);    
  SetListString(wn,len(StringFromStringSet(-3,"JobVc")),StringFromStringSet(-3,"JobVc"),false);    
  SetListString(wn,len(StringFromStringSet(-3,"ResAvVc")),StringFromStringSet(-3,"ResAvVc"),false);    
  SetListString(wn,len(StringFromStringSet(-3,"ORVc")),StringFromStringSet(-3,"ORVc"),false);    
  SetListString(wn,len(USetStr(2541)),USetStr(2541),false);    
  SetListString(wn,len(USetStr(2480)),USetStr(2480),false); 
  SetListString(wn,len(USetStr(4180)),USetStr(4180),false); 
  MailTextRegisterSClassOnOpenWindow = false;
  return;
end;

global
function Boolean IntrastatTransCodeSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,acnt;
  
  IntrastatTransCodeSClassArrayOnOpen(astr,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,60,astr[i],false);
  end;
  IntrastatTransCodeSClassOnOpenWindow = false;
  return;
end;

global
function Boolean IntrastatTransCodeSClassOnOKWindow(Integer wn)
begin
  Integer mwn;
  string 60 tstr;
  
  mwn = MotherWindow(wn);
  if (SelectedListLine(wn)!=-1) then begin
    tstr = GetListString(wn,SelectedListLine(wn));
    tstr = GetIntrastatTransCode(SelectedListLine(wn),tstr);
    CloseWindow(wn);
    PasteString(mwn,tstr);
  end;
  
  IntrastatTransCodeSClassOnOKWindow = false;
  return;
end;

global
function Boolean PDPMSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Array string 255 astr2;
  Array string 255 astr3;
  Integer i;
  
  PDPMSClassArrayOnOpen(astr,astr2,astr3);
  for (i=0;i<astr.length;i=i+1) begin
    AddListRow(wn,"PDPM",1,astr[i],0);
    AddListData(wn,"PDPM","Code",astr[i]);
    AddListData(wn,"PDPM","Comment",astr2[i]);
    AddListData(wn,"PDPM","Type",astr3[i]);
  end;
  PDPMSClassOnOpenWindow = false;
  return;
end;

global
function Boolean PDPMSClassOnOKWindow(Integer wn)
begin
  PasteFromSysList(wn,2);
  PDPMSClassOnOKWindow = false;
  return;
end;

global
function Boolean PL2SClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Array string 255 astr2;
  Array string 255 astr3;
  Array string 255 astr4;
  string 255 artcode,custcode,plcode;
  Integer i,mwn,rownr;
  record ORVc ORr;
  row ORVc ORrw;
  record QTVc QTr;
  row QTVc QTrw;  
  record IVVc IVr;
  row IVVc IVrw;  
  
  mwn = MotherWindow(wn);
  switch (GetWindowFileName(mwn)) begin
    case "ORVc":  
        GetWindowRecord(mwn,ORr);
        custcode = ORr.CustCode;
        plcode = ORr.PriceList;
        rownr = WindowActiveRow(mwn);
        if (rownr<MatRowCnt(ORr)) then begin
          MatRowGet(ORr,rownr,ORrw);
          artcode = ORrw.ArtCode;
        end;
    case "QTVc":  
        GetWindowRecord(mwn,QTr);
        custcode = QTr.CustCode;
        plcode = QTr.PriceList;
        rownr = WindowActiveRow(mwn);
        if (rownr<MatRowCnt(QTr)) then begin
          MatRowGet(QTr,rownr,QTrw);
          artcode = QTrw.ArtCode;
        end;
    case "IVVc":  
        GetWindowRecord(mwn,IVr);
        custcode = IVr.CustCode;
        plcode = IVr.PriceList;
        rownr = WindowActiveRow(mwn);
        if (rownr<MatRowCnt(IVr)) then begin
          MatRowGet(IVr,rownr,IVrw);
          artcode = IVrw.ArtCode;
        end;              
  end;
//  if (nonblank(custcode) and nonblank(artcode) and nonblank(plcode)) then begin 
  if (nonblank(custcode) and nonblank(artcode)) then begin 
    PL2SClassArrayOnOpen(plcode,custcode,artcode,astr,astr2,astr3,astr4);
    for (i=0;i<astr.length;i=i+1) begin
      AddListRow(wn,"PPDL",1,astr[i],0);
      AddListData(wn,"PPDL","Price",astr[i]);
      AddListData(wn,"PPDL","PriceList",astr2[i]);
      AddListData(wn,"PPDL","Item",astr3[i]);
      AddListData(wn,"PPDL","Comment",astr4[i]);
    end;
  end;  
  PL2SClassOnOpenWindow = false;
  return;
end;

global
function Boolean PL2SClassOnOKWindow(Integer wn)
begin
  PasteFromSysList(wn,20);
  PL2SClassOnOKWindow = false;
  return;
end;

global
function Boolean CountryNameSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i;
  
  CountryNameSClassOnOpenRemote(astr);
  for (i=0;i<astr.length;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  CountryNameSClassOnOpenWindow = false;
  return;
end;

global
function Boolean CountryNameSClassOnOKWindow(Integer wn)
begin
  PasteFromSysList(wn,-2);
  CountryNameSClassOnOKWindow = false;
  return;
end;

global
function Boolean ActPrioLevelSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i;
  
  ActPrioLevelSClassArrayOnOpen(astr);
  for (i=0;i<astr.length;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  ActPrioLevelSClassOnOpenWindow = false;
  return;
end;

global
function Boolean ActPrioLevelSClassOnOKWindow(Integer wn)
begin
  PasteFromSysList(wn,-2);
  ActPrioLevelSClassOnOKWindow = false;
  return;
end;

global
function Boolean POSButtonsPagesSClassOnOpenWindow(Integer wn)
begin
  Array string 255 astr;
  Integer i,mwn;
  record POSButtonsVc POSBr;
  
  mwn = MotherWindow(wn);
  if (mwn>0) then begin
    switch (GetWindowClass(mwn)) begin
      case "POSButtonsDClass":
        GetWindowRecord(mwn,POSBr)
    end;
  end;
  POSButtonsPagesSClassArrayOnOpen(POSBr.WindowClass,POSBr.Page,astr);
  for (i=0;i<astr.length;i=i+1) begin
    SetListString(wn,len(astr[i]),astr[i],false);    
  end;
  POSButtonsPagesSClassOnOpenWindow = false;
  return;
end;

global
function Boolean POSButtonsPagesSClassOnOKWindow(Integer wn)
begin
  PasteFromSysList(wn,-2);
  POSButtonsPagesSClassOnOKWindow = false;
  return;
end;
