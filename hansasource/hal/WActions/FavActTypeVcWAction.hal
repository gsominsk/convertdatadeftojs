
global
function Boolean FavActTypeDClassActTypeEFAfter(Integer wn,Boolean changedf)
begin
  record FavActTypeVc FATr;
  record ActTypeVc ActTyper;

  if (changedf) then begin  
    GetWindowRecord(wn,FATr);
    ActTyper.Code = FATr.ActType;
    if (ReadFirstMain(ActTyper,1,true)) then begin
      FATr.ActTypeGr = ActTyper.ActTypeGr;
      FATr.Comment = ActTyper.Comment;
    end;
    PutWindowRecord(wn,FATr);
  end;
  
  FavActTypeDClassActTypeEFAfter = true;
  return;
end;

global
function Boolean FavActTypeDClassAfterEditField(Integer wn,string fieldname,Integer fn,Integer rownr,Integer changed)
begin
  Boolean res;

  switch (fieldname) begin
    case "ActType": res = FavActTypeDClassActTypeEFAfter(wn,changed!=0);
  end;
  
  FavActTypeDClassAfterEditField = res;
  return;
end;

global
function Boolean FavActTypeSClassOnOpenWindow(Integer wn)
begin
  SetWindowSubset(wn,CurrentUser);
  FavActTypeSClassOnOpenWindow = false;
  return;
end;

global
procedure OpenActTypeSClass()
begin
  Integer wn,mwn,wn2;
  record ActTypeVc ActTyper;
  string 255 psname;

  wn = CurWindow;
  psname = GetWindowString(wn,"ActTypepsname");
  if (blank(psname)) then begin
    psname = "ActTypeSClass";
  end;
  mwn = MotherWindow(wn);
  CloseWindow(wn);
  wn2 = OpenWindow(psname,0,mwn,"","",ActTyper);
  PutWindowString(wn2,"ActTypepsname",psname);
  return;
end;

global
procedure OpenFavActTypeSClass()
begin
  Integer wn,mwn,wn2;
  record ActTypeVc ActTyper;
  string 255 psname;

  wn = CurWindow;
  psname = GetWindowClass(wn);
  mwn = MotherWindow(wn);
  CloseWindow(CurWindow);
  wn2 = OpenWindow("FavActTypeSClass",0,mwn,CurrentUser,"",ActTyper);
  PutWindowString(wn2,"ActTypepsname",psname);
  return;
end;
