external function Boolean GetFirstItem(var string,var record INVc);

function Boolean StExValDClassArtCodeEFAfter(Integer wn,Integer fn, Integer rownr,Integer changed)
BEGIN
  record StExValVc StExValr;
  record INVc INr;
  Boolean res;
  
  res = true;
  if (changed!=0) then begin
    GetWindowRecord(wn,StExValr);
    DeselectWindow(wn,false);
    if (GetFirstItem(StExValr.ArtCode,INr)) then begin
      StExValr.Desc = INr.Name;
      PutWindowRecord(wn,StExValr);    
    end else begin
      Beep;
    end;
  end;
  StExValDClassArtCodeEFAfter = res;
  RETURN;
END;

global
function Boolean StExValDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;

  switch (fieldname) begin
    case "ArtCode": res = StExValDClassArtCodeEFAfter(wn,fn,rownr,changed);
  end;
  StExValDClassAfterEditField = res;
  RETURN;
END;

