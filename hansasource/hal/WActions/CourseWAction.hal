function Boolean CourseEventDClassContactEFAfter(integer wn,Integer changedf)
begin
  record CourseVc Courser;  
  record UserVc Userr;
  Boolean res;
  res = true;

  if (changedf!=0) then begin
    GetWindowRecord(wn,Courser);      
    Userr.Code = Courser.Contact;
    if( ReadFirstMain(Userr,1,true)) then begin
      if (nonblank(Userr.CurOurContact)) then begin
        Courser.Responsible = Userr.CurOurContact;
      end else begin
        Courser.Responsible = Userr.Name;
      end;
    end;  
    PutWindowRecord(wn,Courser);  
  end;
  CourseEventDClassContactEFAfter = res;  
  RETURN;
END;

global
function Boolean CourseDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;
  record CourseVc Courser;
  
  switch (fieldname) begin
    case "Contact" : res = CourseEventDClassContactEFAfter(wn,changed);
   end;
  CourseDClassAfterEditField = res;
  RETURN;
END;
