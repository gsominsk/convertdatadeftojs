
global
function Boolean TaxMatrixVClassOnOKWindow(Integer wn)
begin
  record TaxMatrixVc TMr;
  record IVVc IVr;
  row IVVc IVrw;
  longint mwn,rowno;
  
  //wn = CurWindow;
  mwn = MotherWindow(wn);
  
  GetWindowRecord(wn,TMr);
  GetWindowRecord(mwn,IVr);
  
  rowno = StringToInt(GetWindowString(wn,"TaxMatrixActiveRow"));
  if (rowno>=0) then begin
    MatRowGet(IVr,rowno,IVrw);
    PackRowFieldMatrix(IVrw,"TaxMatrix",TMr);
    MatRowPut(IVr,rowno,IVrw);
  end else begin
    PackFieldMatrix(IVr,"TaxMatrix",TMr);
  end;
  
  CloseWindow(wn);

  PutWindowRecord(mwn,IVr);
  if (WindowState(mwn)==Rs_normal) then begin
    SetWindowState(mwn,Rs_update);
  end;
  
  TaxMatrixVClassOnOKWindow = false;
  return;
end;
