procedure ComisionCOVc_PasteCustCode(var record ComisionCOVc ComisionCOr)
begin
  record CUVc CUr;
  
  CUr.Code = ComisionCOr.CustCode;
  if (ReadFirstMain(CUr,1,true)) then begin
    ComisionCOr.CustName = CUr.Name;
  end;
  return;
end;

global
function Boolean ComisionCODClassPrint(Integer wn,Boolean previewf)
BEGIN
  Boolean res;
  ComisionCODClassPrint = res;
  RETURN;
END;

global
function Boolean ComisionCODClassActiveEditField(Integer wn,string fieldname,Integer fn,Integer wnst,Integer rownr,Integer ef)
BEGIN
  Boolean res;
  record ComisionCOVc ComisionCOr;
  record ComisionCOVc ComisionCO2r;
  row ComisionCOVc ComisionCOrw;
  
  switch (fieldname) begin
    case "SerNr": ;
  end;
  res = true;
  ComisionCODClassActiveEditField = res;
  RETURN;
END;

function Boolean ComisionCODClassCustCodeEFAfter(Integer wn,Integer fn,Integer rownr,Integer changedf)
begin
  record ComisionCOVc ComisionCOr;

  if (changedf!=0) then begin  
    GetWindowRecord(wn,ComisionCOr);
    DeselectWindow(wn,false);
    ComisionCOVc_PasteCustCode(ComisionCOr);
    PutWindowRecord(wn,ComisionCOr);
  end;
  ComisionCODClassCustCodeEFAfter = true;
  return;
end;

global
function Boolean ComisionCODClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;

  switch (fieldname) begin
    case "CustCode": res = ComisionCODClassCustCodeEFAfter(wn,fn,rownr,changed);
  end;
  ComisionCODClassAfterEditField = res;
  RETURN;
END;

procedure ComisionCODClassSpecPasteNameArtCode(Integer wn,var string psname)
BEGIN
  record ComisionCOVc ComisionCOr;
  row ComisionCOVc ComisionCOrw;
  Integer rownr;

  GetWindowRecord(wn,ComisionCOr);
  rownr = WindowActiveRow(wn);
  if (rownr>=0) then begin
    MatRowGet(ComisionCOr,rownr,ComisionCOrw);
  end;
  switch (ComisionCOrw.CodeType) begin
    case 0: psname = "ITSClass";
    case 1: psname = "INSClass";
    otherwise psname = "";
  end;
  RETURN;
END;

global
function string 40 ComisionCODClassSpecPasteName(Integer wn,string defpsname)
begin
  string 255 psname;
  
  psname = defpsname;
  switch (WindowActiveField(wn)) begin
    case "ArtCode": ComisionCODClassSpecPasteNameArtCode(wn,psname);
  end;
  ComisionCODClassSpecPasteName = psname;
  return;
end;

global 
function Boolean ComisionCODClassDeleteRowTest(Integer wn,Integer rownr)
begin
  Boolean res;

  res = true;
  ComisionCODClassDeleteRowTest = res;
  return;
end;

global 
function Boolean ComisionCODClassInsertRowTest(Integer wn,Integer rownr)
begin
  Boolean res;

  res = true;
LComisionCODClassInsertRowTest:;  
  ComisionCODClassInsertRowTest = res;
  return;
end;
