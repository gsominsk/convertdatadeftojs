remote function Integer APAccTClassOnOKWindowRemote(record APAccBlock,var string,var string);


//Should be AccBlockCheck but it is called in more places than storing blocks from the interface
global
function Boolean APAccTClassOnOKWindow(Integer wn)
begin
  record APAccBlock APAccb;
  Boolean res;
  string 255 accstr,fieldgoto;
  Integer err;

  res = true;
  GetWindowRecord(wn,APAccb);
  err = APAccTClassOnOKWindowRemote(APAccb,accstr,fieldgoto);
  if (err!=0) then begin
    MessageBox(1120,accstr);
    WindowFieldGoto(wn,APAccb,-1,fieldgoto,true);
    res = -1;
    goto LAPAccBlockCheck;
  end;

LAPAccBlockCheck:;
  APAccTClassOnOKWindow = res;
  return;
end;
