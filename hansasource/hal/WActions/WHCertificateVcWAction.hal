global
function Boolean WHCertificateDClassActiveEditField(Integer wn,string fieldname,Integer fn,Integer wnst,Integer rownr,Integer changed)
begin
  Boolean res;
  record WHCertificateVc WHCertificater;
  
  res = false;
  if (wnst==Rs_insert) then begin
    res = UserCanAction("CreatingWithholdingCertificates",false);
  end;
  switch (fieldname) begin
    case "Comment": res = true;
    case "LangCode": res = true;
    case "DocName": res = true;
    case "WHTaxSerNr":
      res = UserCanAction("EditingWithholdingCertificates",false) or UserCanAction("CreatingWithholdingCertificates",false);
  end;
  WHCertificateDClassActiveEditField = res;
  return;
end;

global
function Boolean WHCertificateDClassPrint(Integer wn,Boolean previewf)
begin
  record WHCertificateVc WHCertificater;

  GetWindowRecord(wn,WHCertificater);  
  if (PrintDocument(WHCertificater,"WHCertificateForm",previewf)) then begin end;
  WHCertificateDClassPrint = true;
  return;
end;
