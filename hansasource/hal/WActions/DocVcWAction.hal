global
function Boolean DocFldVClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
begin
  Boolean res;
  record DocRowVc DRr;

  switch (fieldname) begin
    case "formatNr": 
      GetWindowRecord(wn,DRr);
      if (DRr.formatNr>0) then begin
        DRr.wordWrap = 0;
        PutWindowRecord(wn,DRr);
      end;
      res = true;
  end;
  DocFldVClassAfterEditField = res;
  return;
end;

global
function Boolean DocPageSumVClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
begin
  Boolean res;
  record DocRowVc DRr;

  switch (fieldname) begin
    case "formatNr": 
      GetWindowRecord(wn,DRr);
      if (DRr.formatNr>0) then begin
        DRr.wordWrap = 0;
        PutWindowRecord(wn,DRr);
      end;
      res = true;
  end;
  DocPageSumVClassAfterEditField = res;
  return;
end;

global
function Integer DocMainVClassSelectSetToPaste(Integer wn,string fieldname)
begin
  Integer res;
  
  res = 15;
  switch (fieldname) begin
    case "DocType":
      if (IsBooks) then begin
        if (ValuePack(1)==false) then begin res = 513; end;
      end;
      if (IsStandardProduct) then begin
        res = 530;
      end;
     case "CodePage":
       res = 382;
  end;
  DocMainVClassSelectSetToPaste = res;
  return;
end;
