remote procedure LiqInfoVc_PasteSum(var record LIqInfoVc,Integer);
remote procedure LiqInfoVc_PasteTransNr(var record LIqInfoVc);

function Boolean LiqInfoDClassCUCodeEFAfter(Integer wn,Boolean changedf)
begin
  Boolean res;
  record LIqInfoVc LIqInfor;
  record CUVc CUr;

  res = true;
  if (changedf) then begin
    GetWindowRecord(wn,LIqInfor);
    CUr.Code = LIqInfor.CUCode;
    if (ReadFirstMain(CUr,1,true)) then begin
      LIqInfor.CUName = CUr.Name;
      PutWindowRecord(wn,LIqInfor);    
    end;
  end;
  LiqInfoDClassCUCodeEFAfter = res;
  return;
end;

function Boolean LiqInfoDClassTransNrEFAfter(Integer wn,Boolean changedf)
begin
  Boolean res;
  record LIqInfoVc LIqInfor;

  res = true;
  if (changedf) then begin
    GetWindowRecord(wn,LIqInfor);
    LiqInfoVc_PasteTransNr(LIqInfor);
    LiqInfoVc_PasteSum(LIqInfor,0);
    PutWindowRecord(wn,LIqInfor);    
  end;
  LiqInfoDClassTransNrEFAfter = res;
  return;
end;

function Boolean LiqInfoDClassSumEFAfter(Integer wn,Boolean changedf)
begin
  Boolean res;
  record LIqInfoVc LIqInfor;

  res = true;
  if (changedf) then begin
    GetWindowRecord(wn,LIqInfor);
    LiqInfoVc_PasteSum(LIqInfor,0);
    PutWindowRecord(wn,LIqInfor);    
  end;
  LiqInfoDClassSumEFAfter = res;
  return;
end;

function Boolean LiqInfoDClassBaseSumEFAfter(Integer wn,Boolean changedf)
begin
  Boolean res;
  record LIqInfoVc LIqInfor;

  res = true;
  if (changedf) then begin
    GetWindowRecord(wn,LIqInfor);
    LiqInfoVc_PasteSum(LIqInfor,1);
    PutWindowRecord(wn,LIqInfor);    
  end;
  LiqInfoDClassBaseSumEFAfter = res;
  return;
end;

function Boolean LiqInfoDClassTransDateEFAfter(Integer wn,Boolean changedf)
begin
  Boolean res;
  record LIqInfoVc LIqInfor;

  res = true;
  if (changedf) then begin
    GetWindowRecord(wn,LIqInfor);
    LiqInfoVc_PasteSum(LIqInfor,0);
    PutWindowRecord(wn,LIqInfor);    
  end;
  LiqInfoDClassTransDateEFAfter = res;
  return;
end;

global
function Boolean LiqInfoDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
begin
  Boolean res;

  switch (fieldname) begin
    case "CUCode": res = LiqInfoDClassCUCodeEFAfter(wn,changed!=0);
    case "TransNr": res = LiqInfoDClassTransNrEFAfter(wn,changed!=0);
    case "Sum": res = LiqInfoDClassSumEFAfter(wn,changed!=0);
    case "BaseSum": res = LiqInfoDClassBaseSumEFAfter(wn,changed!=0);
    case "TransDate": res = LiqInfoDClassTransDateEFAfter(wn,changed!=0);
  end;
  LiqInfoDClassAfterEditField = res;
  return;
end;

procedure LiqInfoDClassSpecPasteNameSerNr(Integer wn,var string psname)
begin
  record LiqInfoVc LiqInfor;
  Integer rownr;

  GetWindowRecord(wn,LiqInfor);
  switch (LiqInfor.IntYc) begin
    case IVYc: psname = "ARSClass";
    case VIYc: psname = "APSClass";
    otherwise psname = "";
  end;
  return;
end;

global
function string 40 LiqInfoDClassSpecPasteName(Integer wn,string defpsname)
begin
  string 255 psname;
  
  psname = defpsname;
  switch (WindowActiveField(wn)) begin
    case "TransNr": LiqInfoDClassSpecPasteNameSerNr(wn,psname);
  end;
  LiqInfoDClassSpecPasteName = psname;
  return;
end;
