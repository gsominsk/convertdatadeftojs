external procedure StripEndingSpaces(var string);  
external procedure M4PadString(string,Integer,string,Boolean,var string);
external function Boolean GetNextItem(string,var Integer,var string);

global
Function Boolean NewspaperSClassOnOpenWindow(Integer wn)
begin
  record NewspaperBlock NPr;
  row NewspaperBlock NPrw;
  Integer rwcnt,i;
  string 100 tstr,t2;
  
  BlockLoad(NPr);
  rwcnt = MatRowCnt(NPr);
  for (i=0;i<rwcnt;i=i+1) begin
    MatRowGet(NPr,i,NPrw);
    tstr = NPrw.NewsCode;
    M4PadString(tstr,12," ",false,t2);
    t2 = t2 & NPrw.NewsName;
    SetListString(wn,1,t2,false);
  end;
  NewspaperSClassOnOpenWindow = false;
  return;
end;

global
function Boolean NewspaperSClassOnOKWindow(Integer wn)
begin
  Integer mwn;
  string 60 tstr,t2;
  Integer np;
  Boolean nsep;
  
  mwn = MotherWindow(wn);
  tstr = GetListString(wn,SelectedListLine(wn));
  t2 = left(tstr,10);
  StripEndingSpaces(t2);
  CloseWindow(wn);
  PasteString(mwn,t2);
  NewspaperSClassOnOKWindow = false;
  return;
end;

