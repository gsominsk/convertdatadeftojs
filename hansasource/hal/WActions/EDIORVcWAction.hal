remote updating function LongInt RecordAction_raPasteEDIOrdInOrd(var record EDIORVc,var record ORVc,Boolean);

global
updating procedure ORFromEDIORDsm()
BEGIN
  record EDIORVc EDIORr;
  record ORVc ORr;
  LongInt r;
  Integer wn,nwn;
  
  wn = CurWindow;
  if (WindowState(wn)==0) then begin//Rs_normal
    GetWindowRecord(wn,EDIORr);
    if (EDIORr.Closed==0) then begin
      if (UserCanAction("EDIORToOR",true)) then begin
        r = RecordAction_raPasteEDIOrdInOrd(EDIORr,ORr,true);
        switch (r) begin
          case -1: Beep;
          case -2: MessageBox(1281,"");
          otherwise
            nwn = OpenWindow("ORDClass",1,0,"","",ORr);
        end;
        UpdateBrowses("ORVc");
      end else begin
        MessageBox(1274,StringFromStringSet(3,"EDIORToOR"));
      end;
    end;
  end else begin
    Beep;
  end;
  RETURN;
END;

global
updating procedure ORFromEDIORLsm()
BEGIN
  record EDIORVc EDIORr;
  record ORVc ORr;
  LongInt r;
  Integer wn,nwn;
  
  wn = CurWindow;
  if (WindowState(wn)==0) then begin//Rs_normal
    if (ReadMarkedRecord(wn,EDIORr)) then begin
      if (EDIORr.Closed==0) then begin
        if (UserCanAction("EDIORToOR",true)) then begin
          r = RecordAction_raPasteEDIOrdInOrd(EDIORr,ORr,false);
          switch (r) begin
            case -1: Beep;
            case -2: MessageBox(1281,"");
            otherwise
              nwn = OpenWindow("ORDClass",1,0,"","",ORr);
          end;
          UpdateBrowses("ORVc");
        end else begin
          MessageBox(1274,StringFromStringSet(3,"EDIORToOR"));
        end;
      end;
    end;
  end else begin
    Beep;
  end;
  RETURN;
END;

global 
function Boolean EDIORDClassInsertRowTest(Integer wn,Integer rownr)
begin
  Boolean res;

  res = false;  
  EDIORDClassInsertRowTest = res;
  return;
end;

global 
function Boolean EDIORDClassDeleteRowTest(Integer wn,Integer rownr)
begin
  Boolean res;

  res = false;  
  EDIORDClassDeleteRowTest = res;
  return;
end;

global
function Boolean EDIORDClassClosedButtonAction(Integer wn,Integer value)
BEGIN
  Boolean res;
  record EDIORVc EDIORr;
  Integer normalmode,updatemode;
 
  res = true;
  normalmode = 0;//Rs_normal
  updatemode = 2;//Rs_update
  if (WindowState(wn)==normalmode) then begin
    GetWindowRecord(wn,EDIORr);
    if (EDIORr.Closed!=0) then begin
      res = false;
    end;    
  end;  
  if (WindowState(wn)==updatemode) then begin
    GetPrevWindowRecord(wn,EDIORr);
    if (EDIORr.Closed!=0) then begin
      res = false;
    end;    
  end;  
  EDIORDClassClosedButtonAction = res;
  RETURN;
END;

global
function Boolean EDIORDClassReservedButtonAction(Integer wn,Integer value)
BEGIN
  Boolean res;
 
  res = false;
  EDIORDClassReservedButtonAction = res;
  RETURN;
END;

global
function Boolean EDIORDClassExportFlagButtonAction(Integer wn,Integer value)
BEGIN
  Boolean res;
 
  res = false;
  EDIORDClassExportFlagButtonAction = res;
  RETURN;
END;

global
function Boolean EDIORDClassActiveEditField(Integer wn,string fieldname,Integer fn,Integer wnst,Integer rownr,Integer changed)
BEGIN
  Boolean res;
  
  res = false;
  EDIORDClassActiveEditField = res;
  RETURN;
END;
