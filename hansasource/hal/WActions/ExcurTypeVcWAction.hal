
global
function Boolean ExcurTypeDClassVECodeEFAfter(Integer wn,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;
  record CUVc VEr;
  record ExcurTypeVc ExcurTyper;
  
  if (changed!=0) then begin
    GetWindowRecord(wn,ExcurTyper);
    VEr.Code= ExcurTyper.VECode;
    if ReadFirstMain(VEr,1,true) then begin
      ExcurTyper.VEName= VEr.Name;
    end;
    PutWindowRecord(wn,ExcurTyper);
  end;  
  ExcurTypeDClassVECodeEFAfter = res;
  RETURN;
END;

global
function Boolean ExcurTypeDClassArtCodeEFAfter(Integer wn,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;
  record INVc INr;
  record ExcurTypeVc ExcurTyper;
  
  if (changed!=0) then begin
    GetWindowRecord(wn,ExcurTyper);
    INr.Code= ExcurTyper.ArtCode;
    if ReadFirstMain(INr,1,true) then begin
      ExcurTyper.Cost= INr.InPrice;
    end;
    PutWindowRecord(wn,ExcurTyper);
  end;  
  ExcurTypeDClassArtCodeEFAfter = res;
  RETURN;
END;

global
function Boolean ExcurTypeDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;

  switch (fieldname) begin
    case "ArtCode": res = ExcurTypeDClassArtCodeEFAfter(wn,fn,rownr,changed);
    case "VECode": res = ExcurTypeDClassVECodeEFAfter(wn,fn,rownr,changed);
  end;
  ExcurTypeDClassAfterEditField = res;
  RETURN;
END;

