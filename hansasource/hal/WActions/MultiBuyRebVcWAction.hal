external function Boolean ReadFirstItem(string,var record INVc,Boolean,Boolean);

function Boolean MultiBuyRebDClassRebArtCodeEFAfter(Integer wn,Integer rownr,Boolean changedf)
begin
  record MultiBuyRebVc MBRr;
  row MultiBuyRebVc MBRrw;
  record INVc INr;
  Boolean res;
  
  res = true;
  if (changedf) then begin
    GetWindowRecord(wn,MBRr);
    if (rownr>=0) then begin
      MatRowGet(MBRr,rownr,MBRrw);
      if (ReadFirstItem(MBRrw.RebArtCode,INr,true,true)==false) then begin
      end;
      MBRrw.RebArtName = INr.Name;
      MatRowPut(MBRr,rownr,MBRrw);
    end else begin
      if (ReadFirstItem(MBRr.RebArtCode,INr,true,true)==false) then begin
      end;
      MBRr.RebArtName = INr.Name;
    end;
    PutWindowRecord(wn,MBRr);
  end;
  MultiBuyRebDClassRebArtCodeEFAfter = res;
  return;
end;

function Boolean MultiBuyRebDClassArtCodeEFAfter(Integer wn,Integer rownr,Boolean changedf)
begin
  record MultiBuyRebVc MBRr;
  row MultiBuyRebVc MBRrw;
  record INVc INr;
  Boolean res;
  
  res = true;
  if (changedf) then begin
    GetWindowRecord(wn,MBRr);
    if (rownr>=0) then begin
      MatRowGet(MBRr,rownr,MBRrw);
      if (ReadFirstItem(MBRrw.ArtCode,INr,true,true)==false) then begin
      end;
      MBRrw.ArtName = INr.Name;
      MatRowPut(MBRr,rownr,MBRrw);
    end;
    PutWindowRecord(wn,MBRr);
  end;
  MultiBuyRebDClassArtCodeEFAfter = res;
  return;
end;

global
function Boolean MultiBuyRebDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
begin
  Boolean res;

  switch (fieldname) begin
    case "RebArtCode": res = MultiBuyRebDClassRebArtCodeEFAfter(wn,rownr,changed!=0);
    case "ArtCode": res = MultiBuyRebDClassArtCodeEFAfter(wn,rownr,changed!=0);
  end;
  MultiBuyRebDClassAfterEditField = res;
  return;
end;

global
function Boolean MultiBuyRebDClassUpdateTest(Integer wn)
begin
  Boolean res;
  record MultiBuyRebVc MBRr;
  
  res = true;
  GetWindowRecord(wn,MBRr);
  if (MBRr.Closed>0) then begin
    res = false;
  end;
  MultiBuyRebDClassUpdateTest = res;
  return;
end;
