function boolean COCUInvoiceCompTClassCompCodeEFAfter(Integer wn,string fieldname,Integer rownr,boolean changedf)
begin
  record CompaniesBlock Compb;
  row CompaniesBlock Compbrw;
  record COCUInvoiceCompBlock CICb;
  row COCUInvoiceCompBlock CICbrw;
  integer i,rwcnt;
  string 255 compcode;
  
  if (changedf and rownr>=0) then begin
    GetWindowRecord(wn,CICb);
    MatRowGet(CICb,rownr,CICbrw);
    
    switch (fieldname) begin
      case "CompCode": compcode = CICbrw.CompCode;
      case "InvInCompCode": compcode = CICbrw.InvInCompCode;
    end;
    
    BlockLoad(Compb);
    rwcnt = MatRowCnt(Compb);    
    for (i=0;i<rwcnt;i=i+1) begin
      MatRowGet(Compb,i,Compbrw);
      if (Compbrw.CompCode==compcode) then begin
        switch (fieldname) begin
          case "CompCode": CICbrw.CompName = Compbrw.CompName;
          case "InvInCompCode": CICbrw.InvInCompName = Compbrw.CompName;
        end;
        MatRowPut(CICb,rownr,CICbrw);
        PutWindowRecord(wn,CICb);
        i = rwcnt;
      end;
    end;
  end;
  return;
end;

global
function boolean COCUInvoiceCompTClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
begin
  Boolean res;

  switch (fieldname) begin
    case "CompCode": res = COCUInvoiceCompTClassCompCodeEFAfter(wn,fieldname,rownr,changed!=0);
    case "InvInCompCode": res = COCUInvoiceCompTClassCompCodeEFAfter(wn,fieldname,rownr,changed!=0);
  end;
  COCUInvoiceCompTClassAfterEditField = res;
  return;
end;
