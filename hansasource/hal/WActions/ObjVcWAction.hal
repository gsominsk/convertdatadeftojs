remote function string 255 GetSelDI_Obj2SClass(string,LongInt,var Array string,var Integer);

function Boolean ObjDClassCodeEFActive(Integer wn,Integer fn,Integer wnst,Integer rownr,Integer ef)
begin
  Boolean res;
  record ERVc ERr;
  
  res = true;
  if (wnst==2) then begin//updatemode Rs_update
    res = false;
  end;
  ObjDClassCodeEFActive = res;
  return;
end;

global
function Boolean ObjDClassActiveEditField(Integer wn,string fieldname,Integer fn,Integer wnst,Integer rownr,Integer changed)
begin
  Boolean res;
  
  res = true;
  switch (fieldname) begin
    case "Code": res = ObjDClassCodeEFActive(wn,fn,wnst,rownr,changed);
  end;
  ObjDClassActiveEditField = res;
  return;
end;

global
function string 255 UpWindDI_Obj2SClass(string subset,Integer topm)
begin
  string 255 res;
//  record CYBlock CYb;
  string 255 tstr;
  record OTVc OTr;

  OTr.Code = subset;
  if (topm==1) then begin
    if (ReadFirstMain(OTr,1,true)) then begin
      res = OTr.Code;
    end;
  end;
  if ((blank(res)) or (topm==0)) then begin
//    BlockLoad(CYb);
//    res = CYb.AccClass;
  end;
  UpWindDI_Obj2SClass = res;
  return;
end;


global
function Boolean Obj2SClassOnOpenWindow(Integer wn)
begin
  LongInt l;
  string 255 subset;
  Array string 255 adi;
  Integer i,acnt;
  
  l = SelectedListLine(wn);
  subset = GetSelDI_Obj2SClass(GetWindowSubset(wn),l,adi,acnt);
  ClearStringList(wn);
//  Obj2SClassOnOKWindowDo(subset,adi,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,i,adi[i],false);  
  end;
  SetWindowSubset(wn,subset);
  i = SelectedListLine(wn);
  Obj2SClassOnOpenWindow = true;
  return;
end;

global
function Boolean Obj2SClassOnOKWindow(Integer wn)
begin  
  LongInt l;
  string 255 subset;
  Array string 255 adi;
  Integer i,acnt;
    
  l = SelectedListLine(wn);
  subset = GetSelDI_Obj2SClass(GetWindowSubset(wn),l,adi,acnt);
  ClearStringList(wn);
//  Obj2SClassOnOKWindowDo(subset,adi,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,i,adi[i],false);  
  end;
  SetWindowSubset(wn,subset);
  i = SelectedListLine(wn);
  UpdateBrowses("Obj2SClass");
  Obj2SClassOnOKWindow = true;
  return;
end;

global
procedure Obj2SClassTop()
begin
  Integer wn;
  string 255 subset;
  LongInt l;
  Array string 255 adi;
  Integer i,acnt;
  
  wn = CurWindow;
  subset = UpWindDI_Obj2SClass(GetWindowSubset(wn),0);
  subset = GetSelDI_Obj2SClass(subset,l,adi,acnt);
  ClearStringList(wn);
//  Obj2SClassOnOKWindowDo(subset,adi,acnt);
  for (i=0;i<acnt;i=i+1) begin
    SetListString(wn,i,adi[i],false);  
  end;
  SetWindowSubset(wn,subset);
  i = SelectedListLine(wn);
  UpdateBrowses("");
  return;
end;
