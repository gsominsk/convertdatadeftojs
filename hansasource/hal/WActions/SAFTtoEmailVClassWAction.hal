external procedure FindFiscalYearBlockRow(Date,row YearBlock);

global
function boolean SAFTtoEmailVClassOnOKWindow(integer wn)
begin
  boolean res;
  record RcVc RepSpec;
  row YearBlock Ybrw;

  res = true;
  GetWindowRecord(wn, RepSpec);
  if (RepSpec.flags[0]==2) then begin 
    FindFiscalYearBlockRow(RepSpec.sStartDate,Ybrw);
    if (RepSpec.sStartDate<Ybrw.StartDate) or (RepSpec.sEndDate<>Ybrw.EndDate) then begin
      MessageBox(18812,"");
      res = false;
    end;
  end;  
  SAFTtoEmailVClassOnOKWindow = res;
  return;
end;