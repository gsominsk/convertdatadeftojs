external procedure SendWebProductsToAmazon(string);

global
procedure WebNGProductToAmazonLsm()
begin
  if (UserCanAction("AmazonIntegration",false)) then begin
    SendWebProductsToAmazon("");
  end;
  return;
end;

global
updating procedure WebNGProductToAmazonDsm()
begin
  Integer wn;
  record WebNGProductVc WPr;
  Boolean sendf;
  
  sendf = true;
  if (UserCanAction("AmazonIntegration",false)) then begin
    wn = CurWindow;
    GetWindowRecord(wn,WPr);
    if (WindowState(wn)==Rs_insert or WindowState(wn)==Rs_update) then begin
      sendf = WindowDoOK(wn,0);
    end;
    if (sendf) then begin
      SendWebProductsToAmazon(WPr.Code);
    end;
  end;
  return;
end;