
global
function Boolean CreditCardrDClassCUCodeEFAfter(Integer wn,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;
  record CreditCardVc CreditCardr;
  record CUVc CUr;
  
  if (changed!=0) then begin
    GetWindowRecord(wn,CreditCardr);
    CUr.Code = CreditCardr.CUCode;
    if ReadFirstMain(CUr,1,true) then begin
      CreditCardr.CUName = CUr.Name;
    end;
    PutWindowRecord(wn,CreditCardr);
  end;  
  CreditCardrDClassCUCodeEFAfter = res;
  RETURN;
END;

global
function Boolean CreditCardrDClassBankCodeEFAfter(Integer wn,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;
  record CreditCardVc CreditCardr;
  record BankVc Bankr;
  
  if (changed!=0) then begin
    GetWindowRecord(wn,CreditCardr);
    Bankr.Code = CreditCardr.BankCode;
    if ReadFirstMain(Bankr,1,true) then begin
      CreditCardr.BankName = Bankr.Name;
    end;
    PutWindowRecord(wn,CreditCardr);
  end;  
  CreditCardrDClassBankCodeEFAfter = res;
  RETURN;
END;

global
function Boolean CreditCardDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;

  switch (fieldname) begin
    case "CUCode": res = CreditCardrDClassCUCodeEFAfter(wn,fn,rownr,changed);
    case "BankCode": res = CreditCardrDClassBankCodeEFAfter(wn,fn,rownr,changed);
  end;
  CreditCardDClassAfterEditField = res;
  RETURN;
END;
