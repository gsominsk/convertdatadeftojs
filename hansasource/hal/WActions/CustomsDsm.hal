remote updating function Boolean CalculateCosts(var record CustomsVc);
external updating procedure RecordActionCustoms_Print(var record CustomsVc,string,Boolean);
external procedure DefaultPeriod(var string);

global
procedure DoPUFromCustomsDsm()
BEGIN
  record RcVc RepSpec;
  record CustomsVc Customsr;
  Integer wn,nwn;
  Integer normalmode;
  string 255 tstr;

  normalmode = 0;
  wn = CurWindow;
  if (WindowState(wn)==normalmode)then begin
    GetWindowRecord(wn,Customsr);
    if (Customsr.OKFlag!=0) then begin
      nwn = OpenWindow("CustomsPUVClass",0,0,"","",RepSpec);
      DeselectWindow(nwn,false);
      GetWindowRecord(wn,RepSpec);
      ReportDefaults(RepSpec,"CustomsPUVClass");
      RepSpec.f1 = Customsr.SerNr;
      RepSpec.repname = "CustomsToPUMn";
      DefaultPeriod(tstr);
      RepSpec.Period2Str = tstr;      
      PutWindowRecord(nwn,RepSpec);
      SelectWindow(nwn);
    end else begin
      Beep;
    end;  
  end;
  RETURN;
END;

global
updating procedure DoCalculateCustomsDsm()
BEGIN
  record CustomsVc CUSr;
  
  if (WindowState(CurWindow)==0) then begin//normal
    GetWindowRecord(CurWindow,CUSr);
    if (CalculateCosts(CUSr)) then begin
      PutWindowRecord(CurWindow,CUSr);
    end else begin
      Beep;
    end;
  end;
  RETURN;
END;

global 
procedure PrintCUSTARDsm()
BEGIN
  record CustomsVc Customsr;
  record RcVc RepSpec;
  
  GetWindowRecord(CurWindow,Customsr);
  RepSpec.long1 = Customsr.SerNr;
  RepSpec.repname = "CUSTARRn";
  RepSpec.f1 = "CUSTAR";
  RepSpec.Media = mtScreen;
  RunReport(RepSpec,0);
  RETURN;
END;

global
procedure PrintCUSPARDsm()
BEGIN
  record CustomsVc Customsr;
  record RcVc RepSpec;
  
  GetWindowRecord(CurWindow,Customsr);
  RepSpec.long1 = Customsr.SerNr;
  RepSpec.repname = "CUSPARRn";
  RepSpec.f1 = "CUSPAR";
  RepSpec.Media = mtScreen;
  RunReport(RepSpec,0);
  RETURN;
END;

global
updating procedure EDICustomsLsm()
BEGIN
  RunAutoImport("EDICustomsIn","CUSRES","CUSRESIMP");
  RETURN;
END;

global
updating procedure PrintCustomsL(Integer wn,Boolean previewf)
BEGIN
  record CustomsVc Customsr;
  Integer i;
  
  StartPrintDialogGroup;
  i = 1;
  while (GetRecordFromBrowse(Customsr,wn,i)) begin
    RecordActionCustoms_Print(Customsr,previewf,true);
    i = i + 1;
  end;
  EndPrintDialogGroup;
  RETURN;
END;
