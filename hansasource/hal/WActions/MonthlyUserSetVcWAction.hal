

function Boolean MonthlyUserSetDClassPersonEFAfter(Integer wn,Boolean changedf)
BEGIN
  Boolean res;
  record MonthlyUserSetVc MonthlyUserSetr;
  record UserVc Userr;
  
  if (changedf) then begin
    GetWindowRecord(wn,MonthlyUserSetr);
    Userr.Code = MonthlyUserSetr.Person;
    if (ReadFirstMain(Userr,1,true)) then begin
      MonthlyUserSetr.PersonName = Userr.Name;
    end;
    PutWindowRecord(wn,MonthlyUserSetr);
    res = true;
  end;
  MonthlyUserSetDClassPersonEFAfter = res;
  RETURN;
END;

global
function Boolean MonthlyUserSetDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;

  switch (fieldname) begin
    case "Person": res = MonthlyUserSetDClassPersonEFAfter(wn,changed!=0);
  end;
  MonthlyUserSetDClassAfterEditField = res;
  RETURN;
END;