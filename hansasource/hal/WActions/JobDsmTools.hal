
global
function Boolean CheckedAllowedStatus(string fromstat,string tostat)
BEGIN
  record ReserSeqVc ReserSeqr;
  Boolean res;

  ReserSeqr.FromStatus = fromstat;
  if (ReadFirstMain(ReserSeqr,1,true)) then begin
    if (nonblank(tostat)) then begin
      if (SetInSet(tostat,ReserSeqr.StatusAllowed)) then begin
        res = true;
      end;
    end;
  end;
  CheckedAllowedStatus = res;
  RETURN;
END;

global
procedure MakeActFromRes(record ResVc Resr,record ActVc Actr)
begin
  record HotelBlock HotelSettings;

  Blockload(HotelSettings);
  RecordNew(Actr);
  Actr.OKFlag = 0;
  Actr.TodoFlag = 1;
//  Actr.PrivateFlag = 1;
  Actr.CalTimeFlag = 0;
  Actr.TransDate = CurrentDate;
  Actr.StartTime = CurrentTime;
  Actr.MainPersons = CurrentUser;
  Actr.Resources = Resr.Code;
  return;
end;
 
