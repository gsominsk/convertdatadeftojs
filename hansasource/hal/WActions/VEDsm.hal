remote procedure rlVEInfo_hal(string,var record RcVc);

global
procedure VEStatusLsm()
BEGIN
  record CUVc VEr;
  record RcVc RepSpec;  
  Integer i,wn;
  string 40 firstcu;
  
  wn = CurWindow;
  i = 1;
  while (GetRecordFromBrowse(VEr,wn,i)) begin
    if (i==1) then begin
      firstcu = VEr.Code;
    end;
    i = i + 1;
  end;
  rlVEInfo_hal(firstcu,RepSpec);
  if (nonblank(RepSpec.f1)) then begin
    RepSpec.f1 = RepSpec.f1 & ":";
  end;
  RepSpec.f1 = RepSpec.f1 & VEr.Code;    
  RunReport(RepSpec,0);
  RETURN;
END;

global
procedure VEStatusVEDsm()
BEGIN
  record CUVc VEr;
  record RcVc RepSpec;
  Integer wn;

  wn = CurWindow;
  GetWindowRecord(wn,VEr);
  if (VEr.VEType!=0) then begin
    rlVEInfo_hal(VEr.Code,RepSpec);
    RunReport(RepSpec,0);
  end;
  RETURN;
END;

global
procedure VEStatusVESsm()
begin
  record CUVc VEr;
  record RcVc RepSpec;  
  Integer i,wn;
  string 40 firstcu;
  
  wn = CurWindow;
  i = 1;
  while (GetRecordFromBrowse(VEr,wn,i)) begin
    if (i==1) then begin
      firstcu = VEr.Code;
    end;
    i = i + 1;
  end;  
  rlVEInfo_hal(firstcu,RepSpec);
  if (nonblank(RepSpec.f1)) then begin
    RepSpec.f1 = RepSpec.f1 & ":";
  end;
  RepSpec.f1 = RepSpec.f1 & VEr.Code;    
  RunReport(RepSpec,0);
  return;
end;
