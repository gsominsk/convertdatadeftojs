global
function string 40 PBXQueueSClassPasteSpecialWindowClass(string defpsname)
begin
  record PBXSoundVc PBXSoundr;
  Integer wn;
  string 40 res;

  wn = CurWindow;
  res = defpsname;
  if (GetWindowClass(wn)=="PBXSoundDClass") then begin
    GetWindowRecord(wn,PBXSoundr);
    switch (PBXSoundr.Event) begin
      case kAsteriskEventSoundQueueStart:
        res = "PBXQueueSClass";
      case kAsteriskEventSoundIVRStart:
        res = "PBXIVRTreeSClass";
      case kAsteriskEventSoundIVRClosed:
        res = "PBXIVRTreeSClass";
      case kAsteriskEventSoundLineClosed:
        res = "PBXQueueSClass";
    end;
  end;
  PBXQueueSClassPasteSpecialWindowClass = res;
end;
