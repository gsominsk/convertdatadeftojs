
function Boolean CDDClassCustCodeEFAfter(Integer wn,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;
  record CDVc CDr;
  record CUVc CUr;

  res = true;
  if (changed!=0) then begin
    GetWindowRecord(wn,CDr);
    CUr.Code = CDr.CustCode;
    if (ReadFirstMain(CUr,1,true)) then begin
      CDr.CustName = CUr.Name;
    end;
    PutWindowRecord(wn,CDr);    
  end;
  CDDClassCustCodeEFAfter = res;
  RETURN;
END;

function Boolean CDDClassItemEFAfter(Integer wn,Integer rownr,Boolean changedf)
BEGIN
  Boolean res;
  record CDVc CDr;
  row CDVc CDrw;
  record INVc INr;

  res = true;
  if (changedf) then begin
    GetWindowRecord(wn,CDr);
    if (rownr>=0) then begin
      MatRowGet(CDr,rownr,CDrw);
      INr.Code = CDrw.Item;
      if (ReadFirstMain(INr,1,true)) then begin
        CDrw.Price = INr.UPrice1;
        MatRowPut(CDr,rownr,CDrw);
      end;
      PutWindowRecord(wn,CDr);    
    end;
  end;
  CDDClassItemEFAfter = res;
  RETURN;
END;

global
function Boolean CDDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;

  switch (fieldname) begin
    case "CustCode": res = CDDClassCustCodeEFAfter(wn,fn,rownr,changed);
    case "Item": res = CDDClassItemEFAfter(wn,rownr,changed!=0);
  end;
  CDDClassAfterEditField = res;
  RETURN;
END;
