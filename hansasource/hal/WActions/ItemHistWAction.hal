global
updating procedure DeleteItemHistMn(record RcVc RepSpec)
begin
  record ItemHistVc ItemHistr;

  ResetLoop(ItemHistr);
  while (LoopMain(ItemHistr,1,true)) begin
    RecordDelete(ItemHistr);
    StepBack(ItemHistr);
  end;
  return;
end;

global
updating procedure DeleteItemHistDsm()
begin
  record RcVc RepSpec;
  Integer nwn;
  
  nwn = OpenWindow("DeleteItemHistVClass",1,0,"","",RepSpec);
  RepSpec.repname = "DeleteItemHistMn";
  PutWindowRecord(nwn,RepSpec);
  return;
end;

procedure OpenVcFromItemHist(string filename,LongInt transnr)
BEGIN
  Integer nwn;
  record ItemHistVc ItemHistr;
  record PUVc PUr;
  record SHVc SHr;
  record SDVc SDr;
  record StockMovVc StockMovr;
  record RetVc Retr;
  record RetPUVc RetPUr;
  record StockTakeVc StockTaker;
  record SRVc SRr;
  record IVVc IVr;
  record ORVc ORr;
  record POVc POr;
  record ProdVc Prodr;
  record DispatchVc Dispatchr;
  record OffhireVc Offhirer;
  record INTransferVc INTransferr;
  record WSVc WSr;
  
  ItemHistr.FileName = filename;
  ItemHistr.TransNr = transnr;

  if (ItemHistr.FileName=="WSVc") then begin
    WSr.SerNr = transnr;
    if (ReadFirstMain(WSr,1,true)) then begin
      nwn = OpenWindow("WSDClass",1,0,"","",WSr);
    end; 
  end;
  if (ItemHistr.FileName=="PUVc") then begin
    PUr.SerNr = transnr;
    if (ReadFirstMain(PUr,1,true)) then begin
      nwn = OpenWindow("PUDClass",1,0,"","",PUr);
    end; 
  end;
  if (ItemHistr.FileName=="SHVc") then begin
    SHr.SerNr = transnr;
    if (ReadFirstMain(SHr,1,true)) then begin
      nwn = OpenWindow("SHDClass",1,0,"","",SHr);
    end; 
  end;
  if (ItemHistr.FileName=="SDVc") then begin
    SDr.SerNr = transnr;
    if (ReadFirstMain(SDr,1,true)) then begin
      nwn = OpenWindow("SDDClass",1,0,"","",SDr);
    end; 
  end;
  if (ItemHistr.FileName=="StockMovVc") then begin
    StockMovr.SerNr = transnr;
    if (ReadFirstMain(StockMovr,1,true)) then begin
      nwn = OpenWindow("StockMovDClass",1,0,"","",StockMovr);
    end; 
  end;
  if (ItemHistr.FileName=="RetVc") then begin
    Retr.SerNr = transnr;
    if (ReadFirstMain(Retr,1,true)) then begin
      nwn = OpenWindow("RetDClass",1,0,"","",Retr);
    end; 
  end;
  if (ItemHistr.FileName=="RetPUVc") then begin
    RetPUr.SerNr = transnr;
    if (ReadFirstMain(RetPUr,1,true)) then begin
      nwn = OpenWindow("RetPUDClass",1,0,"","",RetPUr);
    end; 
  end;
  if (ItemHistr.FileName=="StockTakeVc") then begin
    StockTaker.SerNr = transnr;
    if (ReadFirstMain(StockTaker,1,true)) then begin
      nwn = OpenWindow("StockTakeDClass",1,0,"","",StockTaker);
    end; 
  end;
  if (ItemHistr.FileName=="SRVc") then begin
    SRr.SerNr = transnr;
    if (ReadFirstMain(SRr,1,true)) then begin
      nwn = OpenWindow("SRDClass",1,0,"","",SRr);
    end; 
  end;
  if (ItemHistr.FileName=="IVVc") then begin
    IVr.SerNr = transnr;
    if (ReadFirstMain(IVr,1,true)) then begin
      nwn = OpenWindow("IVDClass",1,0,"","",IVr);
    end; 
  end;
  if (ItemHistr.FileName=="Fut1POVc") then begin
    POr.SerNr = transnr;
    if (ReadFirstMain(POr,1,true)) then begin
      nwn = OpenWindow("PODClass",1,0,"","",POr);
    end; 
  end;
  if (ItemHistr.FileName=="Fut3ORVc") then begin
    ORr.SerNr = transnr;
    if (ReadFirstMain(ORr,1,true)) then begin
      nwn = OpenWindow("ORDClass",1,0,"","",ORr);
    end; 
  end;
  if (ItemHistr.FileName=="ProdVc") then begin
    Prodr.SerNr = transnr;
    if (ReadFirstMain(Prodr,1,true)) then begin
      nwn = OpenWindow("ProdDClass",1,0,"","",Prodr);
    end; 
  end;
  if (ItemHistr.FileName=="DispatchVc") then begin
    Dispatchr.SerNr = transnr;
    if (ReadFirstMain(Dispatchr,1,true)) then begin
      nwn = OpenWindow("DispatchDClass",1,0,"","",Dispatchr);
    end; 
  end;
  if (ItemHistr.FileName=="OffhireVc") then begin
    Offhirer.SerNr = transnr;
    if (ReadFirstMain(Offhirer,1,true)) then begin
      nwn = OpenWindow("OffhireDClass",1,0,"","",Offhirer);
    end; 
  end;
  if (ItemHistr.FileName=="INTransferVc") then begin
    INTransferr.SerNr = transnr;
    if (ReadFirstMain(INTransferr,1,true)) then begin
      nwn = OpenWindow("INTransferDClass",1,0,"","",INTransferr);
    end; 
  end;
  RETURN;
END;

global
procedure OpenRegisterFromItemHistDsm()
BEGIN
  record ItemHistVc ItemHistr;
  Integer wn;

  wn = CurWindow;
  GetWindowRecord(wn,ItemHistr);
  OpenVcFromItemHist(ItemHistr.FileName,ItemHistr.TransNr);
  RETURN;
END;
