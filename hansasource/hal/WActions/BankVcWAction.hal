function Boolean BankDClassCustCodeEFAfter(Integer wn,Boolean changedf)
begin
  record BankVc Bankr;
  record CUVc CUr;

  if (changedf) then begin
    GetWindowRecord(wn,Bankr);
    CUr.Code = Bankr.CustCode;
    if (ReadFirstMain(CUr,1,true)) then begin
      Bankr.Name = CUr.Name;
      Bankr.Address0 = CUr.InvAddr0;
      Bankr.Address1 = CUr.InvAddr1;
      Bankr.Address2 = CUr.InvAddr2;
      Bankr.Sorting = CUr.Sorting;
      Bankr.SortCode = CUr.SortCode;
      Bankr.VATNr = CUr.VATNr;
      Bankr.CountryCode = CUr.CountryCode;
      Bankr.LangCode = CUr.LangCode;
      PutWindowRecord(wn,Bankr);
    end;
  end;
  BankDClassCustCodeEFAfter = true;
  return;
end;

global
function Boolean BankDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)

begin
  Boolean res;

  switch (fieldname) begin
    case "CustCode": res = BankDClassCustCodeEFAfter(wn,changed!=0);
  end;
  BankDClassAfterEditField = res;
  return;
end;

function Boolean CreditCardDClassBankCodeEFAfter(Integer wn,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;
  record CreditCardVc CreditCardr;
  record BankVc Bankr;

  res = true;
  if (changed!=0) then begin
    GetWindowRecord(wn,CreditCardr);
    Bankr.Code = CreditCardr.BankCode;
    if (ReadFirstMain(Bankr,1,true)) then begin
      CreditCardr.BankName = Bankr.Name;
      PutWindowRecord(wn,CreditCardr);    
    end;
  end;
  CreditCardDClassBankCodeEFAfter = res;
  RETURN;
END;


function Boolean CreditCardDClassCUCodeEFAfter(Integer wn,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;
  record CreditCardVc CreditCardr;
  record CUVc CUr;

  res = true;
  if (changed!=0) then begin
    GetWindowRecord(wn,CreditCardr);
    CUr.Code = CreditCardr.CUCode;
    if (ReadFirstMain(CUr,1,true)) then begin
      CreditCardr.CUName = CUr.Name;
      PutWindowRecord(wn,CreditCardr);    
    end;
  end;
  CreditCardDClassCUCodeEFAfter = res;
  RETURN;
END;

global
function Boolean CreditCardDClassDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;

  switch (fieldname) begin
    case "BankCode": res = CreditCardDClassBankCodeEFAfter(wn,fn,rownr,changed);
    case "CUCode": res = CreditCardDClassCUCodeEFAfter(wn,fn,rownr,changed);
  end;
  CreditCardDClassDClassAfterEditField = res;
  RETURN;
END;
