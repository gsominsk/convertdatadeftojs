global
function Boolean TTRDClassActiveEditField(Integer wn,string fieldname,Integer fn,Integer wnst,Integer rownr,Integer changed)
BEGIN
  Boolean res;
  record TTRVc TTRr;
  
  res = true;
  GetWindowRecord(wn,TTRr);
  switch (fieldname) begin
   case "TRNumber": res = false;
   case "TRIntYc": res = false;
   case "TRRow": res = false;
   case "B1Val": if (TTRr.TRNumber>0) then begin res = false; end;
   case "B2Val": if (TTRr.TRNumber>0) then begin res = false; end;
  end;
  TTRDClassActiveEditField = res;
  RETURN;
END;

global
procedure OpenTRFromTTRDsm()
begin
  Integer wn,nwn;
  record TTRVc TTRr;
  record TRVc TRr;

  wn = CurWindow; 
  GetWindowRecord(wn,TTRr); 
  TRr.Number = TTRr.TRNumber;
  TRr.IntYc = TTRr.TRIntYc;
   if (ReadFirstMain(TRr,2,true)) then begin
    nwn = OpenWindow("TRDClass",1,0,"","",TRr);
  end;
  return;
end;