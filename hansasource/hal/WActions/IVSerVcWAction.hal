global 
function Boolean IVSerTClassDeleteRowTest(Integer wn,Integer rownr)
begin
  record IVSerBlock IVSerr;
  row IVSerBlock IVSerrw;
  Boolean res;
  Integer rwcnt;
  record AccBlock ARb;
  record IVVc IVr;

  res = true;
  if (rownr>-1) then begin
    BlockLoad(ARb);
    GetWindowRecord(wn,IVSerr);
    if ((rownr>0) and rownr<MatRowCnt(IVSerr)) then begin
      MatRowGet(IVSerr,rownr,IVSerrw);
      if ((ARb.ChronologyforInvNo!=0)) then begin//update
          if (IVSerrw.TSerStart!=-1) then begin
            IVr.SerNr = IVSerrw.TSerEnd;
            if (ReadLastMain(IVr,1,false)) then begin
              if (IVr.SerNr>=IVSerrw.TSerStart) then begin
                res = false;
                MessageBox(1560,"");
                goto LIVSerTClassDeleteRowTest;
              end;
            end;
          end;
      end;
    end;
  end;
LIVSerTClassDeleteRowTest:;  
  IVSerTClassDeleteRowTest = res;
  return;
end;
