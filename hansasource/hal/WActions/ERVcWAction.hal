procedure GetERDeafult(var record ERVc ERp)
BEGIN
  record CurncyCodeVc ccr;
  
  if (nonblank(ERp.CurncyCode)) then begin
    ccr.CurncyCode = ERp.CurncyCode;
    if (ReadFirstMain(ccr,1,true)) then begin
      ERp.FrRate = ccr.DefaultFrom;
      ERp.ToRate1 = ccr.DefaultTo1;
      ERp.ToRate2 = ccr.DefaultTo2;
    end;
  end;
  RETURN;
END;

global
function Boolean ERDClassCurncyCodeEFAfter(Integer wn,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;
  record ERVc ERr;

  res = true;
  if (changed!=0) then begin
    GetWindowRecord(wn,ERr);
    GetERDeafult(ERr);
    PutWindowRecord(wn,ERr);
  end;
  ERDClassCurncyCodeEFAfter = res;
  RETURN;
END;

global
function Boolean ERDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;

  switch (fieldname) begin
    case "CurncyCode": res = ERDClassCurncyCodeEFAfter(wn,fn,rownr,changed);
  end;
  ERDClassAfterEditField = res;
  RETURN;
END;
/*
global
function Boolean ERDClassActiveEditField(Integer wn,string fieldname,Integer fn,Integer wnst,Integer rownr,Integer ef)
BEGIN
  Boolean res;  
  record ERVc ERr;
  
  res = true;
  if (wnst==2) then begin//updatemode Rs_update
    GetWindowRecord(wn,ERr);
    if (ERr.Date!=CurrentDate) then begin
      MessageBox(1934,"");
    end;
  end;
  ERDClassActiveEditField = res;
  RETURN;
END;
*/

global
function Boolean ERDClassUpdateTest(Integer wn)
BEGIN
  Boolean res;

  res = true;
  MessageBox(1934,"");
  ERDClassUpdateTest = res;
  RETURN;
END;

