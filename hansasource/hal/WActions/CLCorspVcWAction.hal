
global
function Boolean CLCorspDClassActiveEditField(Integer wn,string fieldname,Integer fn,Integer wnst,Integer rownr,Integer changed)
begin
  Boolean res;
  record CLCorspVc CLCorspr,CLCorsp2r;
  

  res = true;
  GetWindowRecord(wn,CLCorspr);
  switch (wnst) begin
    case Rs_update:    
      GetPrevWindowRecord(wn,CLCorsp2r);
      if (CLCorsp2r.Closed!=0) then begin 
        res = false;
      end;
    otherwise  
      if (CLCorspr.Closed!=0) then begin 
        res = false;
      end;
  end;
  CLCorspDClassActiveEditField = res;
  return;
end;