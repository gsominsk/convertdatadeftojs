external procedure BFSumup(var record BFVc);

function Boolean BFDClassBFCodeEFAfter(Integer wn,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;
  record BFVc BFr;

  res = true;
  if (changed!=0) then begin
    GetWindowRecord(wn,BFr);
    BFSumup(BFr);
    PutWindowRecord(wn,BFr);    
  end;
  BFDClassBFCodeEFAfter = res;
  RETURN;
END;

function Boolean BFDClasscrvvalEFAfter(Integer wn,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;
  record BFVc BFr;

  res = true;
  if (changed!=0) then begin
    GetWindowRecord(wn,BFr);
    BFSumup(BFr);
    PutWindowRecord(wn,BFr);    
  end;
  BFDClasscrvvalEFAfter = res;
  RETURN;
END;

global
function Boolean BFDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;

  switch (fieldname) begin
    case "BFCode": res = BFDClassBFCodeEFAfter(wn,fn,rownr,changed);
    case "crvval": res = BFDClasscrvvalEFAfter(wn,fn,rownr,changed);
  end;
  BFDClassAfterEditField = res;
  RETURN;
END;
