global
function Boolean SubscriptionDClassOpenRecord(Integer wn,string fieldname,Integer fn,Integer rownr)
begin
  Boolean res;
  record SubscriptionVc Subr;
  record CUVc CUr;
  record SubItemVc SIr;
  Integer nwn;
  
  GetWindowRecord(wn,Subr);  
  switch (fieldname) begin
    case "CUCode":
      CUr.Code = Subr.CUCode;
      if (ReadFirstMain(CUr,1,true)) then begin
        nwn = OpenWindow("CUDClass",0,0,"","",CUr);
      end;
    case "SubIN":
      SIr.SerNr = Subr.SubIN;
      if (ReadFirstMain(SIr,1,true)) then begin
        nwn = OpenWindow("SubItemDClass",0,0,"","",SIr);
      end;
  end;
  SubscriptionDClassOpenRecord = res;
  return;
end;

global
function Boolean SubscriptionTransDClassOpenRecord(Integer wn,string fieldname,Integer fn,Integer rownr)
begin
  Boolean res;
  record SubscriptionTransVc STr;
  row SubscriptionTransVc STrw;
  record CUVc CUr;
  record IVVc IVr;
  record SubscriptionVc Subr;
  Integer nwn;
  
  GetWindowRecord(wn,STr);  
  switch (fieldname) begin
    case "CUCode":
      CUr.Code = STr.CUCode;
      if (ReadFirstMain(CUr,1,true)) then begin
        nwn = OpenWindow("CUDClass",0,0,"","",CUr);
      end;
    case "InvoiceNo":
      IVr.SerNr = STr.InvoiceNo;
      if (ReadFirstMain(IVr,1,true)) then begin
        nwn = OpenWindow("IVDClass",0,0,"","",IVr);
      end;
    case "Subscription":
      if (rownr>=0) then begin
        MatRowGet(STr,rownr,STrw);
        Subr.SerNr = STrw.Subscription;
        if (ReadFirstMain(Subr,1,true)) then begin
          nwn = OpenWindow("SubscriptionDClass",0,0,"","",Subr);
        end;
      end;
  end;
  SubscriptionTransDClassOpenRecord = res;
  return;
end;
