procedure MinPerLocDClassSpecPasteNameItemCode(Integer wn,var string psname)
begin
  record MinPerLocVc MinPerLocr;
  Integer rownr;

  rownr = WindowActiveRow(wn);
  DeselectWindow(wn,false);//to get VARINSClass working WindowDeactivateField
  GetWindowRecord(wn,MinPerLocr);
  WindowFieldGoto(wn,MinPerLocr,rownr,"ItemCode",false);
  return;
end;

global
function string 40 MinPerLocDClassSpecPasteName(Integer wn,string defpsname)
begin
  string 40 psname;

  psname = defpsname;
  switch (WindowActiveField(wn)) begin
    case "ItemCode": MinPerLocDClassSpecPasteNameItemCode(wn,psname);
  end;
  MinPerLocDClassSpecPasteName = psname;
  return;
end;
