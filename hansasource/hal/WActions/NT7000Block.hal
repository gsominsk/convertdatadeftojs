external function Boolean ForkLiftSystemStatus(string);

global
function Boolean NT7000TClassActiveEditField(Integer wn,string fieldname,Integer fn,Integer wnst,Integer rownr,Integer changed)
BEGIN
  Boolean res;
  record NT7000ConnVc NTCr;

  res = true;
  GetWindowRecord(wn,NTCr);
  switch (fieldname) begin
    case "NT7000ServerIP": res = ForkLiftSystemStatus(NTCr.Location);
    case "NT7000ServerPort": res = ForkLiftSystemStatus(NTCr.Location);
  end;
  if (res==false) then begin
    MessageBox(1728,"");
  end;  
  NT7000TClassActiveEditField = res;
  RETURN;
END;

