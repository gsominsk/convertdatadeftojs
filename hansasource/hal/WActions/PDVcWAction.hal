
global
function Boolean PDDClassPDTypeButtonAction(Integer wn,Integer value)
begin
  Boolean res;
  record PDVc PDr,PD2r;

  res = true;
  GetWindowRecord(wn,PDr);
  switch (WindowState(wn)) begin
    case Rs_update:
      GetPrevWindowRecord(wn,PD2r);
      if (PD2r.Closed!=0) then begin
        res = false;
      end;
    otherwise
      if (PDr.Closed!=0) then begin
        res = false;
      end;
  end;

  PDDClassPDTypeButtonAction = res;
  return;
end;

global
function Boolean PDDClassActiveEditField(Integer wn,string fieldname,Integer fn,Integer wnst,Integer rownr,Integer changed)
begin
  Boolean res;
  record PDVc PDr,PD2r;

  res = true;
  GetWindowRecord(wn,PDr);
  switch (wnst) begin
    case Rs_update:
      GetPrevWindowRecord(wn,PD2r);
      if (PD2r.Closed!=0) then begin
        res = false;
      end;
    otherwise
      if (PDr.Closed!=0) then begin
        res = false;
      end;
  end;
  PDDClassActiveEditField = res;
  return;
end;