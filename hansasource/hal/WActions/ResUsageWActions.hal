external function Boolean ReadFirstItem(string,var record INVc,Boolean,Boolean);

function Boolean ResUsageDClassArtCodeEFAfter(Integer wn,Integer fn,Integer rownr,Integer changedf)
begin
  record ResUsageVc ResUsager;
  row ResUsageVc ResUsagerw;
  integer rwcnt,i;
  record INVc INr;

  if (changedf!=0) then begin
    GetWindowRecord(wn,ResUsager);
    MatRowGet(ResUsager,rownr,ResUsagerw);
    if (nonblank(ResUsagerw.ArtCode)) then begin 
      if (ReadFirstItem(ResUsagerw.ArtCode,INr,true,true)) then begin
        ResUsagerw.Description = INr.Name;
        MatRowPut(ResUsager,rownr,ResUsagerw);
      end;
    end;
    PutWindowRecord(wn,ResUsager);
  end;
  ResUsageDClassArtCodeEFAfter = true;
  return;
end;

global
function Boolean ResUsageDClassAfterEditField(Integer wn,string fieldname,Integer fn,Integer rownr,Integer changed)
begin
  Boolean res;
  
  switch (fieldname) begin
    case "ArtCode": res = ResUsageDClassArtCodeEFAfter(wn,fn,rownr,changed);
  end;
  ResUsageDClassAfterEditField = res;
end;