

function Boolean StdOperationDClassMaterialEFAfter(Integer wn,Integer rownr,Integer changed)
BEGIN
  record MaterialVc Materialr;
  record StdOperationVc StdOperationr;
  row StdOperationVc StdOperationrw;
  Boolean res;

  res = true;
  if ((changed!=0) and (rownr>=0)) then begin
    GetWindowRecord(wn,StdOperationr);
    MatRowGet(StdOperationr,rownr,StdOperationrw);
    Materialr.Code = StdOperationrw.Material;
    if (ReadFirstMain(Materialr,1,true)) then begin
      StdOperationrw.Comment = Materialr.Comment;
//      StdOperationrw.ResType = "";
//      StdOperationrw.Resource = "";
      MatRowPut(StdOperationr,rownr,StdOperationrw);
      PutWindowRecord(wn,StdOperationr);
    end;
  end;
  StdOperationDClassMaterialEFAfter = res;
  RETURN;
END;
/*
function Boolean StdOperationDClassResTypeEFAfter(Integer wn,Integer rownr,Integer changed)
BEGIN
  record ResTypeVc ResTyper;
  record StdOperationVc StdOperationr;
  row StdOperationVc StdOperationrw;
  Boolean res;

  res = true;
  if ((changed!=0) and (rownr>=0)) then begin
    GetWindowRecord(wn,StdOperationr);
    MatRowGet(StdOperationr,rownr,StdOperationrw);
    ResTyper.Code = StdOperationrw.ResType;
    if (ReadFirstMain(ResTyper,1,true)) then begin
      StdOperationrw.Comment = ResTyper.Comment;
      StdOperationrw.Material = "";
      MatRowPut(StdOperationr,rownr,StdOperationrw);
      PutWindowRecord(wn,StdOperationr);
    end;
  end;
  StdOperationDClassResTypeEFAfter = res;
  RETURN;
END;

function Boolean StdOperationDClassResourceEFAfter(Integer wn,Integer rownr,Integer changed)
BEGIN
  record ResVc Resr;
  record StdOperationVc StdOperationr;
  row StdOperationVc StdOperationrw;
  Boolean res;

  res = true;
  if ((changed!=0) and (rownr>=0)) then begin
    GetWindowRecord(wn,StdOperationr);
    MatRowGet(StdOperationr,rownr,StdOperationrw);
    Resr.Code = StdOperationrw.Resource;
    if (ReadFirstMain(Resr,1,true)) then begin
      StdOperationrw.Comment = Resr.Name;
      StdOperationrw.Material = "";
      MatRowPut(StdOperationr,rownr,StdOperationrw);
      PutWindowRecord(wn,StdOperationr);
    end;
  end;
  StdOperationDClassResourceEFAfter = res;
  RETURN;
END;
*/

global
function Boolean StdOperationDClassAfterEditField(Integer wn,string fieldname,Integer fn,Integer rownr,Integer changed)
BEGIN
  Boolean res;

  switch (fieldname) begin
    case "Material": res = StdOperationDClassMaterialEFAfter(wn,rownr,changed);
//    case "ResType": res = StdOperationDClassResTypeEFAfter(wn,rownr,changed);
//    case "Resource": res = StdOperationDClassResourceEFAfter(wn,rownr,changed);
  end;
  StdOperationDClassAfterEditField = res;
  RETURN;
END;

