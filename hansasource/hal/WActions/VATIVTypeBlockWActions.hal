global 
function Boolean VATIVTypeTClassDeleteRowTest(Integer wn,Integer rownr)
begin
  record VATIVTypeBlock VATIVTypeb;
  row VATIVTypeBlock VATIVTypebrw;
  Boolean res;
  record VATIVVc VATIVr;

  res = true;
  if (rownr>-1) then begin
    GetWindowRecord(wn,VATIVTypeb);
    MatRowGet(VATIVTypeb,rownr,VATIVTypebrw);
    if (nonblank(VATIVTypebrw.Code)) then begin
      VATIVr.VATIVType = VATIVTypebrw.Code;
      res = not ReadFirstKey("VATIVType",VATIVr,1,true);
      if (res==false) then begin
        MessageBox(22093,"");
      end;
    end;
  end;
  VATIVTypeTClassDeleteRowTest = res;
  return;
end;

global
function Boolean VATIVTypeTClassActiveEditField(Integer wn,string fieldname,Integer fn,Integer wnst,Integer rownr,Integer changed)
begin
  Boolean res;
  record VATIVTypeBlock VATIVTypeb;
  row VATIVTypeBlock VATIVTypebrw;
  record VATIVVc VATIVr;
  
  res = true;
  GetWindowRecord(wn,VATIVTypeb);
  switch (fieldname) begin
    case "Code": 
      MatRowGet(VATIVTypeb,rownr,VATIVTypebrw);
      if (nonblank(VATIVTypebrw.Code)) then begin
        VATIVr.VATIVType = VATIVTypebrw.Code;
        res = not ReadFirstKey("VATIVType",VATIVr,1,true);
        if (res==false) then begin
          MessageBox(22093,"");
        end;
      end;
  end;
  VATIVTypeTClassActiveEditField = res;
  return;
end;
