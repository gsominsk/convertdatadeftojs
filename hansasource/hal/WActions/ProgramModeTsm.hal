remote updating procedure ServerLockCompany(Integer,Integer,string);
remote updating procedure ServerUnlockCompany(Integer);
remote procedure RemoteSendSystemMessage(string,string,LongInt,Integer,Integer,Integer);
remote function Integer ServerStartDBCopy();
external procedure GetCurUser(var record UserVc);

global
updating procedure LockCurrentCompany()
BEGIN
  ServerLockCompany(CurrentCompany,1,CurrentUser);
  MessageBox(2196, "");
  RETURN;
END;

global
updating procedure UnlockCurrentCompany()
BEGIN
  ServerUnlockCompany(CurrentCompany);
  MessageBox(2198, "");
  RETURN;
END;

global
procedure SendSysMsgTsm()
BEGIN
  Integer wn,nwn;
  record RcVc RepSpec;
  record UserVc USr;
  
  GetCurUser(USr);
  wn = CurWindow;
  RecordNew(RepSpec);  
  RepSpec.f1 = USetStr(1380);
  RepSpec.f2 = USr.Name;
  RepSpec.flags[1] = 0;
  RepSpec.flags[2] = 0;
  nwn = OpenWindow("NewSysMessClass",0,wn,"","",RepSpec);
  RETURN;
END;

global
function Boolean NewSysMessClassOnOKWindow(Integer wn)
begin
  Integer mwn;
  record RcVc RepSpec;
  
  GetWindowRecord(wn,RepSpec);
  RemoteSendSystemMessage(RepSpec.f1,RepSpec.f2,RepSpec.long1,RepSpec.flags[1],RepSpec.flags[2],RepSpec.flags[3]);
  CloseWindow(wn);
  NewSysMessClassOnOKWindow = true;
  RETURN;
END;

global
procedure StartDatabaseCopyDsm()
BEGIN
  Integer res;
  
  res = ServerStartDBCopy;
  switch (res) begin
    case 0: MessageBox(20120,"");
    case 1: MessageBox(20121,"");
    case 2: MessageBox(20122,"");
  end;
  RETURN;
END;

