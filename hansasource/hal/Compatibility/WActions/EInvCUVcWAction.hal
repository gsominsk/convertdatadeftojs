global
function Boolean EInvCUDClassRcvInvoicePrefButtonAction(Integer wn,Integer value)
begin
  DeselectWindow(wn,false);
  SelectWindow(wn);
  EInvCUDClassRcvInvoicePrefButtonAction = true;
  return;
end;

global
function Boolean EInvCUDClassActiveEditField(Integer wn,string fieldname,Integer fn,Integer wnst,Integer rownr,Integer changed)
begin
  Boolean res;
  record EInvCUVc EInvCUr;
  
  res = true;
  switch (fieldname) begin
    case "RcvToCompanyCode":
      GetWindowRecord(wn,EInvCUr);
      if (EInvCUr.RcvInvoicePref!=kEInvoiceRcvPreferenceInternal) then begin
        res = false;
      end;
  end;
  
  EInvCUDClassActiveEditField = res;
end;

global
function Boolean EInvCUDClassAfterEditField(Integer wn,string fieldname,Integer fn,Integer rownr,Integer changed)
begin
  Boolean res;
  record CUVc CUr;
  record EInvCUVc EInvCUr;
  
  switch (fieldname) begin
    case "CustCode": 
      if (changed!=0) then begin
        GetWindowRecord(wn,EInvCUr);
        DeselectWindow(wn,false);
        CUr.Code = EInvCUr.CustCode;
        if (ReadFirstMain(CUr,1,true)) then begin
          EInvCUr.Name = CUr.Name;
        end;
        PutWindowRecord(wn,EInvCUr);
      end;
  end;
  EInvCUDClassAfterEditField = res;
  return;
end;
