//tools
external function string 255 removenextnode(var string);
external function string 255 CleanPath(string);
external function string 10 ToolWebNGGetCountry();
external procedure UpdateWebCountry(string);
external function boolean LoginState();
external function string 255 GetLinkToStruct(LongInt,boolean);
external function string 255 FormatLink(string,string,boolean,boolean);
external function string 255 FormatSimpleLinkWithArg(string,string,boolean);
external function string 10 CurrentWebLang();
external procedure RequireSessionState();
//pages
external procedure ShowErrorPage(string);
external procedure ShowWebAppPageStart(record WebNGPageVc,string);
external procedure ShowWebAppPageEnd(record WebNGPageVc);
//translation
external function string 255 ToolWebNGTranslateText(integer);
//webng
external procedure RedirectToStructLink(string);
external procedure RedirectToStartPage();
external procedure RedirectToURL(string);
//apps
external procedure ShopCatalogApp(record WebNGStructVc,string);
external procedure ShopProductInfoApp(record WebNGStructVc,string);
external procedure ShopBasketApp(record WebNGStructVc,string);
external procedure ShopConfigureProductApp(record WebNGStructVc,string);
external procedure ShopAfterAddingToBasketApp(record WebNGStructVc,string);
external procedure ShopCheckoutApp(record WebNGStructVc,string);
external procedure ShopPaymentApp(record WebNGStructVc,string);
external procedure ProductImageDownloadApp(string);

global
procedure ASPApp(record WebNGStructVc WSr,string path)
begin
  record WebNGPageVc WPr;
  record LocalCloudServerVc LMSr;
  
  WPr.Code = WSr.WebPage;
  if (nonblank(WPr.Code)) then begin
    if (ReadFirstMain(WPr,1,true)) then begin end;
  end;
  
  ShowWebAppPageStart(WPr,"");
  
  WebOutString("<ul>");
  
  while (LoopMain(LMSr,1,true)) begin
    WebOutString("<li>");
    WebOutString("<div>" & LMSr.UUID & "</div>");
    WebOutString("<div>" & LMSr.WantedStatus & "</div>");
    WebOutString("<div>" & LMSr.CurrentStatus & "</div>");
    WebOutString("</li>");
  end;
  
  WebOutString("</ul>");
  
  ShowWebAppPageEnd(WPr);
  return;
end;