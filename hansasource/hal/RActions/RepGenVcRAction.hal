external procedure PasteFromSysList(Integer ,Integer);

global
function LongInt RepGenVcRecordDefaults(var record RepGenVc RepGenr,record RepGenVc RepGen2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;
  row RepGenVc repgenrw;
      
  RepGenr.Code = "";
  RepGenr.Media = mtScreen;
  RepGenr.Width = 600;
  RepGenr.SpecWinWidth = 500;
  RepGenVcRecordDefaults = 0;
  
  repgenrw.stp = k4RepGenRowTypeFormDef;
  repgenrw.setno = -1;
  repgenrw.Type = k4RepGenReportHeader;
  MatRowPut(RepGenr,0,repgenrw);
  
  repgenrw.stp = k4RepGenRowTypeFormDef;
  repgenrw.setno = -1;
  repgenrw.Type = k4RepGenReportFooter;
  MatRowPut(RepGenr,1,repgenrw);
  RETURN;
END;

global
function LongInt RepGenVcRecordDuplicate(var record RepGenVc RepGenr,record RepGenVc RepGen2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;

  RepGenr.Code = "";
  RepGenVcRecordDuplicate = res; 
  RETURN;
END;

global
function LongInt RepGenVcRecordSave(var record RepGenVc RepGenr,record RepGenVc RepGen2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;

//  RepGenr.SerNr = NextSerNr("RepGenVc",CurrentDate,-1,false,"");
  RepGenVcRecordSave = res; 
  RETURN;
END;

global
updating function LongInt RepGenVcRecordCheck(record RepGenVc RepGenr,record RepGenVc RepGen2r,LongInt stat,LongInt check)
BEGIN
  LongInt res;
  Boolean testf;
  Integer insertmode,updatemode;
  
  res = 0;
  insertmode = 1;//Rs_insert
  updatemode = 2;//Rs_update
  if (RepGenr.Code=="") then begin
    RecordCheckError(1270,"",-1,"Code");      
    res = -1;
    goto LRepGenVcRecordCheck;
  end;
LRepGenVcRecordCheck:;  
  RepGenVcRecordCheck = res;
  RETURN;
END;

global
procedure PasteSpecSL()
BEGIN
  Integer wn,mwn,wn2;
  record INVc CUr;
  record RcVc rp;

  wn = CurWindow;
  if (GetWindowClass(wn)=="RepGenConditionVClass") then begin 
    WindowFieldGoto(wn,rp,-1,"f6",true);
  end;
  if (GetWindowClass(wn)=="RepGenInputVClass") then begin 
    WindowFieldGoto(wn,rp,-1,"f5",true);
  end;
//  mwn = MotherWindow(wn);
//  CloseWindow(wn);      
  wn2 = OpenWindow("PasteSpecSLSClass",0,wn,"","",CUr);
  return;
END;

global
function Boolean PasteSpecSLSClassOnOKWindow(Integer wn)
begin
  PasteFromSysList(wn,0);
  PasteSpecSLSClassOnOKWindow = false;
  return;
end;

