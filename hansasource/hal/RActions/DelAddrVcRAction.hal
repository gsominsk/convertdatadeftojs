external function Boolean IsVATCodeDefined(string);
/*
global
function LongInt DelAddrVcRecordDefaults(var record DelAddrVc DAr,record DelAddrVc DelAddr2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  string 255 tstr;
  record RentInvoiceBlock RIr;
  
  BlockLoad(RIr);
  DAr.InvoiceBase = RIr.InvoiceBase;
  DAr.IncludeOriginalItem = RIr.IncludeOriginalItem;
  DAr.IncludePeriod = RIr.IncludePeriod;
  DAr.AddEmptyLine = RIr.AddEmptyLine;
  DAr.UseAsQty = RIr.UseAsQty;
  DAr.GroupInvoice = RIr.GroupInvoice;
  DAr.IncludeSite = RIr.IncludeSite;
  DAr.InclCustOrdNr = RIr.InclCustOrdNr;
  DAr.InclRentResNo = RIr.InclRentResNo;
  
  DelAddrVcRecordDefaults = res; 
  return;
end;
*/

global
function LongInt DelAddrVcRecordCheck(var record DelAddrVc DAr,record DelAddrVc DelAddr2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  record CUVc CUr;
  record RegionVc Regr;
  record TaxTemplateVc TTr;

  res = 0;
  if (blank(DAr.DelCode)) then begin
    RecordCheckError(1058,"",-1,"DelCode");
    res = -1;
    goto LDelAddrVcRecordCheck;
  end;  
  if (nonblank(DAr.CustCode)) then begin
    CUr.Code = DAr.CustCode;
    if (ReadFirstMain(CUr,1,true)==false) then begin
      RecordCheckError(1120,"",-1,"CustCode");      
      res = -1; 
      goto LDelAddrVcRecordCheck;
    end;
  end;  
  if (nonblank(DAr.Region)) then begin
    Regr.Code = DAr.Region;
    if (ReadFirstMain(Regr,1,true)==false) then begin
      RecordCheckError(1120,"",-1,"Region");      
      res = -1; 
      goto LDelAddrVcRecordCheck;
    end;
  end;  
  if (nonblank(DAr.TaxTemplateCode)) then begin
    TTr.Code = DAr.TaxTemplateCode;
    if (ReadFirstMain(TTr,1,true)==false) then begin
      RecordCheckError(1120,"",-1,"TaxTemplateCode");      
      res = -1; 
      goto LDelAddrVcRecordCheck;
    end;
  end;
  if (nonblank(DAr.VATCode)) then begin
    if  (IsVATCodeDefined(DAr.VATCode)==false) then begin
      RecordCheckError(1120,"",-1,"VATCode");      
      res = -1; 
      goto LDelAddrVcRecordCheck;
    end;
  end;  

LDelAddrVcRecordCheck:; 
  DelAddrVcRecordCheck = res;
  return;
end;
