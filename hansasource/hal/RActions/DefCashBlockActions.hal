external function Boolean GetPD(var record PDVc);
external function Boolean VATCodeExists(string);
external function Boolean GetPM(string,var string,var string);

global
function LongInt DefCashBlockCheck(var record DefCashBlock DCb,record DefCashBlock DC2b,LongInt stat,LongInt long4)
begin
  LongInt res;
  string 255 tstr,tstr2;
  record PDVc PDr;

  res = 0; 
  if (nonblank(DCb.DefCashPayMode)) then begin
    if (GetPM(DCb.DefCashPayMode,tstr,tstr2)==false) then begin
      RecordCheckError(1101,"",-1,"DefCashPayMode");      
      res = -1;
      goto LDefCashBlockCheck;
    end;
  end;
  if (nonblank(DCb.DefCCPayMode)) then begin
    if (GetPM(DCb.DefCCPayMode,tstr,tstr2)==false) then begin
      RecordCheckError(1101,"",-1,"DefCCPayMode");      
      res = -1;
      goto LDefCashBlockCheck;
    end;
  end;
  if (nonblank(DCb.DefGCSPayMode)) then begin
    if (GetPM(DCb.DefGCSPayMode,tstr,tstr2)==false) then begin
      RecordCheckError(1101,"",-1,"DefGCSPayMode");      
      res = -1;
      goto LDefCashBlockCheck;
    end;
  end;
  if (nonblank(DCb.DefGCRPayMode)) then begin
    if (GetPM(DCb.DefGCRPayMode,tstr,tstr2)==false) then begin
      RecordCheckError(1101,"",-1,"DefGCRPayMode");      
      res = -1;
      goto LDefCashBlockCheck;
    end;
  end;
  if (nonblank(DCb.DefGCSVATCode)) then begin
    if (VATCodeExists(DCb.DefGCSVATCode)==false) then begin
      RecordCheckError(1951,"",-1,"DefGCSVATCode");      
      res = -1;
      goto LDefCashBlockCheck;
    end;
  end;
  if (nonblank(DCb.DefGCRVATCode)) then begin
    if (VATCodeExists(DCb.DefGCRVATCode)==false) then begin
      RecordCheckError(1951,"",-1,"DefGCRVATCode");      
      res = -1;
      goto LDefCashBlockCheck;
    end;
  end;
  if (nonblank(DCb.DefCashPayDeal)) then begin
    PDr.Code = DCb.DefCashPayDeal;
    if (GetPD(PDr)==false) then begin  
      RecordCheckError(1256,"",-1,"DefCashPayDeal");      
      res = -1;
      goto LDefCashBlockCheck;
    end;
  end;
LDefCashBlockCheck:;
  DefCashBlockCheck = res;
  return;
end;
