global
function LongInt TTRFieldBlockCheck(record TTRFieldBlock TTRFb,record TTRFieldBlock TTRF2b,LongInt stat,LongInt long4)
BEGIN
  LongInt res;
  row TTRFieldBlock TTRFrw;
  row TTRFieldBlock TTRF2rw;
  Integer i,j,rwcnt;

  res = 0;
  rwcnt = MatRowCnt(TTRFb);
  for (i=0;i<rwcnt;i=i+1) begin
    MatRowGet(TTRFb,i,TTRFrw);
    if (blank(TTRFrw.Code)) then begin
      RecordCheckError(1058,"",i,"Code");      
      res = -1; 
      goto LTTRFieldBlockCheck;        
    end;
    if (TTRFrw.RowType<=0) then begin
      RecordCheckError(1058,"",i,"RowType");      
      res = -1; 
      goto LTTRFieldBlockCheck;        
    end;
    for (j=i+1;j<rwcnt;j=j+1) begin
      MatRowGet(TTRFb,j,TTRF2rw);
      if (TTRF2rw.Code==TTRFrw.Code) then begin
        RecordCheckError(1547,": " & TTRF2rw.Code,i,"Code");      
        res = -1; 
        goto LTTRFieldBlockCheck;        
      end;
      if (TTRF2rw.RowType==TTRFrw.RowType) then begin
        RecordCheckError(1547,"",i,"RowType");      
        res = -1; 
        goto LTTRFieldBlockCheck;
      end;
    end;
  end;
LTTRFieldBlockCheck:; 
  TTRFieldBlockCheck = res;
  RETURN;
END;
