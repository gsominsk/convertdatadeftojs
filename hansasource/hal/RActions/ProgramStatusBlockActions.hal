global
function LongInt ProgramStatusBlockCheck(var record ProgramStatusBlock PSb,record ProgramStatusBlock PS2b,LongInt stat,LongInt long4)
begin
  LongInt res;
  string 255 errstr;

  if (PSb.BeepOnMessage!=0 and PSb.SingleUserServer!=0) then begin
    RecordCheckError(27333,"",-1,"");
    res = -1;
    goto LProgramStatusBlockCheck;
  end;

LProgramStatusBlockCheck:;
  return;
end;

global
updating function LongInt ProgramStatusBlockImporting(var record ProgramStatusBlock PSb,record ProgramStatusBlock oldPSb,LongInt stat,LongInt long4)
begin
  LongInt res;
  record InternetEnabOldBlock IEOb;

  res = 0;
  if (IsStandardProduct) then begin
    BlockLoad(IEOb);
    IEOb.ProgramName = PSb.ProgramName;
    BlockStore(IEOb);
  end;
  ProgramStatusBlockImporting = res;
  return;
end;
