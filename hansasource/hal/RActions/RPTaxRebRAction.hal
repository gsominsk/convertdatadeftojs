global
function LongInt RPTaxRebVcRecordCheck(record RPTaxRebVc RPTaxRebr,record RPTaxRebVc RPTaxReb2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;
  record CUVc CUr;
  record RPTaxVc RPTaxr;
      
  res = 0;
  if (blank(RPTaxRebr.Code)) then begin
    RecordCheckError(1120,"",-1,"Code");      
    res = -1; 
    goto LRPTaxRebVcRecordCheck;
  end;  
  RPTaxr.Code = RPTaxRebr.Code;
  if (ReadFirstMain(RPTaxr,1,true)==false) then begin
    RecordCheckError(1120," " & RPTaxRebr.Code,-1,"Code");      
    res = -1; 
    goto LRPTaxRebVcRecordCheck;
  end;
  CUr.Code = RPTaxRebr.CustCode;
  if (ReadFirstMain(CUr,1,true)==false) then begin
    RecordCheckError(1120," " & RPTaxRebr.CustCode,-1,"CustCode");      
    res = -1; 
    goto LRPTaxRebVcRecordCheck;
  end;
LRPTaxRebVcRecordCheck:;  
  RPTaxRebVcRecordCheck = res;
  RETURN;
END;  
