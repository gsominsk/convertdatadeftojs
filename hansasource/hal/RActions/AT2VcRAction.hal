global
function LongInt AT2VcRecordInIndex(record AT2Vc AT2r,string indexname)
BEGIN
  LongInt res;
  
  res = 1;
  if (AT2r.Inactive!=0) then begin 
    if (indexname=="ActCode")  then begin res = 0; end;
    if (indexname=="ActAT2Class")  then begin res = 0; end;
    if (indexname=="ActDescription")  then begin res = 0; end;
    if (indexname=="ActAT2Group")  then begin res = 0; end;
  end;
  AT2VcRecordInIndex = res;
  RETURN;
END;

global
function LongInt AT2VcRecordCheck(var record AT2Vc AT2r,record AT2Vc AT22r,LongInt stat,LongInt long4)
begin
  LongInt res;

  if (blank(AT2r.Code)) then begin
    RecordCheckError(1058,"",-1,"Code");      
    res = -1; 
    goto LAT2VcRecordCheck;
  end;
LAT2VcRecordCheck:;  
  return;
end;