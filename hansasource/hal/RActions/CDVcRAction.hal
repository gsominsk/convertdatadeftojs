external procedure GetFullCurncyRate (var string,Date,var val,var val,var val,var val,var val);
external procedure B1ToB2Val(val,val,val,var val);

global
function LongInt CDVcRecordImport(var record CDVc CDr,record CDVc CD2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;
  Boolean gBase1ToBase2;
  record ConvMasterBlock cvm;
  val t,fr,to1,to2,br1,br2;
  string 5 crncycode;
  Integer i,rwcnt;
  row CDVc CDrw;
      
  BlockLoad(cvm);
  if (cvm.Base1ToBase2Flag!=0) then begin gBase1ToBase2 = true; end;
  if (gBase1ToBase2) then begin
    GetFullCurncyRate(crncycode,CurrentDate,fr,to1,to2,br1,br2);
    rwcnt = MatRowCnt(CDr);
    for (i=0;i<rwcnt;i=i+1) begin
      MatRowGet(CDr,i,CDrw);
      B1ToB2Val(CDrw.Price,br1,br2,t);
      CDrw.Price = t;
      MatRowPut(CDr,i,CDrw);
    end;
  end;
  CDVcRecordImport = res;
  RETURN;
END;
