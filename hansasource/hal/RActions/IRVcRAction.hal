external procedure GetFullCurncyRate (var string,Date,var val,var val,var val,var val,var val);
external procedure B1ToB2Val(val,val,val,var val);

global
function LongInt IRVcRecordImport(var record IRVc IRr,record IRVc IR2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;
  val t,fr,to1,to2,br1,br2;
  string 5 curncy;
  Boolean gBase1ToBase2;
  record ConvMasterBlock cvm;
  row IRVc irrw;
  Integer i,rwcnt;
      
  BlockLoad(cvm);
  if (cvm.Base1ToBase2Flag!=0) then begin gBase1ToBase2 = true; end;
  if (gBase1ToBase2) then begin
    GetFullCurncyRate(curncy,IRr.startDate,fr,to1,to2,br1,br2);
    rwcnt = MatRowCnt(IRr);
    for (i=0;i<rwcnt;i=i+1) begin
      MatRowGet(IRr,i,irrw);
      B1ToB2Val(irrw.limit,br1,br2,t);
      irrw.limit = t;
      MatRowPut(IRr,i,irrw);
    end;
  end;
  IRVcRecordImport = res;
  RETURN;
END;
