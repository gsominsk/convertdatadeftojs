external function Boolean InterNetAddrTest(string);

global
function LongInt ContactRelVcRecordDefaults(var record ContactRelVc ContactRelr,record ContactRelVc ContactRel2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  
  ContactRelr.Invalid = 0;
  ContactRelVcRecordDefaults = res; 
  return;
end;

global
function LongInt ContactRelVcRecordDuplicate(var record ContactRelVc ContactRelr,record ContactRelVc ContactRel2r,LongInt stat,LongInt long4)
begin
  LongInt res;

  ContactRelr.Invalid = 0;
  ContactRelVcRecordDuplicate = res; 
  return;
end;

global 
function Boolean ContactRelVcRecordShouldBeSynchronised(record ContactRelVc ContactRelr,string tagstr)
begin
  Boolean res;
  
  res = true;
  ContactRelVcRecordShouldBeSynchronised = res;
  return;
end;

global 
function Boolean ContactRelVcRecordSync(record ContactRelVc ContactRelr,string tagstr)
begin
  Boolean res;
  
  res = true;
  ContactRelVcRecordSync = res;
  return;
end;

global
function LongInt ContactRelVcRecordInIndex(record ContactRelVc ContactRelr,string indexname)
begin
  LongInt res;
  
  res = 1;
  if (ContactRelr.Invalid!=0) then begin 
    if (indexname=="ActCustCode") then begin res = 0; end;
    if (indexname=="ActContactCode") then begin res = 0; end;
    if (indexname=="ActCustName") then begin res = 0; end;
    if (indexname=="ActContactName") then begin res = 0; end;
    if (indexname=="ActCustContactCode") then begin res = 0; end;
    if (indexname=="ActCustContactName") then begin res = 0; end;
    if (indexname=="ActContact") then begin res = 0; end;
  end;
  ContactRelVcRecordInIndex = res;
  return;
end;

global
function LongInt ContactRelVcRecordCheck(record ContactRelVc CRr,record ContactRelVc CR2r,LongInt stat,LongInt long4)
begin
  LongInt res;
      
  res = 0;
  if (nonblankdate(CRr.EndDate)) then begin
    if (CRr.StartDate>CRr.EndDate) then begin
      RecordCheckError(32702,"",-1,"StartDate");      
      res = -1; 
      goto LContactRelVcRecordCheck;
    end;
  end;
  if (nonblank(CRr.ContacteMail)) then begin
    if (InterNetAddrTest(CRr.ContacteMail)==false) then begin
      RecordCheckError(30229,"",-1,"ContacteMail"); 
      res = -1; 
      goto LContactRelVcRecordCheck;
    end;
  end;
LContactRelVcRecordCheck:;  
  ContactRelVcRecordCheck = res;
  return;
end;  
