remote function string 255 AddBranchObjectToObjectList(string,string);
remote updating procedure SMSWhenQT(record QTVc,Integer);

global
function LongInt QTVcRecordDefaultsClient(LongInt wn,var record QTVc QTr,record QTVc QT2r,LongInt long3,LongInt long4)
begin
  LongInt res;
  record LocalMachineBlock LMb;

  BlockLoad(LMb);  
  if (blank(QTr.Location)) then begin
    QTr.Location = LMb.DefLocation;
  end;
  QTr.BranchID = LMb.BranchID;
  QTr.Objects = AddBranchObjectToObjectList(LMb.BranchID,QTr.Objects);
  if (blank(QTr.PriceList)) then begin
    QTr.PriceList = LMb.PLCode;
  end;
  QTVcRecordDefaultsClient = res;
  return;
end;

global
function LongInt QTVcRecordDuplicateClient(LongInt wn,var record QTVc QTr,record QTVc QT2r,LongInt long3,LongInt long4)
begin
  LongInt res;
  record LocalMachineBlock LMb;

  BlockLoad(LMb);  
  QTr.BranchID = LMb.BranchID;
  QTr.Objects = AddBranchObjectToObjectList(LMb.BranchID,QTr.Objects);
  QTVcRecordDuplicateClient = res;
  return;
end;

global
updating function LongInt QTVcRecordSaveClient(LongInt wn,var record QTVc QTr,record QTVc QT2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  
  if (QTr.Rejected==2) then begin
    SMSWhenQT(QTr,2);  
  end;
  UpdateBrowses("PipelineWClass");
  QTVcRecordSaveClient = res;
  return;
end;

global
updating function LongInt QTVcRecordUpdateClient(LongInt wn,var record QTVc QTr,record QTVc QT2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  
  if (QTr.Rejected==2) and (QT2r.Rejected!=2) then begin
    SMSWhenQT(QTr,2);  
  end;
  UpdateBrowses("PipelineWClass");
  QTVcRecordUpdateClient = res;
  return;
end;

global
function LongInt QTVcRecordRemoveClient(LongInt wn,var record QTVc QTr,record QTVc QT2r,LongInt long3,LongInt long4)
begin
  LongInt res;

  UpdateBrowses("PipelineWClass");
  QTVcRecordRemoveClient = res;
  return;
end;
