global
function LongInt RsrtEventTypeVcRecordCheck(record RsrtEventTypeVc RsrtEventTyper,record RsrtEventTypeVc RsrtEventType2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  record ResLocVc RLr;
      
  res = 0;
  if (blank(RsrtEventTyper.Code)) then begin
    RecordCheckError(1120,"",-1,"Code");      
    res = -1; 
    goto LRsrtEventTypeVcRecordCheck;
  end;  
  if (blank(RsrtEventTyper.ArtCode)) then begin
    RecordCheckError(1120,"",-1,"ArtCode");      
    res = -1; 
    goto LRsrtEventTypeVcRecordCheck;
  end;  
  if (nonblank(RsrtEventTyper.ResLoc)) then begin
    RLr.Code = RsrtEventTyper.ResLoc;
    if (ReadFirstMain(RLr,1,true)==false) then begin
      RecordCheckError(1120,"",-1,"ResLoc");      
      res = -1; 
      goto LRsrtEventTypeVcRecordCheck;
    end;
  end;
LRsrtEventTypeVcRecordCheck:;  
  RsrtEventTypeVcRecordCheck = res;
  return;
end;  

global
function LongInt RsrtEventTypeVcRecordInIndex(record RsrtEventTypeVc RETr,string indexname)
begin
  LongInt res;
  
  res = 1;
  if (RETr.Closed!=0) then begin 
    if (indexname=="ActCode") then begin res = 0; end;
    if (indexname=="ActComment") then begin res = 0; end;
    if (indexname=="ActResLoc") then begin res = 0; end;
  end;
  RsrtEventTypeVcRecordInIndex = res;
  return;
end;  
