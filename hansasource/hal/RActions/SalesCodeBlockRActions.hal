global
updating function LongInt SalesCodeBlockCheck(var record SalesCodeBlock SalesCoder,record SalesCodeBlock SalesCode2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;
  Integer i,j,rwcnt;
  row SalesCodeBlock SalesCoderw;
  row SalesCodeBlock SalesCode2rw;
  
  res = 0;     
  rwcnt = MatRowCnt(SalesCoder);
  for (i=0;i<rwcnt;i=i+1) begin
    MatRowGet(SalesCoder,i,SalesCoderw);
    for (j=(i+1);j<rwcnt;j=j+1) begin
      MatRowGet(SalesCoder,i,SalesCode2rw);
      if (SalesCoderw.Code==SalesCode2rw.Code) then begin
        RecordCheckError(1545,"",j,"Code");   
        res = -1;
        goto LSalesCodeBlockCheck;
      end;
    end;
  end;   
LSalesCodeBlockCheck:;
  SalesCodeBlockCheck = res;
  RETURN;
END;
