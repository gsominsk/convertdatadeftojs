global
function LongInt CClassDVcRecordCheck(record CClassDVc CClassDr,record CClassDVc CClassD2p,LongInt stat,LongInt long4)
begin
  LongInt res;
  Integer i,rwcnt;
  row CClassDVc CClassDrw;
  record CClassVc CClassr;
      
  res = 0;
  if (blank(CClassDr.Code)) then begin
    RecordCheckError(1120,"",-1,"Code");      
    res = -1; 
    goto LCClassDVcRecordCheck;
  end;  
  rwcnt = MatRowCnt(CClassDr);
  for (i=0;i<rwcnt;i=i+1) begin
    MatRowGet(CClassDr,i,CClassDrw);
    if (nonblank(CClassDrw.CClass)) then begin
      CClassr.Code = CClassDrw.CClass;
      if (ReadFIrstMain(CClassr,1,true)==false) then begin
        RecordCheckError(2214,"",i,"CClass");
        res = -1;
        goto LCClassDVcRecordCheck;
      end;
    end;
  end;
LCClassDVcRecordCheck:;  
  CClassDVcRecordCheck = res;
  return;
end;  
