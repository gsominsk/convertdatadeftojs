external function Integer FindCharPosition(string,string);

global
function LongInt HALRulesVcRecordCheck(var record HALRulesVc HALRulesr,record HALRulesVc HALRules2r,LongInt stat,LongInt long4)
begin
  LongInt res;

  res = 0;
  if (FindCharPosition(HALRulesr.Filename," ")!=0) then begin
    RecordCheckError(1956,"",-1,"Filename");      
    res = -1;
    goto LHALRulesVcRecordCheck;
  end;
  if (FindCharPosition(HALRulesr.Filename,":")!=0) then begin
    RecordCheckError(1956,"",-1,"Filename");      
    res = -1;
    goto LHALRulesVcRecordCheck;
  end;
  if (InString(HALRulesr.Filename,"..")!=0) then begin
    RecordCheckError(1956,"",-1,"Filename");      
    res = -1;
    goto LHALRulesVcRecordCheck;
  end;
  if (InString(HALRulesr.Filename,".HDB")!=0) then begin
    RecordCheckError(1956,"",-1,"Filename");      
    res = -1;
    goto LHALRulesVcRecordCheck;
  end;
  if ((Left(HALRulesr.Filename,1)=="\\") or (Left(HALRulesr.Filename,1)=="/")) then begin
    RecordCheckError(1956,"",-1,"Filename");      
    res = -1;
    goto LHALRulesVcRecordCheck;
  end;
LHALRulesVcRecordCheck:;
  HALRulesVcRecordCheck = res;
  return;
end;
