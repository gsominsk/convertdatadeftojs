external procedure GetVATRow(string,var row VATCodeBlock);

global
function LongInt Tax1RebVcRecordCheck(record Tax1RebVc Tax1Rebr,record Tax1RebVc Tax1Reb2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;
  record CUVc CUr;
  row VATCodeBlock VATrw;
      
  res = 0;
  if (blank(Tax1Rebr.Code)) then begin
    RecordCheckError(1120,"",-1,"Code");      
    res = -1; 
    goto LTax1RebVcRecordCheck;
  end;  
  CUr.Code = Tax1Rebr.CustCode;
  if (ReadFirstMain(CUr,1,true)==false) then begin
    RecordCheckError(1120," " & Tax1Rebr.CustCode,-1,"CustCode");      
    res = -1; 
    goto LTax1RebVcRecordCheck;
  end;
  GetVATRow(Tax1Rebr.Code,VATrw);
  if (blank(VATrw.VATCode)) then begin
    RecordCheckError(1120," " & Tax1Rebr.Code,-1,"Code");      
    res = -1; 
    goto LTax1RebVcRecordCheck;
  end;
  
LTax1RebVcRecordCheck:;  
  Tax1RebVcRecordCheck = res;
  RETURN;
END;  
