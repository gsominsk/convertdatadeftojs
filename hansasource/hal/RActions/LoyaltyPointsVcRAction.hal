global
function LongInt LoyaltyPointsVcRecordCheck(var record LoyaltyPointsVc LPr,record LoyaltyPointsVc LLP2r,LongInt stat,LongInt long4)
begin
  LongInt res;  
  record LCMemberLevelVc LCMemberLevelr;
  row LoyaltyPointsVc LPrw;
  Integer i,rwcnt;
  record INVc INr;
  record ITVc ITr;

  res = 0;
  if (nonblank(LPr.LCMLevel)) then begin
    LCMemberLevelr.Code = LPr.LCMLevel;
    if (ReadFirstMain(LCMemberLevelr,1,true)==false) then begin
      RecordCheckError(26431,"",-1,"LCMLevel");      
      res = -1;
      goto LLoyaltyPointsVcRecordCheck;
    end;
  end;
  rwcnt = MatRowCnt(LPr);
  for (i=0;i<rwcnt;i=i+1) begin
    MatRowGet(LPr,i,LPrw);
    switch (LPrw.CodeType) begin
      case 0: 
        if (nonblank(LPrw.ITCode)) then begin
          ITr.Code = LPrw.ITCode;
          if (ReadFirstMain(ITr,1,true)==false) then begin
            RecordCheckError(26431,"",i,"ITCode");      
            res = -1;
            goto LLoyaltyPointsVcRecordCheck;
          end;
        end;
      case 1: 
        if (nonblank(LPrw.ITCode)) then begin
          INr.Code = LPrw.ITCode;
          if (ReadFirstMain(INr,1,true)==false) then begin
            RecordCheckError(26431,"",i,"ITCode");      
            res = -1;
            goto LLoyaltyPointsVcRecordCheck;
          end;
        end;
    end;
  end;
LLoyaltyPointsVcRecordCheck:;
  LoyaltyPointsVcRecordCheck = res;
  return;
end;
