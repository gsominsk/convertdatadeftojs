global
function LongInt TimedMaintVcRecordSave(var record TimedMaintVc TimedMaintr,record TimedMaintVc TimedMaint2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  Date blankd;
  
  TimedMaintr.SerNr = NextSerNr("TimedMaintVc",CurrentDate,-1,false,"");
  TimedMaintVcRecordSave = res;
  
  return;
end;

global
function LongInt TimedMaintVcRecordInIndex(record TimedMaintVc TimedMaintr,string indexname)
begin
  LongInt res;
  
  res = 1;
  if ((TimedMaintr.OKFlag==0) or (TimedMaintr.DoneFlag!=0)) then begin 
    if (indexname=="ToDo")  then begin res = 0; end;
  end;
  TimedMaintVcRecordInIndex = res;
  return;
end;

global
function LongInt TimedMaintVcRecordDuplicate(var record TimedMaintVc TMr,record TimedMaintVc TM2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  Date blankd;
  Time blankt;
  
  TMr.OKFlag = 0;
  TMr.DoneFlag = 0;
  TMr.RequestedBy = CurrentUser;
  TMr.ApprovedBy = "";
  
  TMr.Date = blankd;
  TMr.Time = blankt;
  TMr.StartDate = blankd;
  TMr.StartTime = blankt;
  TMr.EndDate = blankd;
  TMr.EndTime = blankt;
  
  if (SingleUserMode) then begin
    TMr.SerNr = NextSerNr("TimedMaintVc",CurrentDate,-1,false,"");
  end;
  return;
end;
