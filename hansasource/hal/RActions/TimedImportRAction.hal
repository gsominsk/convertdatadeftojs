global
function LongInt TimedImportVcRecordSave(var record TimedImportVc TimedImportr,record TimedImportVc TimedImport2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  Date blankd;
  
  TimedImportr.SerNr = NextSerNr("TimedImportVc",CurrentDate,-1,false,"");
  TimedImportVcRecordSave = res;
  
  return;
end;

global
function LongInt TimedImportVcRecordInIndex(record TimedImportVc TimedImportr,string indexname)
begin
  LongInt res;
  
  res = 1;
  if ((TimedImportr.OKFlag==0) or (TimedImportr.DoneFlag!=0)) then begin 
    if (indexname=="ToDo")  then begin res = 0; end;
  end;
  TimedImportVcRecordInIndex = res;
  return;
end;

global
function LongInt TimedImportVcRecordDuplicate(var record TimedImportVc TIr,record TimedImportVc TI2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  Date blankd;
  Time blankt;

  TIr.OKFlag = 0;
  TIr.DoneFlag = 0;
  TIr.RequestedBy = CurrentUser;
  TIr.ApprovedBy = "";
  
  TIr.Date = blankd;
  TIr.Time = blankt;
  TIr.StartDate = blankd;
  TIr.StartTime = blankt;
  TIr.EndDate = blankd;
  TIr.EndTime = blankt;
  
  if (SingleUserMode) then begin
    TIr.SerNr = NextSerNr("TimedImportVc",CurrentDate,-1,false,"");
  end;
  return;
end;
