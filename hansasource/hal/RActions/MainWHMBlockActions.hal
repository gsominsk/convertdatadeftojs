function Integer CheckIfPositionExists(string poscode)
BEGIN
  Integer res;
  record PosVc Posr;

  res = 0;     
  Posr.Code = poscode;
  if (ReadFirstMain(Posr,1,true)==false) then begin
    RecordCheckError(1734," " & poscode,-1,"poscode");    
    res = -1;
    goto LCheckIfPositionExists;
  end else begin
    if (Posr.Closed!=0) then begin
      RecordCheckError(1735," " & poscode,-1,"poscode");    
      res = -1;
      goto LCheckIfPositionExists;
    end;
  end;
LCheckIfPositionExists:;  
  CheckIfPositionExists = res;
  RETURN;
END;

global
updating function LongInt MainWHMBlockCheck(var record MainWHMBlock MainWHMr,record MainWHMBlock MainWHM2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;
  record LocationVc Locr;
  record LocAreaVc LocArear;

  res = 0;     
  if (nonblank(MainWHMr.Location)) then begin
    Locr.Code = MainWHMr.Location;
    if (ReadFirstMain(Locr,1,true)==false) then begin
      RecordCheckError(1290,": " & MainWHMr.Location,-1,"Location");      
      res = -1;
      goto LMainWHMBlockCheck;
    end;
  end;
  if (nonblank(MainWHMr.PalletArea)) then begin
    LocArear.Code = MainWHMr.PalletArea;
    if (ReadFirstMain(LocArear,1,true)==false) then begin
      RecordCheckError(1395," " & MainWHMr.PalletArea,-1,"PalletArea");      
      res = -1;
      goto LMainWHMBlockCheck;
    end;
  end;
  if (nonblank(MainWHMr.PickArea)) then begin
    LocArear.Code = MainWHMr.PickArea;
    if (ReadFirstMain(LocArear,1,true)==false) then begin
      RecordCheckError(1394," " & MainWHMr.PickArea,-1,"PickArea");      
      res = -1;
      goto LMainWHMBlockCheck;
    end;
  end;
  if (nonblank(MainWHMr.DeliveryArea)) then begin
    LocArear.Code = MainWHMr.DeliveryArea;
    if (ReadFirstMain(LocArear,1,true)==false) then begin
      RecordCheckError(1394," " & MainWHMr.DeliveryArea,-1,"DeliveryArea");      
      res = -1;
      goto LMainWHMBlockCheck;
    end;
  end;
  if (nonblank(MainWHMr.DefPUPosCode)) then begin
    if (CheckIfPositionExists(MainWHMr.DefPUPosCode)<0) then begin
      goto LMainWHMBlockCheck;
    end;
  end;
  if (nonblank(MainWHMr.DefProdPosCode)) then begin
    if (CheckIfPositionExists(MainWHMr.DefProdPosCode)<0) then begin
      goto LMainWHMBlockCheck;
    end;
  end;
  if (nonblank(MainWHMr.WraperPosCode)) then begin
    if (CheckIfPositionExists(MainWHMr.WraperPosCode)<0) then begin
      goto LMainWHMBlockCheck;
    end;
  end;
  if (nonblank(MainWHMr.DeliveryPosCode)) then begin
    if (CheckIfPositionExists(MainWHMr.DeliveryPosCode)<0) then begin
      goto LMainWHMBlockCheck;
    end;
  end;
LMainWHMBlockCheck:;
  MainWHMBlockCheck = res;
  RETURN;
END;
