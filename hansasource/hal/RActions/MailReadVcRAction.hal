global
updating function LongInt MailReadVcRecordRemoveAfter(var record MailReadVc MailReadp,record MailReadVc MailRead2p,LongInt stat,LongInt long4)
begin
  LongInt res;
  MailReadVcRecordRemoveAfter = res;
  return;
end;

global
procedure DoSetMailAddrStatus(record MailVc Mailr,LongInt ConfSerNr,Integer status)
begin
  LongInt rwcnt,i;
  row MailVc Mailrw;
  
  rwcnt = MatRowCnt(Mailr);
  for (i = 0; i<rwcnt; i = i + 1) begin
    MatRowGet(Mailr,i,Mailrw);
    
    if (Mailrw.Mailbox==ConfSerNr) then begin
      Mailrw.AddrStatus = status;
      MatRowPut(Mailr,i,Mailrw);
      goto out;
    end;
  end;
  
out:;
  return;
end;

updating procedure SetMailAddrStatus(LongInt MailSerNr,LongInt ConfSerNr,Integer status)
begin
  LongInt res,rwcnt,i;
  record MailVc Mailr;
  record MailVc OldMailr;
  row MailVc Mailrr;
  record ConfVc Confr;
  Boolean dummyf;
  
  Mailr.SerNr = MailSerNr;
  
  if (ReadFirstMain(Mailr,1,true)) then begin
    Confr.SerNr = ConfSerNr;
    
    if (ReadFirstMain(Confr,1,true)) then begin
      rwcnt = MatRowCnt(Mailr);
      for (i = 0; i<rwcnt; i = i + 1) begin
        MatRowGet(Mailr,i,Mailrr);
        
        if (Mailrr.AddrCode==Confr.AddrName) then begin
          RecordCopy(OldMailr,Mailr);
          Mailrr.AddrStatus = 1;
          MatRowPut(Mailr,i,Mailrr);
          dummyf = RecordUpdate(OldMailr,Mailr,false);
          goto out;
        end;
      end;
    end;
  end;
  
out:;
  return;
end;

global
updating function LongInt MailReadVcRecordUpdate(var record MailReadVc MailReadp,record MailReadVc MailRead2p,LongInt stat,LongInt check)
begin
  LongInt res;
  
  /*
  if (MailReadp.accode==1) then begin
    SetMailAddrStatus(MailReadp.mailSerNr,MailReadp.mailBoxNr,1);
  end;
  */
  
  MailReadVcRecordUpdate = res;
  return;
end;

global
updating function LongInt MailReadVcRecordSaveAfter(var record MailReadVc MailReadp,record MailReadVc MailRead2p,LongInt stat,LongInt check)
begin
  LongInt res;
  
  /*
  if (MailReadp.accode==1) then begin
    SetMailAddrStatus(MailReadp.mailSerNr,MailReadp.mailBoxNr,1);
  end;
  */
  
  MailReadVcRecordSaveAfter = res;
  return;
end;
