global
function LongInt SerialPortDeviceVcRecordCheck(record SerialPortDeviceVc SPDr,record SerialPortDeviceVc SPD2r,LongInt stat,LongInt check)
begin
  LongInt res;
  record SerialPortDeviceVc lSPDr;
  
  res = 0;
  if (blank(SPDr.Code)) then begin
    RecordCheckError(1058,"",-1,"Code");      
    res = -1;
    goto LSerialPortDeviceVcRecordCheck;
  end;
  if (blank(SPDr.LocalMachineCode)) then begin
    RecordCheckError(1058,"",-1,"LocalMachineCode");      
    res = -1;
    goto LSerialPortDeviceVcRecordCheck;
  end;
  if (nonblank(SPDr.FailureCode)) then begin
    if (SPDr.FailureCode==SPDr.Code) then begin
      RecordCheckError(2246,"",-1,"FailureCode");      
      res = -1;
      goto LSerialPortDeviceVcRecordCheck;
    end;
    lSPDr.Code = SPDr.FailureCode;
    if (ReadFirstMain(lSPDr,1,true)==false) then begin
      RecordCheckError(1290,"",-1,"FailureCode");      
      res = -1;
      goto LSerialPortDeviceVcRecordCheck;
    end;
  end;
LSerialPortDeviceVcRecordCheck:;  
  SerialPortDeviceVcRecordCheck = res;
  return;
end;

global
function LongInt SerialPortDeviceVcRecordDefaults(record SerialPortDeviceVc SPDr,record SerialPortDeviceVc SPD2r,LongInt stat,LongInt check)
begin
  LongInt res;
  
  SPDr.BaudRate = 9600;
  SPDr.FlowControl = kFlowControlDefault;
  SPDr.ByteSize = 8;
  SPDr.StopBits = 0;
  SPDr.Parity = -1;
  SerialPortDeviceVcRecordDefaults = res;
  return;
end;


global
function LongInt LSerialPortDeviceVcRecordCheck(record LSerialPortDeviceVc SPDr,record LSerialPortDeviceVc SPD2r,LongInt stat,LongInt check)
begin
  LongInt res;
  record SerialPortDeviceVc lSPDr;
  
  res = 0;
  if (blank(SPDr.Code)) then begin
    RecordCheckError(1058,"",-1,"Code");      
    res = -1;
    goto LLSerialPortDeviceVcRecordCheck;
  end;
  if (blank(SPDr.LocalMachineCode)) then begin
    RecordCheckError(1058,"",-1,"LocalMachineCode");      
    res = -1;
    goto LLSerialPortDeviceVcRecordCheck;
  end;
  if (nonblank(SPDr.FailureCode)) then begin
    if (SPDr.FailureCode==SPDr.Code) then begin
      RecordCheckError(2246,"",-1,"FailureCode");      
      res = -1;
      goto LLSerialPortDeviceVcRecordCheck;
    end;
    lSPDr.Code = SPDr.FailureCode;
    if (ReadFirstMain(lSPDr,1,true)==false) then begin
      RecordCheckError(1290,"",-1,"FailureCode");      
      res = -1;
      goto LLSerialPortDeviceVcRecordCheck;
    end;
  end;
LLSerialPortDeviceVcRecordCheck:;  
  LSerialPortDeviceVcRecordCheck = res;
  return;
end;

global
function LongInt LSerialPortDeviceVcRecordDefaults(record LSerialPortDeviceVc LSPDr,record LSerialPortDeviceVc LSPD2r,LongInt stat,LongInt check)
begin
  LongInt res;
  
  LSPDr.BaudRate = 9600;
  LSPDr.FlowControl = kFlowControlDefault;
  LSPDr.ByteSize = 8;
  LSPDr.StopBits = 0;
  LSPDr.Parity = -1;
  LSerialPortDeviceVcRecordDefaults = res;
  return;
end;
