global
function LongInt ShareVcSetBlockCheck(var record ShareVcSetBlock SSBb,record ShareVcSetBlock SSB2b,LongInt stat,LongInt long4)
BEGIN
  LongInt res;
  Integer i,rwcnt,errcode;
  row ShareVcSetBlock SSBbrw;
  record AccVc Accr;
  string 255 errstr;
  
  res = 0;
  rwcnt = MatRowCnt(SSBb);
  for (i=0; i<rwcnt;i=i+1) begin
    MatRowGet(SSBb,i,SSBbrw);
    
    if (SSBbrw.InCompany=="" and SSBbrw.ForCompanies=="") then begin
      goto LShareVcSetBlockCheckLineOK;
    end;
    
    if (StringToInt(SSBbrw.InCompany)<=0) then begin
      RecordCheckError(2246," " & SSBbrw.InCompany,i,"InCompany");      
      res = -1;
      goto LShareVcSetBlockCheck;
    end;
    
    if (SSBbrw.InCompany<>"" and SSBbrw.ForCompanies=="") then begin
      RecordCheckError(2246," " & SSBbrw.InCompany,i,"ForCompanies");      
      res = -1;
      goto LShareVcSetBlockCheck;
    end;
    
LShareVcSetBlockCheckLineOK:;
  end;
LShareVcSetBlockCheck:;  
  ShareVcSetBlockCheck = res;
  return;
end;
