global
function LongInt ASProductStatusVcRecordDefaults(var record ASProductStatusVc ASPSr,record ASProductStatusVc ASPS2r,LongInt long3,LongInt long4)
begin
  LongInt res;
  
  ASPSr.TransDate = CurrentDate;  
  ASProductStatusVcRecordDefaults = res;
  return;
end;

global
function LongInt ASProductStatusVcRecordCheck(var record ASProductStatusVc ASPSr,record ASProductStatusVc ASPS2r,LongInt stat,LongInt long4)
begin
  LongInt res;

  res = 0;
  if (ASPSr.SerNr<=0) then begin
    ASPSr.SerNr = NextSerNr("ASProductStatusVc",ASPSr.TransDate,-1,false,"");
  end;
/*  
  if (blank(ASPSr.Code)) then begin
    RecordCheckError(20117,"",-1,"Code");    
    res = -1;
    goto LASProductStatusVcRecordCheck;
  end;  
*/  
LASProductStatusVcRecordCheck:;
  ASProductStatusVcRecordCheck = res;
  return;
end;

updating procedure StoreASProductStatusHistory(record ASProductStatusVc ASPSr)
begin
  record ASProdStatHistVc ASPSHr;
  row ASProdStatHistVc ASPSHrw;
  row ASProductStatusVc ASPSrw;
  Integer psi,psrwcnt;
  
  RecordNew(ASPSHr);
  ASPSHr.TransDate = CurrentDate;
  ASPSHr.TransTime = CurrentTime;
  ASPSHr.Comment = ASPSr.Comment;
  ASPSHr.Person = CurrentUser;
  ASPSHr.ASProduct = ASPSr.ASProduct;
  ASPSHr.ASStore = ASPSr.ASStore;
  ASPSHr.ASCountry = ASPSr.ASCountry;
  ASPSHr.ASInApp = ASPSr.ASInApp;
  ASPSHr.Country = ASPSr.Country;
  ASPSHr.RespPM = ASPSr.RespPM;
  ASPSHr.SubmissionStatus = ASPSr.SubmissionStatus;
  ASPSHr.StoreStatus = ASPSr.StoreStatus;
  ASPSHr.ASProdStatSerNr = ASPSr.SerNr;
  ASPSHr.DateVersion = ASPSr.DateVersion;
  ASPSHr.SerNr = NextSerNr("ASProdStatHistVc",ASPSHr.TransDate,-1,false,"");
  psrwcnt = MatRowCnt(ASPSr);
  for (psi=0;psi<psrwcnt;psi=psi+1) begin
    MatRowGet(ASPSr,psi,ASPSrw);
    ClearRow(ASPSHr,ASPSHrw,1);
    ASPSHrw.ASInApp = ASPSrw.ASInApp;
    ASPSHrw.ASInAppSKU = ASPSrw.ASInAppSKU;
    ASPSHrw.ASInAppMonths = ASPSrw.ASInAppMonths;
    ASPSHrw.Country = ASPSrw.Country;
    MatRowPut(ASPSHr,MatRowCnt(ASPSHr),ASPSHrw);
  end;
  RecordStore(ASPSHr,false);
  return;
end;

global
updating function LongInt ASProductStatusVcRecordSaveAfter(var record ASProductStatusVc ASPSr,record ASProductStatusVc ASPS2r,LongInt long3,LongInt long4)
begin
  LongInt res;
  
  StoreASProductStatusHistory(ASPSr);
  ASProductStatusVcRecordSaveAfter = res;
  return;
end;

global
updating function LongInt ASProductStatusVcRecordUpdateAfter(var record ASProductStatusVc ASPSr,record ASProductStatusVc ASPS2r,LongInt long3,LongInt long4)
begin
  LongInt res;
  
  StoreASProductStatusHistory(ASPSr);
  ASProductStatusVcRecordUpdateAfter = res;
  return;
end;