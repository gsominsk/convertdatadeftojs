global
function LongInt ConvLocationBlockCheck(var record ConvLocationBlock CLb,record ConvLocationBlock CL2b,LongInt stat,LongInt long4)
begin
  LongInt res;
  Integer j,i,rwcnt,pmrwcnt;
  row ConvLocationBlock CLbrw;
  record LocationVc Locr;
  record ItemHistVc IHr;
  
  res = 0;
  rwcnt = MatRowCnt(CLb);
  for (i=0; i<rwcnt;i=i+1) begin
    MatRowGet(CLb,i,CLbrw);
    if (blank(CLbrw.NewCode)) then begin
      RecordCheckError(1058,"",i,"NewCode");   
      res = -1;
      goto LConvLocationBlockCheck;        
    end;
    IHr.Location = CLbrw.NewCode;
    if (ReadFirstKey("SerNrPerLoc",IHr,1,true)) then begin
      RecordCheckError(1084," " & CLbrw.NewCode,i,"NewCode");   
      res = -1;
      goto LConvLocationBlockCheck;        
    end;
  end;  
LConvLocationBlockCheck:;  
  ConvLocationBlockCheck = res;
  return;
end;
