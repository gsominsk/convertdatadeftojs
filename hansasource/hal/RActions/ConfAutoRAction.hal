updating procedure CleanAllAutoReplyList(LongInt sernr)
begin
  record AutoReplyListVc AutoReplyListr;
  Boolean foundf;

  foundf = true;
  AutoReplyListr.SerNr = sernr;
  while (LoopMain(AutoReplyListr,1,foundf)) begin
    if (AutoReplyListr.SerNr==sernr) then begin
      RecordDelete(AutoReplyListr);
      StepBack(AutoReplyListr);
    end;
  end;
  return;
end;

global
updating function LongInt ConfAutoReplyVcRecordSaveAfter(var record ConfAutoReplyVc Confr,record ConfAutoReplyVc Conf2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;
  Date blankd;

  if (Confr.Activated!=0) then begin
    CleanAllAutoReplyList(Confr.SerNr);
  end;
  ConfAutoReplyVcRecordSaveAfter = res; 
  RETURN;
END;

global
updating function LongInt ConfAutoReplyVcRecordUpdateAfter(var record ConfAutoReplyVc Confr,record ConfAutoReplyVc Conf2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;
  Date blankd;

  if ((Confr.Activated!=0) and (Conf2r.Activated==0)) then begin
    CleanAllAutoReplyList(Confr.SerNr);
  end;
  ConfAutoReplyVcRecordUpdateAfter = res; 
  RETURN;
END;

