global
function LongInt INVcRecordSaveClient(LongInt wn,var record INVc INr,record INVc IN2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  string 255 OperationMenuAction;
  Integer mwn,rwcnt;

  OperationMenuAction = GetWindowString(wn,"OperationMenuAction");

  switch (OperationMenuAction) begin
    case "AddItem":
      mwn = MotherWindow(wn);
      if (mwn>0) then begin
        switch (GetWindowFileName(mwn)) begin
          case "IVVc": begin
            record IVVc IVr;
            row IVVc IVrw;
            
            DeselectWindow(mwn,true);
            GetWindowRecord(mwn,IVr);
            rwcnt = MatRowCnt(IVr);
            WindowFieldGoto(mwn,IVr,rwcnt,"ArtCode",true);
            PasteString(mwn,INr.Code);
//            WindowFieldGoto(mwn,IVr,rwcnt,"Quant",true);
//            PasteString(mwn,"1.00");
          end;
          case "ORVc": begin
            record ORVc ORr;
            row ORVc ORrw;
            
            DeselectWindow(mwn,true);
            GetWindowRecord(mwn,ORr);
            rwcnt = MatRowCnt(ORr);
            WindowFieldGoto(mwn,ORr,rwcnt,"ArtCode",true);
            PasteString(mwn,INr.Code);
//            WindowFieldGoto(mwn,ORr,rwcnt,"Quant",true);
//            PasteString(mwn,"1.00");
          end;
          case "QTVc": begin
            record QTVc QTr;
            row QTVc QTrw;
            
            DeselectWindow(mwn,true);
            GetWindowRecord(mwn,QTr);
            rwcnt = MatRowCnt(QTr);
            WindowFieldGoto(mwn,QTr,rwcnt,"ArtCode",true);
            PasteString(mwn,INr.Code);
//            WindowFieldGoto(mwn,QTr,rwcnt,"Quant",true);
//            PasteString(mwn,"1.00");
          end;
          case "OYVc": begin
            record OYVc OYr;
            row OYVc OYrw;
            
            DeselectWindow(mwn,true);
            GetWindowRecord(mwn,OYr);
            rwcnt = MatRowCnt(OYr);
            WindowFieldGoto(mwn,OYr,rwcnt,"ArtCode",true);
            PasteString(mwn,INr.Code);
//            WindowFieldGoto(mwn,OYr,rwcnt,"Quant",true);
//            PasteString(mwn,"1.00");
          end;
        end;
      end;
  end;  
  INVcRecordSaveClient = res;
  return;
end;
