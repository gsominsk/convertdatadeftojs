global
function LongInt LocLoyaltyPointsVcRecordCheck(var record LocLoyaltyPointsVc LLPr,record LocLoyaltyPointsVc LLP2r,LongInt stat,LongInt long4)
begin
  LongInt res;  
  record LCMemberLevelVc LCMemberLevelr;
  row LocLoyaltyPointsVc LLPrw;
  Integer i,rwcnt;
  record LocationVc Locr;
  record INVc INr;
  record ITVc ITr;

  res = 0;
  Locr.Code = LLPr.Location;
  if (ReadFirstMain(Locr,1,true)==false) then begin
    RecordCheckError(1120,LLPr.Location,-1,"Location");      
    res = -1;
    goto LLocLoyaltyPointsVcRecordCheck;
  end;
  if (nonblank(LLPr.LCMLevel)) then begin
    LCMemberLevelr.Code = LLPr.LCMLevel;
    if (ReadFirstMain(LCMemberLevelr,1,true)==false) then begin
      RecordCheckError(26431,"",-1,"LCMLevel");      
      res = -1;
      goto LLocLoyaltyPointsVcRecordCheck;
    end;
  end;
  rwcnt = MatRowCnt(LLPr);
  for (i=0;i<rwcnt;i=i+1) begin
    MatRowGet(LLPr,i,LLPrw);
    switch (LLPrw.CodeType) begin
      case 0: 
        if (nonblank(LLPrw.ITCode)) then begin
          ITr.Code = LLPrw.ITCode;
          if (ReadFirstMain(ITr,1,true)==false) then begin
            RecordCheckError(26431,"",i,"ITCode");      
            res = -1;
            goto LLocLoyaltyPointsVcRecordCheck;
          end;
        end;
      case 1: 
        if (nonblank(LLPrw.ITCode)) then begin
          INr.Code = LLPrw.ITCode;
          if (ReadFirstMain(INr,1,true)==false) then begin
            RecordCheckError(26431,"",i,"ITCode");      
            res = -1;
            goto LLocLoyaltyPointsVcRecordCheck;
          end;
        end;
    end;
  end;
LLocLoyaltyPointsVcRecordCheck:;
  LocLoyaltyPointsVcRecordCheck = res;
  return;
end;
