external procedure AddCharsToString(var string,string,Integer);
external function Boolean ReadFirstItem(string,var record INVc,Boolean,Boolean);

global
function LongInt BarcodeVcRecordCheck(var record BarcodeVc Barcoder,record BarcodeVc Barcode2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;
  record INVc INr;
  record ItemSettingBlock ISb;
  string 255 tstr;

  res = 0;
  if (ReadFirstItem(Barcoder.Itemcode,INr,true,true)==false) then begin
    RecordCheckError(1233,"",-1,"Itemcode");      
    res = -1; 
    goto LBarcodeVcRecordCheck;
  end;  
  if (len(Barcoder.Barcode)<=0) then begin
    RecordCheckError(1130,"",-1,"Barcode");      
    res = -1; 
    goto LBarcodeVcRecordCheck;
  end;
  
  BlockLoad(ISb);
  if (ISb.BarCodeLength>0) then begin
    if (nonblank(Barcoder.Barcode)) then begin
      if (len(Barcoder.Barcode)<ISb.BarCodeLength ) then begin
        tstr = Barcoder.Barcode;
        AddCharsToString(tstr,"0",ISb.BarCodeLength-len(Barcoder.Barcode));
        Barcoder.Barcode = tstr;
      end;
    end;
  end;
LBarcodeVcRecordCheck:;  
  BarcodeVcRecordCheck = res;
  RETURN;
END;


