global
function LongInt SupersessionINVcRecordCheck(record SupersessionINVc SupersessionINr,record SupersessionINVc SupersessionIN2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  record INVc INr;
  record SupersessionINVc SINr;
      
  res = 0;
  if (nonblank(SupersessionINr.OldArtCode)) then begin
    INr.Code = SupersessionINr.OldArtCode;
    if (ReadFirstMain(INr,1,true)==false) then begin
      RecordCheckError(1120,"",-1,"OldArtCode");      
      res = -1; 
      goto LSupersessionINVcRecordCheck;
    end;
  end;
  if (nonblank(SupersessionINr.NewArtCode)) then begin
    INr.Code = SupersessionINr.NewArtCode;
    if (ReadFirstMain(INr,1,true)==false) then begin
      RecordCheckError(1120,"",-1,"NewArtCode");      
      res = -1; 
      goto LSupersessionINVcRecordCheck;
    end;
  end;
  SINr.OldArtCode = SupersessionINr.NewArtCode;
  SINr.NewArtCode = SupersessionINr.OldArtCode;
  if (ReadFirstKey("NewArtCode",SINr,2,true)) then begin
    RecordCheckError(2246,"",-1,"OldArtCode");      
    res = -1; 
    goto LSupersessionINVcRecordCheck;
  end;
LSupersessionINVcRecordCheck:;  
  SupersessionINVcRecordCheck = res;
  return;
end;  

global
function LongInt SupersessionINVcRecordInIndex(record SupersessionINVc SINr,string indexname)
begin
  LongInt res;
  
  res = 1;
  if (SINr.Closed!=0) then begin 
    if (indexname=="ActOldArtCode") then begin res = 0; end;
    if (indexname=="ActNewArtCode") then begin res = 0; end;
  end;
  SupersessionINVcRecordInIndex = res;
  return;
end;  
