external function Boolean HasMultiCurrency();

global
function LongInt CurncyCodeVcRecordDefaults(var record CurncyCodeVc CurncyCoder,record CurncyCodeVc CurncyCode2r,LongInt long3,LongInt long4)
BEGIN
  LongInt res;  

  CurncyCoder.CurncyCode = "";
  CurncyCoder.Comment = "";
  CurncyCoder.DefaultFrom = blankval;
  CurncyCoder.DefaultTo1 = blankval;
  CurncyCoder.DefaultTo2 = blankval;
  CurncyCoder.MaxFrom = blankval;
  CurncyCoder.MaxTo1 = blankval;
  CurncyCoder.MaxTo2 = blankval;
  CurncyCoder.MinFrom = blankval;
  CurncyCoder.MinTo1 = blankval;
  CurncyCoder.MinTo2 = blankval;
  CurncyCodeVcRecordDefaults = res; 
  RETURN;
END;

global
function LongInt CurncyCodeVcRecordSave(var record CurncyCodeVc CurncyCoder,record CurncyCodeVc CurncyCode2r,LongInt long3,LongInt long4)
BEGIN
  LongInt res;  

  if (CurncyCoder.EMUCurncy!=0) then begin
    if (blankdate(CurncyCoder.EMUDate)) then begin
      CurncyCoder.EMUDate = CurrentDate;
    end;
  end;
  CurncyCodeVcRecordSave = res; 
  RETURN;
END;

global
function LongInt CurncyCodeVcRecordUpdate(var record CurncyCodeVc CurncyCoder,record CurncyCodeVc CurncyCode2r,LongInt long3,LongInt long4)
BEGIN
  LongInt res;  

  if ((CurncyCoder.EMUCurncy!=0) and (CurncyCode2r.EMUCurncy==0)) then begin
    if (blankdate(CurncyCoder.EMUDate)) then begin
      CurncyCoder.EMUDate = CurrentDate;
    end;
  end;
  CurncyCodeVcRecordUpdate = res; 
  RETURN;
END;

global
function LongInt CurncyCodeVcRecordRemoveTest(var record CurncyCodeVc CurncyCoder,record CurncyCodeVc CurncyCode2r,LongInt long3,LongInt long4)
begin
  LongInt res;
  record ERVc ERr;
  
  res = 1;
  ERr.CurncyCode = CurncyCoder.CurncyCode;
  if (ReadFirstMain(ERr,1,true)) then begin
    res = 0;
  end;
  res = 1;
  CurncyCodeVcRecordRemoveTest = res;  
  RETURN;
end;

global
function LongInt CurncyCodeVcRecordCheck(var record CurncyCodeVc CurncyCoder,record CurncyCodeVc CurncyCode2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;

  res = 0;
  if (blank(CurncyCoder.CurncyCode)) then begin
    RecordCheckError(1058,"",-1,"CurncyCode");      
    res = -1; 
    goto LCurncyCodeVcRecordCheck;
  end;
  if (HasMultiCurrency==false) then begin
    if (CountRecords("CurncyCodeVc")>1) then begin//only 2 currencies
      RecordCheckError(22261,"",-1,"CurncyCode");      
      res = -1; 
      goto LCurncyCodeVcRecordCheck;
    end;
  end;
LCurncyCodeVcRecordCheck:;
  CurncyCodeVcRecordCheck = res;
  RETURN;
END;

global 
function Boolean CurncyCodeVcRecordShouldBeSynchronised(record CurncyCodeVc CurncyCoder,string tagstr)
begin
  Boolean res;
  
  res = true;
  CurncyCodeVcRecordShouldBeSynchronised = res;
  return;
end;

global 
function Boolean CurncyCodeVcRecordSync(record CurncyCodeVc CurncyCoder,string tagstr)
begin
  Boolean res;
  
  res = true;
  CurncyCodeVcRecordSync = res;
  return;
end;
