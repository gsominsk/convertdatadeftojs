external procedure B1ToB2Val(val,val,val,var val);
external procedure GetFullCurncyRate (var string,Date,var val,var val,var val,var val,var val);

global
function LongInt AT2TransVcRecordImport(var record AT2TransVc AT2Transr,record AT2TransVc AT2Trans2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  Boolean gBase1ToBase2;
  record ConvMasterBlock CMb;
  string 10 curcode;
  val t,fr,to1,to2,br1,br2;
  
  BlockLoad(CMb);
  if (CMb.Base1ToBase2Flag!=0) then begin gBase1ToBase2 = true; end;
  if (gBase1ToBase2) then begin
    GetFullCurncyRate(curcode,CurrentDate,fr,to1,to2,br1,br2);
    B1ToB2Val(AT2Transr.Sum,br1,br2,t);
    AT2Transr.Sum = t;
    B1ToB2Val(AT2Transr.Sum2,br1,br2,t);
    AT2Transr.Sum2 = t;
  end;
  AT2TransVcRecordImport = res;
  return;
end;
