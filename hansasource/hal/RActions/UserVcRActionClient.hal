external function Boolean IsMoveToCloudB();
external updating function Boolean UserLicensesExpired();

global
function LongInt UserVcRecordSaveClient(LongInt wn,var record UserVc Userr,record UserVc User2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  Integer nwn;
  record RcVc RepSpec;
  
/*
uncomment only on Kae's request  
  if (IsStandardProduct and SingleUserMode) then begin
    if (IsMoveToCloudB) then begin
      nwn = OpenWindow("ConfirmOClass",1,wn,"","",RepSpec);
      PutWindowString(nwn,"ConfirmOClassAction","MoveToCloud");
      ReRunWindowDef(nwn);
    end;
  end;
*/
  UserVcRecordSaveClient = res;
  return;
end;

global
updating function LongInt UserVcRecordUpdateClient(LongInt wn,var record UserVc Userr,record UserVc User2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  record LocalLoginOptBlock LLOb;

  if (ClientMode and UseExternalLicenseModel) then begin
    UserLicensesExpired;
  end;
  if (IsStandardProduct) then begin
    if (Userr.Code==UpperCase(USetStr(37014)) & "1") then begin
      BlockLoad(LLOb);
      LLOb.LastUsedCompCode = "";
      LLOb.AutoConToLastActComp = 0;
      BlockStore(LLOb);
    end;
  end;
  UserVcRecordUpdateClient = res;
  return;
end;
