global
function LongInt QTAnalysisVcRecordCheck(record QTAnalysisVc QTAnalysisp,record QTAnalysisVc QTAnalysis2p,LongInt stat,LongInt long4)
begin
  LongInt res;
  record INVc INr;

  res = 0;
  if (len(QTAnalysisp.ItemCode)<=0) then begin
    RecordCheckError(1130,"",-1,"ItemCode");      
    res = -1; 
    goto LQTAnalysisVcRecordCheck;
  end;
  INr.Code = QTAnalysisp.ItemCode;
  if (ReadFirstMain(INr,1,true)==false) then begin
    RecordCheckError(1290,"",-1,"ItemCode");      
    res = -1; 
    goto LQTAnalysisVcRecordCheck;
  end;
LQTAnalysisVcRecordCheck:;
  QTAnalysisVcRecordCheck = res;
  return;
end;
