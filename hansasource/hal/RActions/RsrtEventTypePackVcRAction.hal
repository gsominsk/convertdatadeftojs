global
function LongInt RsrtEventTypePackVcRecordInIndex(record RsrtEventTypePackVc RETPr,string indexname)
begin
  LongInt res;
  
  res = 1;
  if (RETPr.Closed!=0) then begin 
    if (indexname=="ActCode") then begin res = 0; end;
    if (indexname=="ActCodeStartDate") then begin res = 0; end;
    if (indexname=="ActComment") then begin res = 0; end;
    if (indexname=="ActEventType") then begin res = 0; end;
    if (indexname=="ActRLDate") then begin res = 0; end;
  end;
  RsrtEventTypePackVcRecordInIndex = res;
  return;
end;

global
function LongInt RsrtEventTypePackVcRecordDefaults(record RsrtEventTypePackVc RETPr,record RsrtEventTypePackVc RETP2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  
  RETPr.Code = "";
  RsrtEventTypePackVcRecordDefaults = res;
  return;
end;  

global
function LongInt RsrtEventTypePackVcRecordDuplicate(record RsrtEventTypePackVc RETPr,record RsrtEventTypePackVc RETP2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  
  RETPr.Code = "";
  RsrtEventTypePackVcRecordDuplicate = res;
  return;
end;  

global
function LongInt RsrtEventTypePackVcRecordCheck(record RsrtEventTypePackVc RETPr,record RsrtEventTypePackVc RETP2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  record ResLocVc RLr;
  record RsrtEventTypeVc RETr;
  record INVc INr;
  row RsrtEventTypePackVc RETPrw;
  Integer i,rwcnt;

  res = 0;
  if (blank(RETPr.Code)) then begin
    RecordCheckError(1058,"",-1,"Code");      
    res = -1; 
    goto LRsrtEventTypePackVcRecordCheck;
  end;
  if (nonblank(RETPr.ResLoc)) then begin
    RLr.Code = RETPr.ResLoc;
    if (ReadFirstMain(RLr,1,true)==false) then begin
      RecordCheckError(1120,"",-1,"ResLoc");      
      res = -1; 
      goto LRsrtEventTypePackVcRecordCheck;
    end;
  end;
  if (nonblank(RETPr.ArtCode)) then begin
    INr.Code = RETPr.ArtCode;
    if (ReadFirstMain(INr,1,true)==false) then begin
      RecordCheckError(1120,"",-1,"ArtCode");      
      res = -1; 
      goto LRsrtEventTypePackVcRecordCheck;
    end;
  end else begin
    RecordCheckError(1058,"",-1,"ArtCode");      
    res = -1; 
    goto LRsrtEventTypePackVcRecordCheck;
  end;
  rwcnt = MatRowCnt(RETPr);
  if (rwcnt==0) then begin
    RecordCheckError(1030,"",0,"EventType");      
    res = -1;
    goto LRsrtEventTypePackVcRecordCheck;
  end;
  for (i=0;i<rwcnt;i=i+1) begin
    MatRowGet(RETPr,i,RETPrw);
    if (nonblank(RETPrw.EventType)) then begin
      RETr.Code = RETPrw.EventType;
      if (ReadFirstMain(RETr,1,true)==false) then begin
        RecordCheckError(1120,"",0,"EventType");      
        res = -1; 
        goto LRsrtEventTypePackVcRecordCheck;
      end;
    end;
  end;
LRsrtEventTypePackVcRecordCheck:;  
  RsrtEventTypePackVcRecordCheck = res;
  return;
end;  
