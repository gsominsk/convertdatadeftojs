global
function LongInt QCTemplateVcRecordCheck(record QCTemplateVc QCTr,record QCTemplateVc QCT2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  record QCTemplateVc locQCTr;
  Integer insertmode,updatemode;
  row QCTemplateVc QCTrw;
  Integer i,rwcnt;
  record QCTestVc QCTestr;
  record UnitVc Unitr;
  
  res = 0;
  insertmode = 1;
  updatemode = 2;
  if (len(QCTr.Code)<=0) then begin
    RecordCheckError(1058,"",-1,"Code");      
    res = -1; 
    goto LQCTemplateVcRecordCheck;
  end;
  rwcnt = MatRowCnt(QCTr);
  for (i=0;i<rwcnt;i=i+1) begin
    MatRowGet(QCTr,i,QCTrw);
    if (nonblank(QCTrw.QCTest)) then begin
      QCTestr.Code = QCTrw.QCTest;
      if (ReadFirstMain(QCTestr,1,true)==false) then begin
        RecordCheckError(1290," " & QCTrw.QCTest,i,"QCTest");      
        res = -1; 
        goto LQCTemplateVcRecordCheck;
      end;
    end;
    if (nonblank(QCTrw.QCUnit)) then begin
      Unitr.Code = QCTrw.QCUnit;
      if (ReadFirstMain(Unitr,1,true)==false) then begin
        RecordCheckError(1290," " & QCTrw.QCUnit,i,"QCUnit");      
        res = -1; 
        goto LQCTemplateVcRecordCheck;
      end;
    end;
  end;
LQCTemplateVcRecordCheck:;
  QCTemplateVcRecordCheck = res;
  return;
end;