global
function LongInt ContactVcRecordInIndex(record ContactVc Contactr,string indexname)
BEGIN
  LongInt res;
  
  res = 1;
  if (Contactr.Closed!=0) then begin 
    if (indexname=="ActName")  then begin res = 0; end;
    if (indexname=="ActCompKey")  then begin res = 0; end;
    if (indexname=="ActCompName")  then begin res = 0; end;
    if (indexname=="ActPhone")  then begin res = 0; end;
    if (indexname=="ActTitle")  then begin res = 0; end;
    if (indexname=="ActDepartment")  then begin res = 0; end;
  end;
  ContactVcRecordInIndex = res;
  RETURN;
END;

global
updating function LongInt ContactVcRecordCheck(var record ContactVc Contactr,record ContactVc Contact2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;

  res = 0;     
  if ((blank(Contactr.Name)) or (blank(Contactr.Company))) then begin
    if (blank(Contactr.Name)) then begin
      RecordCheckError(1270,"",-1,"Name");      
      res = -1; 
      goto LContactVcRecordCheck;          
    end else begin
      RecordCheckError(1270,"",-1,"Company");      
      res = -1; 
      goto LContactVcRecordCheck;          
    end;
  end;
LContactVcRecordCheck:;
  ContactVcRecordCheck = res;
  RETURN;
END;

global
function LongInt ContactVcRecordDefaults(var record ContactVc CTr,record ContactVc CT2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;
  record CustomerSettingBlock CSr;

  BlockLoad(CSr);
  CTr.NoLetterPosting = CSr.NoLetterPosting;
  CTr.NoMailPosting = CSr.NoMailPosting;
  ContactVcRecordDefaults = res; 
  RETURN;
END;

