external function Boolean VATAccIsClosed(string,var string,Integer);
external function Boolean IsVATCodeDefined(string);
external procedure SplitAlphaDigit(string,var string,var LongInt);


global
function LongInt TaxTemplateVcRecordInIndex(record TaxTemplateVc TTr,string indexname)
begin
  LongInt res;
  
  res = 1;
  if (TTr.Closed!=0) then begin 
    if (indexname=="ActCode") then begin res = 0; end;
    if (indexname=="ActComment") then begin res = 0; end;
    if (indexname=="ActTaxID") then begin res = 0; end;
  end;
  TaxTemplateVcRecordInIndex = res;
  return;
end;

global
function LongInt TaxTemplateVcRecordRemoveTest(var record TaxTemplateVc TTr,record TaxTemplateVc TT2r,LongInt long3,LongInt long4)
begin
  LongInt res;
  Boolean testf;

  res = 1;
  if (testf) then begin
    if (long3>0) then begin MessageBox(1122,""); end;
    res = 0;
  end;
LTaxTemplateVcRecordRemoveTest:;
  TaxTemplateVcRecordRemoveTest = res; 
  return;
end;

global
function LongInt TaxTemplateVcRecordDuplicate(var record TaxTemplateVc TTr,record TaxTemplateVc TT2r,LongInt stat,LongInt long4)
begin
  LongInt res;

  TTr.Code = "";
  TaxTemplateVcRecordDuplicate = res; 
  return;
end;

global
function LongInt TaxTemplateVcRecordSave(var record TaxTemplateVc TTr,record TaxTemplateVc TT2r,LongInt stat,LongInt long4)
begin
  LongInt res;

  TaxTemplateVcRecordSave = res; 
  return;
end;

global
function LongInt TaxTemplateVcRecordUpdate(var record TaxTemplateVc TTr,record TaxTemplateVc TT2r,LongInt stat,LongInt long4)
begin
  LongInt res;

  TaxTemplateVcRecordUpdate = res; 
  return;
end;

global
function LongInt TaxTemplateVcRecordCheck(var record TaxTemplateVc TTr,record TaxTemplateVc TT2r,LongInt stat,LongInt calltype)
begin
  LongInt res;
  Boolean runcheckf;
  Integer i,rwcnt;
  row TaxTemplateVc TTrw;
  string 255 tstr;
  
  res = 0;
  if (calltype>0) then begin
    runcheckf = true;
  end else begin
    runcheckf = false;
  end;
  if (blank(TTr.Code)) then begin
    res = -1;
    RecordCheckError(1959,"",-1,"Code");
    goto LTaxTemplateVcRecordCheck;
  end;
  if (runcheckf) then begin
    rwcnt = MatRowCnt(TTr);
    for (i=0;i<rwcnt;i=i+1) begin
      MatRowGet(TTr,i,TTrw);
      if (IsVATCodeDefined(TTrw.VATCode)==false) then begin
        RecordCheckError(1951,"",i,"CredVATCodeEU");      
        res = -1;
        goto LTaxTemplateVcRecordCheck;
      end;
      if (VATAccIsClosed(TTrw.VATCode,tstr,1)) then begin
        RecordCheckError(1258,tstr,i,"CredVATCodeEU");      
        res = -1; 
        goto LTaxTemplateVcRecordCheck;
      end;
    end;
  end;      
LTaxTemplateVcRecordCheck:;
  TaxTemplateVcRecordCheck = res;
  return;
end;
