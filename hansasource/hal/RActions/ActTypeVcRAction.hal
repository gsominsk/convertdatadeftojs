global
function LongInt ActTypeVcRecordCheck(record ActTypeVc ActTyper,record ActTypeVc ActType2r,LongInt stat,LongInt check)
begin
  LongInt res;
  Integer i,rwcnt;
  record INVc INr;
  record ActTypeGrVc ActTypeGrr;
  Boolean testf,gentrans;
  Integer insertmode,updatemode;
  
  res = 0;
  insertmode = 1;//Rs_insert
  updatemode = 2;//Rs_update
  if (nonblank(ActTyper.ItemCode)) then begin
    INr.Code = ActTyper.ItemCode;
    if (ReadFirstMain(INr,1,true)==false) then begin 
      RecordCheckError(1233,"",-1,"ItemCode");      
      res = -1;
      goto LActTypeVcRecordCheck;
    end;
    if (INr.ItemType!=3) then begin
      RecordCheckError(1945,"",-1,"ItemCode");      
      res = -1;
      goto LActTypeVcRecordCheck;
    end;
  end;
  if (nonblank(ActTyper.ActTypeGr)) then begin
    ActTypeGrr.Code = ActTyper.ActTypeGr;
    if (ReadFirstMain(ActTypeGrr,1,true)==false) then begin 
      RecordCheckError(1290,"",-1,"ActTypeGr");      
      res = -1;
      goto LActTypeVcRecordCheck;
    end;
  end;
LActTypeVcRecordCheck:;  
  ActTypeVcRecordCheck = res;
  return;
end;
