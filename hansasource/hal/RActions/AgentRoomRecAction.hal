global
function LongInt AgentRoomVcRecordCheck(record AgentRoomVc r1,record AgentRoomVc r2,LongInt stat,LongInt long4)
BEGIN
  LongInt res;
  Record CUVc CUr;
  Record ResVc Resr;

  res = 0;
  if blank(r1.ResCode) then begin
    RecordCheckError(1058,"",-1,"ResCode");      
    res = -1; 
    goto LAgentRoomVcRecordCheck;
  end;
  if blank(r1.CUCode) then begin
    RecordCheckError(1058,"",-1,"CUCode");      
    res = -1; 
    goto LAgentRoomVcRecordCheck;
  end;
  CUr.Code = r1.CUCode;
  if not readfirstmain(CUr,1,true) then begin
    RecordCheckError(1290,"",-1,"CUCode");      
    res = -1; 
    goto LAgentRoomVcRecordCheck;
  end;
  Resr.Code = r1.ResCode;
  if not readfirstmain(Resr,1,true) then begin
    RecordCheckError(1290,"",-1,"ResCode");      
    res = -1; 
    goto LAgentRoomVcRecordCheck;
  end;
LAgentRoomVcRecordCheck:; 
  AgentRoomVcRecordCheck = res;
  RETURN;
END;

