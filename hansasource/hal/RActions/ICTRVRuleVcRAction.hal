external procedure NormalizeObjstr(var string);

global
function LongInt ICTRuleVcRecordDefaults(var record ICTRuleVc ICTRr,record ICTRuleVc ICTR2r,LongInt stat,LongInt long4)
begin
  ICTRr.SerNr = -1;
  ICTRuleVcRecordDefaults = 0;
  return;
end;

global
function LongInt ICTRuleVcRecordDuplicate(var record ICTRuleVc ICTRr,record ICTRuleVc ICTR2r,LongInt stat,LongInt long4)
begin
  ICTRr.SerNr = -1;  
  ICTRuleVcRecordDuplicate = 0;
  return;
end;

global
function LongInt ICTRuleVcRecordCheck(var record ICTRuleVc ICTRr,record ICTRuleVc ICTR2r,LongInt stat,LongInt long4)
begin
  LongInt res;
  string 255 tstr;

  res = 0;
  if (ICTRr.ToCompany<=0) then begin
    RecordCheckError(1058,"",-1,"ToCompany");
    res = -1; 
    goto LICTRuleVcRecordCheck;
  end;
  if (blank(ICTRr.CorAccNumber)) then begin
    RecordCheckError(1058,"",-1,"CorAccNumber");
    res = -1; 
    goto LICTRuleVcRecordCheck;
  end;
  tstr = ICTRr.Objects;
  NormalizeObjstr(tstr);
  ICTRr.Objects = tstr;

  tstr = ICTRr.ToObjects;
  NormalizeObjstr(tstr);
  ICTRr.ToObjects = tstr;

  tstr = ICTRr.CorObjects;
  NormalizeObjstr(tstr);
  ICTRr.CorObjects = tstr;
  
  if (ICTRr.SerNr<=0) then begin
    ICTRr.SerNr = NextSerNr("ICTRuleVc",CurrentDate,-1,false,"");
  end;
LICTRuleVcRecordCheck:;  
  ICTRuleVcRecordCheck = res;
  return;
end;

