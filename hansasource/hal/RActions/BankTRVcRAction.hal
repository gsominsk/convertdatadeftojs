global
function LongInt BankTRVcRecordDefaults(var record BankTRVc BankTRr,record BankTRVc BankTR2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;

  BankTRr.Invalid = 0;
  BankTRVcRecordDefaults = res; 
  RETURN;
END;

global
function LongInt BankTRVcRecordDuplicate(var record BankTRVc BankTRr,record BankTRVc BankTR2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;

  BankTRr.Invalid = 0;
  BankTRVcRecordDuplicate = res; 
  RETURN;
END;

global
function LongInt BankTRVcRecordRemoveTest(var record BankTRVc BankTRr,record BankTRVc BankTR2r,LongInt long3,LongInt globalf)
BEGIN
  LongInt res;

  res = 0;
LBankTRVcRecordRemoveTest:;
  BankTRVcRecordRemoveTest = res; 
  RETURN;
END;

global
function LongInt BankTRVcRecordCheck(var record BankTRVc BankTRr,record BankTRVc BankTR2r,LongInt stat,LongInt long4)
BEGIN
  LongInt res;
  string 255 tstr;

  res = 0;
 if (BankTRr.SerNr<=0) then begin
    BankTRr.SerNr = NextSerNr("BankTRVc",BankTRr.TransDate,-1,false,"");
  end;
LBankTRVcRecordCheck:; 
  BankTRVcRecordCheck = res;
  RETURN;
END;

global
function LongInt BankTRVcRecordInvalidateTest(var record BankTRVc BankTRr,record BankTRVc BankTR2r,LongInt long3,LongInt long4)
BEGIN
  LongInt res;
  
  res = 1;
  if (UserCanAction("BankTRInvalid",true)==false) then begin
    res = 0;
    MessageBox(34500,"");
    goto LBankTRVcRecordInvalidateTest;
  end;
  if (BankTRr.Invalid!=0) then begin
    res = 0;
    goto LBankTRVcRecordInvalidateTest;
  end;
  BankTRr.Invalid = 1;
LBankTRVcRecordInvalidateTest:;
  BankTRVcRecordInvalidateTest = res;  
  RETURN;
END;

global
updating procedure UpdateBankTRFromIP(record IPVc IPr)
begin
  Boolean found;
  record BankTRVc BankTRr;
  record BankTRVc oldBankTRr;
  
  found = true;
  BankTRr.FileName = "IPVc";
  BankTRr.TransNr = IPr.SerNr;
  while (LoopKey("FileName",BankTRr,2,found)) begin
    if (BankTRr.FileName!="IPVc") then begin found = false; end;
    if (BankTRr.TransNr!=IPr.SerNr) then begin found = false; end;
    if (found) then begin
      RecordCopy(oldBankTRr,BankTRr);
      BankTRr.FileName = "";
      BankTRr.TransNr = -1;
      RecordUpdate(oldBankTRr,BankTRr,false);
      StepBack(BankTRr);
    end;
  end;
  return;
end;