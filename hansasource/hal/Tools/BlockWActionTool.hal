external function Boolean VATCodeExists(string);
external function Boolean IsControlAccount(string,Boolean,Boolean);

global
function Integer AccTClassOnOKWindowRemote(record AccBlock ARAccb,var string accstr,var string fieldgoto)
begin
  record AccVc Accr;  
  Integer err;
  record TaxTemplateVc TTr;

  accstr = "";
  fieldgoto = "";
  if (nonblank(ARAccb.ARAcc)) then begin
    Accr.AccNumber = ARAccb.ARAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.ARAcc;
      fieldgoto = "ARAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.ARAcc;
      fieldgoto = "ARAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if (ARAccb.SLAccTest!=0) then begin
      if (IsControlAccount(ARAccb.ARAcc,true,true)==false) then begin
        err = 1082;
        fieldgoto = "ARAcc";
        goto LAccTClassOnOKWindowRemote;
      end;
    end;
  end;
  if (nonblank(ARAccb.BadARAcc)) then begin
    Accr.AccNumber = ARAccb.BadARAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.BadARAcc;
      fieldgoto = "BadARAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.BadARAcc;
      fieldgoto = "BadARAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;  
  if (nonblank(ARAccb.CashAcc)) then begin
    Accr.AccNumber = ARAccb.CashAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.CashAcc;
      fieldgoto = "CashAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.CashAcc;
      fieldgoto = "CashAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.ERebAcc)) then begin
    Accr.AccNumber = ARAccb.ERebAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.ERebAcc;
      fieldgoto = "ERebAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.ERebAcc;
      fieldgoto = "ERebAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.EUERebAcc)) then begin
    Accr.AccNumber = ARAccb.EUERebAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.EUERebAcc;
      fieldgoto = "EUERebAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.EUERebAcc;
      fieldgoto = "EUERebAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.ExpERebAcc)) then begin
    Accr.AccNumber = ARAccb.ExpERebAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.ExpERebAcc;
      fieldgoto = "ExpERebAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.ExpERebAcc;
      fieldgoto = "ExpERebAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.CashBackAcc)) then begin
    Accr.AccNumber = ARAccb.CashBackAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.CashBackAcc;
      fieldgoto = "CashBackAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.CashBackAcc;
      fieldgoto = "CashBackAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.OnAccAcc)) then begin
    Accr.AccNumber = ARAccb.OnAccAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.OnAccAcc;
      fieldgoto = "OnAccAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.OnAccAcc;
      fieldgoto = "OnAccAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.RndAcc)) then begin
    Accr.AccNumber = ARAccb.RndAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.RndAcc;
      fieldgoto = "RndAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.RndAcc;
      fieldgoto = "RndAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.RndLossAcc)) then begin
    Accr.AccNumber = ARAccb.RndLossAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.RndLossAcc;
      fieldgoto = "RndLossAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.RndLossAcc;
      fieldgoto = "RndLossAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.CommisionAcc)) then begin
    Accr.AccNumber = ARAccb.CommisionAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.CommisionAcc;
      fieldgoto = "CommisionAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.CommisionAcc;
      fieldgoto = "CommisionAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.DiscountAcc)) then begin
    Accr.AccNumber = ARAccb.DiscountAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.DiscountAcc;
      fieldgoto = "DiscountAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.DiscountAcc;
      fieldgoto = "DiscountAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.VATBAcc)) then begin
    Accr.AccNumber = ARAccb.VATBAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.VATBAcc;
      fieldgoto = "VATBAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.VATBAcc;
      fieldgoto = "VATBAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.VATERAcc)) then begin
    Accr.AccNumber = ARAccb.VATERAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.VATERAcc;
      fieldgoto = "VATERAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.VATERAcc;
      fieldgoto = "VATERAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;  
  if (nonblank(ARAccb.OnAccVATAcc)) then begin
    Accr.AccNumber = ARAccb.OnAccVATAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.OnAccVATAcc;
      fieldgoto = "OnAccVATAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.OnAccVATAcc;
      fieldgoto = "OnAccVATAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.PreIPVATAcc)) then begin
    Accr.AccNumber = ARAccb.PreIPVATAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.PreIPVATAcc;
      fieldgoto = "PreIPVATAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.PreIPVATAcc;
      fieldgoto = "PreIPVATAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.SalesVAT)) then begin
    Accr.AccNumber = ARAccb.SalesVAT;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.SalesVAT;
      fieldgoto = "SalesVAT";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.SalesVAT;
      fieldgoto = "SalesVAT";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.SalesTAX)) then begin
    Accr.AccNumber = ARAccb.SalesTAX;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.SalesTAX;
      fieldgoto = "SalesTAX";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.SalesTAX;
      fieldgoto = "SalesTAX";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.IntARAcc)) then begin
    Accr.AccNumber = ARAccb.IntARAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.IntARAcc;
      fieldgoto = "IntARAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.IntARAcc;
      fieldgoto = "IntARAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.Tax1TmpAcc)) then begin
    Accr.AccNumber = ARAccb.Tax1TmpAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.Tax1TmpAcc;
      fieldgoto = "Tax1TmpAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.Tax1TmpAcc;
      fieldgoto = "Tax1TmpAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.CredAcc)) then begin
    Accr.AccNumber = ARAccb.CredAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.CredAcc;
      fieldgoto = "CredAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.CredAcc;
      fieldgoto = "CredAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.WriteOffLossAcc)) then begin
    Accr.AccNumber = ARAccb.WriteOffLossAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.WriteOffLossAcc;
      fieldgoto = "WriteOffLossAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.WriteOffLossAcc;
      fieldgoto = "WriteOffLossAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.RateRndOffAcc)) then begin
    Accr.AccNumber = ARAccb.RateRndOffAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.RateRndOffAcc;
      fieldgoto = "RateRndOffAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.RateRndOffAcc;
      fieldgoto = "RateRndOffAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.EMURndOffAcc)) then begin
    Accr.AccNumber = ARAccb.EMURndOffAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.EMURndOffAcc;
      fieldgoto = "EMURndOffAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.EMURndOffAcc;
      fieldgoto = "EMURndOffAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.EMUWriteOffAcc)) then begin
    Accr.AccNumber = ARAccb.EMUWriteOffAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.EMUWriteOffAcc;
      fieldgoto = "EMUWriteOffAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.EMUWriteOffAcc;
      fieldgoto = "EMUWriteOffAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.BaseRoundOffAcc)) then begin
    Accr.AccNumber = ARAccb.BaseRoundOffAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.BaseRoundOffAcc;
      fieldgoto = "BaseRoundOffAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.BaseRoundOffAcc;
      fieldgoto = "BaseRoundOffAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end else begin
//CheckTrans uses this account if diffrence in 2nd base currency
//if this is blank we have nonbalanced transaction
/*
we decided to move it to another place, CheckTrans
    err = 20027;
    fieldgoto = "BaseRoundOffAcc";
    goto LAccTClassOnOKWindowRemote;
*/    
  end;
  if (nonblank(ARAccb.RateGainAcc)) then begin
    Accr.AccNumber = ARAccb.RateGainAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.RateGainAcc;
      fieldgoto = "RateGainAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.RateGainAcc;
      fieldgoto = "RateGainAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.RateLossAcc)) then begin
    Accr.AccNumber = ARAccb.RateLossAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.RateLossAcc;
      fieldgoto = "RateLossAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.RateLossAcc;
      fieldgoto = "RateLossAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.BankRateGainAcc)) then begin
    Accr.AccNumber = ARAccb.BankRateGainAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.BankRateGainAcc;
      fieldgoto = "BankRateGainAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.BankRateGainAcc;
      fieldgoto = "BankRateGainAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.BankRateLossAcc)) then begin
    Accr.AccNumber = ARAccb.BankRateLossAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.BankRateLossAcc;
      fieldgoto = "BankRateLossAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.CashBackAcc;
      fieldgoto = "CashBackAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.ExtraCostAcc)) then begin
    Accr.AccNumber = ARAccb.ExtraCostAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.ExtraCostAcc;
      fieldgoto = "ExtraCostAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.ExtraCostAcc;
      fieldgoto = "ExtraCostAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.DomSalesAcc)) then begin
    Accr.AccNumber = ARAccb.DomSalesAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.DomSalesAcc;
      fieldgoto = "DomSalesAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.DomSalesAcc;
      fieldgoto = "DomSalesAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.EUSalesAcc)) then begin
    Accr.AccNumber = ARAccb.EUSalesAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.EUSalesAcc;
      fieldgoto = "EUSalesAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.EUSalesAcc;
      fieldgoto = "EUSalesAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.ExpSalesAcc)) then begin
    Accr.AccNumber = ARAccb.ExpSalesAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.ExpSalesAcc;
      fieldgoto = "ExpSalesAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.ExpSalesAcc;
      fieldgoto = "ExpSalesAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.VATCodeDom)) then begin
    if (VATCodeExists(ARAccb.VATCodeDom)==false) then begin
      err = 1120;
      accstr = ARAccb.VATCodeDom;
      fieldgoto = "VATCodeDom";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.VATCodeDom;
      fieldgoto = "VATCodeDom";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.VATCodeEU)) then begin
    if (VATCodeExists(ARAccb.VATCodeEU)==false) then begin
      err = 1120;
      accstr = ARAccb.VATCodeEU;
      fieldgoto = "VATCodeEU";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.VATCodeEU;
      fieldgoto = "VATCodeEU";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.VATCodeExp)) then begin
    if (VATCodeExists(ARAccb.VATCodeExp)==false) then begin
      err = 1120;
      accstr = ARAccb.VATCodeExp;
      fieldgoto = "VATCodeExp";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.VATCodeExp;
      fieldgoto = "VATCodeExp";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;  
  if (nonblank(ARAccb.CredDomSalesAcc)) then begin
    Accr.AccNumber = ARAccb.CredDomSalesAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.CredDomSalesAcc;
      fieldgoto = "CredDomSalesAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.CredDomSalesAcc;
      fieldgoto = "CredDomSalesAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.CredEUSalesAcc)) then begin
    Accr.AccNumber = ARAccb.CredEUSalesAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.CredEUSalesAcc;
      fieldgoto = "CredEUSalesAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.CredEUSalesAcc;
      fieldgoto = "CredEUSalesAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.CredExpSalesAcc)) then begin
    Accr.AccNumber = ARAccb.CredExpSalesAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.CredExpSalesAcc;
      fieldgoto = "CredExpSalesAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.CredExpSalesAcc;
      fieldgoto = "CredExpSalesAcc";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.CredVATCodeDom)) then begin
    if (VATCodeExists(ARAccb.CredVATCodeDom)==false) then begin
      err = 1120;
      accstr = ARAccb.CredVATCodeDom;
      fieldgoto = "CredVATCodeDom";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.CredVATCodeDom;
      fieldgoto = "CredVATCodeDom";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;  
  if (nonblank(ARAccb.CredVATCodeEU)) then begin
    if (VATCodeExists(ARAccb.CredVATCodeEU)==false) then begin
      err = 1120;
      accstr = ARAccb.CredVATCodeEU;
      fieldgoto = "CredVATCodeEU";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.CredVATCodeEU;
      fieldgoto = "CredVATCodeEU";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;  
  if (nonblank(ARAccb.CredVATCodeExp)) then begin
    if (VATCodeExists(ARAccb.CredVATCodeExp)==false) then begin
      err = 1120;
      accstr = ARAccb.CredVATCodeExp;
      fieldgoto = "CredVATCodeExp";
      goto LAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.CredVATCodeExp;
      fieldgoto = "CredVATCodeExp";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;  
  if (nonblank(ARAccb.TaxTemplateCode)) then begin
    TTr.Code = ARAccb.TaxTemplateCode;
    if (ReadFirstMain(TTr,1,true)==false) then begin
      err = 1084;
      accstr = ARAccb.TaxTemplateCode;
      fieldgoto = "TaxTemplateCode";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.TaxTemplateCodeEU)) then begin
    TTr.Code = ARAccb.TaxTemplateCodeEU;
    if (ReadFirstMain(TTr,1,true)==false) then begin
      err = 1084;
      accstr = ARAccb.TaxTemplateCodeEU;
      fieldgoto = "TaxTemplateCodeEU";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.TaxTemplateCodeExp)) then begin
    TTr.Code = ARAccb.TaxTemplateCodeExp;
    if (ReadFirstMain(TTr,1,true)==false) then begin
      err = 1084;
      accstr = ARAccb.TaxTemplateCodeExp;
      fieldgoto = "TaxTemplateCodeExp";
      goto LAccTClassOnOKWindowRemote;
    end;
  end;
LAccTClassOnOKWindowRemote:;  
  AccTClassOnOKWindowRemote = err;
  return;
end;

global
function Integer INAccTClassOnOKWindowRemote(record AccBlock ARAccb,var string accstr,var string fieldgoto)
begin
  record AccVc Accr;  
  Integer err;

  accstr = "";
  fieldgoto = "";
  if (nonblank(ARAccb.StockAcc)) then begin
    Accr.AccNumber = ARAccb.StockAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.StockAcc;
      fieldgoto = "StockAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.StockAcc;
      fieldgoto = "StockAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.StockGainAcc)) then begin
    Accr.AccNumber = ARAccb.StockGainAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.StockGainAcc;
      fieldgoto = "StockGainAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.StockGainAcc;
      fieldgoto = "StockGainAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.StockLossAcc)) then begin
    Accr.AccNumber = ARAccb.StockLossAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.StockLossAcc;
      fieldgoto = "StockLossAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.StockLossAcc;
      fieldgoto = "StockLossAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.StockCostAcc)) then begin
    Accr.AccNumber = ARAccb.StockCostAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.StockCostAcc;
      fieldgoto = "StockCostAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.StockCostAcc;
      fieldgoto = "StockCostAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.EUStockCostAcc)) then begin
    Accr.AccNumber = ARAccb.EUStockCostAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.EUStockCostAcc;
      fieldgoto = "EUStockCostAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.EUStockCostAcc;
      fieldgoto = "EUStockCostAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.ExpStockCostAcc)) then begin
    Accr.AccNumber = ARAccb.ExpStockCostAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.ExpStockCostAcc;
      fieldgoto = "ExpStockCostAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.ExpStockCostAcc;
      fieldgoto = "ExpStockCostAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.INTransferAcc)) then begin
    Accr.AccNumber = ARAccb.INTransferAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.INTransferAcc;
      fieldgoto = "INTransferAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.INTransferAcc;
      fieldgoto = "INTransferAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.ProdICostAcc)) then begin
    Accr.AccNumber = ARAccb.ProdICostAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.ProdICostAcc;
      fieldgoto = "ProdICostAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.ProdICostAcc;
      fieldgoto = "ProdICostAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.ProdWCostAcc)) then begin
    Accr.AccNumber = ARAccb.ProdWCostAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.ProdWCostAcc;
      fieldgoto = "ProdWCostAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.ProdWCostAcc;
      fieldgoto = "ProdWCostAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.DiscardedAccount)) then begin
    Accr.AccNumber = ARAccb.DiscardedAccount;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.DiscardedAccount;
      fieldgoto = "DiscardedAccount";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.DiscardedAccount;
      fieldgoto = "DiscardedAccount";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.ReturnedAcc)) then begin
    Accr.AccNumber = ARAccb.ReturnedAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.ReturnedAcc;
      fieldgoto = "ReturnedAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.ReturnedAcc;
      fieldgoto = "ReturnedAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.RetPUAcc)) then begin
    Accr.AccNumber = ARAccb.RetPUAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.RetPUAcc;
      fieldgoto = "RetPUAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.RetPUAcc;
      fieldgoto = "RetPUAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.ConsigStockAcc)) then begin
    Accr.AccNumber = ARAccb.ConsigStockAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.ConsigStockAcc;
      fieldgoto = "ConsigStockAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.ConsigStockAcc;
      fieldgoto = "ConsigStockAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.PurchAcc)) then begin
    Accr.AccNumber = ARAccb.PurchAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.PurchAcc;
      fieldgoto = "PurchAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.PurchAcc;
      fieldgoto = "PurchAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.EUPurchAcc)) then begin
    Accr.AccNumber = ARAccb.EUPurchAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.EUPurchAcc;
      fieldgoto = "EUPurchAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.EUPurchAcc;
      fieldgoto = "EUPurchAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.ExpPurchAcc)) then begin
    Accr.AccNumber = ARAccb.ExpPurchAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.ExpPurchAcc;
      fieldgoto = "ExpPurchAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.ExpPurchAcc;
      fieldgoto = "ExpPurchAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.PUFreightAcc)) then begin
    Accr.AccNumber = ARAccb.PUFreightAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.PUFreightAcc;
      fieldgoto = "PUFreightAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.PUFreightAcc;
      fieldgoto = "PUFreightAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.PUCustomsAcc)) then begin
    Accr.AccNumber = ARAccb.PUCustomsAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.PUCustomsAcc;
      fieldgoto = "PUCustomsAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.PUCustomsAcc;
      fieldgoto = "PUCustomsAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.PUExtraAcc)) then begin
    Accr.AccNumber = ARAccb.PUExtraAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.PUExtraAcc;      
      fieldgoto = "PUExtraAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.PUExtraAcc;
      fieldgoto = "PUExtraAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.PUCost1)) then begin
    Accr.AccNumber = ARAccb.PUCost1;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.PUCost1;      
      fieldgoto = "PUCost1";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.PUCost1;
      fieldgoto = "PUCost1";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.PUCost2)) then begin
    Accr.AccNumber = ARAccb.PUCost2;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.PUCost2;      
      fieldgoto = "PUCost2";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.PUCost2;
      fieldgoto = "PUCost2";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.PUCost3)) then begin
    Accr.AccNumber = ARAccb.PUCost3;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.PUCost3;      
      fieldgoto = "PUCost3";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.PUCost3;
      fieldgoto = "PUCost3";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.PUCost4)) then begin
    Accr.AccNumber = ARAccb.PUCost4;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.PUCost4;      
      fieldgoto = "PUCost4";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.PUCost4;
      fieldgoto = "PUCost4";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.PUCost5)) then begin
    Accr.AccNumber = ARAccb.PUCost5;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.PUCost5;      
      fieldgoto = "PUCost5";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.PUCost5;
      fieldgoto = "PUCost5";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.ConsigPurchAcc)) then begin
    Accr.AccNumber = ARAccb.ConsigPurchAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.ConsigPurchAcc;      
      fieldgoto = "ConsigPurchAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.ConsigPurchAcc;
      fieldgoto = "ConsigPurchAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.BBVarAcc)) then begin
    Accr.AccNumber = ARAccb.BBVarAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.BBVarAcc;      
      fieldgoto = "BBVarAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.BBVarAcc;
      fieldgoto = "BBVarAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.ItemPriceVar)) then begin
    Accr.AccNumber = ARAccb.ItemPriceVar;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.ItemPriceVar;      
      fieldgoto = "ItemPriceVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.ItemPriceVar;
      fieldgoto = "ItemPriceVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.FreightPriceVar)) then begin
    Accr.AccNumber = ARAccb.FreightPriceVar;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.FreightPriceVar;      
      fieldgoto = "FreightPriceVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.FreightPriceVar;
      fieldgoto = "FreightPriceVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.CustomsPriceVar)) then begin
    Accr.AccNumber = ARAccb.CustomsPriceVar;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.CustomsPriceVar;      
      fieldgoto = "CustomsPriceVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.CustomsPriceVar;
      fieldgoto = "CustomsPriceVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.Cost1PriceVar)) then begin
    Accr.AccNumber = ARAccb.Cost1PriceVar;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.Cost1PriceVar;      
      fieldgoto = "Cost1PriceVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.Cost1PriceVar;
      fieldgoto = "Cost1PriceVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.Cost2PriceVar)) then begin
    Accr.AccNumber = ARAccb.Cost2PriceVar;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.Cost2PriceVar;      
      fieldgoto = "Cost2PriceVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.Cost2PriceVar;
      fieldgoto = "Cost2PriceVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.Cost3PriceVar)) then begin
    Accr.AccNumber = ARAccb.Cost3PriceVar;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.Cost3PriceVar;      
      fieldgoto = "Cost3PriceVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.Cost3PriceVar;
      fieldgoto = "Cost3PriceVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.Cost4PriceVar)) then begin
    Accr.AccNumber = ARAccb.Cost4PriceVar;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.Cost4PriceVar;      
      fieldgoto = "Cost4PriceVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.Cost4PriceVar;
      fieldgoto = "Cost4PriceVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.Cost5PriceVar)) then begin
    Accr.AccNumber = ARAccb.Cost5PriceVar;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.Cost5PriceVar;      
      fieldgoto = "Cost5PriceVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.Cost5PriceVar;
      fieldgoto = "Cost5PriceVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.SRVarAcc)) then begin
    Accr.AccNumber = ARAccb.SRVarAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.SRVarAcc;      
      fieldgoto = "SRVarAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.SRVarAcc;
      fieldgoto = "SRVarAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.InPriceVarAcc)) then begin
    Accr.AccNumber = ARAccb.InPriceVarAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.InPriceVarAcc;      
      fieldgoto = "InPriceVarAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.InPriceVarAcc;
      fieldgoto = "InPriceVarAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.RetPUVar)) then begin
    Accr.AccNumber = ARAccb.RetPUVar;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.RetPUVar;      
      fieldgoto = "RetPUVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.RetPUVar;
      fieldgoto = "RetPUVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.DisassembleProdVar)) then begin
    Accr.AccNumber = ARAccb.DisassembleProdVar;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.DisassembleProdVar;
      fieldgoto = "DisassembleProdVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.DisassembleProdVar;
      fieldgoto = "DisassembleProdVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.DropSHVar)) then begin
    Accr.AccNumber = ARAccb.DropSHVar;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.DropSHVar;
      fieldgoto = "DropSHVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.DropSHVar;
      fieldgoto = "DropSHVar";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(ARAccb.DropShipCOSAccrualAcc)) then begin
    Accr.AccNumber = ARAccb.DropShipCOSAccrualAcc;
    if (ReadFirstMain(Accr,1,true)==false) then begin
      err = 1007;
      accstr = ARAccb.DropShipCOSAccrualAcc;
      fieldgoto = "DropShipCOSAccrualAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
    if ((Accr.blockedFlag!=0) or (Accr.GroupAcc!=0)) then begin
      err = 1084;
      accstr = ARAccb.DropShipCOSAccrualAcc;
      fieldgoto = "DropShipCOSAccrualAcc";
      goto LINAccTClassOnOKWindowRemote;
    end;
  end;
LINAccTClassOnOKWindowRemote:;  
  INAccTClassOnOKWindowRemote = err;
  return;
end;

global
function Integer APAccTClassOnOKWindowRemote(record APAccBlock APAccb,var string accstr,var string fieldgoto)
begin
  record AccVc Accr;  
  Integer err;
  record TaxTemplateVc TTr;

  accstr = "";
  fieldgoto = "";
  if (nonblank(APAccb.TaxTemplateCode)) then begin
    TTr.Code = APAccb.TaxTemplateCode;
    if (ReadFirstMain(TTr,1,true)==false) then begin
      accstr = APAccb.TaxTemplateCode;
      fieldgoto = "TaxTemplateCode";
      err = 1084;
      goto LAPAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(APAccb.TaxTemplateCodeEU)) then begin
    TTr.Code = APAccb.TaxTemplateCodeEU;
    if (ReadFirstMain(TTr,1,true)==false) then begin
      accstr = APAccb.TaxTemplateCodeEU;
      fieldgoto = "TaxTemplateCodeEU";
      err = 1084;
      goto LAPAccTClassOnOKWindowRemote;
    end;
  end;
  if (nonblank(APAccb.TaxTemplateCodeExp)) then begin
    TTr.Code = APAccb.TaxTemplateCodeExp;
    if (ReadFirstMain(TTr,1,true)==false) then begin
      accstr = APAccb.TaxTemplateCodeExp;
      fieldgoto = "TaxTemplateCodeExp";
      err = 1084;
      goto LAPAccTClassOnOKWindowRemote;
    end;
  end;
LAPAccTClassOnOKWindowRemote:;  
  APAccTClassOnOKWindowRemote = err;
  return;
end;

global
function LongInt WHTaxTClassOnOKWindowRemote(record WHTaxBlock WHTaxb,var string accstr,var string fieldgoto,var integer rw)
begin
  LongInt res;
  row WHTaxBlock WHTaxrw;
  record APAccBlock APb;
  Integer i,rwcnt;
  
  res = 0;
  BlockLoad(APb);
  if (APb.PMControlWithTax==1) then begin 
    rwcnt = MatRowCnt(WHTaxb);
    for (i=0;i<rwcnt;i=i+1) begin
      MatRowGet(WHTaxb,i,WHTaxrw);
      if blank(WHTaxrw.PayMode) then begin 
        fieldgoto = "PayMode";
        res = 28702;
        rw = i;
        goto LWHTaxTClassOnOKWindowRemote;
      end;
    end;
  end;
LWHTaxTClassOnOKWindowRemote:;     
  WHTaxTClassOnOKWindowRemote = res;
  return;
end;  
