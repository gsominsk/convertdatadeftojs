external function Boolean ReadFirstItem(string,var record INVc,Boolean,Boolean);

global
procedure RemoveInvalidVarietyItemAfterPasting_RecVc(var record RecVc Recr,var integer rwcnt)
begin
  integer i,ri;
  record INVc INr;
  row RecVc Recrw;

  for (ri=0;ri<rwcnt;ri=ri+1) begin
    MatRowGet(Recr,ri,Recrw);
    if (blank(Recrw.Item) and blank(Recrw.InQty) and blank(Recrw.OutQty) and blank(Recrw.Comment)) then begin
      MatRowDelete(Recr,ri);
      rwcnt = MatRowCnt(Recr);
    end;
  end;
end;

global
procedure RemoveInvalidVarietyItemAfterPasting_ProdVc(var record ProdVc Prodr,var integer rwcnt)
begin
  integer i,ri;
  record INVc INr;
  row ProdVc Prodrw;

  for (ri=0;ri<rwcnt;ri=ri+1) begin
    MatRowGet(Prodr,ri,Prodrw);
    if (blank(Prodrw.Item) and blank(Prodrw.InQty) and blank(Prodrw.OutQty) and blank(Prodrw.Comment)) then begin
      MatRowDelete(Prodr,ri);
      rwcnt = MatRowCnt(Prodr);
    end;
  end;
end;

global
procedure RemoveInvalidVarietyItemAfterPasting_ORVc(var record ORVc ORr,var integer rwcnt)
begin
  integer i,ri;
  record INVc INr;
  row ORVc ORrw;

  for (ri=0;ri<rwcnt;ri=ri+1) begin
    MatRowGet(ORr,ri,ORrw);
    if (blank(ORrw.ArtCode) and blank(ORrw.Quant) and blank(ORrw.Spec)) then begin
      MatRowDelete(ORr,ri);
      rwcnt = MatRowCnt(ORr);
    end;
  end;
end;

global
procedure RemoveInvalidVarietyItemAfterPasting_IVVc(var record IVVc IVr,var integer rwcnt)
begin
  integer i,ri;
  record INVc INr;
  row IVVc IVrw;

  for (ri=0;ri<rwcnt;ri=ri+1) begin
    MatRowGet(IVr,ri,IVrw);
    if (blank(IVrw.ArtCode) and blank(IVrw.Quant) and blank(IVrw.Spec)) then begin
      MatRowDelete(IVr,ri);
      rwcnt = MatRowCnt(IVr);
    end;
  end;
end;

global
procedure RemoveInvalidVarietyItemAfterPasting_IVCashVc(var record IVCashVc IVCashr,var integer rwcnt)
begin
  integer i,ri;
  record INVc INr;
  row IVCashVc IVCashrw;

  for (ri=0;ri<rwcnt;ri=ri+1) begin
    MatRowGet(IVCashr,ri,IVCashrw);
    if (blank(IVCashrw.ArtCode) and blank(IVCashrw.Quant) and blank(IVCashrw.Spec)) then begin
      MatRowDelete(IVCashr,ri);
      rwcnt = MatRowCnt(IVCashr);
    end;
  end;
end;

global
procedure RemoveInvalidVarietyItemAfterPasting_StockMovVc(var record StockMovVc StockMovr,var integer rwcnt)
begin
  integer i,ri;
  record INVc INr;
  row StockMovVc StockMovrw;

  for (ri=0;ri<rwcnt;ri=ri+1) begin
    MatRowGet(StockMovr,ri,StockMovrw);
    if (blank(StockMovrw.ArtCode) and blank(StockMovrw.Quant) and blank(StockMovrw.Spec)) then begin
      MatRowDelete(StockMovr,ri);
      rwcnt = MatRowCnt(StockMovr);
    end;
  end;
end;

global
procedure RemoveInvalidVarietyItemAfterPasting_StockTakeVc(var record StockTakeVc StockTaker,var integer rwcnt)
begin
  integer i,ri;
  record INVc INr;
  row StockTakeVc StockTakerw;

  for (ri=0;ri<rwcnt;ri=ri+1) begin
    MatRowGet(StockTaker,ri,StockTakerw);
    if (blank(StockTakerw.ArtCode) and blank(StockTakerw.Qty) and blank(StockTakerw.Spec)) then begin
      MatRowDelete(StockTaker,ri);
      rwcnt = MatRowCnt(StockTaker);
    end;
  end;
end;

global
procedure RemoveInvalidVarietyItemAfterPasting_QTVc(var record QTVc QTr,var integer rwcnt)
begin
  integer i,ri;
  record INVc INr;
  row QTVc QTrw;

  for (ri=0;ri<rwcnt;ri=ri+1) begin
    MatRowGet(QTr,ri,QTrw);
    if (blank(QTrw.ArtCode) and blank(QTrw.Quant) and blank(QTrw.Spec)) then begin
      MatRowDelete(QTr,ri);
      rwcnt = MatRowCnt(QTr);
    end;
  end;
end;

global
procedure RemoveInvalidVarietyItemAfterPasting_PUVc(var record PUVc PUr,var integer rwcnt)
begin
  integer i,ri;
  record INVc INr;
  row PUVc PUrw;

  for (ri=0;ri<rwcnt;ri=ri+1) begin
    MatRowGet(PUr,ri,PUrw);
    if (blank(PUrw.ArtCode) and blank(PUrw.Quant) and blank(PUrw.Spec)) then begin
      MatRowDelete(PUr,ri);
      rwcnt = MatRowCnt(PUr);
    end;
  end;
end;

global
procedure RemoveInvalidVarietyItemAfterPasting_POVc(var record POVc POr,var integer rwcnt)
begin
  integer i,ri;
  record INVc INr;
  row POVc POrw;

  for (ri=0;ri<rwcnt;ri=ri+1) begin
    MatRowGet(POr,ri,POrw);
    if (blank(POrw.ArtCode) and blank(POrw.Quant) and blank(POrw.Spec)) then begin
      MatRowDelete(POr,ri);
      rwcnt = MatRowCnt(POr);
    end;
  end;
end;

global
procedure RemoveInvalidVarietyItemAfterPasting_IntORVc(var record IntORVc IntORr,var integer rwcnt)
begin
  integer i,ri;
  record INVc INr;
  row IntORVc IntORrw;

  for (ri=0;ri<rwcnt;ri=ri+1) begin
    MatRowGet(IntORr,ri,IntORrw);
    if (blank(IntORrw.ArtCode) and blank(IntORrw.Quant) and blank(IntORrw.Spec)) then begin
      MatRowDelete(IntORr,ri);
      rwcnt = MatRowCnt(IntORr);
    end;
  end;
end;

global
procedure RemoveInvalidVarietyItemAfterPasting_POQTVc(var record POQTVc POQTr,var integer rwcnt)
begin
  integer i,ri;
  record INVc INr;
  row POQTVc POQTrw;

  for (ri=0;ri<rwcnt;ri=ri+1) begin
    MatRowGet(POQTr,ri,POQTrw);
    if (blank(POQTrw.ArtCode) and blank(POQTrw.Quant) and blank(POQTrw.Spec)) then begin
      MatRowDelete(POQTr,ri);
      rwcnt = MatRowCnt(POQTr);
    end;
  end;
end;

global
procedure RemoveInvalidVarietyItemAfterPasting_SDVc(var record SDVc SDr,var integer rwcnt)
begin
  integer i,ri;
  record INVc INr;
  row SDVc SDrw;

  for (ri=0;ri<rwcnt;ri=ri+1) begin
    MatRowGet(SDr,ri,SDrw);
    if (blank(SDrw.ArtCode) and blank(SDrw.Qty) and blank(SDrw.Spec)) then begin
      MatRowDelete(SDr,ri);
      rwcnt = MatRowCnt(SDr);
    end;
  end;
end;

global
procedure RemoveInvalidVarietyItemAfterPasting_SRVc(var record SRVc SRr,var integer rwcnt)
begin
  integer i,ri;
  record INVc INr;
  row SRVc SRrw;

  for (ri=0;ri<rwcnt;ri=ri+1) begin
    MatRowGet(SRr,ri,SRrw);
    if (blank(SRrw.ArtCode) and blank(SRrw.Qty) and blank(SRrw.Spec)) then begin
      MatRowDelete(SRr,ri);
      rwcnt = MatRowCnt(SRr);
    end;
  end;
end;

global
procedure RemoveInvalidVarietyItems_IVCashVc(var record IVCashVc IVCashr,var integer rwcnt)
begin
  integer i,ri;
  record INVc INr;
  row IVCashVc IVCashrw;

  for (ri=0;ri<rwcnt;ri=ri+1) begin
    MatRowGet(IVCashr,ri,IVCashrw);
    if (nonblank(IVCashrw.ArtCode)) then begin 
      if (ReadFirstItem(IVCashrw.ArtCode,INr,true,true)==false) then begin
        MatRowDelete(IVCashr,ri);
        rwcnt = MatRowCnt(IVCashr);
      end;    
    end;   
  end;
end;