external procedure RecSumup(record RecVc);
external function Boolean GetFirstItem(var string,var record INVc);
external function Boolean ReadFirstItem(string,var record INVc,Boolean,Boolean);
external function Boolean FindItemVAR(string,var string,var string,var string,var string);

global
procedure RecVc_PasteItem(var record RecVc Recr,Integer rownr)
begin
  record INVc INr;
  row RecVc Recrw;
  Boolean itemfound;
  string 60 sz,msk,mskrep;
  string 200 varsubset;
  
  MatRowGet(Recr,rownr,Recrw);
  itemfound = GetFirstItem(Recrw.Item,INr);
  if (itemfound==false) then begin
    itemfound = ReadFirstItem(Recrw.Item,INr,true,true);
    if (FindItemVAR(INr.Code,sz,msk,mskrep,varsubset)) then begin
      INr.Code = Recrw.Item;
    end;
  end;
  if (itemfound) then begin
    Recrw.Item = INr.Code;    
    Recrw.Comment = INr.Name;
    Recrw.ItemCost = INr.InPrice;    
    Recrw.Unittext = INr.Unittext;    
    MatRowPut(Recr,rownr,Recrw);
  end;
  RecSumup(Recr);
  return;
end;
