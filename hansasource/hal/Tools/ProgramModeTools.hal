global
updating procedure ServerLockCompany(Integer comp,Integer level,string usercode)
begin
  record CYBlock CYr;
  
  if (comp>0) then begin // TODO: company 0
    BlockLoad(CYr);
    CYr.LockedBy = usercode;
    CYr.LockedLevel = level;
    BlockStore(CYr);
  end;
  LockCompany(comp,level);
  return;
end;

global
updating procedure ServerUnlockCompany(Integer comp)
begin
  record CYBlock CYr;
  
  UnlockCompany(comp);
  if (comp>0) then begin // TODO: company 0
    BlockLoad(CYr);
    CYr.LockedBy = "";
    CYr.LockedLevel = 0;
    BlockStore(CYr);
  end;
  LockCompany(comp,0);
  return;
end;

global
updating procedure ServerLockAllCompanies(string usercode)
begin
  integer i,rwcnt;
  record CompaniesBlock Compb;
  
  BlockLoad(Compb);
  rwcnt = MatRowCnt(Compb);  
  
  for (i = 0; i<=rwcnt; i = i + 1) begin // Incl. company 0
    ServerLockCompany(i,1,usercode);
  end;
  
  return;
end;

global
updating procedure ServerUnLockAllCompanies(string usercode)
begin
  integer i,rwcnt;
  record CompaniesBlock Compb;
  
  BlockLoad(Compb);
  rwcnt = MatRowCnt(Compb);  
  
  for (i = 0; i<=rwcnt; i = i + 1) begin // Incl. company 0
    ServerUnlockCompany(i);
  end;
  
  return;
end;

global
procedure RemoteSendSystemMessage(string mess1,string mess2,LongInt minstodown,Integer nologin,Integer autooff,Integer thiscomp)
begin
  SendSystemMessage(mess1,mess2,minstodown,nologin,autooff,thiscomp);
  return;
end;

global
function Integer ServerStartDBCopy()
begin
  Integer res;
  
  res = StartDatabaseCopy;
  ServerStartDBCopy = res;
  return;
end;

