global
function Boolean SyncINToLocalIN_NextRecord(string keystr,
                 var LongInt looppos,var LongInt seqnr,var record INVc INr,
                 var LongInt itseqnr,var record ITVc ITr)
begin
  Boolean res;
  
  SetLoopPosition(INr,looppos);  
  res = LoopKey(keystr,INr,1,true);
  seqnr = ReadSequenceNr(keystr,INr,1,true);
  looppos = GetLoopPosition(INr);

  ITr.Code = INr.Group;
  itseqnr = ReadSequenceNr("Code",ITr,1,true);
  SyncINToLocalIN_NextRecord = res;
  return;
end;

global
function Boolean SyncPLToLocalPL_NextRecord(string keystr,Integer segs,
                 var LongInt looppos,var LongInt seqnr,var record PLVc PLr)
begin
  Boolean res;
  
  SetLoopPosition(PLr,looppos);  
  res = LoopKey(keystr,PLr,segs,true);
  seqnr = ReadSequenceNr(keystr,PLr,segs,true);
  looppos = GetLoopPosition(PLr);
  SyncPLToLocalPL_NextRecord = res;
  return;
end;

global
function Boolean SyncSPDToLocalSPD_NextRecord(string keystr,
                 var LongInt looppos,var LongInt seqnr,var record SerialPortDeviceVc SPDr)
begin
  Boolean res;
  
  SetLoopPosition(SPDr,looppos);  
  res = LoopKey(keystr,SPDr,1,true);
  seqnr = ReadSequenceNr(keystr,SPDr,1,true);
  looppos = GetLoopPosition(SPDr);
  SyncSPDToLocalSPD_NextRecord = res;
  return;
end;
