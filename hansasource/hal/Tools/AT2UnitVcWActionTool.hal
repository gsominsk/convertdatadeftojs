external procedure RemoveOldATCatObjects(string,var string);

global
function Boolean PasteAT2CodeInAT2Unit(var record AT2UnitVc AT2Unitp,string lastefstr)
BEGIN
  record AT2Vc ATCatr;
  string 255 tstr,objects;
  Boolean res;
  
  ATCatr.Code = AT2Unitp.AT2Code;
  if (ReadFirstMain(ATCatr,1,true)) then begin
    if (nonblank(ATCatr.Model1)) then begin
      AT2Unitp.Model1 = ATCatr.Model1;
    end;
    if (nonblank(ATCatr.Model2)) then begin
      AT2Unitp.Model2 = ATCatr.Model2;
    end;
    if (nonblank(ATCatr.MinModel)) then begin
      AT2Unitp.ModelMin = ATCatr.MinModel;
    end;
    if (nonblank(ATCatr.MaxModel)) then begin
      AT2Unitp.ModelMax = ATCatr.MaxModel;
    end;
    if ((lastefstr!=ATCatr.Code) ) then begin//and (nonblank(lastefstr))
      objects = AT2Unitp.Objects;
      RemoveOldATCatObjects(lastefstr,objects);
      if (nonblank(ATCatr.Objects)) then begin
        if (SetInSet(ATCatr.Objects,objects)==false) then begin
          if (nonblank(AT2Unitp.Objects)) then begin
            objects = ",";
          end;
          objects = ATCatr.Objects; 
        end;
      end;
      AT2Unitp.Objects = objects;
    end;
    res = true;
  end;
  PasteAT2CodeInAT2Unit = res;
  RETURN;
END;

