remote function Boolean DoResolveIncomingMail(var record MailVc,var string);
remote updating function Boolean DoInsertIncomingMail(var record MailVc,string);

global
function Boolean ResolveIncomingMail(var record MailVc Mailr)
begin
  Boolean res;
  string 255 IncomingMailToAddress;
  transaction string 255 gExtGateIncomingMailToAddress;
  
  res = DoResolveIncomingMail(Mailr,IncomingMailToAddress);
  
  gExtGateIncomingMailToAddress = IncomingMailToAddress;
//LogText(0,"ResolveIncomingMail gExtGateIncomingMailToAddress " & gExtGateIncomingMailToAddress);  
  ResolveIncomingMail = res;
end;

global
updating function Boolean InsertIncomingMail(var record MailVc Mailr)
begin
  transaction string 255 gExtGateIncomingMailToAddress;

//LogText(0,"InsertIncomingMail gExtGateIncomingMailToAddress " & gExtGateIncomingMailToAddress);  
  InsertIncomingMail = DoInsertIncomingMail(Mailr,gExtGateIncomingMailToAddress);
end;
