
// Not used, since the report that can call this is commented out
global 
updating function Boolean CreateBDReminder(string t,string tid,var record ActVc Actr)
begin
  string 20 cust;
  string 60 contact;
  record CUVc CUr,mainCUr;
  boolean res;
  integer i,ln;
  string 1 cs;
  date wdate;
  
  RecordNew(Actr);
  contact = "";
  ln = len(tid);
  for (i=0;i<ln;i=i+1) begin
    cs = mid(tid,i,1);
    if (cs=="|") then begin
      cust = Right(tid,ln-i-1);
      i = ln;
    end else begin
      contact = contact & cs;  
    end;
  end;
  
  CUr.Code = contact; 
  mainCUr.Code = cust;

  ReadFirstMain(mainCUr,1,true);
  if (ReadFirstMain(CUr,1,true)) then begin
    RecordNew(Actr);
    wdate = AddYear(CUr.BirthDate,GetYear(currentdate)-GetYear(CUr.BirthDate));
    if (GetMonth(CUr.BirthDate)<GetMonth(currentdate)) or 
      (GetMonth(CUr.BirthDate)==GetMonth(currentdate) and 
      GetDay(CUr.BirthDate)<GetDay(currentdate)) then begin
      wdate = AddYear(wdate,1); 
    end;
    Actr.TransDate = wdate;
    Actr.EndDate = wdate;
    Actr.StartTime = USetStr(10993);
    Actr.Comment = USetStr(10984) & " - " & CUr.Name;
    Actr.TodoFlag = 2;
    Actr.CUCode = cust;
    Actr.CUName = mainCUr.Name;
    Actr.Contact = CUr.Name;   
    if (nonblank(CUr.Phone)) then begin
      Actr.Phone = CUr.Phone;    
    end else begin
      Actr.Phone = mainCUr.Phone;    
    end;
    Actr.SerNr = NextSerNr("ActVc",Actr.TransDate,-1,false,"");
    res = RecordStore(Actr,true);
  end;
  CreateBDReminder = res;
  return;
end;