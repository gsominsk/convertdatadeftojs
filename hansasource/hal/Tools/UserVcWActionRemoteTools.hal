

procedure AddLineToArea(string line,area req)
begin
  AddTextToArea(line,req);
  AddTextToArea(chr(10),req);
  return;
end;

global
procedure GetUsersForEmailAddr(string emailAddr,integer compno,var area a_users)
begin
  record UserVc Userr;
  boolean foundf,testf;

  if (blank(emailAddr)) then begin goto LGetUsersForEmailAddr; end;
  if (SetCompany(compno,false)) then begin
    Userr.LoginEmailAddr = emailAddr;
    foundf = true;
    while (LoopKey("LoginEmailAddr",Userr,1,foundf)) begin
      if (Userr.LoginEmailAddr!=emailAddr) then begin foundf = false; end;
      testf = foundf;
      if (Userr.Closed!=0) then begin testf = false; end;
      if (testf) then begin
        AddLineToArea(Userr.Code,a_users);
      end;
    end;
  end;

LGetUsersForEmailAddr:;
end;

