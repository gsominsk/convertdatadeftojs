external function Boolean Do_FindMailBoxName(var string);
external function Boolean InterNetAddrTest(string);

global
procedure LocalMailVc_PasteAddrCode(var record LocalMailVc LocalMailp,Integer rownr)
BEGIN
  row LocalMailVc LocalMailrw;
  string 255 tstr;
  
  MatRowGet(LocalMailp,rownr,LocalMailrw);
  if (nonblank(LocalMailrw.AddrCode)) then begin
    tstr = LocalMailrw.AddrCode;
    if (Do_FindMailBoxName(tstr)) then begin
      LocalMailrw.AddrCode = tstr;
      MatRowPut(LocalMailp,rownr,LocalMailrw);
    end else begin
// Not if it is a E-LocalMail address... 
      if (InterNetAddrTest(LocalMailrw.AddrCode)==false) then begin
        Beep;
      end;
    end;
  end;
  RETURN;
END;