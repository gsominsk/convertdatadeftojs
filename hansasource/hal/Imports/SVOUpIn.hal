#ifdef HAL
external procedure StripEndingSpaces(var string);

function
Integer FindSpacePosition(string tstr,Integer l)
BEGIN
  Integer i,res;
  
  res = 0;
  for (i=0;i<l;i=i+1) begin
    if ((CharacterMatch(tstr," ",i)) or (CharacterMatch(tstr,"\n",i))) then begin
      res = i;
      goto L99;
    end;
  end;  
L99:;
  FindSpacePosition = res;
  RETURN;
END;

global
updating procedure SVOUpIn(record RcVc RepSpec)
BEGIN
  record CUVc CUr;
  record INVc INr;
  record SVOSerVc SVOSerr;// SVOSerView
  Boolean testf,storef;
  string 255 tstr;
  Integer i;
  
  testf = true;  
  i = 1;
  storef = true;
  while (testf) begin  
    tstr = ImportField();
//    if (len(tstr)==0) then begin testf = false; end;
    if (len(tstr)==0) then begin 
      if (nonblank(SVOSerr.SerialNr) and nonblank(SVOSerr.ItemCode) and (storef)) then begin
        if (RecordStore(SVOSerr,true)) then begin end;
      end;    
      testf = NextImportLine(false); 
      storef = true;
      i = 1;
      SVOSerr.CustCode = "";
      SVOSerr.ItemCode = "";
      SVOSerr.SerialNr = "";      
    end;
    if (blank(tstr)==false) then begin
      if (i==1) then begin
        SVOSerr.SerialNr = tstr;
        StripEndingSpaces(SVOSerr.SerialNr);        
      end;
      if (i==2) then begin
        INr.Code = tstr;
        if (ReadFirstMain(INr,1,true)) then begin
          SVOSerr.ItemCode = INr.Code;
          SVOSerr.ItemName = INr.Name;
//          SVOSerr.xInStock = 1;
        end else begin
          storef = false;
        end;
      end;
      if (i==3) then begin
        CUr.Code = tstr;
        if (ReadFirstMain(CUr,1,true)) then begin
          SVOSerr.CustCode = CUr.Code;
          SVOSerr.CustName = CUr.Name;
        end else begin
        end;
      end;
      i = i+1;
    end;
  end;
  CloseFile;        
  RETURN;
END;
#endif