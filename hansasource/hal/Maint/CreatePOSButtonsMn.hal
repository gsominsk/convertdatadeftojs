updating procedure CreateNewPage(string WindowClass,integer Page,string ButtonGroup,string Comment,var record POSButtonsVc POSButtonsr)
begin

  RecordNew(POSButtonsr);
  POSButtonsr.WindowClass = WindowClass;
  POSButtonsr.Page = Page;
  POSButtonsr.POSButtonGroupCode = ButtonGroup;
  POSButtonsr.Comment = Comment;

  return;
end;

procedure CreateNewButton(record POSButtonsVc POSButtonsr,integer ButtonType,string Code,integer Colour,string Label,integer RowIndex)
begin
  row POSButtonsVc POSButtonsrw;

  POSButtonsrw.ButtonType = ButtonType;
  POSButtonsrw.Code = Code;
  POSButtonsrw.colnr = Colour;
  POSButtonsrw.Label = Label;
  MatRowPut(POSButtonsr,RowIndex,POSButtonsrw);

  return;
end;

global
updating procedure CreatePOSButtonsMn(record RcVc RepSpec)
begin
  record ITVc ITr;
  record POSButtonsVc POSButtonsMainPager,POSButtonsItemPager;
  record POSButtonsVc POSButtonsrw;
  record INVc INr;
  string 255 WindowClass,POSButGroup,ItemGroupName;
  integer PageCnt;

  WindowClass = RepSpec.f2;
  if blank(WindowClass) then begin
    WindowClass = "NPTSIVCashDClass";
  end;
  if RepSpec.flags[0]==1 then begin
    while (LoopMain(POSButtonsItemPager,1,true)) begin
      if (WindowClass==POSButtonsItemPager.WindowClass) then begin
        RecordDelete(POSButtonsItemPager);
        StepBack(POSButtonsItemPager);
      end;
    end;
  end;
  POSButGroup = RepSpec.f1;
  CreateNewPage(WindowClass,1,POSButGroup,"Main",POSButtonsMainPager);
  PageCnt = 1;
  while (LoopMain(ITr,1,true)) begin
    PageCnt = PageCnt+1;
    if blank(ITr.Comment) then begin
      ItemGroupName = "Unknown";
    end else begin
      ItemGroupName = ITr.Comment;
    end;
    CreateNewButton(POSButtonsMainPager,kPOSButtonTypeGotoPage,PageCnt,6,ItemGroupName,MatRowCnt(POSButtonsMainPager));
    CreateNewPage(WindowClass,PageCnt,POSButGroup,ItemGroupName,POSButtonsItemPager);
    ResetLoop(INr);
    RecordClear(INr);
    INr.Group = ITr.Code;
    while LoopKey("Code:" & ITr.Code,INr,1,true) begin
      CreateNewButton(POSButtonsItemPager,kPOSButtonTypeItem,INr.Code,2,INr.Name,MatRowCnt(POSButtonsItemPager))
    end;
    RecordInsert(POSButtonsItemPager,false);
  end;
  RecordInsert(POSButtonsMainPager,false);

  return;
end;