global
updating procedure CUCOSDUpdateMn(record RcVc RepSpec)
begin
  record COCUServiceVc orgCOr;
  record COCUServiceVc COr;
  record COCUServiceVc oldCOr;
  LongInt frco,toco;
  Boolean foundf,testf;
  LongInt perdays;
  Date td;
  
  frco = FirstInRange(RepSpec.f1,20);
  toco = LastInRange(RepSpec.f1,20);
  perdays = RepSpec.long1;
  COr.SerNr = frco;
  foundf = true;
  while (LoopMain(COr,1,foundf)) begin
    if (nonblank(RepSpec.f1)) then begin
      if (COr.SerNr>toco) then begin
        foundf = false;
      end;
    end;
    testf = foundf;
    if (nonblank(RepSpec.f2)) then begin
      if (RepSpec.f2!=COr.Class) then begin
        testf = false;
      end;
    end;
    if (RepSpec.flags[10]>0) then begin
      if (RepSpec.flags[10]==100) Then begin
        RepSpec.flags[10] = 0;
      end;
      if (RepSpec.flags[10]!=COr.ProgType) then begin
        testf = false;
      end;
    end;
    if (testf) then begin
      testf = false;
      td = COr.startDate;
      if (td.day!=1) then begin testf = true; end;
      if (perdays>=0 and COr.invDays!=perdays) then begin testf = true; end;
      testf = true;
      if (testf) then begin
        RecordCopy(orgCOr,COr);
        RecordCopy(oldCOr,COr);
        COr.OKFlag = 0;
        RecordUpdate(oldCOr,COr,true);
        
        RecordCopy(oldCOr,COr);
        if (orgCOr.OKFlag!=0) then begin
          COr.OKFlag = 1;
        end;
        td.day = 1;
        COr.startDate = td;
        COr.invDays = perdays;
        RecordUpdate(oldCOr,COr,true);
      end;
    end;
  end;
  return;
end;
