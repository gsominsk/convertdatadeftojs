global
updating procedure FillinIPNrMn(record RcVc RepSpec)
begin
  record IPVc IPr;
  row IPVc IPrw;
  record IPVc oldIPr;
  Boolean found,updf;
  Integer rwcnt,i;
  
  found = true;
  while (LoopMain(IPr,1,found)) begin
    if (found) then begin
      updf = false;
      RecordCopy(oldIPr,IPr);
      rwcnt = MatRowCnt(IPr);
      for(i=0;i<rwcnt;i=i+1) begin
        MatRowGet(IPr,i,IPrw);
        if (blank(IPrw.InvoiceOfficialSerNr)) then begin
          IPrw.InvoiceOfficialSerNr = IPrw.InvoiceNr;
          MatRowPut(IPr,i,IPrw);
          updf = true;
        end;
      end;
      if (updf) then begin
        if (RecordUpdate(oldIPr,IPr,false)==0) then begin
        end;
      end;
    end;
  end;
  return;
end;