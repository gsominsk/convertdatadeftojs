globalupdating function boolean DoETasksQueueCleanup(var record RcVc RepSpec)begin  Boolean res;  record ETasksQueueVc ETQr;  Boolean found;  record SMSVc SMSr;    ETQr.Status = 0;  ETQr.FileName = "SMSVc";  found = true;  SetLoopPosition(ETQr,RepSpec.long2);  while (LoopKey("StatusFileName",ETQr,2,found)) begin    if (ETQr.Status!=0) then begin found = false; end;    if (ETQr.FileName!="SMSVc") then begin found = false; end;    if (found) then begin      SMSr.SerNr = ETQr.RecSerNr;      if (ReadFirstMain(SMSr,1,true)) then begin        if (SMSr.MessageType!=kComMessageTypeSms) then begin          RecordRemove(ETQr);          StepBack(ETQr);LogText(0,"1.DoETasksQueueCleanup deleting ETQr.SerNr " & ETQr.SerNr & " ETQr.FileName " & ETQr.FileName);          found = false;          res = true;        end;      end else begin        RecordRemove(ETQr);        StepBack(ETQr);LogText(0,"2.DoETasksQueueCleanup deleting ETQr.SerNr " & ETQr.SerNr & " ETQr.FileName " & ETQr.FileName);        found = false;        res = true;      end;      RepSpec.long2 = GetLoopPosition(ETQr);    end;  end;  DoETasksQueueCleanup = res;  return;end;globalprocedure ETasksQueueCleanupMn(record RcVc RepSpec)begin  while (qupdating.DoETasksQueueCleanup(RepSpec)) begin  end;  return;end;/*globalprocedure ETasksQueueCleanupMn(record RcVc RepSpec)begin  record ETasksQueueVc ETQr;  Boolean found;  record SMSVc SMSr;    ETQr.Status = 0;  ETQr.FileName = "SMSVc";  while (LoopKey("StatusFileName",ETQr,2,found)) begin    if (ETQr.Status!=0) then begin found = false; end;    if (ETQr.FileName!="SMSVc") then begin found = false; end;        if (found) then begin      SMSr.SerNr = ETQr.RecSerNr;      if (ReadFirstMain(SMSr,1,true)) then begin        if (SMSr.MessageType!=kComMessageTypeSms) then begin          RecordRemove(ETQr);        end;      end else begin        RecordRemove(ETQr);      end;    end;  end;  return;end;*/