external updating procedure ARInstallmentAdd(record IVVc,val,Boolean);

global
updating procedure CreateInstlHistMn(record RcVc RepSpec)
begin
  Boolean found;
  record IVVc IVr;
  LongInt friv,toiv;
  
  friv = FirstInRange(RepSpec.f1,10);
  toiv = LastInRange(RepSpec.f1,10);
  IVr.SerNr = friv;
  found = true;
  while (LoopMain(IVr,1,found)) begin
    if (nonblank(RepSpec.f1)) then begin
      if (IVr.SerNr>toiv) then begin found = false; end;
    end;
    if (found) then begin
      if (IVr.InstallmentInv==1) then begin
        ARInstallmentAdd(IVr,IVr.Sum4,false);
      end;
    end;
  end;
  return;
end;