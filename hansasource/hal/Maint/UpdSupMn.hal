external procedure CheckFlush(var Integer,Integer);

global
updating procedure UpdSupMn(record RcVc RepSpec)
BEGIN
  record CUVc VEr,oldVEr;
  string 20 fromve,tove;
  string 255 tstr;
  Boolean TrHs,save,testf;
  Integer flushcnt;
  
  fromve = FirstInRange(RepSpec.f1,10);
  tove = LastInRange(RepSpec.f1,10);
  VEr.Code = fromve;
  TrHs = true;
  while (LoopMain(VEr,1,TrHs)) begin
    if (TrHs) then begin
      if (nonblank(tove)) then begin
        if (VEr.Code>tove) then begin
          TrHs = false;
        end;
      end;
    end;   
    testf = true;   
    if (VEr.VEType==0) then begin testf = false; end;
    if (TrHs and testf) then begin
      RecordCopy(oldVEr,VEr);
      if (RepSpec.flags[0]==1) then begin
        tstr = VEr.AccOperator;
        VEr.AccOperator = VEr.Bank;
        VEr.Bank = tstr;
        save = true;
      end;
      if (save) then begin
        if (RecordUpdate(oldVEr,VEr,true)!=0) then begin
        end;
        CheckFlush(flushcnt,10);
      end;  
    end;
    MaintTrace(VEr.Code);                                      
  end;
  RETURN;
END;