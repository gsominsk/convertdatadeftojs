global
updating procedure DelATTransMn(record RcVc RepSpec)
begin
  record AT2TransVc ATTransr;
  Boolean foundf,testf;
  Integer flushcnt;

  foundf = true;
  flushcnt = 0;
  while LoopMain(ATTransr,1,foundf) begin
    testf = true;
    if (nonblank(RepSpec.f1) and RepSpec.f1 <> ATTransr.InventoryNr) then begin
      testf = false;
    end;
    if (RepSpec.long1>0 and RepSpec.long1 <> ATTransr.TransNr) then begin
      testf = false;
    end;
    if (testf) then begin
      RecordDelete(ATTransr);
      StepBack(ATTransr);
    end;
  end;
  return;
end;