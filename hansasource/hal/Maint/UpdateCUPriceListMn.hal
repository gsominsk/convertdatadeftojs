global
updating function Boolean UpdateCUPriceListMnExecute(var record RcVc RepSpec)
begin
  Boolean res;
  record CUVc CUr;
  record CUVc oldCUr;
  Boolean found,testf;
  string 255 frcu,tocu;
  
  frcu = FirstInRange(RepSpec.f1,20);
  tocu = LastInRange(RepSpec.f1,20);
  CUr.Code = frcu;
  SetLoopPosition(CUr,RepSpec.long1);
  found = true;
  while (LoopMain(CUr,1,found)) begin
    if (nonblank(RepSpec.f1)) then begin 
      if (CUr.Code>tocu) then begin found = false; end;
    end;
    if (found) then begin
      testf = true;
      if (nonblank(RepSpec.f2)) then begin
        if (SetInSet(RepSpec.f2,CUr.Classification)==false) then begin
          testf = false;
        end;
      end;
      if (testf) then begin
        RecordCopy(oldCUr,CUr);
        CUr.PLCode = RepSpec.FirstAcc;
        RecordUpdate(oldCUr,CUr,false);
      end;
      res = true;
      RepSpec.long1 = GetLoopPosition(CUr);
    end;
  end;
  UpdateCUPriceListMnExecute = res;
  return;
end;

global
procedure UpdateCUPriceListMn(record RcVc RepSpec)
begin
  record CUVc CUr;

  while (qupdating.UpdateCUPriceListMnExecute(RepSpec)) begin
  end;  
  return;
end;
