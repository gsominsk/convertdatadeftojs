external procedure CheckFlush(var Integer,Integer);

global 
updating procedure MassMailMn(Record RcVc RepSpec)
begin
  record CUVc CUr;
  Boolean foundf,testf;
  string 20 frcu,tocu;
  Boolean res;
  Integer cnt;
  
  frcu = FirstInRange(RepSpec.f1,20);
  tocu = LastInRange(RepSpec.f1,20);
  foundf = true;
  CUr.Code = frcu;
  while (LoopMain(CUr,1,foundf)) begin
    if (foundf) then begin
      if (nonblank(RepSpec.f1)) then begin
        if (CUr.Code > tocu) then begin
          foundf = false;  
        end;  
      end;
    end;
    testf = true;
    if (foundf==false) then begin
      testf = false;
    end;
    if (testf) then begin
      MaintTrace(CUr.Code);
      CUr.NoLetterPosting = RepSpec.flags[1];
      CUr.NoMailPosting = RepSpec.flags[2];
      res = RecordStore(CUr,true);
      CheckFlush(cnt, 25)    
    end; 
  end; 
  return;
end;  
