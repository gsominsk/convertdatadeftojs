external updating function Boolean SendSMSFromSystem(string,string,string,string);

global
updating procedure SendUpdateSMSMn(record RcVc RepSpec)
begin
  record MobileDeviceVc MobileDevicer;
  Boolean TrHs;
  string 255 tstr;
  LongInt fromno;
  LongInt tono;

  fromno = FirstInRange(RepSpec.f3,20);
  tono = LastInRange(RepSpec.f3,20);

  MobileDevicer.SerNr = fromno;
  if (nonblank(RepSpec.f2)) then begin
    tstr = RepSpec.f2 & " ";
  end;
  tstr = tstr & RepSpec.f1;
  TrHs = true;
  while (LoopMain(MobileDevicer,1,TrHs)) begin
    if (tono!=-1) then begin
      if (MobileDevicer.SerNr>tono) then begin
        TrHs = false;
      end;
    end;    
    if (TrHs) then begin
      if (MobileDevicer.ActiveFlag==1) then begin
        if (RepSpec.flags[0]==MobileDevicer.DeviceType) then begin
          if (SendSMSFromSystem(RepSpec.f4,MobileDevicer.MobileNumber,tstr,"")) then begin
          end;
        end;
      end;
    end;
  end;
  return;
end;
