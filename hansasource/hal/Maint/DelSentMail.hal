external procedure CheckFlush(var Integer,Integer);

global
updating procedure DelSentMailMn(record RcVc RepSpec)
begin
  Record EMailQueVc EMailQuer;
  Boolean TrHs,testf; 
  Integer flushcnt;
 
  EMailQuer.EMailSent = kEMailQueueSent;
  TrHs = true; 
  while (LoopKey("Sending",EMailQuer,1,TrHs)) begin
     testf = true;     
     if (EMailQuer.EMailSent!=kEMailQueueSent) then begin
       TrHs = false;
       testf = false;
     end;
     if (EMailQuer.QueDate<RepSpec.sStartDate) or (EMailQuer.QueDate>RepSpec.sEndDate) then begin
       testf = false;
     end;
     if (testf) then begin
       RecordDelete(EMailQuer);     
       StepBack(EMailQuer);        
     end;
  end;  
  return;
end;

