external updating procedure AddToResTypeSupport(record JobVc,Boolean);

global
updating procedure RebuildResTypeSupMn(record RcVc RepSpec)
begin
  record JobVc Jobr;
  record ResTypeSupportVc ResTypeSupportr;
  Boolean testf;
  
  SetDatabaseToUnsafeMode;
  
  while (LoopMain(ResTypeSupportr,1,true)) begin
    RecordDelete(ResTypeSupportr);
    StepBack(ResTypeSupportr);
  end;
  
  if (RepSpec.flags[0]==0) then begin
    Jobr.SerNr = -1;
    while (LoopMain(Jobr,1,true)) begin
      AddToResTypeSupport(Jobr,false);
      MaintTrace(Jobr.SerNr);
    end;
  end;
  
  SetDatabaseToSafeMode;
  
  return;
end;
