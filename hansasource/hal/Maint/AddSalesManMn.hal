external function Boolean CUVc_PasteSalesMan(var record CUVc);
external procedure CheckFlush(var Integer,Integer);

global
updating procedure AddSalesManMn(record RcVc RepSpec)
BEGIN
  record CUVc CUr;
  record CUVc oldCUr;
  string 20 fromcust;
  string 20 tocust;
  string 20 fromcat;
  string 20 tocat;
  Boolean TrHs,testf;
  Integer flushcnt;

  fromcust = FirstInRange(RepSpec.f1,20);
  tocust = LastInRange(RepSpec.f1,20);
  fromcat = FirstInRange(RepSpec.f2,5);
  tocat = LastInRange(RepSpec.f2,5);
  TrHs = true;
  CUr.Code = fromcust;
  ResetLoop(CUr);
  while(LoopMain(CUr,1,TrHs)) begin
    if (nonblank(RepSpec.f1)) then begin
      if (CUr.Code>tocust) then begin
        TrHs = false;
      end;
    end;
    testf = true;
    if (TrHs==false) then begin
      testf = false;
    end;
    if (nonblank(RepSpec.f2)) then begin
      if ((CUr.CustCat<fromcat) or (CUr.CustCat>tocat)) then begin
        testf = false;
      end;
    end;
    if (testf) then begin
      RecordCopy(oldCUr,CUr);
      CUr.SalesMan = RepSpec.FirstAcc;
      if (CUVc_PasteSalesMan(CUr)) then begin
        if (RecordUpdate(oldCUr,CUr,false)) then begin  end;
        CheckFlush(flushcnt,10);
      end;
    end;
  end;
  RETURN;
END;

