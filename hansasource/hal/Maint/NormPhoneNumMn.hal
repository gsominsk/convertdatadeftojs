external updating procedure StoreNormalizedNumbers(record CUVc,Integer);

global
updating procedure NormPhoneNumMn(record RcVc RepSpec)
begin
  record CUVc CUr;
  record CompaniesBlock CompaniesRec;
  record NormPhoneNumVc NormPhoneNumr;
  row CompaniesBlock comprw;
  Boolean found;
  Integer compnr,oldcomp;
  Integer i,rwcnt;

  if (RepSpec.flags[0]==1) then begin
    while (LoopMain(NormPhoneNumr,1,true)) begin
      RecordDelete(NormPhoneNumr);
      StepBack(NormPhoneNumr);
    end;
  end;
  oldcomp = CurrentCompany;
  BlockLoad(CompaniesRec);
  rwcnt = MatRowCnt(CompaniesRec);
  for (i=0;i<rwcnt;i=i+1) begin
    MatRowGet(CompaniesRec,i,comprw);
    if (SetCompany(i+1,false)) then begin
      ResetLoop(CUr);
      found = true;
      CUr.Code = "";
      while (LoopMain(CUr,1,found)) begin
        if (found) then begin
          StoreNormalizedNumbers(CUr,i+1);
        end;
      end;
    end;
  end;
  ResetCompany(oldcomp);
  return;
end;
