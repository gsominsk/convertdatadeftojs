global
updating procedure GrJobFromMoJobMn(record RcVc RepSpec)
begin
  record JobVc Jobr;
  record JobVc oldJobr;
  record JobVc subJobr;
  Boolean found,testf;
  Time blankt;
  record HotelBlock Hotelb;
  
  BlockLoad(Hotelb);
  found = true;
  Jobr.TransDate = RepSpec.sStartDate;
  while (LoopKey("TransDate",Jobr,1,found)) begin
    if (DateInRange(Jobr.TransDate,RepSpec.sStartDate,RepSpec.sEndDate)==false) then begin
      found = false;
    end;
    if (found) then begin
      testf = true;
      if (Jobr.ResStatus==Hotelb.ChOutSt) then begin testf = false; end;
      if (Jobr.ResStatus==Hotelb.NoshowStatus) then begin testf = false; end;
      if (Jobr.ResStatus==Hotelb.WebDeletedStatus) then begin testf = false; end;
      if (Jobr.ReservationType==kReservationTypeGroup) then begin testf = false; end;
      if (testf) then begin
        subJobr.Mother = Jobr.SerNr;
        testf = ReadFirstKey("MotherKey",subJobr,1,true);
      end;
      if (testf) then begin
        RecordCopy(subJobr,Jobr);
        RecordCopy(oldJobr,Jobr);
        Jobr.ReservationType = kReservationTypeGroup;
        Jobr.StartTime = blankt;
        Jobr.EndTime = blankt;
        Jobr.ResUsage = "";
        if (RecordUpdate(oldJobr,Jobr,true)==0) then begin
          subJobr.Mother = Jobr.SerNr;
          subJobr.SerNr = NextSerNr("JobVc",subJobr.TransDate,-1,false,"");
          RecordStore(subJobr,false);
        end;
      end;
    end;
  end;
  return;
end;